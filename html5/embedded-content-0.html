<!DOCTYPE html><html lang="en-US-x-Hixie"><meta charset="utf-8"><title>4.7 Embedded content — HTML5</title><script src="link-fixup.js"></script>
<style type="text/css">

     .applies thead th > * { display: block; }
     .applies thead code { display: block; }
     .applies tbody th { white-space: nowrap; }
     .applies td { text-align: center; }
     .applies .yes { background: yellow; }

     .matrix, .matrix td { border: hidden; text-align: right; }
     .matrix { margin-left: 2em; }

     .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
     .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
     .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

     td.eg { border-width: thin; text-align: center; }

     #table-example-1 { border: solid thin; border-collapse: collapse; margin-left: 3em; }
     #table-example-1 * { font-family: "Essays1743", serif; line-height: 1.01em; }
     #table-example-1 caption { padding-bottom: 0.5em; }
     #table-example-1 thead, #table-example-1 tbody { border: none; }
     #table-example-1 th, #table-example-1 td { border: solid thin; }
     #table-example-1 th { font-weight: normal; }
     #table-example-1 td { border-style: none solid; vertical-align: top; }
     #table-example-1 th { padding: 0.5em; vertical-align: middle; text-align: center; }
     #table-example-1 tbody tr:first-child td { padding-top: 0.5em; }
     #table-example-1 tbody tr:last-child td { padding-bottom: 1.5em; }
     #table-example-1 tbody td:first-child { padding-left: 2.5em; padding-right: 0; width: 9em; }
     #table-example-1 tbody td { padding-left: 2em; padding-right: 2em; }
     #table-example-1 tbody td:first-child + td { width: 10em; }
     #table-example-1 tbody td:first-child + td ~ td { width: 2.5em; }
     #table-example-1 tbody td:first-child + td + td + td ~ td { width: 1.25em; }

     .apple-table-examples { border: none; border-collapse: separate; border-spacing: 1.5em 0em; width: 40em; margin-left: 3em; }
     .apple-table-examples * { font-family: "Times", serif; }
     .apple-table-examples td, .apple-table-examples th { border: none; white-space: nowrap; padding-top: 0; padding-bottom: 0; }
     .apple-table-examples tbody th:first-child { border-left: none; width: 100%; }
     .apple-table-examples thead th:first-child ~ th { font-size: smaller; font-weight: bolder; border-bottom: solid 2px; text-align: center; }
     .apple-table-examples tbody th, .apple-table-examples tfoot th { font: inherit; text-align: left; }
     .apple-table-examples td { text-align: right; vertical-align: top; }
     .apple-table-examples.e1 tbody tr:last-child td { border-bottom: solid 1px; }
     .apple-table-examples.e1 tbody + tbody tr:last-child td { border-bottom: double 3px; }
     .apple-table-examples.e2 th[scope=row] { padding-left: 1em; }
     .apple-table-examples sup { line-height: 0; }

     .details-example img { vertical-align: top; }

     #base64-table {
       white-space: nowrap;
       font-size: 0.6em;
       column-width: 6em;
       column-count: 5;
       column-gap: 1em;
       -moz-column-width: 6em;
       -moz-column-count: 5;
       -moz-column-gap: 1em;
       -webkit-column-width: 6em;
       -webkit-column-count: 5;
       -webkit-column-gap: 1em;
     }
     #base64-table thead { display: none; }
     #base64-table * { border: none; }
     #base64-table tbody td:first-child:after { content: ':'; }
     #base64-table tbody td:last-child { text-align: right; }

     #named-character-references-table {
       white-space: nowrap;
       font-size: 0.6em;
       column-width: 30em;
       column-gap: 1em;
       -moz-column-width: 30em;
       -moz-column-gap: 1em;
       -webkit-column-width: 30em;
       -webkit-column-gap: 1em;
     }
     #named-character-references-table > table > tbody > tr > td:first-child + td,
     #named-character-references-table > table > tbody > tr > td:last-child { text-align: center; }
     #named-character-references-table > table > tbody > tr > td:last-child:hover > span { position: absolute; top: auto; left: auto; margin-left: 0.5em; line-height: 1.2; font-size: 5em; border: outset; padding: 0.25em 0.5em; background: white; width: 1.25em; height: auto; text-align: center; }
     #named-character-references-table > table > tbody > tr#entity-CounterClockwiseContourIntegral > td:first-child { font-size: 0.5em; }

     .glyph.control { color: red; }

     @font-face {
       font-family: 'Essays1743';
       src: url('fonts/Essays1743.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-weight: bold;
       src: url('fonts/Essays1743-Bold.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-style: italic;
       src: url('fonts/Essays1743-Italic.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-style: italic;
       font-weight: bold;
       src: url('fonts/Essays1743-BoldItalic.ttf');
     }

    </style>
<style type="text/css">
       pre { margin-left: 2em; white-space: pre-wrap; }
       h2 { margin: 3em 0 1em 0; }
       h3 { margin: 2.5em 0 1em 0; }
       h4 { margin: 2.5em 0 0.75em 0; }
       h5, h6 { margin: 2.5em 0 1em; }
       h1 + h2, h1 + h2 + h2, h1 + p, h1 + p + h2 { margin: 0.75em 0 0.75em; }
       h2 + h3, h3 + h4, h4 + h5, h5 + h6 { margin-top: 0.5em; }
       p { margin: 1em 0; }
       hr:not(.top) { display: block; background: none; border: none; padding: 0; margin: 2em 0; height: auto; }
       .element dd,  .element dl { margin-top: 0em; margin-bottom: 0.25em;}
       dt { margin-top: 0.75em; margin-bottom: 0.5em; clear: left; }
        .element dt { margin-top: 0.5em; margin-bottom: 0.5em;  }
       dt + dt { margin-top: 0; }
       dd dt { margin-top: 0.25em; margin-bottom: 0; }
       dd p { margin-top: 0; }
       dd dl + p { margin-top: 1em; }
       dd table + p { margin-top: 1em; }
       p + * > li, dd li { margin: 1em 0; }
       dt, dfn { font-weight: bold; font-style: normal; }
       i, em { font-style: italic; }
       dt dfn { font-style: italic; }
       pre, code { font-size: inherit; font-family: monospace; font-variant: normal; }
       pre strong { color: black; font: inherit; font-weight: bold; background: yellow; }
       pre em { font-weight: bolder; font-style: normal; }
       @media screen { code { color: #D93B00; } code :link, code :visited { color: inherit; } }
       var { background-color: #f9f9f9; border: 1px solid #eee; padding: 0 2px; }
       var sub { vertical-align: bottom; font-size: smaller; position: relative; top: 0.1em; }
       table { border-collapse: collapse; border-style: hidden hidden none hidden; }
       table thead, table tbody { border-bottom: solid; }
       table tbody th:first-child { border-left: solid; }
       table tbody th { text-align: left; }
       table td, table th { border-left: solid; border-right: solid; border-bottom: solid thin; vertical-align: top; padding: 0.2em; }
       blockquote { margin: 0 0 0 2em; border: 0; padding: 0; font-style: italic; }

       .bad, .bad *:not(.XXX) { color: #5F6D7A; border-color: gray; background: transparent; }
       .matrix, .matrix td { border: none; text-align: right; }
       .matrix { margin-left: 2em; }
       .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
       .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
       .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

       .toc dfn, h1 dfn, h2 dfn, h3 dfn, h4 dfn, h5 dfn, h6 dfn { font: inherit; }
       img.extra, p.overview { float: right; }
       pre.idl { border: solid thin #d3d3d3; background: #FCFCFC; color: black; padding: 0.5em 1em; position: relative; }
       pre.idl :link, pre.idl :visited { color: inherit; background: transparent; }
       pre.idl::before { content: "IDL"; font: bold small sans-serif; padding: 0.5em; background: white; position: absolute; top: 0; margin: -1px 0 0 -4em; width: 1.5em; border: thin solid; border-radius: 0 0 0 0.5em }
       pre.css { border: solid thin; background: #FFFFEE; color: black; padding: 0.5em 1em; }
       pre.css:first-line { color: #AAAA50; }
       dl.domintro {padding: 0.5em 1em; border: none; background:#E9FBE9; border: 1px solid lightgray; }
       hr + dl.domintro, div.impl + dl.domintro { margin-top: 2.5em; margin-bottom: 1.5em; }
       dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
       dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
       dl.domintro dd p { margin: 0.5em 0; }
       dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This definition is non-normative. Implementation requirements are given below this definition.'; color: #606060; border:1px solid lightgray; background: white; padding: 0 0.25em;font-size:.9em;}
       dl.switch { padding-left: 2em; }
       dl.switch > dt { text-indent: -1.5em; }
       dl.switch > dt:before { content: '\21AA'; padding: 0 0.5em 0 0; display: inline-block; width: 1em; text-align: right; line-height: 0.5em; }
       dl.triple { padding: 0 0 0 1em; }
       dl.triple dt, dl.triple dd { margin: 0; display: inline }
       dl.triple dt:after { content: ':'; }
       dl.triple dd:after { content: '\A'; white-space: pre; }
       .diff-old { text-decoration: line-through; color: silver; background: transparent; }
       .diff-chg, .diff-new { text-decoration: underline; color: green; background: transparent; }
       a .diff-new { border-bottom: 1px blue solid; }

       figure.diagrams { border: double black; background: white; padding: 1em; }
       figure.diagrams img { display: block; margin: 1em auto; } 

       h2 { page-break-before: always; }
       h1, h2, h3, h4, h5, h6 { page-break-after: avoid; }
       h1 + h2, hr + h2.no-toc { page-break-before: auto; }

       p  > span:not([title=""]):not([class="XXX"]):not([class="impl"]):not([class="note"]):not([class="t2"]):not([id]):not([lang]),
       li > span:not([title=""]):not([class="XXX"]):not([class="impl"]):not([class="note"]):not([class="t2"]):not([id]):not([lang])
       { border-bottom: solid #9999CC; }

       div.head { margin: 0 0 1em; padding: 1em 0 0 0; }
       div.head p { margin: 0; }
       div.head h1 { margin: 0; }
       div.head .logo { float: right; margin: 0 1em; }
       div.head .logo img { border: none } /* remove border from top image */
       div.head dl { margin: 1em 0; }
       div.head p.copyright, div.head p.alt { font-size: x-small; font-style: oblique; margin: 0; }

       body > .toc > li { margin-top: 1em; margin-bottom: 1em; }
       body > .toc.brief > li { margin-top: 0.35em; margin-bottom: 0.35em; }
       body > .toc > li > * { margin-bottom: 0.5em; }
       body > .toc > li > * > li > * { margin-bottom: 0.25em; }
       .toc, .toc li { list-style: none; }

       .brief { margin-top: 1em; margin-bottom: 1em; line-height: 1.1; }
       .brief li { margin: 0; padding: 0; }
       .brief li p { margin: 0; padding: 0; }

       .category-list { margin-top: -0.75em; margin-bottom: 1em; line-height: 1.5; }
       .category-list::before { content: '\21D2\A0'; font-size: 1.2em; font-weight: 900; }
       .category-list li { display: inline; }
       .category-list li:not(:last-child)::after { content: ', '; }
       .category-list li > span, .category-list li > a { text-transform: lowercase; }
       .category-list li * { text-transform: none; } /* don't affect <code> nested in <a> */

       .XXX { color: #E50000; background: white; border: solid red; padding: 0.5em; margin: 1em 0; }
       .XXX > :first-child { margin-top: 0; }
       p .XXX { line-height: 3em; }
       .annotation { border: solid thin black; background: #0C479D; color: white; position: relative; margin: 8px 0 20px 0; }
       .annotation:before { position: absolute; left: 0; top: 0; width: 100%; height: 100%; margin: 6px -6px -6px 6px; background: #333333; z-index: -1; content: ''; }
       .annotation :link, .annotation :visited { color: inherit; }
       .annotation :link:hover, .annotation :visited:hover { background: transparent; }
       .annotation span { border: none ! important; }
       .note { border-left-style: solid; border-left-width: 0.25em; background: none repeat scroll 0 0 #E9FBE9; border-color: #52E052; }
       .warning { background-color: #F9F0D4; border: medium double #FF0000; margin: 1em; padding: 1em; }
       .note em, .warning em, .note i, .warning i { font-style: normal; }
       p.note, div.note { padding: 0.5em 2em; }
       span.note { padding: 0 2em; }
       .note p:first-child, .warning p:first-child { margin-top: 0; }
       .note p:last-child, .warning p:last-child { margin-bottom: 0; }
       .warning:before { font-style: normal; }
       p.note:before { content: 'Note: '; font-weight: bolder;}
       p.warning:before { content: '\26A0 Warning! '; font-weight:bolder;}
       .critical {margin:1em; border:double red; padding:1em; background-color:#F9F0D4;}

       .bookkeeping:before { display: block; content: 'Bookkeeping details'; font-weight: bolder; font-style: italic; }
       .bookkeeping { font-size: 0.8em; margin: 2em 0; }
       .bookkeeping p { margin: 0.5em 2em; display: list-item; list-style: square; }
       .bookkeeping dt { margin: 0.5em 2em 0; }
       .bookkeeping dd { margin: 0 3em 0.5em; }

       h4 { position: relative; z-index: 3; }
       h4 + .element, h4 + div + .element { margin-top: -2.5em; padding-top: 2em; }
       .element {
         background: #F4F4FA;
         color: black;
         margin: 0 0 1em 0.15em;
         padding: 0 1em 0.25em 0.75em;
         border-left: solid #9999FF 0.25em;
         position: relative;
         z-index: 1;
       }
       .element:before {
         position: absolute;
         z-index: 2;
         top: 0;
         left: -1.15em;
         height: 2em;
         width: 0.9em;
         background: #F4F4FA;
         content: ' ';
         border-style: none none solid solid;
         border-color: #9999FF;
         border-width: 0.25em;
       }

       .example { display: block; color: #222222; background: #FCFCFC; border-left-style: solid;border-color:#c0c0c0; border-left-width: 0.25em; margin-left: 1em; padding-left: 1em;padding-bottom: 0.5em;}
       div.example:before { content: 'Code Example: '; font-weight: bolder;}
       td > .example:only-child { margin: 0 0 0 0.1em; }

       ul.domTree, ul.domTree ul { padding: 0 0 0 1em; margin: 0; }
       ul.domTree li { padding: 0; margin: 0; list-style: none; position: relative; }
       ul.domTree li li { list-style: none; }
       ul.domTree li:first-child::before { position: absolute; top: 0; height: 0.6em; left: -0.75em; width: 0.5em; border-style: none none solid solid; content: ''; border-width: 0.1em; }
       ul.domTree li:not(:last-child)::after { position: absolute; top: 0; bottom: -0.6em; left: -0.75em; width: 0.5em; border-style: none none solid solid; content: ''; border-width: 0.1em; }
       ul.domTree span { font-style: italic; font-family: serif; }
       ul.domTree .t1 code { color: purple; font-weight: bold; }
       ul.domTree .t2 { font-style: normal; font-family: monospace; }
       ul.domTree .t2 .name { color: black; font-weight: bold; }
       ul.domTree .t2 .value { color: blue; font-weight: normal; }
       ul.domTree .t3 code, .domTree .t4 code, .domTree .t5 code { color: gray; }
       ul.domTree .t7 code, .domTree .t8 code { color: green; }
       ul.domTree .t10 code { color: teal; }

       body.dfnEnabled dfn { cursor: pointer; }
       .dfnPanel {
         display: inline;
         position: absolute;
         z-index: 10;
         height: auto;
         width: auto;
         padding: 0.5em 0.75em;
         font: small sans-serif, Droid Sans Fallback;
         background: #DDDDDD;
         color: black;
         border: outset 0.2em;
       }
       .dfnPanel * { margin: 0; padding: 0; font: inherit; text-indent: 0; }
       .dfnPanel :link, .dfnPanel :visited { color: black; }
       .dfnPanel p { font-weight: bolder; }
       .dfnPanel * + p { margin-top: 0.25em; }
       .dfnPanel li { list-style-position: inside; }

       #configUI { position: absolute; z-index: 20; top: 10em; right: 1em; width: 11em; font-size: small; }
       #configUI p { margin: 0.5em 0; padding: 0.3em; background: #EEEEEE; color: black; border: inset thin; }
       #configUI p label { display: block; }
       #configUI #updateUI, #configUI .loginUI { text-align: center; }
       #configUI input[type=button] { display: block; margin: auto; }

       fieldset { margin: 1em; padding: 0.5em 1em; }
       fieldset > legend + * { margin-top: 0; }
       fieldset > :last-child { margin-bottom: 0; }
       fieldset p { margin: 0.5em 0; }
       header p.subline {color:#005A9C; font: 140% sans-serif;margin: 0.75em 0;}
       #authorButton {overflow: visible; padding: 0.1em 0.3em; position: fixed; right: 2em; top: 6em; width: auto;}

       @media print {#authorButton { display:none;}}

   .stability {
     position: fixed;
     bottom: 0;
     left: 0; right: 0;
     margin: 0 auto 0 auto;
     width: 50%;
     background: maroon; color: yellow;
     -webkit-border-radius: 1em 1em 0 0;
     -moz-border-radius: 1em 1em 0 0;
     border-radius: 1em 1em 0 0;
     -moz-box-shadow: 0 0 1em #500;
     -webkit-box-shadow: 0 0 1em #500;
     box-shadow: 0 0 1em red;
     padding: 0.5em 1em;
     text-align: center;
   }
   .stability strong {
     display: block;
   }
   .stability input {
     -moz-appearance: none; -webkit-appearance: none; margin: 0; 
     border: 0; padding: 0.25em 0.5em; background: transparent; color: black;
     position: absolute; top: -0.5em; right: 0; font: 1.25em sans-serif; text-align: center;
   }
   .stability input:hover {
     color: white;
     text-shadow: 0 0 2px black;
   }
   .stability input:active {
     padding: 0.3em 0.45em 0.2em 0.55em;
   }
   .stability :link, .stability :visited,
   .stability :link:hover, .stability :visited:hover {
     background: transparent;
     color: white;
   }

  </style><link href="https://www.w3.org/StyleSheets/TR/W3C-REC" rel="stylesheet" type="text/css"><link href="superseded.css" rel="stylesheet" type="text/css"><script>
   function getCookie(name) {
     var params = location.search.substr(1).split("&");
     for (var index = 0; index < params.length; index++) {
       if (params[index] == name)
         return "1";
       var data = params[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     var cookies = document.cookie.split("; ");
     for (var index = 0; index < cookies.length; index++) {
       var data = cookies[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     return null;
   }
  </script><!-- style switcher script by Stommepoes  --><link href="switcher/author-view.css" id="author-view" rel="alternate stylesheet" title="Author documentation only"><script src="switcher/authorstylesheet.js"></script><link href="edits.html" rel="prev" title="4.6 Edits">
  <link href="Overview.html#contents" rel="contents" title="Table of contents">
  <link href="links.html" rel="next" title="4.8 Links">
  <body class="split chapter" onload="fixBrokenLink();"><div class="head" id="head">
<header><span id="styleSwitch"></span>
   <p><a href="http://www.w3.org/"><img alt="W3C" height="48" src="http://www.w3.org/Icons/w3c_home" width="72"></a></p>

    <h1 id="big-title">HTML5</h1>
    <p class="no-num no-toc subline">A vocabulary and associated APIs for HTML and XHTML</p>
   <h2 class="no-num no-toc" id="w3c-recommendation-28-october-2014">W3C Recommendation 28 October 2014</h2>
   </header></div>
  

  <nav class="prev_next">
   <a href="edits.html">← 4.6 Edits</a> –
   <a href="Overview.html#contents">Table of contents</a> –
   <a href="links.html">4.8 Links →</a>
  <ol class="toc"><li><ol><li><a href="embedded-content-0.html#embedded-content-0"><span class="secno">4.7 </span>Embedded content</a>
    <ol><li><a href="embedded-content-0.html#the-img-element"><span class="secno">4.7.1 </span>The <code>img</code> element</a>
      <ol><li><a href="embedded-content-0.html#alt"><span class="secno">4.7.1.1 </span>Requirements for providing text to act as an alternative for images</a>
        <ol><li><a href="embedded-content-0.html#examples-of-scenarios-where-users-benefit-from-text-alternatives-for-images"><span class="secno">4.7.1.1.1 </span>Examples of scenarios where users benefit from text alternatives for images</a><li><a href="embedded-content-0.html#general-guidelines"><span class="secno">4.7.1.1.2 </span>General guidelines</a><li><a href="embedded-content-0.html#a-link-or-button-containing-nothing-but-an-image"><span class="secno">4.7.1.1.3 </span>A link or button containing nothing but an image</a><li><a href="embedded-content-0.html#graphical-representations:-charts,-diagrams,-graphs,-maps,-illustrations"><span class="secno">4.7.1.1.4 </span>Graphical Representations: Charts, diagrams, graphs, maps, illustrations</a><li><a href="embedded-content-0.html#images-of-text"><span class="secno">4.7.1.1.5 </span>Images of text</a><li><a href="embedded-content-0.html#images-that-include-text"><span class="secno">4.7.1.1.6 </span>Images that include text</a><li><a href="embedded-content-0.html#images-that-enhance-the-themes-or-subject-matter-of-the-page-content"><span class="secno">4.7.1.1.7 </span>Images that enhance the themes or subject matter of the page content</a><li><a href="embedded-content-0.html#a-graphical-representation-of-some-of-the-surrounding-text"><span class="secno">4.7.1.1.8 </span>A graphical representation of some of the surrounding text</a><li><a href="embedded-content-0.html#a-purely-decorative-image-that-doesn't-add-any-information"><span class="secno">4.7.1.1.9 </span>A purely decorative image that doesn't add any information</a><li><a href="embedded-content-0.html#inline"><span class="secno">4.7.1.1.10 </span>Inline images</a><li><a href="embedded-content-0.html#a-group-of-images-that-form-a-single-larger-picture-with-no-links"><span class="secno">4.7.1.1.11 </span>A group of images that form a single larger picture with no links</a><li><a href="embedded-content-0.html#image-maps-0"><span class="secno">4.7.1.1.12 </span>Image maps</a><li><a href="embedded-content-0.html#a-group-of-images-that-form-a-single-larger-picture-with-links"><span class="secno">4.7.1.1.13 </span>A group of images that form a single larger picture with links</a><li><a href="embedded-content-0.html#images-of-pictures"><span class="secno">4.7.1.1.14 </span>Images of Pictures</a><li><a href="embedded-content-0.html#webcam-images"><span class="secno">4.7.1.1.15 </span>Webcam images</a><li><a href="embedded-content-0.html#when-a-text-alternative-is-not-available-at-the-time-of-publication"><span class="secno">4.7.1.1.16 </span>When a text alternative is not available at the time of publication</a><li><a href="embedded-content-0.html#an-image-not-intended-for-the-user"><span class="secno">4.7.1.1.17 </span>An image not intended for the user</a><li><a href="embedded-content-0.html#icon-images"><span class="secno">4.7.1.1.18 </span>Icon Images</a><li><a href="embedded-content-0.html#logos,-insignia,-flags,-or-emblems"><span class="secno">4.7.1.1.19 </span>Logos, insignia, flags, or emblems</a><li><a href="embedded-content-0.html#captcha-images"><span class="secno">4.7.1.1.20 </span>CAPTCHA Images</a><li><a href="embedded-content-0.html#guidance-for-markup-generators"><span class="secno">4.7.1.1.21 </span>Guidance for markup generators</a><li><a href="embedded-content-0.html#guidance-for-conformance-checkers"><span class="secno">4.7.1.1.22 </span>Guidance for conformance checkers</a></ol></ol><li><a href="embedded-content-0.html#the-iframe-element"><span class="secno">4.7.2 </span>The <code>iframe</code> element</a><li><a href="embedded-content-0.html#the-embed-element"><span class="secno">4.7.3 </span>The <code>embed</code> element</a><li><a href="embedded-content-0.html#the-object-element"><span class="secno">4.7.4 </span>The <code>object</code> element</a><li><a href="embedded-content-0.html#the-param-element"><span class="secno">4.7.5 </span>The <code>param</code> element</a><li><a href="embedded-content-0.html#the-video-element"><span class="secno">4.7.6 </span>The <code>video</code> element</a><li><a href="embedded-content-0.html#the-audio-element"><span class="secno">4.7.7 </span>The <code>audio</code> element</a><li><a href="embedded-content-0.html#the-source-element"><span class="secno">4.7.8 </span>The <code>source</code> element</a><li><a href="embedded-content-0.html#the-track-element"><span class="secno">4.7.9 </span>The <code>track</code> element</a><li><a href="embedded-content-0.html#media-elements"><span class="secno">4.7.10 </span>Media elements</a>
      <ol><li><a href="embedded-content-0.html#error-codes"><span class="secno">4.7.10.1 </span>Error codes</a><li><a href="embedded-content-0.html#location-of-the-media-resource"><span class="secno">4.7.10.2 </span>Location of the media resource</a><li><a href="embedded-content-0.html#mime-types"><span class="secno">4.7.10.3 </span>MIME types</a><li><a href="embedded-content-0.html#network-states"><span class="secno">4.7.10.4 </span>Network states</a><li><a href="embedded-content-0.html#loading-the-media-resource"><span class="secno">4.7.10.5 </span>Loading the media resource</a><li><a href="embedded-content-0.html#offsets-into-the-media-resource"><span class="secno">4.7.10.6 </span>Offsets into the media resource</a><li><a href="embedded-content-0.html#ready-states"><span class="secno">4.7.10.7 </span>Ready states</a><li><a href="embedded-content-0.html#playing-the-media-resource"><span class="secno">4.7.10.8 </span>Playing the media resource</a><li><a href="embedded-content-0.html#seeking"><span class="secno">4.7.10.9 </span>Seeking</a><li><a href="embedded-content-0.html#media-resources-with-multiple-media-tracks"><span class="secno">4.7.10.10 </span>Media resources with multiple media tracks</a>
        <ol><li><a href="embedded-content-0.html#audiotracklist-and-videotracklist-objects"><span class="secno">4.7.10.10.1 </span><code>AudioTrackList</code> and <code>VideoTrackList</code> objects</a><li><a href="embedded-content-0.html#selecting-specific-audio-and-video-tracks-declaratively"><span class="secno">4.7.10.10.2 </span>Selecting specific audio and video tracks declaratively</a></ol><li><a href="embedded-content-0.html#synchronising-multiple-media-elements"><span class="secno">4.7.10.11 </span>Synchronising multiple media elements</a>
        <ol><li><a href="embedded-content-0.html#introduction-0"><span class="secno">4.7.10.11.1 </span>Introduction</a><li><a href="embedded-content-0.html#media-controllers"><span class="secno">4.7.10.11.2 </span>Media controllers</a><li><a href="embedded-content-0.html#assigning-a-media-controller-declaratively"><span class="secno">4.7.10.11.3 </span>Assigning a media controller declaratively</a></ol><li><a href="embedded-content-0.html#timed-text-tracks"><span class="secno">4.7.10.12 </span>Timed text tracks</a>
        <ol><li><a href="embedded-content-0.html#text-track-model"><span class="secno">4.7.10.12.1 </span>Text track model</a><li><a href="embedded-content-0.html#sourcing-in-band-text-tracks"><span class="secno">4.7.10.12.2 </span>Sourcing in-band text tracks</a><li><a href="embedded-content-0.html#sourcing-out-of-band-text-tracks"><span class="secno">4.7.10.12.3 </span>Sourcing out-of-band text tracks</a><li><a href="embedded-content-0.html#guidelines-for-exposing-cues-in-various-formats-as-text-track-cues"><span class="secno">4.7.10.12.4 </span>Guidelines for exposing cues in various formats as <span data-anolis-xref="text track
  cue">text track cues</span></a><li><a href="embedded-content-0.html#text-track-api"><span class="secno">4.7.10.12.5 </span>Text track API</a><li><a href="embedded-content-0.html#text-tracks-describing-chapters"><span class="secno">4.7.10.12.6 </span>Text tracks describing chapters</a><li><a href="embedded-content-0.html#cue-events"><span class="secno">4.7.10.12.7 </span>Event definitions</a></ol><li><a href="embedded-content-0.html#user-interface"><span class="secno">4.7.10.13 </span>User interface</a><li><a href="embedded-content-0.html#time-ranges"><span class="secno">4.7.10.14 </span>Time ranges</a><li><a href="embedded-content-0.html#event-definitions"><span class="secno">4.7.10.15 </span>Event definitions</a><li><a href="embedded-content-0.html#mediaevents"><span class="secno">4.7.10.16 </span>Event summary</a><li><a href="embedded-content-0.html#security-and-privacy-considerations"><span class="secno">4.7.10.17 </span>Security and privacy considerations</a><li><a href="embedded-content-0.html#best-practices-for-authors-using-media-elements"><span class="secno">4.7.10.18 </span>Best practices for authors using media elements</a><li><a href="embedded-content-0.html#best-practices-for-implementors-of-media-elements"><span class="secno">4.7.10.19 </span>Best practices for implementors of media elements</a></ol><li><a href="embedded-content-0.html#the-map-element"><span class="secno">4.7.11 </span>The <code>map</code> element</a><li><a href="embedded-content-0.html#the-area-element"><span class="secno">4.7.12 </span>The <code>area</code> element</a><li><a href="embedded-content-0.html#image-maps"><span class="secno">4.7.13 </span>Image maps</a>
      <ol><li><a href="embedded-content-0.html#authoring"><span class="secno">4.7.13.1 </span>Authoring</a><li><a href="embedded-content-0.html#processing-model-0"><span class="secno">4.7.13.2 </span>Processing model</a></ol><li><a href="embedded-content-0.html#mathml"><span class="secno">4.7.14 </span>MathML</a><li><a href="embedded-content-0.html#svg"><span class="secno">4.7.15 </span>SVG</a><li><a href="embedded-content-0.html#dimension-attributes"><span class="secno">4.7.16 </span>Dimension attributes</a></ol></ol></ol></nav>

  <h3 id="embedded-content-0"><span class="secno">4.7 </span>Embedded content</h3>


  <h4 id="the-img-element"><span class="secno">4.7.1 </span>The <dfn><code>img</code></dfn> element</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd><a href="dom.html#flow-content-1">Flow content</a>.</dd>
   <dd><a href="dom.html#phrasing-content-1">Phrasing content</a>.</dd>
   <dd><a href="dom.html#embedded-content-2">Embedded content</a>.</dd>
   <dd><a href="forms.html#form-associated-element">Form-associated element</a>.</dd>
   <dd>If the element has a <code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> attribute: <a href="dom.html#interactive-content-0">Interactive content</a>.</dd>
   <dd><a href="dom.html#palpable-content-0">Palpable content</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>Where <a href="dom.html#embedded-content-2">embedded content</a> is expected.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd>Empty.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
   <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> - Replacement text for use when images are not available</dd>
   <dd><code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> - Address of the resource</dd>

   <dd><code data-anolis-xref="attr-img-crossorigin"><a href="#attr-img-crossorigin">crossorigin</a></code> - How the element handles crossorigin requests</dd>
   <dd><code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> - Name of <a href="#image-map">image map</a> to use </dd>
   <dd><code data-anolis-xref="attr-img-ismap"><a href="#attr-img-ismap">ismap</a></code> - Whether the image is a server-side image map</dd>
   <dd><code data-anolis-xref="attr-dim-width"><a href="#attr-dim-width">width</a></code> - Horizontal dimension</dd>
   <dd><code data-anolis-xref="attr-dim-height"><a href="#attr-dim-height">height</a></code> - Vertical dimension</dd>
   <dt><a data-anolis-xref="element-dfn-tag-omission" href="dom.html#element-dfn-tag-omission">Tag omission in text/html</a>:</dt>
   <dd>No <a data-anolis-xref="syntax-end-tag" href="syntax.html#syntax-end-tag">end tag</a>.</dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd><a href="dom.html#index-aria-presentation"><code title="">presentation</code></a> role only, for an 
   <code><a href="#the-img-element">img</a></code> element whose <code>alt</code> attribute's value is empty (<code title="">alt=""</code>), otherwise 
   <a href="dom.html#allowed-aria-roles,-states-and-properties">any role value</a>.</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dd>Any <code title="">aria-*</code> attributes 
   <a href="dom.html#allowed-aria-roles,-states-and-properties">applicable to the allowed roles</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">[NamedConstructor=<a data-anolis-xref="dom-image" href="#dom-image">Image</a>(optional unsigned long width, optional unsigned long height)]
interface <dfn id="htmlimageelement">HTMLImageElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a data-anolis-xref="dom-img-alt" href="#dom-img-alt">alt</a>;
           attribute DOMString <a data-anolis-xref="dom-img-src" href="#dom-img-src">src</a>;

           attribute DOMString <a data-anolis-xref="dom-img-crossOrigin" href="#dom-img-crossorigin">crossOrigin</a>;
           attribute DOMString <a data-anolis-xref="dom-img-useMap" href="#dom-img-usemap">useMap</a>;
           attribute boolean <a data-anolis-xref="dom-img-isMap" href="#dom-img-ismap">isMap</a>;
           attribute unsigned long <a data-anolis-xref="dom-img-width" href="#dom-img-width">width</a>;
           attribute unsigned long <a data-anolis-xref="dom-img-height" href="#dom-img-height">height</a>;
  readonly attribute unsigned long <a data-anolis-xref="dom-img-naturalWidth" href="#dom-img-naturalwidth">naturalWidth</a>;
  readonly attribute unsigned long <a data-anolis-xref="dom-img-naturalHeight" href="#dom-img-naturalheight">naturalHeight</a>;
  readonly attribute boolean <a data-anolis-xref="dom-img-complete" href="#dom-img-complete">complete</a>;
};</pre>
   </dd>
  </dl><!--TOPIC:HTML--><p>An <code><a href="#the-img-element">img</a></code> element represents an image.</p>

  <!-- v2 ideas for <img>:

     * Maps sites would like to know which images are already cached,
       so that they can use images that are vaguely suitable while
       they wait for the most appropriate image to download.

       Almost like lowsrc="", except that many images might be
       appropriate.

       Slight hitch: their images are at a different origin, and we
       don't want to allow arbitrary cross-origin inspection (privacy
       leak risk). So it will require them to do CORS opt-in.

     * See note at rel=noreferrer.

  -->

  <p>The image given by the <dfn data-anolis-xref="attr-img-src" id="attr-img-src"><code>src</code></dfn>

  attributes is the embedded content; the value of
  the <dfn data-anolis-xref="attr-img-alt" id="attr-img-alt"><code>alt</code></dfn> attribute provides equivalent content for
  those who cannot process images or who have image loading disabled<!--
--><!--
  -->.</p>

  <p>The requirements on the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute's value are described
  <a href="#alt">in the next section</a>.</p>

  <p>The <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> attribute must be present, and must contain a
  <a href="infrastructure.html#valid-non-empty-url-potentially-surrounded-by-spaces">valid non-empty URL potentially surrounded by spaces</a> referencing a non-interactive,
  optionally animated, image resource that is neither paged nor scripted.</p>



  <p class="note">The requirements above imply that images can be static bitmaps (e.g. PNGs, GIFs,
  JPEGs), single-page vector documents (single-page PDFs, XML files with an SVG root element),
  animated bitmaps (APNGs, animated GIFs), animated vector graphics (XML files with an SVG root
  element that use declarative SMIL animation), and so forth. However, these definitions preclude
  SVG files with script, multipage PDF files, interactive MNG files, HTML documents, plain text
  documents, and so forth. <a href="references.html#refsPNG">[PNG]</a> <a href="references.html#refsGIF">[GIF]</a> <a href="references.html#refsJPEG">[JPEG]</a> <a href="references.html#refsPDF">[PDF]</a> <a href="references.html#refsXML">[XML]</a> <a href="references.html#refsAPNG">[APNG]</a> <!-- <a href="#refsAGIF">[AGIF]</a> --> <a href="references.html#refsSVG">[SVG]</a>
  <a href="references.html#refsMNG">[MNG]</a> </p>

  <p>The <code><a href="#the-img-element">img</a></code> element must not be used as a layout tool. In particular, <code><a href="#the-img-element">img</a></code>
  elements should not be used to display transparent images, as such images rarely convey meaning and
  rarely add anything useful to the document.</p>

  <hr><p>The <dfn data-anolis-xref="attr-img-crossorigin" id="attr-img-crossorigin"><code>crossorigin</code></dfn> attribute is a <a href="infrastructure.html#cors-settings-attribute">CORS
  settings attribute</a>. Its purpose is to allow images from third-party sites that allow
  cross-origin access to be used with <code><a href="scripting-1.html#the-canvas-element">canvas</a></code>.</p>

  <div class="impl">

  <hr><p>An <code><a href="#the-img-element">img</a></code> is always in one of the following states:</p>

  <dl><dt><dfn data-anolis-xref="img-none" id="img-none">Unavailable</dfn></dt>
   <dd>The user agent hasn't obtained any image data.</dd>

   <dt><dfn data-anolis-xref="img-inc" id="img-inc">Partially available</dfn></dt>
   <dd>The user agent has obtained some of the image data.</dd>

   <dt><dfn data-anolis-xref="img-all" id="img-all">Completely available</dfn></dt>
   <dd>The user agent has obtained all of the image data and at least
   the image dimensions are available.</dd>

   <dt><dfn data-anolis-xref="img-error" id="img-error">Broken</dfn></dt>
   <dd>The user agent has obtained all of the image data that it can,
   but it cannot even decode the image enough to get the image
   dimensions (e.g. the image is corrupted, or the format is not
   supported, or no data could be obtained).</dd>

  </dl><p>When an <code><a href="#the-img-element">img</a></code> element is either in the <a data-anolis-xref="img-inc" href="#img-inc">partially
  available</a> state or in the <a data-anolis-xref="img-all" href="#img-all">completely available</a> state, it is
  said to be <dfn data-anolis-xref="img-available" id="img-available">available</dfn>.</p>

  <p>An <code><a href="#the-img-element">img</a></code> element is initially <a data-anolis-xref="img-none" href="#img-none">unavailable</a>.</p>

  <p>When an <code><a href="#the-img-element">img</a></code> element is <a data-anolis-xref="img-available" href="#img-available">available</a>, it
  <a href="infrastructure.html#provides-a-paint-source">provides a paint source</a> whose width is the image's intrinsic width, whose height is
  the image's intrinsic height, and whose appearance is the intrinsic appearance of the image.</p>

  <p>In a <a href="browsers.html#browsing-context">browsing context</a> where <a data-anolis-xref="concept-bc-noscript" href="webappapis.html#concept-bc-noscript">scripting is
  disabled</a>, user agents may obtain images immediately or on demand. In a <a href="browsers.html#browsing-context">browsing
  context</a> where <a data-anolis-xref="concept-bc-noscript" href="webappapis.html#concept-bc-noscript">scripting is enabled</a>, user agents
  must obtain images immediately.</p>

  <p>A user agent that obtains images immediately must synchronously <a href="#update-the-image-data">update the image
  data</a> of an <code><a href="#the-img-element">img</a></code> element whenever that element is created with a <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> attribute.
  A user agent that obtains images immediately must also synchronously
  <a href="#update-the-image-data">update the image data</a> of an <code><a href="#the-img-element">img</a></code> element whenever that element has its
  <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> or <code data-anolis-xref="attr-img-crossorigin"><a href="#attr-img-crossorigin">crossorigin</a></code> attribute set, changed, or removed.</p> <!-- Note
  how this does NOT happen when the base URL changes. -->

  <p>A user agent that obtains images on demand must <a href="#update-the-image-data">update the image data</a> of an
  <code><a href="#the-img-element">img</a></code> element whenever it needs the image data (i.e. on demand), but only if the
  <code><a href="#the-img-element">img</a></code> element has a <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code>

  attribute, and only if the <code><a href="#the-img-element">img</a></code> element is in the
  <a data-anolis-xref="img-none" href="#img-none">unavailable</a> state. When an <code><a href="#the-img-element">img</a></code> element's <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> or <code data-anolis-xref="attr-img-crossorigin"><a href="#attr-img-crossorigin">crossorigin</a></code> attribute set, changed, or removed, if the user
  agent only obtains images on demand, the <code><a href="#the-img-element">img</a></code> element must return to the <a data-anolis-xref="img-none" href="#img-none">unavailable</a> state.</p> <!-- Note how this does NOT happen when the base
  URL changes. -->

  <p>Each <code><a href="#the-img-element">img</a></code> element has a <dfn id="last-selected-source">last selected source</dfn>, which must initially be
  null, and a <dfn id="current-pixel-density">current pixel density</dfn>, which must initially be undefined.</p>

  <p>When an <code><a href="#the-img-element">img</a></code> element has a <a href="#current-pixel-density">current pixel density</a> that is not 1.0, the
  element's image data must be treated as if its resolution, in device pixels per CSS pixels, was
  the <a href="#current-pixel-density">current pixel density</a>.</p>

  <p class="example">For example, if the <a href="#current-pixel-density">current pixel density</a> is 3.125, that means
  that there are 300 device pixels per CSS inch, and thus if the image data is 300x600, it has an
  intrinsic dimension of 96 CSS pixels by 192 CSS pixels.</p>

  <p>Each <code><a href="dom.html#document">Document</a></code> object must have a <dfn id="list-of-available-images">list of available images</dfn>. Each image
  in this list is identified by a tuple consisting of an <a href="infrastructure.html#absolute-url">absolute URL</a>, a <a href="infrastructure.html#cors-settings-attribute">CORS
  settings attribute</a> mode, and, if the mode is not <a data-anolis-xref="attr-crossorigin-none" href="infrastructure.html#attr-crossorigin-none">No
  CORS</a>, an <a href="browsers.html#origin-0">origin</a>. User agents may copy entries from one <code><a href="dom.html#document">Document</a></code>
  object's <a href="#list-of-available-images">list of available images</a> to another at any time (e.g. when the
  <code><a href="dom.html#document">Document</a></code> is created, user agents can add to it all the images that are loaded in
  other <code><a href="dom.html#document">Document</a></code>s), but must not change the keys of entries copied in this way when
  doing so. User agents may also remove images from such lists at any time (e.g. to save
  memory).</p>

  <p>When the user agent is to <dfn id="update-the-image-data">update the image data</dfn> of an <code><a href="#the-img-element">img</a></code> element, it
  must run the following steps:</p>

  <ol><li><p>Return the <code><a href="#the-img-element">img</a></code> element to the <a data-anolis-xref="img-none" href="#img-none">unavailable</a>
   state.</p>

   <li><p>If an instance of the <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching</a> algorithm is still running for
   this element, then abort that algorithm, discarding any pending <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> generated by that algorithm.</li>

   <li><p>Forget the <code><a href="#the-img-element">img</a></code> element's current image data, if any.</li>

   <li><p>If the user agent cannot support images, or its support for images has been disabled, then
   abort these steps.</li>

   <li>



    Otherwise, if the element has a <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> attribute specified and
    its value is not the empty string, let <var data-anolis-xref="">selected source</var> be the value of the
    element's <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> attribute, and <var data-anolis-xref="">selected pixel
    density</var> be 1.0. Otherwise, let <var data-anolis-xref="">selected source</var> be null and <var data-anolis-xref="">selected pixel density</var> be undefined.<p></p>

   </li>

   <li><p>Let the <code><a href="#the-img-element">img</a></code> element's <a href="#last-selected-source">last selected source</a> be <var data-anolis-xref="">selected source</var> and the <code><a href="#the-img-element">img</a></code> element's <a href="#current-pixel-density">current pixel
   density</a> be <var data-anolis-xref="">selected pixel density</var>.</li>

   <li>

    <p>If <var data-anolis-xref="">selected source</var> is not null, run these substeps:</p>

    <ol><li><p><a data-anolis-xref="resolve a url" href="infrastructure.html#resolve-a-url">Resolve</a> <var data-anolis-xref="">selected source</var>, relative
     to the element. If that is not successful, abort these steps.</li>

     <li><p>Let <var data-anolis-xref="">key</var> be a tuple consisting of the resulting <a href="infrastructure.html#absolute-url">absolute
     URL</a>, the <code><a href="#the-img-element">img</a></code> element's <code data-anolis-xref="attr-img-crossorigin"><a href="#attr-img-crossorigin">crossorigin</a></code>
     attribute's mode, and, if that mode is not <a data-anolis-xref="attr-crossorigin-none" href="infrastructure.html#attr-crossorigin-none">No CORS</a>,
     the <code><a href="dom.html#document">Document</a></code> object's <a href="browsers.html#origin-0">origin</a>.</li>

     <li><p>If the <a href="#list-of-available-images">list of available images</a> contains an entry for <var data-anolis-xref="">key</var>, then set the <code><a href="#the-img-element">img</a></code> element to the <a data-anolis-xref="img-all" href="#img-all">completely
     available</a> state, update the presentation of the image appropriately, <a href="webappapis.html#queue-a-task">queue a
     task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-load">load</code> at the
     <code><a href="#the-img-element">img</a></code> element, and abort these steps.</li>

    </ol></li>

   <li><p>Asynchronously <a href="webappapis.html#await-a-stable-state">await a stable state</a>, allowing the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that invoked this algorithm to continue. The <a href="webappapis.html#synchronous-section">synchronous
   section</a> consists of all the remaining steps of this algorithm until the algorithm says the
   <a href="webappapis.html#synchronous-section">synchronous section</a> has ended. (Steps in <a data-anolis-xref="synchronous
   section" href="webappapis.html#synchronous-section">synchronous sections</a> are marked with ⌛.)</li>

   <li>

    <p>⌛ If another instance of this algorithm for this <code><a href="#the-img-element">img</a></code> element was started
    after this instance (even if it aborted and is no longer running), then abort these steps.</p>

    <p class="note">Only the last instance takes effect, to avoid multiple requests when, for
    example, the <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code>
    and <code data-anolis-xref="attr-img-crossorigin"><a href="#attr-img-crossorigin">crossorigin</a></code> attributes are all set in
    succession.</p>

   </li>

   <li>

    <p>⌛ If <var data-anolis-xref="">selected source</var> is null, then set the element to the <a data-anolis-xref="img-error" href="#img-error">broken</a> state, <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
    event</a> named <code data-anolis-xref="event-error">error</code> at the <code><a href="#the-img-element">img</a></code> element, and
    abort these steps.</p>

   </li>

   <li>

    <p>⌛ <a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="infrastructure.html#fire-a-progress-event">fire a progress event</a> named <code data-anolis-xref="event-loadstart">loadstart</code> at
    the <code><a href="#the-img-element">img</a></code> element.</p>

   </li>

   <li>

<!--CLEANUP-->
    <p>⌛ Do a <a href="infrastructure.html#potentially-cors-enabled-fetch">potentially CORS-enabled fetch</a><!--FETCH--> of the <a href="infrastructure.html#absolute-url">absolute
    URL</a> that resulted from the earlier step, with the <i>mode</i> being the current state of the
    element's <code data-anolis-xref="attr-img-crossorigin"><a href="#attr-img-crossorigin">crossorigin</a></code> content attribute, the <i data-anolis-xref="">origin</i> being the <a href="browsers.html#origin-0">origin</a> of the <code><a href="#the-img-element">img</a></code> element's
    <code><a href="dom.html#document">Document</a></code>, and the <i>default origin behaviour</i> set to <i>taint</i>.</p>

    <p>The resource obtained in this fashion, if any, is the <code><a href="#the-img-element">img</a></code> element's image data.
    It can be either <a href="infrastructure.html#cors-same-origin">CORS-same-origin</a> or <a href="infrastructure.html#cors-cross-origin">CORS-cross-origin</a>; this affects
    the <a href="browsers.html#origin-0">origin</a> of the image itself (e.g. when used on a <code><a href="scripting-1.html#the-canvas-element">canvas</a></code>).</p>

    <!-- same text in <input type=image> section and similar text elsewhere -->
    <p>Fetching the image must <a href="syntax.html#delay-the-load-event">delay the load event</a> of the element's document until the
    <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that is <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> by the
    <a href="webappapis.html#networking-task-source">networking task source</a> once the resource has been <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> (<a href="#img-load">defined below</a>) has been run.</p>

    <p class="warning">This, unfortunately, can be used to perform a rudimentary port scan of the
    user's local network (especially in conjunction with scripting, though scripting isn't actually
    necessary to carry out such an attack). User agents may implement <a data-anolis-xref="origin" href="browsers.html#origin-0">cross-origin</a> access control policies that are stricter than those
    described above to mitigate this attack, but unfortunately such policies are typically not
    compatible with existing Web content.</p>

    <p>If the resource is <a href="infrastructure.html#cors-same-origin">CORS-same-origin</a>, each <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a>
    that is <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> by the <a href="webappapis.html#networking-task-source">networking task source</a>
    while the image is being <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> must <a href="infrastructure.html#fire-a-progress-event">fire a progress
    event</a> named <code data-anolis-xref="event-progress">progress</code> at the <code><a href="#the-img-element">img</a></code>
    element.</p>

   </li>

   <li><p>End the <a href="webappapis.html#synchronous-section">synchronous section</a>, continuing the remaining steps asynchronously,
   but without missing any data from the <a href="infrastructure.html#fetch">fetch</a> algorithm.</li>

   <li>

    <p>As soon as possible, jump to the first applicable entry from the following list:</p>

    <dl class="switch"><dt>If the resource type is <code><a href="iana.html#multipart/x-mixed-replace">multipart/x-mixed-replace</a></code></dt>

     <dd>

      <p>The next <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that is <a data-anolis-xref="queue a
      task" href="webappapis.html#queue-a-task">queued</a> by the <a href="webappapis.html#networking-task-source">networking task source</a> while the image is being <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> must set the <code><a href="#the-img-element">img</a></code> element's state to <a data-anolis-xref="img-inc" href="#img-inc">partially available</a>.</p>

      <p>Each <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that is <a data-anolis-xref="queue a
      task" href="webappapis.html#queue-a-task">queued</a> by the <a href="webappapis.html#networking-task-source">networking task source</a> while the image is being <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> must update the presentation of the image, but as each new
      body part comes in, it must replace the previous image. Once one body part has been completely
      decoded, the user agent must set the <code><a href="#the-img-element">img</a></code> element to the <a data-anolis-xref="img-all" href="#img-all">completely available</a> state and <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire
      a simple event</a> named <code data-anolis-xref="event-load">load</code> at the <code><a href="#the-img-element">img</a></code>
      element.</p>

      <p class="note">The <code data-anolis-xref="event-progress">progress</code> and <code data-anolis-xref="event-loadend">loadend</code> events are not fired for
      <code><a href="iana.html#multipart/x-mixed-replace">multipart/x-mixed-replace</a></code> image streams.</p>

     </dd>

     <dt>If the resource type and data corresponds to a supported image format, <a href="#img-determine-type">as described below</a></dt>

     <dd>

      <p>The next <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that is <a data-anolis-xref="queue a
      task" href="webappapis.html#queue-a-task">queued</a> by the <a href="webappapis.html#networking-task-source">networking task source</a> while the image is being <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> must set the <code><a href="#the-img-element">img</a></code> element's state to <a data-anolis-xref="img-inc" href="#img-inc">partially available</a>.</p>

      <p id="img-load">That <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a>, and each subsequent <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a>, that is <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> by the
      <a href="webappapis.html#networking-task-source">networking task source</a> while the image is being <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> must update the presentation of the image appropriately (e.g. if
      the image is a progressive JPEG, each packet can improve the resolution of the image).</p>

      <p>Furthermore, the last <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that is <a data-anolis-xref="queue a
      task" href="webappapis.html#queue-a-task">queued</a> by the <a href="webappapis.html#networking-task-source">networking task source</a> once the resource has been
      <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> must additionally run the steps for the matching entry in
      the following list:</p>

      <dl class="switch"><dt>If the download was successful and the user agent was able to determine the image's width and height</dt>

       <dd>

        <ol><li><p>Set the <code><a href="#the-img-element">img</a></code> element to the <a data-anolis-xref="img-all" href="#img-all">completely
         available</a> state.</p>

         <li><p>Add the image to the <a href="#list-of-available-images">list of available images</a> using the key <var data-anolis-xref="">key</var>.</li>

         <li>

          <p>If the resource is <a href="infrastructure.html#cors-same-origin">CORS-same-origin</a>: <a href="infrastructure.html#fire-a-progress-event">fire a progress event</a>
          named <code data-anolis-xref="event-load">load</code> at the <code><a href="#the-img-element">img</a></code> element.</p>

          <p>If the resource is <a href="infrastructure.html#cors-cross-origin">CORS-cross-origin</a>: <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named
          <code data-anolis-xref="event-load">load</code> at the <code><a href="#the-img-element">img</a></code> element.</p>

         </li>

         <li>

          <p>If the resource is <a href="infrastructure.html#cors-same-origin">CORS-same-origin</a>: <a href="infrastructure.html#fire-a-progress-event">fire a progress event</a>
          named <code data-anolis-xref="event-load">loadend</code> at the <code><a href="#the-img-element">img</a></code> element.</p>

          <p>If the resource is <a href="infrastructure.html#cors-cross-origin">CORS-cross-origin</a>: <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named
          <code data-anolis-xref="event-load">loadend</code> at the <code><a href="#the-img-element">img</a></code> element.</p>

         </li>

        </ol></dd>

       <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/saved/1222 -->

       <dt>Otherwise</dt>

       <dd>

        <ol><li><p>Set the <code><a href="#the-img-element">img</a></code> element to the <a data-anolis-xref="img-error" href="#img-error">broken</a>
         state.</li>

         <li>

          <p>If the resource is <a href="infrastructure.html#cors-same-origin">CORS-same-origin</a>: <a href="infrastructure.html#fire-a-progress-event">fire a progress event</a>
          named <code data-anolis-xref="event-load">load</code> at the <code><a href="#the-img-element">img</a></code> element.</p>

          <p>If the resource is <a href="infrastructure.html#cors-cross-origin">CORS-cross-origin</a>: <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named
          <code data-anolis-xref="event-load">load</code> at the <code><a href="#the-img-element">img</a></code> element.</p>

         </li>

         <li>

          <p>If the resource is <a href="infrastructure.html#cors-same-origin">CORS-same-origin</a>: <a href="infrastructure.html#fire-a-progress-event">fire a progress event</a>
          named <code data-anolis-xref="event-load">loadend</code> at the <code><a href="#the-img-element">img</a></code> element.</p>

          <p>If the resource is <a href="infrastructure.html#cors-cross-origin">CORS-cross-origin</a>: <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named
          <code data-anolis-xref="event-load">loadend</code> at the <code><a href="#the-img-element">img</a></code> element.</p>

         </li>

        </ol></dd>

      </dl></dd>

     <dt>Otherwise</dt>

     <dd>

      <p>Either the image data is corrupted in some fatal way such that the image dimensions cannot
      be obtained, or the image data is not in a supported file format; the user agent must set the
      <code><a href="#the-img-element">img</a></code> element to the <a data-anolis-xref="img-error" href="#img-error">broken</a> state, abort the <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching</a> algorithm, discarding any pending <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> generated by that algorithm, and then <a href="webappapis.html#queue-a-task">queue a
      task</a> to first <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-error">error</code> at the <code><a href="#the-img-element">img</a></code> element and then <a href="webappapis.html#fire-a-simple-event">fire a simple
      event</a> named <code data-anolis-xref="event-loadend">loadend</code> at the <code><a href="#the-img-element">img</a></code>
      element.</p>

     </dd>

    </dl></li>

  </ol><p>While a user agent is running the above algorithm for an element <var data-anolis-xref="">x</var>, there
  must be a strong reference from the element's <code><a href="dom.html#document">Document</a></code> to the element <var data-anolis-xref="">x</var>, even if that element is not <a data-anolis-xref="in a Document" href="infrastructure.html#in-a-document">in</a> its
  <code><a href="dom.html#document">Document</a></code>.</p>

  <p>When an <code><a href="#the-img-element">img</a></code> element is in the <a data-anolis-xref="img-all" href="#img-all">completely available</a>
  state <em>and</em> the user agent can decode the media data without errors, then the
  <code><a href="#the-img-element">img</a></code> element is said to be <dfn data-anolis-xref="img-good" id="img-good">fully decodable</dfn>.</p>

  <p>Whether the image is fetched successfully or not (e.g. whether the response code was a 2xx code
  <a data-anolis-xref="concept-http-equivalent-codes" href="infrastructure.html#concept-http-equivalent-codes">or equivalent</a>) must be ignored when determining
  the image's type and whether it is a valid image.</p>

  <p class="note">This allows servers to return images with error responses, and have them
  displayed.</p>

  <p id="img-determine-type">The user agent should apply the <a data-anolis-xref="Content-Type sniffing:
  image" href="infrastructure.html#content-type-sniffing:-image">image sniffing rules</a> to determine the type of the image, with the image's <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">associated Content-Type headers</a> giving the <var data-anolis-xref="">official
  type</var>. If these rules are not applied, then the type of the image must be the type given by
  the image's <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">associated Content-Type headers</a>.</p>

  <p>User agents must not support non-image resources with the <code><a href="#the-img-element">img</a></code> element (e.g. XML
  files whose root element is an HTML element). User agents must not run executable code (e.g.
  scripts) embedded in the image resource. User agents must only display the first page of a
  multipage resource (e.g. a PDF file). User agents must not allow the resource to act in an
  interactive fashion, but should honor any animation in the resource.</p>

  <p>This specification does not specify which image types are to be supported.</p>

  <hr><hr><p>What an <code><a href="#the-img-element">img</a></code> element represents depends on the <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> attribute and the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code>
  attribute.</p>

  <dl class="switch"><dt>If the <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> attribute is set and the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute is set to the empty string</dt>

   <dd>

    <p>The image is either decorative or supplemental to the rest of the content, redundant with
    some other information in the document.</p>

    <p>If the image is <a data-anolis-xref="img-available" href="#img-available">available</a> and the user agent is configured
    to display that image, then the element <a href="dom.html#represents">represents</a> the element's image data.</p>

    <p>Otherwise, the element <a href="dom.html#represents">represents</a> nothing, and may be omitted completely from
    the rendering. User agents may provide the user with a notification that an image is present but
    has been omitted from the rendering.</p>

   </dd>

   <dt>If the <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> attribute is set and the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute is set to a value that isn't empty</dt>

   <dd>

    <p>The image is a key part of the content; the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute
    gives a textual equivalent or replacement for the image.</p>

    <p>If the image is <a data-anolis-xref="img-available" href="#img-available">available</a> and the user agent is configured
    to display that image, then the element <a href="dom.html#represents">represents</a> the element's image data.</p>

    <p>Otherwise, the element <a href="dom.html#represents">represents</a> the text given by the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute. User agents may provide the user with a notification
    that an image is present but has been omitted from the rendering.</p>

   </dd>

   <dt>If the <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> attribute is set and the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute is not</dt>

   <dd>
    <p>There is no textual equivalent of the image available.</p>

    <p>If the image is <a data-anolis-xref="img-available" href="#img-available">available</a> and the user agent is configured
    to display that image, then the element <a href="dom.html#represents">represents</a> the element's image data.</p>

    <p>Otherwise, the user agent should display some sort of indicator that there is an image that
    is not being rendered, and may, if requested by the user, or if so configured, or when required
    to provide contextual information in response to navigation, provide caption information for the
    image, derived as follows:</p>

    <ol><!-- when editing this list, search for the two other occurrences of 'critical-no-alt' --><li><p>If the image is a descendant of a <code><a href="grouping-content.html#the-figure-element">figure</a></code> element that has a child
     <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element, and, ignoring the <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element and its
     descendants, the <code><a href="grouping-content.html#the-figure-element">figure</a></code> element has no <code><a href="infrastructure.html#text-0">Text</a></code> node descendants other
     than <a href="dom.html#inter-element-whitespace">inter-element whitespace</a>, and no <a href="dom.html#embedded-content-2">embedded content</a> descendant
     other than the <code><a href="#the-img-element">img</a></code> element, then the contents of the first such
     <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element are the caption information; abort these steps.</li>

     <li><p>There is no caption information.</li>

    </ol></dd>
   <dt>If the <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> attribute is not set and either the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute is set to the empty string or the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute is not set at all</dt>

   <dd>

    <p>The element <a href="dom.html#represents">represents</a> nothing.</p>

   </dd>

   <dt>Otherwise</dt>

   <dd>

    <p>The element <a href="dom.html#represents">represents</a> the text given by the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute.</p>

   </dd>

  </dl><p>The <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute does not represent advisory information.
  User agents must not present the contents of the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute
  in the same way as content of the <code data-anolis-xref="attr-title"><a href="dom.html#attr-title">title</a></code> attribute.</p>

<!--POLITICS-->
  <p class="warning auth">While user agents are encouraged to repair cases of missing <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attributes, authors must not rely on such behavior. <a href="#alt">Requirements for providing text to act as an alternative for images</a> are described
  in detail below.</p>

  <p>The <em>contents</em> of <code><a href="#the-img-element">img</a></code> elements, if any, are ignored for the purposes of
  rendering.</p>

  </div>

  <hr><p>The <code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> attribute,
  if present, can indicate that the image has an associated
  <a href="#image-map">image map</a>.</p>

  <p>The <dfn data-anolis-xref="attr-img-ismap" id="attr-img-ismap"><code>ismap</code></dfn>
  attribute, when used on an element that is a descendant of an
  <code><a href="text-level-semantics.html#the-a-element">a</a></code> element with an <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> attribute, indicates by its
  presence that the element provides access to a server-side image
  map. This affects how events are handled on the corresponding
  <code><a href="text-level-semantics.html#the-a-element">a</a></code> element.</p>

  <p>The <code data-anolis-xref="attr-img-ismap"><a href="#attr-img-ismap">ismap</a></code> attribute is a
  <a href="infrastructure.html#boolean-attribute">boolean attribute</a>. The attribute must not be specified
  on an element that does not have an ancestor <code><a href="text-level-semantics.html#the-a-element">a</a></code> element
  with an <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> attribute.</p>

  <p>The <code><a href="#the-img-element">img</a></code> element supports <a href="#dimension-attributes">dimension
  attributes</a>.</p>

  <div class="impl">

  <p>The <dfn data-anolis-xref="dom-img-alt" id="dom-img-alt"><code>alt</code></dfn>, <dfn data-anolis-xref="dom-img-src" id="dom-img-src"><code>src</code></dfn>
  IDL attributes must <a href="infrastructure.html#reflect">reflect</a> the
  respective content attributes of the same name.</p>

  <p>The <dfn data-anolis-xref="dom-img-crossOrigin" id="dom-img-crossorigin"><code>crossOrigin</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-img-crossorigin"><a href="#attr-img-crossorigin">crossorigin</a></code> content attribute,
  <a href="infrastructure.html#limited-to-only-known-values">limited to only known values</a>.</p>

  <p>The <dfn data-anolis-xref="dom-img-useMap" id="dom-img-usemap"><code>useMap</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> content attribute.</p>

  <p>The <dfn data-anolis-xref="dom-img-isMap" id="dom-img-ismap"><code>isMap</code></dfn> IDL attribute must <a href="infrastructure.html#reflect">reflect</a>
  the <code data-anolis-xref="attr-img-ismap"><a href="#attr-img-ismap">ismap</a></code> content attribute.</p>

  </div>

<!--TOPIC:DOM APIs-->
  <dl class="domintro"><dt><var data-anolis-xref="">image</var> . <code data-anolis-xref="dom-img-width"><a href="#dom-img-width">width</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>
   <dt><var data-anolis-xref="">image</var> . <code data-anolis-xref="dom-img-height"><a href="#dom-img-height">height</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>These attributes return the actual rendered dimensions of the
    image, or zero if the dimensions are not known.</p>

    <p>They can be set, to change the corresponding content
    attributes.</p>

   </dd>

   <dt><var data-anolis-xref="">image</var> . <code data-anolis-xref="dom-img-naturalWidth"><a href="#dom-img-naturalwidth">naturalWidth</a></code></dt>
   <dt><var data-anolis-xref="">image</var> . <code data-anolis-xref="dom-img-naturalHeight"><a href="#dom-img-naturalheight">naturalHeight</a></code></dt>

   <dd>

    <p>These attributes return the intrinsic dimensions of the image,
    or zero if the dimensions are not known.</p>

   </dd>

   <dt><var data-anolis-xref="">image</var> . <code data-anolis-xref="dom-img-complete"><a href="#dom-img-complete">complete</a></code></dt>

   <dd>

    <p>Returns true if the image has been completely downloaded or if
    no image is specified; otherwise, returns false.</p>

   </dd>

   <dt><var data-anolis-xref="">image</var> = new <code data-anolis-xref="dom-image"><a href="#dom-image">Image</a></code>( [ <var data-anolis-xref="">width</var> [, <var data-anolis-xref="">height</var> ] ] )</dt>

   <dd>

    <p>Returns a new <code><a href="#the-img-element">img</a></code> element, with the <code data-anolis-xref="attr-dim-width"><a href="#attr-dim-width">width</a></code> and <code data-anolis-xref="attr-dim-height"><a href="#attr-dim-height">height</a></code> attributes set to the values
    passed in the relevant arguments, if applicable.</p>

   </dd>

  </dl><div class="impl">

  <p>The IDL attributes <dfn data-anolis-xref="dom-img-width" id="dom-img-width"><code>width</code></dfn> and <dfn data-anolis-xref="dom-img-height" id="dom-img-height"><code>height</code></dfn> must return the rendered width and height of the
  image, in CSS pixels, if the image is <a href="rendering.html#being-rendered">being rendered</a>, and is being rendered to a
  visual medium; or else the intrinsic width and height of the image, in CSS pixels, if the image is
  <i data-anolis-xref="img-available"><a href="#img-available">available</a></i> but not being rendered to a visual medium; or else 0, if
  the image is not <i data-anolis-xref="img-available"><a href="#img-available">available</a></i>. <a href="references.html#refsCSS">[CSS]</a></p>

  <p>On setting, they must act as if they <a data-anolis-xref="reflect" href="infrastructure.html#reflect">reflected</a> the respective
  content attributes of the same name.</p>

  <p>The IDL attributes <dfn data-anolis-xref="dom-img-naturalWidth" id="dom-img-naturalwidth"><code>naturalWidth</code></dfn> and <dfn data-anolis-xref="dom-img-naturalHeight" id="dom-img-naturalheight"><code>naturalHeight</code></dfn> must return the intrinsic width and
  height of the image, in CSS pixels, if the image is <i data-anolis-xref="img-available"><a href="#img-available">available</a></i>, or
  else 0. <a href="references.html#refsCSS">[CSS]</a></p>

  <p>The IDL attribute <dfn data-anolis-xref="dom-img-complete" id="dom-img-complete"><code>complete</code></dfn> must return true if
  any of the following conditions is true:</p>

  <ul class="brief"><li>The <code data-anolis-xref="attr-img-src"><a href="#attr-img-src">src</a></code> attribute is omitted.



   <li>The final <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that is <a data-anolis-xref="queue a
   task" href="webappapis.html#queue-a-task">queued</a> by the <a href="webappapis.html#networking-task-source">networking task source</a> once the resource has been <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> has been <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a>.

   <li>The <code><a href="#the-img-element">img</a></code> element is <a data-anolis-xref="img-all" href="#img-all">completely available</a>.

   <li>The <code><a href="#the-img-element">img</a></code> element is <a data-anolis-xref="img-error" href="#img-error">broken</a>.

  </ul><p>Otherwise, the attribute must return false.</p>

  <p class="note">The value of <code data-anolis-xref="dom-img-complete"><a href="#dom-img-complete">complete</a></code> can thus change while
  a <a data-anolis-xref="concept-script" href="webappapis.html#concept-script">script</a> is executing.</p>

  <p>A constructor is provided for creating <code><a href="#htmlimageelement">HTMLImageElement</a></code> objects (in addition to
  the factory methods from DOM such as <code data-anolis-xref="">createElement()</code>): <dfn data-anolis-xref="dom-image" id="dom-image"><code>Image(<var data-anolis-xref="">width</var>, <var data-anolis-xref="">height</var>)</code></dfn>.
  When invoked as a constructor, this must return a new <code><a href="#htmlimageelement">HTMLImageElement</a></code> object (a new
  <code><a href="#the-img-element">img</a></code> element). If the <var data-anolis-xref="">width</var> argument is present, the new object's
  <code data-anolis-xref="attr-dim-width"><a href="#attr-dim-width">width</a></code> content attribute must be set to <var data-anolis-xref="">width</var>. If the <var data-anolis-xref="">height</var> argument is also present, the new object's
  <code data-anolis-xref="attr-dim-height"><a href="#attr-dim-height">height</a></code> content attribute must be set to <var data-anolis-xref="">height</var>. The element's document must be the <a href="browsers.html#active-document">active document</a> of the
  <a href="browsers.html#browsing-context">browsing context</a> of the <code><a href="browsers.html#window">Window</a></code> object on which the interface object of
  the invoked constructor is found.</p>

  </div>
<!--TOPIC:HTML-->

<!-- base alt advice on acc requirements and best practice (note whole section rewritten) SF-->
  <h5 id="alt"><span class="secno">4.7.1.1 </span>Requirements for providing text to act as an alternative for images</h5>

  <p><a href="http://www.w3.org/TR/WCAG20/#text-altdef">Text alternatives</a>, <a href="references.html#refsWCAG">[WCAG]</a>
  are a primary way of making visual information accessible, because they can be rendered through any
  sensory modality (for example, visual, auditory or tactile) to match the needs of the user. Providing text alternatives allows
  the information to be rendered in a variety of ways by a variety of user agents. For example, a person who cannot see a picture
  can have the text alternative read aloud using synthesized speech.</p>
 
  <p class="note">The <code>alt</code> attribute on images is a very important accessibility attribute.
  Authoring useful <code>alt</code> attribute content requires the author to carefully consider the context in 
  which the image appears and the function that image may have in that context. The guidance included 
  here addresses the most common ways authors use images. Additional guidance and techniques are available in <a href="http://w3.org/WAI/alt/">Resources on Alternative Text for Images</a>.</p>


  <h6 id="examples-of-scenarios-where-users-benefit-from-text-alternatives-for-images"><span class="secno">4.7.1.1.1 </span>Examples of scenarios where users benefit from text alternatives for images</h6>

  <ul><li>They have a very slow connection and are browsing with images disabled.</li>
      <li>They have a vision impairment and use text to speech software.</li>
      <li>They have a cognitive impairment and use text to speech software.</li>
      <li>They are using a text-only browser.</li>
      <li>They are listening to the page being read out by a voice Web browser.</li>
      <li>They have images disabled to save on download costs.</li>
      <li>They have problems loading images or the source of an image is wrong.</li>
    </ul><h6 id="general-guidelines"><span class="secno">4.7.1.1.2 </span>General guidelines</h6>

  <p>Except where otherwise specified, the <code>alt</code> attribute must be specified and its value must not be empty; 
  the value must be an appropriate functional replacement for the image. The specific requirements for the <code>alt</code> attribute content
  depend on the image's function in the page, as described in the following sections.</p>
  
  <p>To determine an appropriate text alternative it is important to think about why an image is being included in a page. 
  What is its purpose? Thinking like this will help you to understand what is important about the image for the 
  intended audience. Every image has a reason for being on a page, because it provides useful information, performs a 
  function, labels an interactive element, enhances aesthetics or is purely decorative. Therefore, knowing what the image 
  is for, makes writing an appropriate text alternative easier.</p>
  
  <h6 id="a-link-or-button-containing-nothing-but-an-image"><span class="secno">4.7.1.1.3 </span>A link or button containing nothing but an image</h6>

  <p>When an <code><a href="text-level-semantics.html#the-a-element">a</a></code> element that is a <a href="links.html#hyperlink">hyperlink</a>, or a <code><a href="forms.html#the-button-element">button</a></code> element, has no text content
 but contains one or more images, include text in the <code>alt</code> attribute(s) that together convey the purpose of the link or button.</p>
  
	<div class="example">

  <p>In this example, a user is asked to pick her preferred color
  from a list of three. Each color is given by an image, but for
  users who cannot view the images,
  the color names are included within the <code>alt</code> attributes of the images:</p>
  <p><img alt="The example HTML code as displayed in a browser. 3 links each containing a rectangular image:  1 is blue with the text 'blue', 2 red with the text 'red' and 3 is green with the text 'green'." height="45" src="images/buttons.png" width="274"></p>
        
  <pre>  &lt;ul&gt;
  &lt;li&gt;&lt;a href="red.html"&gt;&lt;img src="red.jpeg" <strong>alt="Red"</strong>&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href="green.html"&gt;&lt;img src="green.jpeg" <strong>alt="Green"</strong>&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href="blue.html"&gt;&lt;img src="blue.jpeg" <strong>alt="Blue"</strong>&gt;&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
  </pre>
	</div>

  <div class="example">

  <p>In this example, a link contains a logo. The link points to the W3C web site <strong>from an external site</strong>. The text alternative is
  a brief description of the link target.</p>
  <p><abbr title="World Wide Web Consortium"><img alt="W3C logo used as link content." height="48" src="images/w3c_home.png" width="72"></abbr></p>

  <pre>  &lt;a href="http://w3.org"&gt;
  &lt;img src="images/w3c_home.png" width="72" height="48" <strong>alt="W3C web site"</strong>&gt;
  &lt;/a&gt;
  </pre>
  </div>
	  
	<div class="example">
  <p>This example is the same as the previous example, except that the <strong>link is on the W3C web site</strong>. The text alternative is
  a brief description of the link target.</p>
  <p><abbr title="World Wide Web Consortium"><img alt="W3C logo used as link content." height="48" src="images/w3c_home.png" width="72"></abbr></p>

  <pre>  &lt;a href="http://w3.org"&gt;
  &lt;img src="images/w3c_home.png" width="72" height="48" <strong>alt="W3C home"</strong>&gt;
  &lt;/a&gt;
  </pre>
  <p class="note">Depending on the context in which an image of a logo is used it could be appropriate to provide an indication
  that the image is a <em>logo</em> as part of the text alternative. Refer to section <a href="#logos,-insignia,-flags,-or-emblems">4.7.1.1.19 Logos, insignia, flags, or emblems</a>.</p>
  </div>

  <div class="example">
  <p>In this example, a link contains a print preview icon. The link points to a version of the page with a
  print stylesheet applied. The text alternative is a brief description of the link target.</p>
  <p><img alt="Print preview icon used as link content." height="30" src="images/preview.png" width="32"></p>

  <pre>  &lt;a href="preview.html"&gt;
  &lt;img src="images/preview.png" width="32" height="30" <strong>alt="Print preview."</strong>&gt;
  &lt;/a&gt;
  </pre>
  </div>

  <div class="example">
  <p>In this example, a button contains a search icon. The button submits a search form. The text alternative is a
  brief description of what the button does.</p>
  <p><img alt="Search icon used as button content." height="29" src="images/search.png" width="74"></p>

  <pre>  &lt;button&gt;
  &lt;img src="images/search.png" width="74" height="29" <strong>alt="Search"</strong>&gt;
  &lt;/button&gt;
  </pre>
  </div>

  <div class="example">
  <p>In this example, a company logo for the <i>PIP Corporation</i> has been split into the following two images,
  the first containing the word <i>PIP</i> and the second with the abbreviated word <i>CO</i>. The images are the
  sole content of a link to the <i>PIPCO</i> home page. In this case a brief description of the link target is provided.
  As the images are presented to the user as a single entity the text alternative <i>PIP CO home</i> is in the
  <code>alt</code> attribute of the first image.</p>

  <p><img alt="Image containing the text 'PIP'." height="64" src="images/pip.gif" width="99"><img alt="Image containing the text 'CO'." height="64" src="images/co.gif" width="103"></p>

  <pre>  &lt;a href="pipco-home.html"&gt;
  &lt;img src="pip.gif" <strong>alt="PIP CO home"</strong>&gt;&lt;img src="co.gif" <strong>alt=""</strong>&gt;
  &lt;/a&gt;
  </pre>
  </div>
 
  <h6 id="graphical-representations:-charts,-diagrams,-graphs,-maps,-illustrations"><span class="secno">4.7.1.1.4 </span>Graphical Representations: Charts, diagrams, graphs, maps, illustrations</h6>

  <p>Users can benefit when content is presented in graphical form, for example as a 
  flowchart, a diagram, a graph, or a map showing directions. Users also benefit when 
  content presented in a graphical form is also provided in a textual format, these users include 
  those who are unable to view the image (e.g. because they have a very slow connection, 
  or because they are using a text-only browser, or because they are listening to the page 
  being read out by a hands-free automobile voice Web browser, or because they have a 
  visual impairment and use an assistive technology to render the text to speech).</p>

  <div class="example">
  <p>In the following example we have an image of a pie chart, with text in the <code>alt</code> attribute 
  representing the data shown in the pie chart:</p>
  <p><img alt="Browser Share: Internet Explorer 25%, Firefox 40%, Chrome 25%, Safari 6% and Opera 4%." height="299" src="images/browserShare.png" width="380"></p>

  <pre>  &lt;img src="piechart.gif" <strong>alt="Pie chart: Browser Share - Internet Explorer 25%, Firefox 40%, Chrome 25%, Safari 6% and Opera 4%."</strong>&gt;
  </pre>
  </div>

  <div class="example">
  <p>In the case where an image repeats the previous paragraph in graphical form. The <code>alt</code> attribute content labels the image.</p>

  <pre> &lt;p&gt;According to a recent study Firefox has a 40% browser share, Internet Explorer has 25%, Chrome has 25%, Safari has 6% and Opera has 4%.&lt;/p&gt;
 &lt;p&gt;&lt;img src="piechart.gif" <strong>alt="Pie chart representing the data in the previous paragraph."</strong>&gt;&lt;/p&gt;</pre>
  <p>It can be seen that when the image is not available, for example because the <code>src</code> attribute value is incorrect, the text alternative provides the user with a brief description of the image content:</p>
  <p><img alt="Representation of the code snippet above." src="images/brokenimg.png"></p>
  </div>
  
  <p class="note">In cases where the text alternative is lengthy, more than a sentence or two, or would benefit from 
 the use of structured markup, provide a brief description or label using the <code>alt</code> 
 attribute, and an associated text alternative.</p>
  
  <div class="example">
  <p>Here's an example of a flowchart image, with a short text alternative 
  included in the <code>alt</code> attribute, in this case the text alternative is a description of the link target 
  as the image is the sole content of a link. The link points to a description, within the same document, of the 
  process represented in the flowchart.</p>
  
  <p><img alt="Flowchart: Dealing with a broken lamp." height="320" src="images/flowchart.png" width="221"></p>

  <pre>  <strong>
  &lt;a href="#desc"&gt;</strong>&lt;img src="flowchart.gif" <strong>alt="Flowchart: Dealing with a broken lamp."</strong>&gt;<strong>&lt;/a&gt;</strong>

  ...

  ...

  &lt;div <strong>id="desc"</strong>&gt;
  &lt;h2&gt;Dealing with a broken lamp&lt;/h2&gt;
  <strong data-anolis-xref="">&lt;ol&gt;</strong>
  <strong data-anolis-xref="">&lt;li&gt;</strong>Check if it's plugged in, if not, plug it in.<strong>&lt;/li&gt;</strong>
  <strong data-anolis-xref="">&lt;li&gt;</strong>If it still doesn't work; check if the bulb is burned out. If it is, replace the bulb.<strong>&lt;/li&gt;</strong>
  <strong data-anolis-xref="">&lt;li&gt;</strong>If it still doesn't work; buy a new lamp.<strong>&lt;/li&gt;</strong>
  <strong data-anolis-xref="">&lt;/ol&gt;</strong>
  &lt;/div&gt;</pre>
  </div>  

  <div class="example">
  <p>In this example, there is an image of a chart. It would be inappropriate to provide the information depicted in
  the chart as a plain text alternative in an <code>alt</code> attribute as the information is a data set. Instead a 
  structured text alternative is provided below the image in the form of a data table using the data that is represented 
  in the chart image.</p>

  <p><img alt="Bar Chart showing average rainfall in millimetres by Country and Season." height="341" src="images/table.gif" width="407"></p>
  <p class="note">Indications of the highest and lowest rainfall for each season have been included in the 
  table, so trends easily identified in the chart are also available in the data table.</p>
  
  <table style="width:28em; border: 1px solid #000;"><caption>Average rainfall in millimetres  by country and season.</caption>
  <tr><td><th scope="col">United Kingdom<th scope="col">Japan<th scope="col">Australia<tr><th scope="row">Spring<td>5.3 (highest)<td>2.4<td>2 (lowest)<tr><th scope="row">Summer<td>4.5 (highest)<td>3.4<td>2 (lowest)<tr><th scope="row">Autumn<td>3.5 (highest)<td>1.8<td>1.5 (lowest)<tr><th scope="row">Winter<td>1.5 (highest)<td>1.2<td>1 (lowest)</table><pre>  &lt;figure&gt;
  &lt;figcaption&gt;Rainfall Data&lt;/figcaption&gt;
  &lt;img src="rainchart.gif" <strong>alt="Bar chart: Average rainfall in millimetres by Country and Season."</strong>&gt;
  &lt;table&gt;
  &lt;caption&gt;Rainfall in millimetres by Country and Season.&lt;/caption&gt;
  &lt;tr&gt;&lt;td&gt;&lt;th scope="col"&gt;UK &lt;th scope="col"&gt;Japan&lt;th scope="col"&gt;Australia&lt;/tr&gt;
  &lt;tr&gt;&lt;th scope="row"&gt;Spring &lt;td&gt;5.5 (highest)&lt;td&gt;2.4 &lt;td&gt;2 (lowest)&lt;/tr&gt;
  &lt;tr&gt;&lt;th scope="row"&gt;Summer &lt;td&gt;4.5 (highest)&lt;td&gt;3.4&lt;td&gt;2 (lowest)&lt;/tr&gt;
  &lt;tr&gt;&lt;th scope="row"&gt;Autumn &lt;td&gt;3.5 (highest) &lt;td&gt;1.8 &lt;td&gt;1.5 (lowest)&lt;/tr&gt;
  &lt;tr&gt;&lt;th scope="row"&gt;Winter &lt;td&gt;1.5 (highest) &lt;td&gt;1.2 &lt;td&gt;1 lowest&lt;/tr&gt;
  &lt;/table&gt;
  &lt;/figure&gt;
  </pre>
  <p class="note">The <code><a href="grouping-content.html#the-figure-element">figure</a></code> element is used to group the Bar Chart image and data table. 
  The <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element provides a caption for the grouped content.</p>
  </div>

  <h6 id="images-of-text"><span class="secno">4.7.1.1.5 </span>Images of text</h6>

  <p>Sometimes, an image only contains  text, and the purpose of the image 
  is to display text  using visual effects and /or fonts.  It is <em>strongly</em> 
  recommended that text styled using CSS be used, but if this is not possible, provide 
  the same text in the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute as is in the image.</p>

  <div class="example">
  <p>This example shows an image of the text "Get Happy!" written in a fancy multi colored freehand style.
   The image makes up the content of a heading. In this case the text alternative for the image is "Get Happy!".</p>

   <p><img alt="Get Happy!" height="77" src="images/text.png" width="275"></p>

  <pre>&lt;h1&gt;&lt;img src="gethappy.gif" <strong>alt="Get Happy!"</strong>&gt;&lt;/h1&gt;</pre>
  </div>

  <div class="example">
  <p>In this example we have an advertising image consisting of text, the phrase "The BIG sale" is
   repeated 3 times, each time the text gets smaller and fainter, the last line reads "...ends Friday"
   In the context of use, as an advertisement, it is recommended that the image's text alternative only include the text "The BIG sale"
   once as the repetition is for visual effect and the repetition of the text for users who cannot view
   the image is unnecessary and could be confusing.</p>

  <p><img alt="The big sale ...ends Friday." height="190" src="images/sale.png" width="400"></p>
  <pre>  &lt;p&gt;&lt;img src="sale.gif" <strong>alt="The BIG sale ...ends Friday."</strong>&gt;&lt;/p&gt;
  </pre>
  <p class="note">In situations where there is also a photo or other graphic along with the image of text,
    ensure that the words in the image text are included in the text alternative, along with any other description
    of the image that conveys meaning to users who can view the image, so the information is also
    available to users who cannot view the image.</p>
  </div>
 <p>When an image is used to represent a character that cannot otherwise be represented in Unicode,
  for example gaiji, itaiji, or new characters such as novel currency symbols, the text alternative
  should be a more conventional way of writing the same thing, e.g. using the phonetic hiragana or
  katakana to give the character's pronunciation.</p>

  <div class="example">

   <p>In this example from 1997, a new-fangled currency symbol that looks like a curly E with two
   bars in the middle instead of one is represented using an image. The alternative text gives the
   character's pronunciation.</p>

<p>Only <img alt="euro " height="18" src="images/euro.png" width="21">5.99!</p>

   <pre>&lt;p&gt;Only &lt;img src="euro.png" alt="euro "&gt;5.99!</pre>

  </div>

  <p>An image should not be used if Unicode characters would serve an identical purpose. Only when
  the text cannot be directly represented using Unicode, e.g. because of decorations or because the
  character is not in the Unicode character set (as in the case of gaiji), would an image be
  appropriate.</p>

  <p class="note">If an author is tempted to use an image because their default system font does not
  support a given character, then Web Fonts are a better solution than images.</p>
  <!-- Fork - move example to correct section and add image example SF-->
  <div class="example">

   <p>An illuminated manuscript might use graphics for some of its letters. The text alternative in
   such a situation is just the character that the image represents.</p>
   <p><img alt="O" height="32" src="images/fancyO.png" width="24">nce upon a time and a long long time ago...</p>
   <pre>&lt;p&gt;&lt;img src="initials/fancyO.png" <mark>alt="O"</mark>&gt;nce upon a time and a long long time ago...</pre> 
  </div>
  
  <h6 id="images-that-include-text"><span class="secno">4.7.1.1.6 </span>Images that include text</h6>

  <p>Sometimes, an image consists of a graphics such as a chart and associated text. 
  In this case it is recommended that the text in the image is included in the text alternative.</p>

  <div class="example">
  <p>Consider an image containing  a pie chart and associated text. It is recommended wherever 
  possible to provide any associated text as text, not an image of text. 
  If this is not possible include the text in the text alternative along with the pertinent information
  conveyed in the image.</p>

  <p><img alt="Figure 1. Distribution of Articles by Journal 
  Category. Pie chart: Language=68%, Education=14% and Science=18%." height="279" id="piechart" src="images/figure1.png" width="351"></p>
  <pre>  &lt;p&gt;&lt;img src="figure1.gif" <strong>alt="Figure 1. Distribution of Articles by Journal Category. 
  Pie chart: Language=68%, Education=14% and Science=18%."</strong>&gt;&lt;/p&gt;
  </pre>
  </div>

  <div class="example">
  <p>Here's another example of the same <a href="#piechart">pie chart</a> image, 
  showing a short text alternative included in the <code>alt</code> attribute 
  and a longer text alternative in text. The <code><a href="grouping-content.html#the-figure-element">figure</a></code> and <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> 
  elements are used to associate the longer text alternative with the image. The <code>alt</code> attribute is used
  to label the image.</p>

  <pre>  &lt;figure&gt;
  &lt;img src="figure1.gif" <strong>alt="Figure 1"</strong>&gt;
  &lt;figcaption&gt;&lt;strong&gt;Figure 1.&lt;/strong&gt; Distribution of Articles by Journal Category. 
  Pie chart: Language=68%, Education=14% and Science=18%.&lt;/figcaption&gt;
  &lt;/figure&gt;
  </pre>
  <p class="note">The advantage of this method over the previous example is that the text alternative 
  is available to all users at all times. It also allows structured mark up to be used in the text 
  alternative, where as a text alternative provided using the <code>alt</code> attribute does not.</p>
  </div>

  <h6 id="images-that-enhance-the-themes-or-subject-matter-of-the-page-content"><span class="secno">4.7.1.1.7 </span>Images that enhance the themes or subject matter of the page content</h6>

  <p>An image that isn't discussed directly by the surrounding text but still has 
  some relevance can be included in a page using the <code><a href="#the-img-element">img</a></code> element. Such images 
  are more than mere decoration, they may augment the themes or subject matter of the page 
  content and so still form part of the content. In these cases, it is recommended that a 
  text alternative be provided. </p>

  <div class="example">
  <p>Here is an example of an image closely related to the subject matter of the page content 
  but not directly discussed. An image of a painting inspired by a poem, on a page reciting that poem. 
  The following snippet shows an example. The image is a painting titled the "Lady of Shallot", it is 
  inspired by the poem and its subject matter is derived from the poem. Therefore it is strongly 
  recommended that a text alternative is provided. There is a short description of the content of 
  the image in the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute and
  a link below the image to a longer description located at the bottom of the document. At the end 
  of the longer description there is also a link to further information about the painting.</p>
  <p><img alt="A painting inspired by Alfred Tennyson's poem The Lady of Shalott" height="234" src="images/shalott.jpg" width="338"></p>
  <pre>  &lt;header&gt;
  &lt;h1&gt;The Lady of Shalott&lt;/h1&gt;
  &lt;p&gt;A poem by Alfred Lord Tennyson&lt;/p&gt;
  &lt;/header&gt;

  &lt;img src="shalott.jpeg" <strong>alt="Painting of a  young woman with long hair, sitting in a wooden boat. "</strong>&gt;
  &lt;p&gt;&lt;a href="#des"&gt;Description of the painting&lt;/a&gt;.&lt;/p&gt;


  &lt;!-- Full Recitation of Alfred, Lord Tennyson's Poem.  --&gt;

  ...
  ...
  ...
  &lt;p id="des"&gt;<strong>The woman in the painting is wearing a flowing white dress. A large piece of intricately 
  patterned fabric is draped over the side. In her right hand she holds the chain mooring the boat. Her expression 
  is mournful. She stares at a crucifix lying in front of her. Beside it are three candles. Two have blown out.</strong> 
  <strong>&lt;a href="http://bit.ly/5HJvVZ"&gt;Further information about the painting&lt;/a&gt;.</strong>&lt;/p&gt;
  </pre>
  </div>

   <div class="example">
    <p>This example illustrates the provision of a text alternative identifying an image as a photo of the main subject of a page.</p>
    <img alt="Portrait photo(black and white) of Robin, accompanied by a heading 'Robin Berjon' and a question
    'what more needs to be said?'" height="138" src="images/robin.png" width="354"><pre>    &lt;img src="orateur_robin_berjon.png" alt="Portrait photo(black and white) of Robin."&gt;
    &lt;h1&gt;Robin Berjon&lt;/h1&gt;
    &lt;p&gt;What more needs to be said?&lt;/p&gt;
    </pre>
  </div>

  <h6 id="a-graphical-representation-of-some-of-the-surrounding-text"><span class="secno">4.7.1.1.8 </span>A graphical representation of some of the surrounding text</h6>

  <p>In many cases, the image is actually just supplementary, and its presence merely reinforces the
  surrounding text. In these cases, the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute must be
  present but its value must be the empty string.</p>

  <p>In general, an image falls into this category if removing the image doesn't make the page any
  less useful, but including the image makes it a lot easier for users of visual browsers to
  understand the concept.</p>


  <div class="example">
  <p>It is not always easy to write a useful text alternative for an image, another option is to provide a link to a 
  description or further information about the image when one is available. </p>
  <p>In this example of  the same image, there is a short text alternative included in the <code>alt</code> attribute, and 
  there is a link after the image. The link points to a page containing <a href="http://www.tate.org.uk/servlet/ViewWork?cgroupid=-1&amp;workid=15984">information about the painting</a>. </p>

  <p><strong>The Lady of Shalott</strong><br><small>A poem by Alfred Lord Tennyson.</small></p>
  <p><img alt="Painting of a woman in a white flowing dress, sitting in a small boat." height="171" src="images/shalott.jpg" width="271"></p>
  <p><a href="http://bit.ly/5HJvVZ">About this painting.</a></p>
  <p><em>Full recitation of Alfred, Lord Tennyson's poem.</em></p>
  <pre>  &lt;header&gt;&lt;h1&gt;The Lady of Shalott&lt;/h1&gt;
  &lt;p&gt;A poem by Alfred Lord Tennyson&lt;/p&gt;&lt;/header&gt;
  &lt;figure&gt;
  &lt;img src="shalott.jpeg" <strong>alt="Painting of a woman in a white flowing dress, sitting in a small boat."</strong>&gt;
  &lt;p&gt;&lt;a href="http://bit.ly/5HJvVZ"&gt;<strong>About this painting.</strong>&lt;/a&gt;&lt;/p&gt;
  &lt;/figure&gt;
  &lt;!-- Full Recitation of Alfred, Lord Tennyson's Poem.  --&gt;
  </pre>
  </div>

  <h6 id="a-purely-decorative-image-that-doesn't-add-any-information"><span class="secno">4.7.1.1.9 </span>A purely decorative image that doesn't add any information</h6>

  <p>Purely decorative images are visual enhancements, decorations or embellishments that provide no 
  function or information beyond aesthetics to users who can view the images.</p>

  <p>Mark up purely decorative images so they can be ignored by assistive technology by using an empty <code>alt</code> 
  attribute (<code>alt=""</code>). While it is not unacceptable to include decorative images inline, 
  it is recommended if they are purely decorative to include the image using CSS.</p>

  <div class="example">
  <p>Here's an example of an image being used as a decorative banner for a person's blog, the image offers no information 
  and so an empty <code>alt</code> attribute is used.</p>
  
  <div>
  <p><img alt="" height="30" src="images/border.png" width="400"></p>
  <p><strong>Clara's Blog</strong></p>
  <p>Welcome to my blog...</p>
  </div>
  <pre>  &lt;header&gt;
  &lt;div&gt;&lt;img src="border.gif" <strong>alt=""</strong> width="400" height="30"&gt;&lt;/div&gt;
  &lt;h1&gt;Clara's Blog&lt;/h1&gt;
  &lt;/header&gt;
  &lt;p&gt;Welcome to my blog...&lt;/p&gt;
  </pre>
  </div>

  <h6 id="inline"><span class="secno">4.7.1.1.10 </span>Inline images</h6>

  <p>When images are used inline as part of the flow of text in a sentence, provide a word or phrase as a text 
  alternative which makes sense in the context of the sentence it is apart of.</p>

  <div class="example">
  <p>I <img alt="love" height="24" src="images/heart.png" width="27"> you.</p>

  <pre>I &lt;img src="heart.png" <strong>alt="love"</strong>&gt; you.</pre>

  <p>My <img alt="heart" height="24" src="images/heart.png" width="27"> breaks.</p>

  <pre>My &lt;img src="heart.png" <strong>alt="heart"</strong>&gt; breaks.</pre>
  </div>    

  <h6 id="a-group-of-images-that-form-a-single-larger-picture-with-no-links"><span class="secno">4.7.1.1.11 </span>A group of images that form a single larger picture with no links</h6>

  <p>When a picture has been sliced into smaller image files that are then displayed
  together to form the complete picture again, include a text alternative for one
  of the images using the <code>alt</code> attribute as per the relevant relevant
  guidance for the picture as a whole, and then include an empty <code>alt</code>
  attribute on the other images.</p>

  <div class="example">
  <p>In this example, a picture representing a company logo for the <i>PIP Corporation</i>
  has been split into two pieces, the first containing the letters "PIP" and the second with the word "CO".
  The text alternatve <i>PIP CO</i> is in the <code>alt</code> attribute of the first image.</p>

  <p><img alt="Image containing the text 'PIP'." height="64" src="images/pip.gif" width="99"><img alt="Image containing the text 'CO'." height="64" src="images/co.gif" width="103"></p>

  <pre>  &lt;img src="pip.gif" <strong>alt="PIP CO"</strong>&gt;&lt;img src="co.gif" <strong>alt=""</strong>&gt;
  </pre>
  </div>

  <div class="example">
  <p>In the following example, a rating is shown as three filled
  stars and two empty stars. While the text alternative could have
  been "★★★☆☆", the author has
  instead decided to more helpfully give the rating in the form "3
  out of 5". That is the text alternative of the first image, and the
  rest have empty <code>alt</code> attributes.</p>
  <p><img alt="3 out of 5." height="30" src="images/rating.png" width="149"></p>

  <pre>  &lt;p&gt;Rating: &lt;meter max=5 value=3&gt;
  &lt;img src="1" <strong>alt="3 out of 5"</strong>&gt;
  &lt;img src="1" <strong>alt=""</strong>&gt;&lt;img src="1" <strong>alt=""</strong>&gt;
  &lt;img src="0" <strong>alt=""</strong>&gt;&lt;img src="0" <strong>alt=""</strong>&gt;
  &lt;/meter&gt;&lt;/p&gt;
  </pre>

  </div>
 
  <h6 id="image-maps-0"><span class="secno">4.7.1.1.12 </span>Image maps</h6>
  If an <code><a href="#the-img-element">img</a></code> element has a <code>usemap</code> attribute which references a <code><a href="#the-map-element">map</a></code> element containing 
  <code><a href="#the-area-element">area</a></code> elements that have <code>href</code> attributes, the <code><a href="#the-img-element">img</a></code> is considered to be interactive content.
  In such cases, always provide a text alternative for the image using the <code>alt</code> attribute.<p></p>
<div class="example">

   <p>Consider the following image which is a map of <a href="http://en.wikipedia.org/wiki/Katoomba,_New_South_Wales">Katoomba</a>, 
   it has 2 interactive regions corresponding to the areas of North and South Katoomba:</p>
   
   <p><img alt="Map of Katoomba." height="249" src="images/imagemap.png" usemap="#Map" width="209"></p>
<map name="Map"><area alt="North Katoomba" coords="78,124,124,10,189,29,173,93,168,132,136,151,110,130" href="#" shape="poly"><area alt="South Katoomba" coords="66,63,80,135,106,138,137,154,167,137,175,133,144,240,49,223,17,137,17,61" href="#" shape="poly"></map><p>The text alternative is a brief description of the image. The <code>alt</code> attribute on each
   of the <code><a href="#the-area-element">area</a></code> elements provides text describing the content of the target page of each linked region:</p>

 <pre>&lt;p&gt;View houses for sale in North Katoomba or South Katoomba:&lt;/p&gt;
 &lt;p&gt;&lt;img src="imagemap.png" width="209" <mark>alt="Map of Katoomba"</mark> height="249" usemap="#Map"&gt;

 &lt;map name="Map"&gt; 
 &lt;area shape="poly" coords="78,124,124,10,189,29,173,93,168,132,136,151,110,130" 
 href="north.html" <mark>alt="Houses in North Katoomba"</mark>&gt;
 &lt;area shape="poly" coords="66,63,80,135,106,138,137,154,167,137,175,133,144,240,49,223,17,137,17,61" 
 <mark>alt="Houses in South Katoomba"</mark> href="south.html"&gt;
 &lt;/map&gt; </pre>

  </div>

  <h6 id="a-group-of-images-that-form-a-single-larger-picture-with-links"><span class="secno">4.7.1.1.13 </span>A group of images that form a single larger picture with links</h6>

  <p class="note">Generally, <a data-anolis-xref="image map" href="#image-map">image maps</a> should be
  used instead of slicing an image for links.</p>

  <p>Sometimes, when you create a composite picture from multiple images, you may wish to 
  link one or more of the images. Provide an <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute 
  for each linked image to describe the purpose of the link.
  </p>

  <div class="example">
  <p>In the following example, a composite picture is used to represent a "crocoduck"; a fictional creature which
  defies evolutionary principles by being part crocodile and part duck. You are asked to interact with the
  crocoduck, but you need to exercise caution...</p>

  <p><img alt="crocodile's angry, chomping head" src="images/crocoduck1.png"><img alt="duck's soft, feathery body" src="images/crocoduck2.png"></p>
  <pre>  &lt;h1&gt;The crocoduck&lt;/h1&gt;
  &lt;p&gt;You encounter a strange creature called a "crocoduck". 
  The creature seems angry! Perhaps some friendly stroking will help to calm 
  it, but be careful not to stroke any crocodile parts. This would just enrage 
  the beast further.&lt;/p&gt;
  &lt;a href="?stroke=head"&gt;&lt;img src="crocoduck1.png" <strong>alt="Stroke crocodile's angry, chomping head"</strong>&gt;&lt;/a&gt; 
  &lt;a href="?stroke=body"&gt;&lt;img src="crocoduck2.png" <strong>alt="Stroke duck's soft, feathery body"</strong>&gt;&lt;/a&gt;  
  </pre>

  </div>
  
  <h6 id="images-of-pictures"><span class="secno">4.7.1.1.14 </span>Images of Pictures</h6>

  <p>Images of pictures or graphics include visual representations of objects, people, scenes, abstractions, etc.  
  This <a href="http://www.w3.org/TR/WCAG20/#non-text-contentdef">non-text content</a>, <a href="references.html#refsWCAG">[WCAG]</a> can convey a significant amount of 
  information visually or provide a <a href="http://www.w3.org/TR/WCAG20/#sensoryexpdef">specific sensory experience</a>, <a href="references.html#refsWCAG">[WCAG]</a> to 
  a sighted person. Examples include photographs, paintings, drawings and artwork.</p>
  
  <p>An appropriate text alternative for a picture is a brief description, or <a href="http://www.w3.org/TR/WCAG20/#namedef">name</a> <a href="references.html#refsWCAG">[WCAG]</a>. As in all text alternative authoring decisions, writing suitable text alternatives for pictures requires 
  human judgment. The text value is subjective to the context where the image is used and the page author's writing style. Therefore, 
  there is no single 'right' or 'correct' piece of <code>alt</code> text for any particular image. In  addition to providing a short text 
  alternative that gives a brief description of the non-text content, also providing supplemental content through another means when 
  appropriate may be useful.</p>
  
  <div class="example">
  <p>This first example shows an image uploaded to a photo-sharing site. The photo is of a cat, sitting in the bath. The image has a 
  text alternative provided using the <code><a href="#the-img-element">img</a></code> element's <code>alt</code> attribute. It also has a caption provided by including 
  the <code><a href="#the-img-element">img</a></code> element in a <code><a href="grouping-content.html#the-figure-element">figure</a></code> element and using a <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element to identify the caption text.</p>
  
  <p><img alt="Lola the cat sitting under an umbrella in the bath tub." height="242" src="images/lola.png" width="300"></p>
  <p>Lola prefers a bath to a shower.</p>
   
  <pre>  &lt;figure&gt;
  &lt;img src="664aef.jpg" <strong>alt="Lola the cat sitting under an umbrella in the bath tub."</strong>&gt;
  &lt;figcaption&gt;Lola prefers a bath to a shower.&lt;/figcaption&gt;
  &lt;/figure&gt;
  </pre>
  </div>
   
  <div class="example">
  <p>This example is of an image that defies a complete description, as the subject of the image is open to interpretation.
  The image has a text alternative in the <code>alt</code> attribute which gives users who cannot view the image a sense 
  of what the image is. It also has a caption provided by including the <code><a href="#the-img-element">img</a></code> element in a <code><a href="grouping-content.html#the-figure-element">figure</a></code> 
  element and using a <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element to identify the caption text.</p>
  
  <p><img alt="An abstract, freeform, vertically symmetrical, black inkblot on a light background." height="197" src="images/inkblot1.png" width="300"></p>
  <p>The first of the ten cards in the Rorschach test.</p>
   
  <pre>&lt;figure&gt;
  &lt;img src="Rorschach1.jpg" <strong>alt="An abstract, freeform, vertically symmetrical, black inkblot on a light background."</strong>&gt;
  &lt;figcaption&gt;The first of the ten cards in the Rorschach test.&lt;/figcaption&gt;
  &lt;/figure&gt; </pre>
  </div>
   
  <h6 id="webcam-images"><span class="secno">4.7.1.1.15 </span>Webcam images</h6>

  <p>Webcam images are static images that are automatically updated periodically. Typically the images are
  from a fixed viewpoint, the images may update on the page automatically as each new image is uploaded from
  the camera or the user may be required to refresh the page to view an updated image. Examples include traffic
  and weather cameras.</p>

  <div class="example">
  <p>This example is fairly typical; the title and a time stamp are included in the image, automatically generated
  by the webcam software. It would be better if the text information was not included in the image, but as it is part
  of the image, include it part of the text alternative. A caption is also provided using the <code><a href="grouping-content.html#the-figure-element">figure</a></code>
  and <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> elements.  As the image is provided to give a visual indication of the current weather near a building,
  a link to a local weather forecast is provided, as with automatically generated and uploaded webcam images it may be impractical to
  provide such information as a text alternative.</p>

  <p>The text of the <code>alt</code> attribute includes a prose version of the timestamp, designed to make the text more
  understandable when announced by text to speech software.  The text alternative also includes a description of some aspects
  of what can be seen in the image which are unchanging, although weather conditions and time of day change.</p>

  <p><img alt="Sopwith house weather cam. Taken on the 21/04/10 at 11:51 and 34 seconds. In the foreground are the safety
  rails on the flat part of the roof. Nearby ther are low rise industrial buildings, beyond those are block of flats. In the distance there's a
  church steeple." height="225" src="images/webcam1.png" width="296"></p>

  <p>View from the top of Sopwith house, looking towards North Kingston. This image is updated every hour.</p>

  <p>View the <a href="http://news.bbc.co.uk/weather/forecast/4296?area=Kingston">latest weather details</a> for Kingston upon Thames.</p>
   
  <pre>&lt;figure&gt;
  &lt;img src="webcam1.jpg" <strong>alt="Sopwith house weather cam. Taken on the 21/04/10 at 11:51 and 34 seconds.
  In the foreground are the safety rails on the flat part of the roof. Nearby there are low rise industrial buildings,
  beyond are blocks of flats. In the distance there's a church steeple."</strong>&gt;
  &lt;figcaption&gt;View from Sopwith house, looking towards north Kingston. This image is updated every hour.&lt;/figcaption&gt;
  &lt;/figure&gt;
  &lt;p&gt;View the &lt;a href="http://news.bbc.co.uk/weather/forecast/4296?area=Kingston"&gt;latest weather details&lt;/a&gt; for Kingston upon Thames.&lt;/p&gt;
  </pre>
  </div>

  <h6 id="when-a-text-alternative-is-not-available-at-the-time-of-publication"><span class="secno">4.7.1.1.16 </span>When a text alternative is not available at the time of publication</h6>

  <p>In some cases an image is included in a published document, but the author is unable to provide an appropriate text alternative. 
  In such cases the minimum requirement is to provide a caption for the image using the <code><a href="grouping-content.html#the-figure-element">figure</a></code> and <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> 
  elements under the following conditions:</p>

  <ul id="figcaption-as-alt-condition"><li>The <code><a href="#the-img-element">img</a></code> element is in a <code><a href="grouping-content.html#the-figure-element">figure</a></code> element
  <li>The <code><a href="grouping-content.html#the-figure-element">figure</a></code> element contains a <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element
  <li>The <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element contains content other than inter-element whitespace
  <li>Ignoring the <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element and its descendants, the <code><a href="grouping-content.html#the-figure-element">figure</a></code>
  element has no <code><a href="infrastructure.html#text-0">Text</a></code> node descendants other than inter-element whitespace, and no 
  embedded content descendant other than the <code><a href="#the-img-element">img</a></code> element.
  </ul><p class="note">In other words, the only content of the <code><a href="grouping-content.html#the-figure-element">figure</a></code> is an <code><a href="#the-img-element">img</a></code> element and a <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code>
  element, and the <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element must include (caption) content.</p>
  <p class="note">Such cases are to be kept to an absolute
    minimum. If there is even the slightest possibility of the author
    having the ability to provide real alternative text, then it would
    not be acceptable to omit the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code>
    attribute.</p>
  
  <div class="example">
  <p>In this example, a person uploads a photo, as part of a bulk upoad of many images, to a photo sharing site. The user has not
  provided a text alternative or a caption for the image. The site's authoring tool inserts a caption automatically using whatever useful
  information it has for the image. In this case it's the file name and date the photo was taken.</p> 
  
  <p><img alt="no text alternative provided" height="258" src="images/clara.png" width="300"></p>
  <p><strong>clara.jpg, taken on 12/11/2010.</strong></p>

  <pre>  &lt;figure&gt;
  &lt;img src="clara.jpg"&gt;
  &lt;figcaption&gt;<strong>clara.jpg, taken on 12/11/2010.</strong>&lt;/figcaption&gt;
  &lt;/figure&gt;
  </pre>
  <p>Notice that even in this example, as much useful information
    as possible is still included in the <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> element.</p>
  </div>

  <div class="example">
  <p>In this second example, a person uploads a photo to a photo sharing site. She has provided
  a caption for the image but not a text alternative. This may be because the site does not provide users with the ability
  to add a text alternative in the <code>alt</code> attribute.</p> 
  
  <p><img alt="no text alternative provided" height="250" src="images/elo.png" width="205"></p>
  <p><strong>Eloisa with Princess Belle</strong></p>

  <pre>  &lt;figure&gt;
  &lt;img src="elo.jpg"&gt;
  &lt;figcaption&gt;<strong>Eloisa with Princess Belle</strong>&lt;/figcaption&gt;
  &lt;/figure&gt;
  </pre>

  </div>

  <div class="example">
  <p>Sometimes the entire point of the image is that a textual
  description is not available, and the user is to provide the
  description. For example, software that displays images and
  asks for alternative text precisely for the purpose of then
  writing a page with correct alternative text. Such a page could
  have a table of images, like this:</p>

  <pre>&lt;table&gt;
  &lt;tr&gt;&lt;tr&gt; &lt;th&gt; Image &lt;th&gt; Description&lt;tr&gt;
  &lt;td&gt;
  &lt;figure&gt;
  &lt;img src="2421.png"&gt;
  &lt;figcaption&gt;Image 640 by 100, filename 'banner.gif'&lt;/figcaption&gt;
  &lt;/figure&gt;
  &lt;td&gt; &lt;input name="alt2421"&gt;
  &lt;tr&gt;
  &lt;td&gt; &lt;figure&gt;
  &lt;img src="2422.png"&gt;
  &lt;figcaption&gt;Image 200 by 480, filename 'ad3.gif'&lt;/figcaption&gt;
  &lt;/figure&gt;
  &lt;td&gt; &lt;input name="alt2422"&gt;
  &lt;/table&gt;</pre>

  </div>

  <p class="note">Since some users cannot use images at all (e.g. because they are blind) the 
  <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute is only allowed to be omitted when no text 
  alternative is available and none can be made available, as in the above examples.</p>
  
  <h6 id="an-image-not-intended-for-the-user"><span class="secno">4.7.1.1.17 </span>An image not intended for the user</h6>

  <p class="auth">Generally authors should avoid using <code><a href="#the-img-element">img</a></code> elements
  for purposes other than showing images.</p>

  <p>If an <code><a href="#the-img-element">img</a></code> element is being used for purposes other
  than showing an image, e.g. as part of a service to count page
  views, use an empty <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute.</p>

  <div class="example">
  <p>An example of an <code><a href="#the-img-element">img</a></code> element used to collect web page statistics.
  The <code>alt</code> attribute is empty as the image has no meaning.</p>
 
  <pre>  &lt;img src="http://server3.stats.com/count.pl?NeonMeatDream.com" width="0" height="0" <strong>alt=""</strong>&gt;
  </pre>
  </div>
  
  <p class="note">It is recommended for the example use above the <code data-anolis-xref="attr-dim-width"><a href="#attr-dim-width">width</a></code> and
  <code data-anolis-xref="attr-dim-height"><a href="#attr-dim-height">height</a></code> attributes  be set to zero.</p>
  
  <div class="example">
  <p>Another example use is when an image such as a <i>spacer.gif</i> is used to aid positioning of content. 
  The <code>alt</code> attribute is empty as the image has no meaning.</p>
   
  <pre>  &lt;img src="spacer.gif" width="10" height="10" <strong>alt=""</strong>&gt;
  </pre>
  </div>

  <p class="note">It is recommended that that CSS be used to position content instead of <code><a href="#the-img-element">img</a></code> elements.</p>
  
  <h6 id="icon-images"><span class="secno">4.7.1.1.18 </span>Icon Images</h6>

  <p>An icon is usually a simple picture representing a program, action, data file or a concept. 
  Icons are intended to help users of visual browsers to recognize features at a glance.</p>

  <p>Use an empty <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute when an icon is supplemental to
  text conveying the same meaning.</p>

 <div class="example">
 <p>In this example, we have a link pointing to a site's home page, the link contains a 
 house icon image and the text "home". The image has an empty <code>alt</code> text. 
 Where images are used in this way, it would also be appropriate to add the image using CSS</p>
        
  <p><img alt="A house icon next to the word 'home'." height="38" src="images/home.png" width="100"></p>
       
  <pre>  &lt;a href="home.html"&gt;&lt;img src="home.gif" width="15" height="15" <strong>alt=""</strong>&gt;Home&lt;/a&gt;
  </pre>

  <pre>  #home:before
  { 
  content: url(home.png);
  }

  &lt;a href="home.html" id="home"&gt;Home&lt;/a&gt;
  </pre>
 </div>

 <div class="example">
 <p>In this example, there is a warning message, with a warning icon. The word "Warning!" is in emphasized 
 text next to the icon. As the information conveyed by the icon is redundant the <code><a href="#the-img-element">img</a></code> element is given an an empty <code>alt</code> attribute.</p>

 <p><img alt="Warning!" height="34" src="images/warning.png" width="38"><strong>Warning!</strong> Your session is about to expire.</p>

  <pre>  &lt;p&gt;&lt;img src="warning.png" width="15" height="15" <strong>alt=""</strong>&gt;
  &lt;strong&gt;Warning!&lt;/strong&gt; 
  Your session is about to expire&lt;/p&gt;
  </pre>
 </div>

 <p>When an icon conveys additional information not available in text, provide a text alternative.</p>
 
 <div class="example">
 <p>In this example, there is a warning message, with a warning icon. The icon emphasizes the 
 importance of the message and identifies it as a particular type of content.</p>
 <p><img alt="Warning!" height="34" src="images/warning.png" width="38"><strong>Your session is about to expire.</strong></p>

  <pre>  &lt;p&gt;&lt;img src="warning.png" width="15" height="15" <strong>alt="Warning!"</strong>&gt;
  Your session is about to expire&lt;/p&gt;
  </pre>

 </div>

  <h6 id="logos,-insignia,-flags,-or-emblems"><span class="secno">4.7.1.1.19 </span>Logos, insignia, flags, or emblems</h6>
  <p>Many pages include logos, insignia, flags, or emblems, which stand for a company, organization, project, 
  band, software package, country, or other entity. What can be considered as an appropriate text alternative depends upon, 
  like all images, the context in which the image is being used and what function it serves in the given context.</p>
  
  <p>If a logo is the sole content of a link, provide a brief description of the link target in the <code>alt</code> attribute.</p>
  <div class="example">
  <p>This example illustrates the use of the HTML5 logo as the sole content of a link to the HTML specification.</p>
  <p><a href="http://www.w3.org/html/wg/drafts/html/master/">
  <img alt="HTML 5.1 Nightly specification" height="128" src="images/HTML5_Logo.png" width="128"></a></p>
  <pre>  &lt;a href="http://dev.w3.org/html5/spec/spec.html"&gt;
  &lt;img src="HTML5_Logo.png" <strong>alt="HTML 5.1 specification"</strong>&gt;&lt;/a&gt;
  </pre>
  </div>
  <p>If a logo is being used to represent the entity, e.g. as a page heading, provide the name of the 
  entity being represented by the logo as the text alternative.</p>
  <div class="example">
  <p>This example illustrates the use of the WebPlatform.org logo being used to represent itself.</p>
  <p><img alt="WebPlatform.org" height="100" src="images/logo-with-text.png" width="110"> and other developer resources</p>

  <pre>  &lt;h2&gt;&lt;img src="images/webplatform.png" <strong>alt="WebPlatform.org"</strong>&gt; and other developer resources&lt;h2&gt;
  </pre>
  <p class="note">The text alternative in the example above could also include the word "logo" to describe the type of image content. 
  If so, it is suggested that square brackets be used to delineate this information: <code>alt="[logo] WebPlatform.org"</code>.</p>
  </div>
  <p>If a logo is being used next to the name of the what that it represents, then the logo is supplemental. 
  Include an empty <code>alt</code> attribute as the text alternative is already provided.</p>
  
  <div class="example">
  <p>This example illustrates the use of a logo next to the name of the organization it represents.</p>
  <p><img alt="" height="68" src="images/webplatform.png" width="72"> WebPlatform.org</p>
  <pre>  &lt;img src="images/webplatform1.png" <strong>alt=""</strong>&gt; WebPlatform.org
  </pre>
  
  </div>
  <p>If the logo is used alongside text discussing the subject or entity the logo represents, then provide 
  a text alternative which describes the logo.</p>

  <div class="example">
  <p>This example illustrates the use of a logo next to text discussing the subject the logo represents.</p>
  <p style="float:left;"><img alt="HTML5 logo: Shaped like a shield with the 
  text 'HTML' above and the numeral '5' prominent on the face of the shield." height="128" src="images/HTML5_Logo.png" width="128"></p>
  <p style="width:30em;"><strong>HTML5</strong> is a language for structuring and presenting content for the World 
    Wide Web, a core technology of the Internet. It is the latest revision of the HTML standard 
   (originally created in 1990 and most recently standardized as HTML4 in 1997) and currently remains 
   under development. Its core aims have been to improve the language with support for the latest 
   multimedia while keeping it easily readable by humans and consistently understood by computers and 
   devices (web browsers, parsers etc.). </p>
  <pre style="clear:both">  &lt;p&gt;&lt;img src="HTML5_Logo.png" <strong>alt="HTML5 logo: Shaped like a shield with the 
  text 'HTML' above and the numeral '5' prominent on the face of the shield."</strong>&gt;&lt;/p&gt;
  
  <i>Information about HTML5</i></pre>
  </div>
  
  <h6 id="captcha-images"><span class="secno">4.7.1.1.20 </span>CAPTCHA Images</h6>
  <p>CAPTCHA stands for "Completely Automated Public Turing test to tell Computers and Humans Apart".
  CAPTCHA images are used for security purposes to confirm that content is being accessed by a person
  rather than a computer. This authentication is done through visual verification of an image. CAPTCHA 
  typically presents an image with characters or words in it that the user is to re-type. The image is 
  usually distorted and has some noise applied to it to make the characters difficult to read.</p>
  
  <p>To improve the accessibility of CAPTCHA provide text alternatives that identify and describe the purpose of the image, and provide alternative 
  forms of the CAPTCHA using output modes for different types of sensory perception. For instance provide 
  an audio alternative along with the visual image. Place the audio option right next to the visual one. 
  This helps but is still problematic for people without sound cards, the deaf-blind, and some people with limited hearing. 
  Another method is to include a form that asks a question along with the visual image. This helps but can be 
  problematic for people with cognitive impairments.</p>
  <p class="note">It is strongly recommended that alternatives to CAPTCHA be used, as all forms of CAPTCHA introduce 
  unacceptable barriers to entry for users with disabilities. Further information is available in 
  <a href="http://www.w3.org/TR/turingtest/">Inaccessibility of CAPTCHA</a>.</p>
  <div class="example">
  <p>This example shows a CAPTCHA test which uses a distorted image of text. The text alternative in the 
  <code>alt</code> attribute provides instructions for a user in the case where she cannot access the image content. </p>
  <p><img alt="captcha containing the words 'aides' and 'sprucest'. The letters are distorted and the color of the letters and background is partially inverted," height="60" src="images/captcha.png" width="270"></p>
  <p><strong>Example code:</strong></p>
  <pre>&lt;img src="captcha.png" <strong>alt="If you cannot view this image an audio challenge is provided."</strong>&gt; 
  &lt;!-- audio CAPTCHA option that allows the user to listen and type the word --&gt;  
  &lt;!-- form that asks a question --&gt;
  </pre>
  </div>
  <!-- alt advice SF-->


  <div class="impl">

  <h6 id="guidance-for-markup-generators"><span class="secno">4.7.1.1.21 </span>Guidance for markup generators</h6>

  <p>Markup generators (such as WYSIWYG authoring tools) should,
  wherever possible, obtain a text alternative from their
  users. However, it is recognized that in many cases, this will not
  be possible.</p>

  <p>For images that are the sole contents of links, markup generators
  should examine the link target to determine the title of the target,
  or the URL of the target, and use information obtained in this
  manner as the text alternative.</p>

  <!-- WHATWG recommend use of @title this is bad for usability and accessibility -->
  <p>For images that have captions, markup generators should use the
  <code><a href="grouping-content.html#the-figure-element">figure</a></code> and <code><a href="grouping-content.html#the-figcaption-element">figcaption</a></code> elements to provide the
  image's caption.</p>
    <p>As a last resort, implementors should either set the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute to the empty string, under
  the assumption that the image is a purely decorative image that
  doesn't add any information but is still specific to the surrounding
  content, or omit the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute
  altogether, under the assumption that the image is a key part of the
  content.</p>

  <p>Markup generators may specify a <dfn data-anolis-xref="attr-img-generator-unable-to-provide-required-alt" id="attr-img-generator-unable-to-provide-required-alt"><code>generator-unable-to-provide-required-alt</code></dfn>
  attribute on <code><a href="#the-img-element">img</a></code> elements for which they have been
  unable to obtain a text alternative and for which they have therefore
  omitted the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute. The
  value of this attribute must be the empty string. Documents
  containing such attributes are not conforming, but conformance
  checkers will <a href="#guidance-for-conformance-checkers">silently
  ignore</a> this error.</p>

  <p class="note">This is intended to avoid markup generators from
  being pressured into replacing the error of omitting the <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute with the even more
  egregious error of providing phony text alternatives, because
  state-of-the-art automated conformance checkers cannot distinguish
  phony text alternatives from correct text alternatives.</p>

  <p>Markup generators should generally avoid using the image's own
  file name as the text alternative. Similarly, markup generators
  should avoid generating text alternatives from any content that will
  be equally available to presentation user agents (e.g. Web
  browsers).</p>

  <p class="note">This is because once a page is generated, it will
  typically not be updated, whereas the browsers that later read the
  page can be updated by the user, therefore the browser is likely to
  have more up-to-date and finely-tuned heuristics than the markup
  generator did when generating the page.</p>

  </div>

  <div class="impl">

  <h6 id="guidance-for-conformance-checkers"><span class="secno">4.7.1.1.22 </span>Guidance for conformance checkers</h6>

  <p>A conformance checker must report the lack of an <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute as an error unless one of
  the conditions listed below applies:</p>

  <ul><!-- when editing this list, search for the two other occurrences
   of 'critical-no-alt' --><li><p>The <code><a href="#the-img-element">img</a></code> element is in a <code><a href="grouping-content.html#the-figure-element">figure</a></code>
   element that satisfies <a href="#figcaption-as-alt-condition">the
   conditions described above</a>.</li>

<!--TITLE-->

   <!-- the following are additional entries not included in the
   aforementioned list, as they apply only to conformance checkers -->


   <li><p>The <code><a href="#the-img-element">img</a></code> element has a (non-conforming) <code data-anolis-xref="attr-img-generator-unable-to-provide-required-alt"><a href="#attr-img-generator-unable-to-provide-required-alt">generator-unable-to-provide-required-alt</a></code>
   attribute whose value is the empty string. A conformance checker
   that is not reporting the lack of an <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute as an error must also not
   report the presence of the empty <code data-anolis-xref="attr-img-generator-unable-to-provide-required-alt"><a href="#attr-img-generator-unable-to-provide-required-alt">generator-unable-to-provide-required-alt</a></code>
   attribute as an error. (This case does not represent a case where
   the document is conforming, only that the generator could not
   determine appropriate alternative text — validators are not
   required to show an error in this case, because such an error might
   encourage markup generators to include bogus alternative text
   purely in an attempt to silence validators. Naturally, conformance
   checkers <em>may</em> report the lack of an <code data-anolis-xref="attr-img-alt"><a href="#attr-img-alt">alt</a></code> attribute as an error even in the
   presence of the <code data-anolis-xref="attr-img-generator-unable-to-provide-required-alt"><a href="#attr-img-generator-unable-to-provide-required-alt">generator-unable-to-provide-required-alt</a></code>
   attribute; for example, there could be a user option to report
   <em>all</em> conformance errors even those that might be the more
   or less inevitable result of using a markup generator.)</li>

  </ul></div>

  <h4 id="the-iframe-element"><span class="secno">4.7.2 </span>The <dfn><code>iframe</code></dfn> element</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd><a href="dom.html#flow-content-1">Flow content</a>.</dd>
   <dd><a href="dom.html#phrasing-content-1">Phrasing content</a>.</dd>
   <dd><a href="dom.html#embedded-content-2">Embedded content</a>.</dd>
   <dd><a href="dom.html#interactive-content-0">Interactive content</a>.</dd>
   <dd><a href="dom.html#palpable-content-0">Palpable content</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>Where <a href="dom.html#embedded-content-2">embedded content</a> is expected.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd>Text that conforms to <a href="#iframe-content-model">the requirements given in the prose</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
   <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-iframe-src"><a href="#attr-iframe-src">src</a></code> - Address of the resource</dd>
   <dd><code data-anolis-xref="attr-iframe-srcdoc"><a href="#attr-iframe-srcdoc">srcdoc</a></code> - A document to render in the <code><a href="#the-iframe-element">iframe</a></code></dd>
   <dd><code data-anolis-xref="attr-iframe-name"><a href="#attr-iframe-name">name</a></code> - Name of <a href="browsers.html#nested-browsing-context">nested browsing context</a></dd>
   <dd><code data-anolis-xref="attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code> - Security rules for nested content</dd>
   <dd><code data-anolis-xref="attr-dim-width"><a href="#attr-dim-width">width</a></code> - Horizontal dimension</dd>
   <dd><code data-anolis-xref="attr-dim-height"><a href="#attr-dim-height">height</a></code> - Vertical dimension</dd>
   <dt><a data-anolis-xref="element-dfn-tag-omission" href="dom.html#element-dfn-tag-omission">Tag omission in text/html</a>:</dt>
   <dd>Neither tag is omissible</dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd><a href="dom.html#index-aria-application"><code title="">application</code></a>, <a href="dom.html#index-aria-document">
   <code title="">document</code></a>, <a href="dom.html#index-aria-img"><code title="">img</code></a> or 
   <a href="dom.html#index-aria-presentation"><code title="">presentation</code></a>.</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dd>Any <code title="">aria-*</code> attributes 
   <a href="dom.html#allowed-aria-roles,-states-and-properties">applicable to the allowed roles</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">interface <dfn id="htmliframeelement">HTMLIFrameElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a data-anolis-xref="dom-iframe-src" href="#dom-iframe-src">src</a>;
           attribute DOMString <a data-anolis-xref="dom-iframe-srcdoc" href="#dom-iframe-srcdoc">srcdoc</a>;
           attribute DOMString <a data-anolis-xref="dom-iframe-name" href="#dom-iframe-name">name</a>;
  [PutForwards=<span data-anolis-xref="dom-DOMSettableTokenList-value">value</span>] readonly attribute <a href="infrastructure.html#domsettabletokenlist">DOMSettableTokenList</a> <a data-anolis-xref="dom-iframe-sandbox" href="#dom-iframe-sandbox">sandbox</a>;
           attribute DOMString <a data-anolis-xref="dom-dim-width" href="#dom-dim-width">width</a>;
           attribute DOMString <a data-anolis-xref="dom-dim-height" href="#dom-dim-height">height</a>;
  readonly attribute <a href="dom.html#document">Document</a>? <a data-anolis-xref="dom-iframe-contentDocument" href="#dom-iframe-contentdocument">contentDocument</a>;
  readonly attribute <a href="browsers.html#windowproxy">WindowProxy</a>? <a data-anolis-xref="dom-iframe-contentWindow" href="#dom-iframe-contentwindow">contentWindow</a>;
};</pre>
   </dd>
  </dl><!--TOPIC:HTML--><!-- INTRO --><p>The <code><a href="#the-iframe-element">iframe</a></code> element <a href="dom.html#represents">represents</a> a <a href="browsers.html#nested-browsing-context">nested browsing
  context</a>.</p>


  <!-- SRC/SRCDOC -->

  <p>The <dfn data-anolis-xref="attr-iframe-src" id="attr-iframe-src"><code>src</code></dfn> attribute gives the address of a page
  that the <a href="browsers.html#nested-browsing-context">nested browsing context</a> is to contain. The attribute, if present, must be a
  <a href="infrastructure.html#valid-non-empty-url-potentially-surrounded-by-spaces">valid non-empty URL potentially surrounded by spaces</a>.</p>

  <p>The <dfn data-anolis-xref="attr-iframe-srcdoc" id="attr-iframe-srcdoc"><code>srcdoc</code></dfn> attribute gives the content of
  the page that the <a href="browsers.html#nested-browsing-context">nested browsing context</a> is to contain. The value of the attribute
  is the source of <dfn id="an-iframe-srcdoc-document">an <code>iframe</code> <code data-anolis-xref="attr-iframe-srcdoc">srcdoc</code>
  document</dfn>.</p>

  <p>For <code><a href="#the-iframe-element">iframe</a></code> elements in <a href="infrastructure.html#html-documents">HTML documents</a>, the <code data-anolis-xref="attr-iframe-srcdoc"><a href="#attr-iframe-srcdoc">srcdoc</a></code> attribute, if present, must have a value using <a href="syntax.html#syntax">the
  HTML syntax</a> that consists of the following syntactic components, in the given order:</p>

  <ol><li>Any number of <a data-anolis-xref="syntax-comments" href="syntax.html#syntax-comments">comments</a> and <a data-anolis-xref="space
   character" href="infrastructure.html#space-character">space characters</a>.</li>

   <li>Optionally, a <a data-anolis-xref="syntax-doctype" href="syntax.html#syntax-doctype">DOCTYPE</a>.

   <li>Any number of <a data-anolis-xref="syntax-comments" href="syntax.html#syntax-comments">comments</a> and <a data-anolis-xref="space
   character" href="infrastructure.html#space-character">space characters</a>.</li>

   <li>The root element, in the form of an <code><a href="semantics.html#the-html-element">html</a></code> <a data-anolis-xref="syntax-elements" href="syntax.html#syntax-elements">element</a>.</li>

   <li>Any number of <a data-anolis-xref="syntax-comments" href="syntax.html#syntax-comments">comments</a> and <a data-anolis-xref="space
   character" href="infrastructure.html#space-character">space characters</a>.</li>

  </ol><p>For <code><a href="#the-iframe-element">iframe</a></code> elements in <a href="infrastructure.html#xml-documents">XML documents</a>, the <code data-anolis-xref="attr-iframe-srcdoc"><a href="#attr-iframe-srcdoc">srcdoc</a></code> attribute, if present, must have a value that matches the
  production labeled <code data-anolis-xref="">document</code> in the XML specification. <a href="references.html#refsXML">[XML]</a></p>

  <p class="note">In <a href="syntax.html#syntax">the HTML syntax</a>, authors need only remember to use """ (U+0022) characters to wrap the attribute contents and then to escape all """ (U+0022) and U+0026 AMPERSAND (&amp;) characters, and to specify the <code data-anolis-xref="attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code> attribute, to ensure safe embedding of content.</p>

  <p class="note">Due to restrictions of <a href="the-xhtml-syntax.html#the-xhtml-syntax">the XHTML syntax</a>, in XML the "&lt;" (U+003C) character needs to be escaped as well. In order to prevent <a href="http://www.w3.org/TR/xml/#AVNormalize">attribute-value normalization</a>, some of XML's
  whitespace characters — specifically "tab" (U+0009), "LF" (U+000A), and "CR" (U+000D) — also need to be escaped. <a href="references.html#refsXML">[XML]</a></p>

  <p class="note">If the <code data-anolis-xref="attr-iframe-src"><a href="#attr-iframe-src">src</a></code> attribute and the <code data-anolis-xref="attr-iframe-srcdoc"><a href="#attr-iframe-srcdoc">srcdoc</a></code> attribute are both specified together, the <code data-anolis-xref="attr-iframe-srcdoc"><a href="#attr-iframe-srcdoc">srcdoc</a></code> attribute takes priority. This allows authors to provide
  a fallback <span>URL</span> for legacy user agents that do not support the <code data-anolis-xref="attr-iframe-srcdoc"><a href="#attr-iframe-srcdoc">srcdoc</a></code> attribute.</p>


  <div class="impl">

  <hr><!-- SRC/SRCDOC PROCESSING MODEL --><p>When an <code><a href="#the-iframe-element">iframe</a></code> element is <a data-anolis-xref="insert an element into a document" href="infrastructure.html#insert-an-element-into-a-document">inserted
  into a document</a>, the user agent must create a <a href="browsers.html#nested-browsing-context">nested browsing context</a>, and
  then <a href="#process-the-iframe-attributes">process the <code>iframe</code> attributes</a> for the "first time".</p>

  <p>When an <code><a href="#the-iframe-element">iframe</a></code> element is <a data-anolis-xref="remove an element from a document" href="infrastructure.html#remove-an-element-from-a-document">removed
  from a document</a>, the user agent must <a data-anolis-xref="a browsing context is
  discarded" href="browsers.html#a-browsing-context-is-discarded">discard</a> the <a href="browsers.html#nested-browsing-context">nested browsing context</a>.</p>

  <p class="note">This happens without any <code data-anolis-xref="event-unload">unload</code> events firing
  (the <a href="browsers.html#nested-browsing-context">nested browsing context</a> and its <code><a href="dom.html#document">Document</a></code> are <em data-anolis-xref="a browsing
  context is discarded"><a href="browsers.html#a-browsing-context-is-discarded">discarded</a></em>, not <em data-anolis-xref="unload a document"><a href="browsers.html#unload-a-document">unloaded</a></em>).</p>

  <!-- START of section that's very similar to <frame> -->

  <p>Whenever an <code><a href="#the-iframe-element">iframe</a></code> element with a <a href="browsers.html#nested-browsing-context">nested browsing context</a> has its
  <code data-anolis-xref="attr-iframe-srcdoc"><a href="#attr-iframe-srcdoc">srcdoc</a></code> attribute set, changed, or removed, the user agent
  must <a href="#process-the-iframe-attributes">process the <code>iframe</code> attributes</a>.</p>

  <p>Similarly, whenever an <code><a href="#the-iframe-element">iframe</a></code> element with a <a href="browsers.html#nested-browsing-context">nested browsing context</a>
  but with no <code data-anolis-xref="attr-iframe-srcdoc"><a href="#attr-iframe-srcdoc">srcdoc</a></code> attribute specified has its <code data-anolis-xref="attr-iframe-src"><a href="#attr-iframe-src">src</a></code> attribute set, changed, or removed, the user agent must
  <a href="#process-the-iframe-attributes">process the <code>iframe</code> attributes</a>.</p> <!-- It doesn't happen when the base
  URL is changed, though. -->

  <p>When the user agent is to <dfn id="process-the-iframe-attributes">process the <code>iframe</code> attributes</dfn>, it must run
  the first appropriate steps from the following list:</p>

  <dl class="switch"><dt>If the <code data-anolis-xref="attr-iframe-srcdoc"><a href="#attr-iframe-srcdoc">srcdoc</a></code> attribute is specified</dt>

   <dd><p><a href="browsers.html#navigate">Navigate</a><!--DONAV iframe--> the element's <a href="browsers.html#child-browsing-context">child browsing context</a>
   to a resource whose <a href="infrastructure.html#content-type">Content-Type</a> is <code><a href="iana.html#text/html">text/html</a></code>, whose <span>URL</span>
   is <code><a href="infrastructure.html#about:srcdoc">about:srcdoc</a></code>, and whose data consists of the value of the attribute. The
   resulting <code><a href="dom.html#document">Document</a></code> must be considered <a href="#an-iframe-srcdoc-document">an <code>iframe</code> <code data-anolis-xref="attr-iframe-srcdoc">srcdoc</code> document</a>.</dd>

   <dt>Otherwise, if the element has no <code data-anolis-xref="attr-iframe-src"><a href="#attr-iframe-src">src</a></code> attribute
   specified, and the user agent is processing the <code><a href="#the-iframe-element">iframe</a></code>'s attributes for the "first
   time"</dt>

   <dd>

    <p><a href="webappapis.html#queue-a-task">Queue a task</a> to run the <a href="#iframe-load-event-steps">iframe load event steps</a>.</p>

    <p>The <a href="webappapis.html#task-source">task source</a> for this <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> is the
    <a href="webappapis.html#dom-manipulation-task-source">DOM manipulation task source</a>.</p>

   </dd>

   <dt>Otherwise</dt>

   <dd>

    <ol><li>

<!--CLEANUP-->
      <p>If the value of the <code data-anolis-xref="attr-iframe-src"><a href="#attr-iframe-src">src</a></code> attribute is missing, or its value is the empty string,
      let <var data-anolis-xref="">url</var> be the string "<code><a href="infrastructure.html#about:blank">about:blank</a></code>".</p>
      <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/saved/2641 -->

      <p>Otherwise, <a data-anolis-xref="resolve a url" href="infrastructure.html#resolve-a-url">resolve</a> the value of the <code data-anolis-xref="attr-iframe-src"><a href="#attr-iframe-src">src</a></code> attribute, relative to the <code><a href="#the-iframe-element">iframe</a></code> element.</p>

      <p>If that is not successful, then let <var data-anolis-xref="">url</var> be the string
      "<code><a href="infrastructure.html#about:blank">about:blank</a></code>". Otherwise, let <var data-anolis-xref="">url</var> be the resulting
      <a href="infrastructure.html#absolute-url">absolute URL</a>.</p>

     </li>

     <li>

      <p>If there exists an <a href="browsers.html#ancestor-browsing-context">ancestor browsing context</a> whose <a href="browsers.html#active-document">active
      document</a>'s <a data-anolis-xref="the document's address" href="dom.html#the-document's-address">address</a>, ignoring fragment
      identifiers, is equal to <var data-anolis-xref="">url</var>, then abort these steps.</p>
      <!-- http://www.hixie.ch/tests/adhoc/html/frames/iframes/ 008.html and 009.html -->
      <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/saved/1969 -->
      <!-- I'm assuming that "resolve" will normalise things like scheme and hostname case -->

     </li>

     <li>

      <p><a href="browsers.html#navigate">Navigate</a><!--DONAV iframe--> the element's <a href="browsers.html#child-browsing-context">child browsing context</a>
      to <var data-anolis-xref="">url</var>.</p>
      
     </li>

    </ol></dd>

  </dl><p>Any <a data-anolis-xref="navigate" href="browsers.html#navigate">navigation</a> required of the user agent in the <a href="#process-the-iframe-attributes">process
  the <code>iframe</code> attributes</a> algorithm must be completed as an <span>explicit
  self-navigation override</span> and with the <code><a href="#the-iframe-element">iframe</a></code> element's document's
  <a href="browsers.html#browsing-context">browsing context</a> as the <a href="browsers.html#source-browsing-context">source browsing context</a>.</p>

  <p>Furthermore, if the <a href="browsers.html#active-document">active document</a> of the element's <a href="browsers.html#child-browsing-context">child browsing
  context</a> before such a <a data-anolis-xref="navigate" href="browsers.html#navigate">navigation</a> was not <a href="syntax.html#completely-loaded">completely
  loaded</a> at the time of the new <a data-anolis-xref="navigate" href="browsers.html#navigate">navigation</a>, then the <a data-anolis-xref="navigate" href="browsers.html#navigate">navigation</a> must be completed with <a href="browsers.html#replacement-enabled">replacement enabled</a>.</p>

  <p>Similarly, if the <a href="browsers.html#child-browsing-context">child browsing context</a>'s <a href="browsers.html#session-history">session history</a> contained
  only one <code><a href="dom.html#document">Document</a></code> when the <a href="#process-the-iframe-attributes">process the <code>iframe</code> attributes</a>
  algorithm was invoked, and that was the <code><a href="infrastructure.html#about:blank">about:blank</a></code> <code><a href="dom.html#document">Document</a></code> created
  when the <a href="browsers.html#child-browsing-context">child browsing context</a> was created, then any <a data-anolis-xref="navigate" href="browsers.html#navigate">navigation</a> required of the user agent in that algorithm must be completed
  with <a href="browsers.html#replacement-enabled">replacement enabled</a>.</p> <!-- see also the note near similar text for the
  location.assign() method -->

  <p>When a <code><a href="dom.html#document">Document</a></code> in an <code><a href="#the-iframe-element">iframe</a></code> is marked as <a href="syntax.html#completely-loaded">completely
  loaded</a>, the user agent must synchronously run the <a href="#iframe-load-event-steps">iframe load event steps</a>.</p>

  <p class="note">A <code data-anolis-xref="event-load">load</code> event is also fired at the
  <code><a href="#the-iframe-element">iframe</a></code> element when it is created if no other data is loaded in it.</p>

  <p>Each <code><a href="dom.html#document">Document</a></code> has an <dfn id="iframe-load-in-progress">iframe load in progress</dfn> flag and a <dfn id="mute-iframe-load">mute
  iframe load</dfn> flag. When a <code><a href="dom.html#document">Document</a></code> is created, these flags must be unset for
  that <code><a href="dom.html#document">Document</a></code>.</p>

  <p>The <dfn id="iframe-load-event-steps">iframe load event steps</dfn> are as follows:</p>

  <ol><li><p>Let <var data-anolis-xref="">child document</var> be the <a href="browsers.html#active-document">active document</a> of the
   <code><a href="#the-iframe-element">iframe</a></code> element's <a href="browsers.html#nested-browsing-context">nested browsing context</a>.</li>

   <li><p>If <var data-anolis-xref="">child document</var> has its <a href="#mute-iframe-load">mute iframe load</a> flag set,
   abort these steps.</li>

   <li><p>Set <var data-anolis-xref="">child document</var>'s <a href="#iframe-load-in-progress">iframe load in progress</a>
   flag.</li>

   <li><p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-load">load</code> at the
   <code><a href="#the-iframe-element">iframe</a></code> element.</li>

   <li><p>Unset <var data-anolis-xref="">child document</var>'s <a href="#iframe-load-in-progress">iframe load in progress</a>
   flag.</li>

  </ol><p class="warning">This, in conjunction with scripting, can be used to probe the URL space of the
  local network's HTTP servers. User agents may implement <a data-anolis-xref="origin" href="browsers.html#origin-0">cross-origin</a>
  access control policies that are stricter than those described above to mitigate this attack, but
  unfortunately such policies are typically not compatible with existing Web content.</p>

  <p>When the <code><a href="#the-iframe-element">iframe</a></code>'s <a href="browsers.html#browsing-context">browsing context</a>'s <a href="browsers.html#active-document">active document</a> is
  not <a href="syntax.html#ready-for-post-load-tasks">ready for post-load tasks</a>, and when anything in the <code><a href="#the-iframe-element">iframe</a></code> is <a data-anolis-xref="delay the load event" href="syntax.html#delay-the-load-event">delaying the load event</a> of the <code><a href="#the-iframe-element">iframe</a></code>'s
  <a href="browsers.html#browsing-context">browsing context</a>'s <a href="browsers.html#active-document">active document</a>, and when the <code><a href="#the-iframe-element">iframe</a></code>'s
  <a href="browsers.html#browsing-context">browsing context</a> is in the <a href="browsers.html#delaying-load-events-mode">delaying <code data-anolis-xref="event-load">load</code> events
  mode</a>, the <code><a href="#the-iframe-element">iframe</a></code> must <a href="syntax.html#delay-the-load-event">delay the load event</a> of its document.</p>

  <p class="note">If, during the handling of the <code data-anolis-xref="event-load">load</code> event, the
  <a href="browsers.html#browsing-context">browsing context</a> in the <code><a href="#the-iframe-element">iframe</a></code> is again <a data-anolis-xref="navigate" href="browsers.html#navigate">navigated</a>, that will further <a href="syntax.html#delay-the-load-event">delay the load event</a>.</p>

  </div>

  <!-- END of section that's very similar to <frame> -->

  <p class="note">If, when the element is created, the <code data-anolis-xref="attr-iframe-srcdoc"><a href="#attr-iframe-srcdoc">srcdoc</a></code> attribute is not set, and the <code data-anolis-xref="attr-iframe-src"><a href="#attr-iframe-src">src</a></code> attribute is either also not set or set but its value cannot be
  <a data-anolis-xref="resolve a url" href="infrastructure.html#resolve-a-url">resolved</a>, the browsing context will remain at the initial
  <code><a href="infrastructure.html#about:blank">about:blank</a></code> page.</p>

  <p class="note">If the user <a data-anolis-xref="navigate" href="browsers.html#navigate">navigates</a> away from this page, the
  <code><a href="#the-iframe-element">iframe</a></code>'s corresponding <code><a href="browsers.html#windowproxy">WindowProxy</a></code> object will proxy new
  <code><a href="browsers.html#window">Window</a></code> objects for new <code><a href="dom.html#document">Document</a></code> objects, but the <code data-anolis-xref="attr-iframe-src"><a href="#attr-iframe-src">src</a></code> attribute will not change.</p>


  <hr><!-- NAME --><p>The <dfn data-anolis-xref="attr-iframe-name" id="attr-iframe-name"><code>name</code></dfn> attribute, if present, must be a
  <a href="browsers.html#valid-browsing-context-name">valid browsing context name</a>. The given value is used to name the <a href="browsers.html#nested-browsing-context">nested
  browsing context</a>. <span class="impl">When the browsing context is created, if the attribute
  is present, the <a href="browsers.html#browsing-context-name">browsing context name</a> must be set to the value of this attribute;
  otherwise, the <a href="browsers.html#browsing-context-name">browsing context name</a> must be set to the empty string.</span></p>

  <div class="impl">

  <p>Whenever the <code data-anolis-xref="attr-iframe-name"><a href="#attr-iframe-name">name</a></code> attribute is set, the nested
  <a href="browsers.html#browsing-context">browsing context</a>'s <a data-anolis-xref="browsing context name" href="browsers.html#browsing-context-name">name</a> must be changed to
  the new value. If the attribute is removed, the <a href="browsers.html#browsing-context-name">browsing context name</a> must be set to
  the empty string.</p>

  </div>


  <hr><!-- SANDBOX --><p>The <dfn data-anolis-xref="attr-iframe-sandbox" id="attr-iframe-sandbox"><code>sandbox</code></dfn> attribute, when specified,
  enables a set of extra restrictions on any content hosted by the <code><a href="#the-iframe-element">iframe</a></code>. Its value
  must be an <a href="infrastructure.html#unordered-set-of-unique-space-separated-tokens">unordered set of unique space-separated tokens</a> that are <a href="infrastructure.html#ascii-case-insensitive">ASCII
  case-insensitive</a>. The allowed values are <code data-anolis-xref="attr-iframe-sandbox-allow-forms"><a href="browsers.html#attr-iframe-sandbox-allow-forms">allow-forms</a></code>, <code data-anolis-xref="attr-iframe-sandbox-allow-pointer-lock"><a href="browsers.html#attr-iframe-sandbox-allow-pointer-lock">allow-pointer-lock</a></code>, <code data-anolis-xref="attr-iframe-sandbox-allow-popups"><a href="browsers.html#attr-iframe-sandbox-allow-popups">allow-popups</a></code>, <code data-anolis-xref="attr-iframe-sandbox-allow-same-origin"><a href="browsers.html#attr-iframe-sandbox-allow-same-origin">allow-same-origin</a></code>, <code data-anolis-xref="attr-iframe-sandbox-allow-scripts"><a href="browsers.html#attr-iframe-sandbox-allow-scripts">allow-scripts</a></code>, and <code data-anolis-xref="attr-iframe-sandbox-allow-top-navigation"><a href="browsers.html#attr-iframe-sandbox-allow-top-navigation">allow-top-navigation</a></code>.</p>

  <p>When the attribute is set, the content is treated as being from a unique <a href="browsers.html#origin-0">origin</a>,
  forms, scripts, and various potentially annoying APIs are disabled, links are prevented from
  targeting other <a data-anolis-xref="browsing context" href="browsers.html#browsing-context">browsing contexts</a>, and plugins are secured.
  The <code data-anolis-xref="attr-iframe-sandbox-allow-same-origin"><a href="browsers.html#attr-iframe-sandbox-allow-same-origin">allow-same-origin</a></code> keyword causes
  the content to be treated as being from its real origin instead of forcing it into a unique
  origin; the <code data-anolis-xref="attr-iframe-sandbox-allow-top-navigation"><a href="browsers.html#attr-iframe-sandbox-allow-top-navigation">allow-top-navigation</a></code>
  keyword allows the content to <a href="browsers.html#navigate">navigate</a> its <a href="browsers.html#top-level-browsing-context">top-level browsing context</a>;
  and the <code data-anolis-xref="attr-iframe-sandbox-allow-forms"><a href="browsers.html#attr-iframe-sandbox-allow-forms">allow-forms</a></code>, <code data-anolis-xref="attr-iframe-sandbox-allow-pointer-lock"><a href="browsers.html#attr-iframe-sandbox-allow-pointer-lock">allow-pointer-lock</a></code>, <code data-anolis-xref="attr-iframe-sandbox-allow-popups"><a href="browsers.html#attr-iframe-sandbox-allow-popups">allow-popups</a></code> and <code data-anolis-xref="attr-iframe-sandbox-allow-scripts"><a href="browsers.html#attr-iframe-sandbox-allow-scripts">allow-scripts</a></code> keywords re-enable forms, the
  pointer lock API, popups, and scripts respectively. <a href="references.html#refsPOINTERLOCK">[POINTERLOCK]</a></p>

  <p class="warning">Setting both the <code data-anolis-xref="attr-iframe-sandbox-allow-scripts"><a href="browsers.html#attr-iframe-sandbox-allow-scripts">allow-scripts</a></code> and <code data-anolis-xref="attr-iframe-sandbox-allow-same-origin"><a href="browsers.html#attr-iframe-sandbox-allow-same-origin">allow-same-origin</a></code> keywords together when the
  embedded page has the <a href="browsers.html#same-origin">same origin</a> as the page containing the <code><a href="#the-iframe-element">iframe</a></code>
  allows the embedded page to simply remove the <code data-anolis-xref="attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code>
  attribute and then reload itself, effectively breaking out of the sandbox altogether.</p>

  <p class="warning">These flags only take effect when the <a href="browsers.html#nested-browsing-context">nested browsing context</a> of
  the <code><a href="#the-iframe-element">iframe</a></code> is <a data-anolis-xref="navigate" href="browsers.html#navigate">navigated</a>. Removing them, or removing the
  entire <code data-anolis-xref="attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code> attribute, has no effect on an
  already-loaded page.</p>

  <p class="warning">Potentially hostile files should not be served from the same server as the file
  containing the <code><a href="#the-iframe-element">iframe</a></code> element. Sandboxing hostile content is of minimal help if an
  attacker can convince the user to just visit the hostile content directly, rather than in the
  <code><a href="#the-iframe-element">iframe</a></code>. To limit the damage that can be caused by hostile HTML content, it should be
  served from a separate dedicated domain. Using a different domain ensures that scripts in the
  files are unable to attack the site, even if the user is tricked into visiting those pages
  directly, without the protection of the <code data-anolis-xref="attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code>
  attribute.</p>

  <div class="impl">

  <!-- v2: Add a new attribute that enables new restrictions, e.g.:
       - disallow cross-origin loads of any kind (networking
         override that only allows same-origin URLs or about:,
         javascript:, data:)
       - block access to 'parent.frames' from sandbox
  -->

  <p>When an <code><a href="#the-iframe-element">iframe</a></code> element with a <code data-anolis-xref="attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code>
  attribute has its <a href="browsers.html#nested-browsing-context">nested browsing context</a> created (before the initial
  <code><a href="infrastructure.html#about:blank">about:blank</a></code> <code><a href="dom.html#document">Document</a></code> is created), and when an <code><a href="#the-iframe-element">iframe</a></code>
  element's <code data-anolis-xref="attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code> attribute is set or changed while it
  has a <a href="browsers.html#nested-browsing-context">nested browsing context</a>, the user agent must <a data-anolis-xref="parse a sandboxing
  directive" href="browsers.html#parse-a-sandboxing-directive">parse the sandboxing directive</a> using the attribute's value as the <var data-anolis-xref="">input</var>, and the <code><a href="#the-iframe-element">iframe</a></code> element's <a href="browsers.html#nested-browsing-context">nested browsing context</a>'s
  <a href="browsers.html#iframe-sandboxing-flag-set"><code>iframe</code> sandboxing flag set</a> as the output.</p>

  <p>When an <code><a href="#the-iframe-element">iframe</a></code> element's <code data-anolis-xref="attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code>
  attribute is removed while it has a <a href="browsers.html#nested-browsing-context">nested browsing context</a>, the user agent must
  empty the <code><a href="#the-iframe-element">iframe</a></code> element's <a href="browsers.html#nested-browsing-context">nested browsing context</a>'s
  <a href="browsers.html#iframe-sandboxing-flag-set"><code>iframe</code> sandboxing flag set</a> as the output.</p>

  </div>

  <div class="example">

   <p>In this example, some completely-unknown, potentially hostile, user-provided HTML content is
   embedded in a page. Because it is served from a separate domain, it is affected by all the normal
   cross-site restrictions. In addition, the embedded page has scripting disabled, plugins disabled,
   forms disabled, and it cannot navigate any frames or windows other than itself (or any frames or
   windows it itself embeds).</p>

   <pre>&lt;p&gt;We're not scared of you! Here is your content, unedited:&lt;/p&gt;
&lt;iframe sandbox src="http://usercontent.example.net/getusercontent.cgi?id=12193"&gt;&lt;/iframe&gt;</pre>

   <p class="warning">It is important to use a separate domain so that if the attacker convinces the
   user to visit that page directly, the page doesn't run in the context of the site's origin, which
   would make the user vulnerable to any attack found in the page.</p>

  </div>

  <div class="example">

   <p>In this example, a gadget from another site is embedded. The gadget has scripting and forms
   enabled, and the origin sandbox restrictions are lifted, allowing the gadget to communicate with
   its originating server. The sandbox is still useful, however, as it disables plugins and popups,
   thus reducing the risk of the user being exposed to malware and other annoyances.</p>

   <pre>&lt;iframe sandbox="allow-same-origin allow-forms allow-scripts"
        src="http://maps.example.com/embedded.html"&gt;&lt;/iframe&gt;</pre>

  </div>

  <div class="example">

   <p>Suppose a file A contained the following fragment:</p>

   <pre>&lt;iframe sandbox="allow-same-origin allow-forms" src=B&gt;&lt;/iframe&gt;</pre>

   <p>Suppose that file B contained an iframe also:</p>

   <pre>&lt;iframe sandbox="allow-scripts" src=C&gt;&lt;/iframe&gt;</pre>

   <p>Further, suppose that file C contained a link:</p>

   <pre>&lt;a href=D&gt;Link&lt;/a&gt;</pre>

   <p>For this example, suppose all the files were served as <code><a href="iana.html#text/html">text/html</a></code>.</p>

   <p>Page C in this scenario has all the sandboxing flags set. Scripts are disabled, because the
   <code><a href="#the-iframe-element">iframe</a></code> in A has scripts disabled, and this overrides the <code data-anolis-xref="attr-iframe-sandbox-allow-scripts"><a href="browsers.html#attr-iframe-sandbox-allow-scripts">allow-scripts</a></code> keyword set on the
   <code><a href="#the-iframe-element">iframe</a></code> in B. Forms are also disabled, because the inner <code><a href="#the-iframe-element">iframe</a></code> (in B)
   does not have the <code data-anolis-xref="attr-iframe-sandbox-allow-forms"><a href="browsers.html#attr-iframe-sandbox-allow-forms">allow-forms</a></code> keyword
   set.</p>

   <p>Suppose now that a script in A removes all the <code data-anolis-xref="attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code> attributes in A <!--grammar-check-override--> and B.
   This would change nothing immediately. If the user clicked the link in C, loading page D into the
   <code><a href="#the-iframe-element">iframe</a></code> in B, page D would now act as if the <code><a href="#the-iframe-element">iframe</a></code> in B had the <code data-anolis-xref="attr-iframe-sandbox-allow-same-origin"><a href="browsers.html#attr-iframe-sandbox-allow-same-origin">allow-same-origin</a></code> and <code data-anolis-xref="attr-iframe-sandbox-allow-forms"><a href="browsers.html#attr-iframe-sandbox-allow-forms">allow-forms</a></code> keywords set, because that was the
   state of the <a href="browsers.html#nested-browsing-context">nested browsing context</a> in the <code><a href="#the-iframe-element">iframe</a></code> in A when page B was
   loaded.</p>

   <p>Generally speaking, dynamically removing or changing the <code data-anolis-xref="attr-iframe-sandbox"><a href="#attr-iframe-sandbox">sandbox</a></code> attribute is ill-advised, because it can make it quite
   hard to reason about what will be allowed and what will not.</p>

  </div>

  <hr><!-- DIM ATTRIBUTES --><p>The <code><a href="#the-iframe-element">iframe</a></code> element supports <a href="#dimension-attributes">dimension attributes</a> for cases where the
  embedded content has specific dimensions (e.g. ad units have well-defined dimensions).</p>

  <p>An <code><a href="#the-iframe-element">iframe</a></code> element never has <a href="dom.html#fallback-content">fallback content</a>, as it will always
  create a nested <a href="browsers.html#browsing-context">browsing context</a>, regardless of whether the specified initial
  contents are successfully used.</p>


  <hr><!-- FALLBACK --><p>Descendants of <code><a href="#the-iframe-element">iframe</a></code> elements represent nothing. (In legacy user agents that do
  not support <code><a href="#the-iframe-element">iframe</a></code> elements, the contents would be parsed as markup that could act as
  fallback content.)</p>

  <p id="iframe-content-model">When used in <a href="infrastructure.html#html-documents">HTML documents</a>, the allowed content model
  of <code><a href="#the-iframe-element">iframe</a></code> elements is text, except that invoking the <a href="syntax.html#html-fragment-parsing-algorithm">HTML fragment parsing
  algorithm</a> with the <code><a href="#the-iframe-element">iframe</a></code> element as the <var data-anolis-xref="concept-frag-parse-context"><a href="syntax.html#concept-frag-parse-context">context</a></var> element and the text contents as the <var data-anolis-xref="">input</var> must result in a list of nodes that are all <a href="dom.html#phrasing-content-1">phrasing content</a>,
  with no <a data-anolis-xref="parse error" href="syntax.html#parse-error">parse errors</a> having occurred, with no <code><a href="scripting-1.html#the-script-element">script</a></code>
  elements being anywhere in the list or as descendants of elements in the list, and with all the
  elements in the list (including their descendants) being themselves conforming.</p>

  <p>The <code><a href="#the-iframe-element">iframe</a></code> element must be empty in <a href="infrastructure.html#xml-documents">XML documents</a>.</p>

  <p class="note">The <a href="syntax.html#html-parser">HTML parser</a> treats markup inside <code><a href="#the-iframe-element">iframe</a></code> elements as
  text.</p>


  <div class="impl">

  <hr><!-- DOM --><p>The IDL attributes <dfn data-anolis-xref="dom-iframe-src" id="dom-iframe-src"><code>src</code></dfn>, <dfn data-anolis-xref="dom-iframe-srcdoc" id="dom-iframe-srcdoc"><code>srcdoc</code></dfn>, <dfn data-anolis-xref="dom-iframe-name" id="dom-iframe-name"><code>name</code></dfn>, and <dfn data-anolis-xref="dom-iframe-sandbox" id="dom-iframe-sandbox"><code>sandbox</code></dfn> must <a href="infrastructure.html#reflect">reflect</a> the respective
  content attributes of the same name.</p>

  <p>The <dfn data-anolis-xref="dom-iframe-contentDocument" id="dom-iframe-contentdocument"><code>contentDocument</code></dfn> IDL attribute
  must return the <code><a href="dom.html#document">Document</a></code> object of the <a href="browsers.html#active-document">active document</a> of the
  <code><a href="#the-iframe-element">iframe</a></code> element's <a href="browsers.html#nested-browsing-context">nested browsing context</a>, if any and if its
  <a href="browsers.html#effective-script-origin">effective script origin</a> is the <a href="browsers.html#same-origin">same origin</a> as the <a href="browsers.html#effective-script-origin">effective script
  origin</a> specified by the <a href="webappapis.html#incumbent-settings-object">incumbent settings object</a>, or null otherwise.</p>

  <p>The <dfn data-anolis-xref="dom-iframe-contentWindow" id="dom-iframe-contentwindow"><code>contentWindow</code></dfn> IDL attribute must
  return the <code><a href="browsers.html#windowproxy">WindowProxy</a></code> object of the <code><a href="#the-iframe-element">iframe</a></code> element's <a href="browsers.html#nested-browsing-context">nested
  browsing context</a>, if any, or null otherwise.</p>

  </div>

  <div class="example">

   <p>Here is an example of a page using an <code><a href="#the-iframe-element">iframe</a></code> to include advertising from an
   advertising broker:</p>

   <pre>&lt;iframe src="http://ads.example.com/?customerid=923513721&amp;amp;format=banner"
        width="468" height="60"&gt;&lt;/iframe&gt;</pre>

  </div>




  <h4 id="the-embed-element"><span class="secno">4.7.3 </span>The <dfn><code>embed</code></dfn> element</h4>

<!-- (v2?)
 we have all kinds of quirks we should define if they come up during
 testing, as e.g. shown in:
 http://mxr.mozilla.org/mozilla-central/source/layout/generic/nsObjectFrame.cpp
 http://trac.webkit.org/browser/trunk/WebCore/html/HTMLEmbedElement.cpp
 http://trac.webkit.org/browser/trunk/WebCore/rendering/RenderPartObject.cpp (updateWidget)
 e.g. - 240x200 default
      - the attributes/params are sent in a name-value pair list as follows (for Gecko):
         + attributes of the element, in source order
         + a synthesised 'src' attribute, if there was no 'src' but
           there was a 'data', with the value of the 'data' attribute
         + the params, in source order
        (WebKit does something different still)
      - the HIDDEN attribute (might be moot now)
-->

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd><a href="dom.html#flow-content-1">Flow content</a>.</dd>
   <dd><a href="dom.html#phrasing-content-1">Phrasing content</a>.</dd>
   <dd><a href="dom.html#embedded-content-2">Embedded content</a>.</dd>
   <dd><a href="dom.html#interactive-content-0">Interactive content</a>.</dd>
   <dd><a href="dom.html#palpable-content-0">Palpable content</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>Where <a href="dom.html#embedded-content-2">embedded content</a> is expected.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd>Empty.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
  <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-embed-src"><a href="#attr-embed-src">src</a></code> - Address of the resource</dd>
   <dd><code data-anolis-xref="attr-embed-type"><a href="#attr-embed-type">type</a></code> - Type of embedded resource</dd>
   <dd><code data-anolis-xref="attr-dim-width"><a href="#attr-dim-width">width</a></code> - Horizontal dimension</dd>
   <dd><code data-anolis-xref="attr-dim-height"><a href="#attr-dim-height">height</a></code>- Vertical dimension</dd>
   <dd>Any other attribute that has no namespace (see prose).</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">Tag omission in text/html</span>:</dt>
   <dd>No <a data-anolis-xref="syntax-end-tag" href="syntax.html#syntax-end-tag">end tag</a></dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd><a href="dom.html#index-aria-application"><code title="">application</code></a>, <a href="dom.html#index-aria-document">
   <code title="">document</code></a> or <a href="dom.html#index-aria-img"><code title="">img</code></a> or 
   <a href="dom.html#index-aria-presentation"><code title="">presentation</code></a>.</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">interface <dfn id="htmlembedelement">HTMLEmbedElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a data-anolis-xref="dom-embed-src" href="#dom-embed-src">src</a>;
           attribute DOMString <a data-anolis-xref="dom-embed-type" href="#dom-embed-type">type</a>;
           attribute DOMString <a data-anolis-xref="dom-dim-width" href="#dom-dim-width">width</a>;
           attribute DOMString <a data-anolis-xref="dom-dim-height" href="#dom-dim-height">height</a>;
  <a data-anolis-xref="dom-embed-caller" href="#dom-embed-caller">legacycaller</a> any (any... arguments);
};</pre>
    <div class="impl">
    <p>Depending on the type of content instantiated by the
    <code><a href="#the-embed-element">embed</a></code> element, the node may also support other
    interfaces.</p>
    </div>
   </dd>
  </dl><!--TOPIC:HTML--><p>The <code><a href="#the-embed-element">embed</a></code> element provides an integration point for an external (typically
  non-HTML) application or interactive content.</p>

  <p>The <dfn data-anolis-xref="attr-embed-src" id="attr-embed-src"><code>src</code></dfn> attribute gives the address of the
  resource being embedded. The attribute, if present, must contain a <a href="infrastructure.html#valid-non-empty-url-potentially-surrounded-by-spaces">valid non-empty URL
  potentially surrounded by spaces</a>.</p>

  <p>The <dfn data-anolis-xref="attr-embed-type" id="attr-embed-type"><code>type</code></dfn> attribute, if present, gives the
  <a href="infrastructure.html#mime-type">MIME type</a> by which the plugin to instantiate is selected. The value must be a
  <a href="infrastructure.html#valid-mime-type">valid MIME type</a>. If both the <code data-anolis-xref="attr-embed-type"><a href="#attr-embed-type">type</a></code> attribute and
  the <code data-anolis-xref="attr-embed-src"><a href="#attr-embed-src">src</a></code> attribute are present, then the <code data-anolis-xref="attr-embed-type"><a href="#attr-embed-type">type</a></code> attribute must specify the same type as the <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">explicit Content-Type metadata</a> of the resource given by the <code data-anolis-xref="attr-embed-src"><a href="#attr-embed-src">src</a></code> attribute.</p>

  <div class="impl">

  <p>When the element is created with neither a <code data-anolis-xref="attr-embed-src"><a href="#attr-embed-src">src</a></code> attribute
  nor a <code data-anolis-xref="attr-embed-type"><a href="#attr-embed-type">type</a></code> attribute, and when attributes are removed such
  that neither attribute is present on the element anymore, and when the element has a <a href="#media-element">media
  element</a> ancestor, and when the element has an ancestor <code><a href="#the-object-element">object</a></code> element that is
  <em>not</em> showing its <a href="dom.html#fallback-content">fallback content</a>, any <a href="infrastructure.html#plugin">plugin</a> instantiated for
  the element must be removed, and the <code><a href="#the-embed-element">embed</a></code> element then represents nothing.</p>

  <p>An <code><a href="#the-embed-element">embed</a></code> element is said to be <dfn data-anolis-xref="concept-embed-active" id="concept-embed-active">potentially
  active</dfn> when the following conditions are all met simultaneously:</p>

  <ul class="brief"><li>The element is <a data-anolis-xref="in a document" href="infrastructure.html#in-a-document">in a <code>Document</code></a> or was <a data-anolis-xref="in a document" href="infrastructure.html#in-a-document">in a <code>Document</code></a> the last time the <a href="webappapis.html#event-loop">event loop</a>
   reached step 1.</li>

   <li>The element's <code><a href="dom.html#document">Document</a></code> is <a href="browsers.html#fully-active">fully active</a>.</li>

   <li>The element has either a <code data-anolis-xref="attr-embed-src"><a href="#attr-embed-src">src</a></code> attribute set or a <code data-anolis-xref="attr-embed-type"><a href="#attr-embed-type">type</a></code> attribute set (or both).</li>

   <li>The element's <code data-anolis-xref="attr-embed-src"><a href="#attr-embed-src">src</a></code> attribute is either absent or its value
   is not the empty string.</li>

   <li>The element is not a descendant of a <a href="#media-element">media element</a>.</li>

   <li>The element is not a descendant of an <code><a href="#the-object-element">object</a></code> element that is not showing its
   <a href="dom.html#fallback-content">fallback content</a>.</li>

   <li>The element is <a href="rendering.html#being-rendered">being rendered</a>, or was <a href="rendering.html#being-rendered">being rendered</a> the last time
   the <a href="webappapis.html#event-loop">event loop</a> reached step 1.</li>

  </ul><p>Whenever an <code><a href="#the-embed-element">embed</a></code> element that was not <a data-anolis-xref="concept-embed-active" href="#concept-embed-active">potentially active</a> becomes <a data-anolis-xref="concept-embed-active" href="#concept-embed-active">potentially active</a>, and whenever a <a data-anolis-xref="concept-embed-active" href="#concept-embed-active">potentially active</a> <code><a href="#the-embed-element">embed</a></code> element that is
  remaining <a data-anolis-xref="concept-embed-active" href="#concept-embed-active">potentially active</a> and has its <code data-anolis-xref="attr-embed-type"><a href="#attr-embed-type">src</a></code> attribute set, changed, or removed or its <code data-anolis-xref="attr-embed-type"><a href="#attr-embed-type">type</a></code> attribute set, changed, or removed, the user agent must
  <a href="webappapis.html#queue-a-task">queue a task</a> using the <dfn id="embed-task-source">embed task source</dfn> to run <a href="#the-embed-element-setup-steps">the
  <code>embed</code> element setup steps</a>.</p>

  <p><dfn id="the-embed-element-setup-steps">The <code>embed</code> element setup steps</dfn> are as follows:</p>

  <ol><li><p>If another <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> has since been queued to run <a href="#the-embed-element-setup-steps">the
   <code>embed</code> element setup steps</a> for this element, then abort these steps.</li>

   <li>

    <dl class="switch"><dt>If the element has a <code data-anolis-xref="attr-embed-src"><a href="#attr-embed-src">src</a></code> attribute set</dt>

     <dd>

      <p>The user agent must <a data-anolis-xref="resolve a url" href="infrastructure.html#resolve-a-url">resolve</a> the value of the element's
      <code data-anolis-xref="attr-embed-src"><a href="#attr-embed-src">src</a></code> attribute, relative to the element. If that is
      successful, the user agent should <a href="infrastructure.html#fetch">fetch</a><!--FETCH--> the resulting <a href="infrastructure.html#absolute-url">absolute
      URL</a>, from the element's <a href="browsers.html#browsing-context-scope-origin">browsing context scope origin</a> if it has one<!--
      potentially http-origin privacy sensitive -->. The <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that
      is <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> by the <a href="webappapis.html#networking-task-source">networking task source</a> once
      the resource has been <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> must run the following steps:</p>
      <!-- Note that this doesn't happen when the base URL changes. -->

      <ol><li><p>If another <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> has since been queued to run
       <a href="#the-embed-element-setup-steps">the <code>embed</code> element setup steps</a> for this element, then abort these
       steps.</li>

       <li>

        <p>Determine the <dfn data-anolis-xref="concept-embed-type" id="concept-embed-type">type of the content</dfn> being embedded, as
        follows (stopping at the first substep that determines the type):</p>

        <ol><li><p>If the element has a <code data-anolis-xref="attr-embed-type"><a href="#attr-embed-type">type</a></code> attribute, and that
         attribute's value is a type that a <a href="infrastructure.html#plugin">plugin</a> supports, then the value of the
         <code data-anolis-xref="attr-embed-type"><a href="#attr-embed-type">type</a></code> attribute is the <a data-anolis-xref="concept-embed-type" href="#concept-embed-type">content's type</a>.</li>

         <li>

          <!-- if we get to this point we know we can successfully parsed the URL, since this algorithm is
          only used after fetching the resource in the steps above -->

          <p>Otherwise, if applying the <a href="infrastructure.html#url-parser-0">URL parser</a> algorithm to the <span>URL</span> of
          the specified resource (after any redirects) results in a <a href="infrastructure.html#parsed-url">parsed URL</a> whose
          <a data-anolis-xref="concept-url-path" href="infrastructure.html#concept-url-path">path</a> component matches a pattern that a
          <a href="infrastructure.html#plugin">plugin</a> supports, then the <a data-anolis-xref="concept-embed-type" href="#concept-embed-type">content's
          type</a> is the type that that plugin can handle.</p>

          <p class="example">For example, a plugin might say that it can handle resources with <a data-anolis-xref="concept-url-path" href="infrastructure.html#concept-url-path">path</a> components that end with the four character string
          "<code data-anolis-xref="">.swf</code>".</p>

          <!-- it's sad that we have to do extension sniffing. sigh. -->
          <!-- see also <object> which has a similar step -->

         </li>

         <li><p>Otherwise, if the specified resource has <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">explicit
         Content-Type metadata</a>, then that is the <a data-anolis-xref="concept-embed-type" href="#concept-embed-type">content's
         type</a>.</li>

         <li><p>Otherwise, the content has no <a data-anolis-xref="concept-embed-type" href="#concept-embed-type">type</a> and there
         can be no appropriate <a href="infrastructure.html#plugin">plugin</a> for it.</li>

         <!-- This algorithm is a monument to bad design. Go legacy! -->

        </ol></li>

       <li>

        <p>If the previous step determined that the <a data-anolis-xref="concept-embed-type" href="#concept-embed-type">content's
        type</a> is <code data-anolis-xref="">image/svg+xml</code>, then run the following substeps:</p>

        <ol><li><p>If the <code><a href="#the-embed-element">embed</a></code> element is not associated with a <a href="browsers.html#nested-browsing-context">nested browsing
         context</a>, associate the element with a newly created <a href="browsers.html#nested-browsing-context">nested browsing
         context</a>, and, if the element has a <code data-anolis-xref="attr-embed-name"><a href="obsolete.html#attr-embed-name">name</a></code>
         attribute, set the <a href="browsers.html#browsing-context-name">browsing context name</a> of the element's <a href="browsers.html#nested-browsing-context">nested
         browsing context</a> to the value of this attribute.</p>
         <!-- http://software.hixie.ch/utilities/js/live-dom-viewer/?saved=2291 - dynamic changes to 'name' don't do anything -->

         <li><p><a href="browsers.html#navigate">Navigate</a><!--DONAV embed--> the <a href="browsers.html#nested-browsing-context">nested browsing context</a> to
         the fetched resource, with <a href="browsers.html#replacement-enabled">replacement enabled</a>, and with the
         <code><a href="#the-embed-element">embed</a></code> element's document's <a href="browsers.html#browsing-context">browsing context</a> as the <a href="browsers.html#source-browsing-context">source
         browsing context</a>. (The <code data-anolis-xref="attr-embed-src"><a href="#attr-embed-src">src</a></code> attribute of the
         <code><a href="#the-embed-element">embed</a></code> element doesn't get updated if the browsing context gets further
         navigated to other locations.)</li>

         <li><p>The <code><a href="#the-embed-element">embed</a></code> element now <a href="dom.html#represents">represents</a> its associated
         <a href="browsers.html#nested-browsing-context">nested browsing context</a>.</li>

        </ol></li>

       <li>

        <p>Otherwise, find and instantiate an appropriate <a href="infrastructure.html#plugin">plugin</a> based on the <a data-anolis-xref="concept-embed-type" href="#concept-embed-type">content's type</a>, and hand that <a href="infrastructure.html#plugin">plugin</a> the
        content of the resource, replacing any previously instantiated plugin for the element. The
        <code><a href="#the-embed-element">embed</a></code> element now represents this <a href="infrastructure.html#plugin">plugin</a> instance.</p>

       </li>

      </ol><p>Whether the resource is fetched successfully or not (e.g. whether the response code was a
      2xx code <a data-anolis-xref="concept-http-equivalent-codes" href="infrastructure.html#concept-http-equivalent-codes">or equivalent</a>) must be ignored
      when determining the <a data-anolis-xref="concept-embed-type" href="#concept-embed-type">content's type</a> and when handing
      the resource to the plugin.</p>

      <p class="note">This allows servers to return data for plugins even with error responses (e.g.
      HTTP 500 Internal Server Error codes can still contain plugin data).</p>

      <p>Fetching the resource must <a href="syntax.html#delay-the-load-event">delay the load event</a> of the element's document.</p>
      <!-- if we add load/error events, then replace the previous paragraph with the text one: -->
      <!-- similar text in various places -->
      <!--<p>Fetching the resource must <span>delay the load event</span> of the element's document
      until the final <span data-x="concept-task">task</span> that is <span data-x="queue a
      task">queued</span> by the <span>networking task source</span> once the resource has been
      <span data-x="fetch">fetched</span> has been run.</p>-->

     </dd>

     <dt>If the element has no <code data-anolis-xref="attr-embed-src"><a href="#attr-embed-src">src</a></code> attribute set</dt>

     <dd>

      <p>The user agent should find and instantiate an appropriate <a href="infrastructure.html#plugin">plugin</a> based on the
      value of the <code data-anolis-xref="attr-embed-type"><a href="#attr-embed-type">type</a></code> attribute. The <code><a href="#the-embed-element">embed</a></code>
      element now represents this <a href="infrastructure.html#plugin">plugin</a> instance.</p>

     </dd>

    </dl></li>

  </ol><p>The <code><a href="#the-embed-element">embed</a></code> element has no <a href="dom.html#fallback-content">fallback content</a>. If the user agent can't
  find a suitable plugin when attempting to find and instantiate one for the algorithm above, then
  the user agent must use a default plugin. This default could be as simple as saying "Unsupported
  Format".</p>

  <p>Whenever an <code><a href="#the-embed-element">embed</a></code> element that was <a data-anolis-xref="concept-embed-active" href="#concept-embed-active">potentially
  active</a> stops being <a data-anolis-xref="concept-embed-active" href="#concept-embed-active">potentially active</a>, any
  <a href="infrastructure.html#plugin">plugin</a> that had been instantiated for that element must be unloaded.</p>

  <p id="sandboxPluginEmbed">When a <a href="infrastructure.html#plugin">plugin</a> is to be instantiated but it cannot be <a data-anolis-xref="concept-plugin-secure" href="infrastructure.html#concept-plugin-secure">secured</a> and the <a href="browsers.html#sandboxed-plugins-browsing-context-flag">sandboxed plugins browsing context
  flag</a> is set on the <code><a href="#the-embed-element">embed</a></code> element's <code><a href="dom.html#document">Document</a></code>'s <a href="browsers.html#active-sandboxing-flag-set">active
  sandboxing flag set</a>, then the user agent must not instantiate the <a href="infrastructure.html#plugin">plugin</a>, and
  must instead render the <code><a href="#the-embed-element">embed</a></code> element in a manner that conveys that the
  <a href="infrastructure.html#plugin">plugin</a> was disabled. The user agent may offer the user the option to override the
  sandbox and instantiate the <a href="infrastructure.html#plugin">plugin</a> anyway; if the user invokes such an option, the
  user agent must act as if the conditions above did not apply for the purposes of this element.</p>

  <p class="warning">Plugins that cannot be <a data-anolis-xref="concept-plugin-secure" href="infrastructure.html#concept-plugin-secure">secured</a> are
  disabled in sandboxed browsing contexts because they might not honor the restrictions imposed by
  the sandbox (e.g. they might allow scripting even when scripting in the sandbox is disabled). User
  agents should convey the danger of overriding the sandbox to the user if an option to do so is
  provided.</p>

  </div>

  <p>Any namespace-less attribute other than <code data-anolis-xref="attr-embed-name"><a href="obsolete.html#attr-embed-name">name</a></code>, <code data-anolis-xref="attr-embed-align"><a href="obsolete.html#attr-embed-align">align</a></code>, <code data-anolis-xref="attr-embed-hspace"><a href="obsolete.html#attr-embed-hspace">hspace</a></code>, and <code data-anolis-xref="attr-embed-vspace"><a href="obsolete.html#attr-embed-vspace">vspace</a></code> <!-- when editing, see also note below --> may be
  specified on the <code><a href="#the-embed-element">embed</a></code> element, so long as its name is <a href="infrastructure.html#xml-compatible">XML-compatible</a>
  and contains no <a href="infrastructure.html#uppercase-ascii-letters">uppercase ASCII letters</a>. These attributes are then passed as
  parameters to the <a href="infrastructure.html#plugin">plugin</a>.</p>

  <p class="note">All attributes in <a href="infrastructure.html#html-documents">HTML documents</a> get lowercased automatically, so the
  restriction on uppercase letters doesn't affect such documents.</p>

  <p class="note">The four exceptions are to exclude legacy attributes that have side-effects beyond
  just sending parameters to the <a href="infrastructure.html#plugin">plugin</a>.</p>

  <div class="impl">

  <p>The user agent should pass the names and values of all the attributes of the <code><a href="#the-embed-element">embed</a></code>
  element that have no namespace to the <a href="infrastructure.html#plugin">plugin</a> used, when one is instantiated.</p>

  <p>The <code><a href="#htmlembedelement">HTMLEmbedElement</a></code> object representing the element must expose the scriptable
  interface of the <a href="infrastructure.html#plugin">plugin</a> instantiated for the <code><a href="#the-embed-element">embed</a></code> element, if any. At a
  minimum, this interface must implement the <dfn data-anolis-xref="dom-embed-caller" id="dom-embed-caller">legacy caller
  operation</dfn>. (It is suggested that the default behavior of this legacy caller operation, e.g.
  the behavior of the default plugin's legacy caller operation, be to throw a
  <code><a href="infrastructure.html#notsupportederror">NotSupportedError</a></code> exception.)</p>

  </div>

  <p>The <code><a href="#the-embed-element">embed</a></code> element supports <a href="#dimension-attributes">dimension attributes</a>.</p>

  <div class="impl">

  <p>The IDL attributes <dfn data-anolis-xref="dom-embed-src" id="dom-embed-src"><code>src</code></dfn> and <dfn data-anolis-xref="dom-embed-type" id="dom-embed-type"><code>type</code></dfn> each must <a href="infrastructure.html#reflect">reflect</a> the respective
  content attributes of the same name.</p>

  </div>

  <div class="example">

   <p>Here's a way to embed a resource that requires a proprietary plugin, like Flash:</p>

   <pre>&lt;embed src="catgame.swf"&gt;</pre>

   <p>If the user does not have the plugin (for example if the plugin vendor doesn't support the
   user's platform), then the user will be unable to use the resource.</p>

   <p>To pass the plugin a parameter "quality" with the value "high", an attribute can be
   specified:</p>

   <pre>&lt;embed src="catgame.swf" quality="high"&gt;</pre>

   <p>This would be equivalent to the following, when using an <code><a href="#the-object-element">object</a></code> element
   instead:</p>

   <pre>&lt;object data="catgame.swf"&gt;
 &lt;param name="quality" value="high"&gt;
&lt;/object&gt;</pre>

  </div>




  <h4 id="the-object-element"><span class="secno">4.7.4 </span>The <dfn><code>object</code></dfn> element</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd><a href="dom.html#flow-content-1">Flow content</a>.</dd>
   <dd><a href="dom.html#phrasing-content-1">Phrasing content</a>.</dd>
   <dd><a href="dom.html#embedded-content-2">Embedded content</a>.</dd>
   <dd>If the element has a <code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> attribute: <a href="dom.html#interactive-content-0">Interactive content</a>.</dd> <!-- also when showing a plugin or a nested browsing context, but checking that statically is hard...) -->
   <dd><a data-anolis-xref="category-listed" href="forms.html#category-listed">Listed</a>, <a data-anolis-xref="category-submit" href="forms.html#category-submit">submittable</a>, and <a data-anolis-xref="category-form-attr" href="forms.html#category-form-attr">reassociateable</a> <a href="forms.html#form-associated-element">form-associated element</a>.</dd>
   <dd><a href="dom.html#palpable-content-0">Palpable content</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>Where <a href="dom.html#embedded-content-2">embedded content</a> is expected.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd>Zero or more <code><a href="#the-param-element">param</a></code> elements, then, <a href="dom.html#transparent">transparent</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
   <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> - Address of the resource</dd>
   <dd><code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> - Type of embedded resource</dd>
   <dd><code data-anolis-xref="attr-object-typemustmatch"><a href="#attr-object-typemustmatch">typemustmatch</a></code> - Whether the <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> 
   attribute and the <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">Content-Type</a> value need to match for the resource to be used</dd>
   <dd><code data-anolis-xref="attr-object-name"><a href="#attr-object-name">name</a></code> - Name of <a href="browsers.html#nested-browsing-context">nested browsing context</a></dd>
   <dd><code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> - Name of <a href="#image-map">image map</a> to use </dd>
   <dd><code data-anolis-xref="attr-fae-form"><a href="forms.html#attr-fae-form">form</a></code> - Associates the control with a <code><a href="forms.html#the-form-element">form</a></code> element</dd>
   <dd><code data-anolis-xref="attr-dim-width"><a href="#attr-dim-width">width</a></code> - Horizontal dimension</dd>
   <dd><code data-anolis-xref="attr-dim-height"><a href="#attr-dim-height">height</a></code> - Vertical dimension</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">Tag omission in text/html</span>:</dt>
   <dd>Neither tag is omissible.</dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd><a href="dom.html#index-aria-application"><code title="">application</code></a>, <a href="dom.html#index-aria-document">
   <code title="">document</code></a> or <a href="dom.html#index-aria-img"><code title="">img</code></a> or 
   <a href="dom.html#index-aria-presentation"><code title="">presentation</code></a>.</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dd>Any <code title="">aria-*</code> attributes 
   <a href="dom.html#allowed-aria-roles,-states-and-properties">applicable to the allowed roles</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">interface <dfn id="htmlobjectelement">HTMLObjectElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a data-anolis-xref="dom-object-data" href="#dom-object-data">data</a>;
           attribute DOMString <a data-anolis-xref="dom-object-type" href="#dom-object-type">type</a>;
           attribute boolean <a data-anolis-xref="dom-object-typeMustMatch" href="#dom-object-typemustmatch">typeMustMatch</a>;
           attribute DOMString <a data-anolis-xref="dom-object-name" href="#dom-object-name">name</a>;
           attribute DOMString <a data-anolis-xref="dom-object-useMap" href="#dom-object-usemap">useMap</a>;
  readonly attribute <a href="forms.html#htmlformelement">HTMLFormElement</a>? <a data-anolis-xref="dom-fae-form" href="forms.html#dom-fae-form">form</a>;
           attribute DOMString <a data-anolis-xref="dom-dim-width" href="#dom-dim-width">width</a>;
           attribute DOMString <a data-anolis-xref="dom-dim-height" href="#dom-dim-height">height</a>;
  readonly attribute <a href="dom.html#document">Document</a>? <a data-anolis-xref="dom-object-contentDocument" href="#dom-object-contentdocument">contentDocument</a>;
  readonly attribute <a href="browsers.html#windowproxy">WindowProxy</a>? <a data-anolis-xref="dom-object-contentWindow" href="#dom-object-contentwindow">contentWindow</a>;

  readonly attribute boolean <a data-anolis-xref="dom-cva-willValidate" href="forms.html#dom-cva-willvalidate">willValidate</a>;
  readonly attribute <a href="forms.html#validitystate">ValidityState</a> <a data-anolis-xref="dom-cva-validity" href="forms.html#dom-cva-validity">validity</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-cva-validationMessage" href="forms.html#dom-cva-validationmessage">validationMessage</a>;
  boolean <a data-anolis-xref="dom-cva-checkValidity" href="forms.html#dom-cva-checkvalidity">checkValidity</a>();
  void <a data-anolis-xref="dom-cva-setCustomValidity" href="forms.html#dom-cva-setcustomvalidity">setCustomValidity</a>(DOMString error);

  <a data-anolis-xref="dom-object-caller" href="#dom-object-caller">legacycaller</a> any (any... arguments);
};</pre>
    <div class="impl">
    <p>Depending on the type of content instantiated by the
    <code><a href="#the-object-element">object</a></code> element, the node also supports other
    interfaces.</p>
    </div>
   </dd>
  </dl><!--TOPIC:HTML--><p>The <code><a href="#the-object-element">object</a></code> element can represent an external resource, which, depending on the
  type of the resource, will either be treated as an image, as a <a href="browsers.html#nested-browsing-context">nested browsing
  context</a>, or as an external resource to be processed by a <a href="infrastructure.html#plugin">plugin</a>.</p>

  <p>The <dfn data-anolis-xref="attr-object-data" id="attr-object-data"><code>data</code></dfn> attribute, if present, specifies the
  address of the resource. If present, the attribute must be a <a href="infrastructure.html#valid-non-empty-url-potentially-surrounded-by-spaces">valid non-empty URL potentially
  surrounded by spaces</a>.</p>

  <p class="warning">Authors who reference resources from other <a data-anolis-xref="origin" href="browsers.html#origin-0">origins</a>
  that they do not trust are urged to use the <code data-anolis-xref="attr-object-typemustmatch"><a href="#attr-object-typemustmatch">typemustmatch</a></code> attribute defined below. Without that
  attribute, it is possible in certain cases for an attacker on the remote host to use the plugin
  mechanism to run arbitrary scripts, even if the author has used features such as the Flash
  "allowScriptAccess" parameter.</p> <!-- for example, if the user doesn't have flash installed but
  does have java installed, and the remote site unexpectedly returns java instead of flash, then
  java will run, and it will ignore the allowScriptAccess thing -->

  <p>The <dfn data-anolis-xref="attr-object-type" id="attr-object-type"><code>type</code></dfn> attribute, if present, specifies the
  type of the resource. If present, the attribute must be a <a href="infrastructure.html#valid-mime-type">valid MIME type</a>.</p>

  <p>At least one of either the <code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> attribute or the <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute must be present.</p>

  <p>The <dfn data-anolis-xref="attr-object-typemustmatch" id="attr-object-typemustmatch"><code>typemustmatch</code></dfn> attribute is a
  <a href="infrastructure.html#boolean-attribute">boolean attribute</a> whose presence indicates that the resource specified by the <code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> attribute is only to be used if the value of the <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute and the <a href="infrastructure.html#content-type">Content-Type</a> of the
  aforementioned resource match.</p>

  <p>The <code data-anolis-xref="attr-object-typemustmatch"><a href="#attr-object-typemustmatch">typemustmatch</a></code> attribute must not be
  specified unless both the <code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> attribute and the <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute are present.</p>

  <p>The <dfn data-anolis-xref="attr-object-name" id="attr-object-name"><code>name</code></dfn> attribute, if present, must be a
  <a href="browsers.html#valid-browsing-context-name">valid browsing context name</a>. The given value is used to name the <a href="browsers.html#nested-browsing-context">nested
  browsing context</a>, if applicable.</p>

  <div class="impl">

  <p>Whenever one of the following conditions occur:</p>

  <ul><li>the element is created,

   <li>the element is popped off the <a href="syntax.html#stack-of-open-elements">stack of open elements</a> of an <a href="syntax.html#html-parser">HTML
   parser</a> or <a href="the-xhtml-syntax.html#xml-parser">XML parser</a>,

   <li>the element is not on the <a href="syntax.html#stack-of-open-elements">stack of open elements</a> of an <a href="syntax.html#html-parser">HTML parser</a>
   or <a href="the-xhtml-syntax.html#xml-parser">XML parser</a>, and it is either <a data-anolis-xref="insert an element into a
   document" href="infrastructure.html#insert-an-element-into-a-document">inserted into a document</a> or <a data-anolis-xref="remove an element from a
   document" href="infrastructure.html#remove-an-element-from-a-document">removed from a document</a>,

   <li>the element's <code><a href="dom.html#document">Document</a></code> changes whether it is <a href="browsers.html#fully-active">fully active</a>,

   <li>one of the element's ancestor <code><a href="#the-object-element">object</a></code> elements changes to or from showing its
   <a href="dom.html#fallback-content">fallback content</a>,

   <li>the element's <code data-anolis-xref="attr-object-classid"><a href="obsolete.html#attr-object-classid">classid</a></code> attribute is set, changed, or removed,

   <li>the element's <code data-anolis-xref="attr-object-classid"><a href="obsolete.html#attr-object-classid">classid</a></code> attribute is not present, and
   its <code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> attribute is set, changed, or removed,

   <li>neither the element's <code data-anolis-xref="attr-object-classid"><a href="obsolete.html#attr-object-classid">classid</a></code> attribute nor its
   <code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> attribute are present, and its <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute is set, changed, or removed,

   <li>the element changes from <a href="rendering.html#being-rendered">being rendered</a> to not being rendered, or vice versa,

  </ul><!-- Changing the base URL doesn't trigger this. --><p>...the user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to run the following steps to (re)determine
  what the <code><a href="#the-object-element">object</a></code> element represents. The <a href="webappapis.html#task-source">task source</a> for this <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> is the <a href="webappapis.html#dom-manipulation-task-source">DOM manipulation task source</a>. This <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> being <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> or actively
  running must <a href="syntax.html#delay-the-load-event">delay the load event</a> of the element's document. <!--As described in the
  algorithm, once the algorithm starts fetching a resource, the fetch is what starts delaying the
  load event. But to tide us over from when the parser finds the <object> element and the fetching
  begins, we have to block the load event like this, lest the parse end before this task gets
  run.--></p>

  <ol><li>

    <p>If the user has indicated a preference that this <code><a href="#the-object-element">object</a></code> element's <a href="dom.html#fallback-content">fallback
    content</a> be shown instead of the element's usual behavior, then jump to the step below labeled <i>fallback</i>.</p>

    <p class="note">For example, a user could ask for the element's <a href="dom.html#fallback-content">fallback content</a> to
    be shown because that content uses a format that the user finds more accessible.</p>

   </li>

   <li>

    <p>If the element has an ancestor <a href="#media-element">media element</a>, or has an ancestor
    <code><a href="#the-object-element">object</a></code> element that is <em>not</em> showing its <a href="dom.html#fallback-content">fallback content</a>, or
    if the element is not <a data-anolis-xref="in a document" href="infrastructure.html#in-a-document">in a <code>Document</code></a> with a
    <a href="browsers.html#browsing-context">browsing context</a>, or if the element's <code><a href="dom.html#document">Document</a></code> is not <a href="browsers.html#fully-active">fully
    active</a>, or if the element is still in the <a href="syntax.html#stack-of-open-elements">stack of open elements</a> of an
    <a href="syntax.html#html-parser">HTML parser</a> or <a href="the-xhtml-syntax.html#xml-parser">XML parser</a>, or if the element is not <a href="rendering.html#being-rendered">being
    rendered</a>, then jump to the step below labeled <i>fallback</i>.</p>

   </li>

   <li>

    <!-- what if it's not in the document? if that should prevent plugin instantiation, then here
    just skip to the last step -->

    <p>If the <code data-anolis-xref="attr-object-classid"><a href="obsolete.html#attr-object-classid">classid</a></code> attribute is present, and has a value
    that isn't the empty string, then: if the user agent can find a <a href="infrastructure.html#plugin">plugin</a> suitable
    according to the value of the <code data-anolis-xref="attr-object-classid"><a href="obsolete.html#attr-object-classid">classid</a></code> attribute, and
    either <a href="#sandboxPluginObject">plugins aren't being sandboxed</a> or that
    <a href="infrastructure.html#plugin">plugin</a> can be <a data-anolis-xref="concept-plugin-secure" href="infrastructure.html#concept-plugin-secure">secured</a>, then that
    <a href="infrastructure.html#plugin">plugin</a> <a href="#object-plugin">should be used</a>, and the value of the <code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> attribute, if any, should be passed to the
    <a href="infrastructure.html#plugin">plugin</a>. If no suitable <a href="infrastructure.html#plugin">plugin</a> can be found, or if the
    <a href="infrastructure.html#plugin">plugin</a> reports an error, jump to the step below labeled <i>fallback</i>.</p>

    <!--
     case insensitive:
      is "clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" -> application/x-shockwave-flash
      is "clsid:cfcdaa03-8be4-11cf-b84b-0020afbbccfa" -> audio/x-pn-realaudio-plugin
      is "clsid:02bf25d5-8c17-4b23-bc80-d3488abddc6b" -> video/quicktime
      is "clsid:166b1bca-3f9c-11cf-8075-444553540000" -> application/x-director
      is "clsid:6bf52a52-394a-11d3-b153-00c04f79faa6" -> application/x-mplayer2
      starts with "java:"                             -> application/x-java-vm
      starts with "clsid:"                            -> application/x-oleobject
    -->

   </li>

   <!-- (v2?)
   we may have to define magic fallback to <param> if it turns out to
   be needed in testing:
   <hyatt> apparently your url can come from <param>
   <hyatt> not just the data attribute
   <hyatt> our code looks for params with "src", "movie", "code" and "url"
   <hyatt> and also tries to find the type on a param
   <Hixie> oh that's you trying to have hacky activex support
   <Hixie> opera does that too
   <hyatt> yeah we support activex versions of plugins that are common
   <hyatt> like flash and quicktime and realaudio
   <Hixie> that would be a step 1b. if no data attribute, then look for a <param> to get you a URL instead.
   <Hixie> and if you find one, carry on as if that was your data="".
   -->

   <li><p>If the <code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> attribute is present and its value is
   not the empty string, then:</p>

    <ol><li><p>If the <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute is present and its value is
     not a type that the user agent supports, and is not a type that the user agent can find a
     <a href="infrastructure.html#plugin">plugin</a> for, then the user agent may jump to the step below labeled <i>fallback</i>
     without fetching the content to examine its real type.</li>

     <li><p><a data-anolis-xref="resolve a url" href="infrastructure.html#resolve-a-url">Resolve</a> the <span>URL</span> specified by the <code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> attribute, relative to the element.</li>

     <li><p>If that failed, <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-error">error</code> at the element, then jump to the step below labeled
     <i>fallback</i>.</li>

     <li>

      <p><a href="infrastructure.html#fetch">Fetch</a><!--FETCH--> the resulting <a href="infrastructure.html#absolute-url">absolute URL</a>, from the element's
      <a href="browsers.html#browsing-context-scope-origin">browsing context scope origin</a> if it has one<!-- potentially http-origin privacy
      sensitive -->.</p>

      <!-- similar text in various places -->
      <p>Fetching the resource must <a href="syntax.html#delay-the-load-event">delay the load event</a> of the element's document
      until the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that is <a data-anolis-xref="queue a
      task" href="webappapis.html#queue-a-task">queued</a> by the <a href="webappapis.html#networking-task-source">networking task source</a> once the resource has been
      <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> (defined next) has been run.</p>

      <p>For the purposes of the <a href="browsers.html#application-cache">application cache</a> networking model, this
      <a href="infrastructure.html#fetch">fetch</a> operation is not for a <a href="browsers.html#child-browsing-context">child browsing context</a> (though it might
      end up being used for one after all, as defined below).</p>

     </li>

     <li><p>If the resource is not yet available (e.g. because the resource was not available in the
     cache, so that loading the resource required making a request over the network), then jump to
     the step below labeled <i>fallback</i>. The <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that is
     <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> by the <a href="webappapis.html#networking-task-source">networking task source</a> once the
     resource is available must restart this algorithm from this step. Resources can load
     incrementally; user agents may opt to consider a resource "available" whenever enough data has
     been obtained to begin processing the resource.</li>

     <li><p>If the load failed (e.g. there was an HTTP 404 error, there was a DNS error), <a href="webappapis.html#fire-a-simple-event">fire
     a simple event</a> named <code data-anolis-xref="event-error">error</code> at the element, then jump to
     the step below labeled <i>fallback</i>.</li>

     <li id="object-type-detection">

      <p>Determine the <var data-anolis-xref="">resource type</var>, as follows:</p>

<!-- Hopefully this step is exactly equivalent to the following:

 START
   |
   V
 Is there a Content-Type and is the UA going to obey it blindly?
   |                   |
   | YES               | NO
   |                   V                                                          YES
   |                 Is there a type="" attribute whose value is a plugin type? ============================================-.
   |                   |                                                                                                     |
   |                   | NO                                                                                                  |
   |                   V                        NO                                       YES                                 |
   |                 Is there a Content type? ========-> Is there a type="" attribute? ==========> Let TYPE be type=""       |
   |                   |                                                           |               attribute value           |
   |                   | YES                                                       | NO                    |                 |
   V            NO     V                                                           |                       V                 |
   +-<============== Is it text/plain or application/octet-stream?                 `==> Let TYPE be  =====>+                 |
   |                   |                                     |                          Sniffed type       |                 |
   |                   | text/plain                          | octet-stream                                V                 |
   |                   V                              YES    V                                          Is TYPE              |
   |                 Does the page sniff as binary? ======> Is there a type="" attribute?       application/octet-stream?    |
   |                   |                                     |              |                      |                |        |
   |                   | NO                                  | YES          | NO                   | YES            | NO     |
   |                   |                                     |       YES    V                      V                |        |
   |                   |                  application/octet-stream? =====> Extension that is plugin type?           |        |
   |                   |                                     |                          |          |                |        |
   |                   |                                     | NO                       | NO       | YES            |        |
   |                   |                                     V                          |          |                |        |
   |                   |                           Type attribute is XML or     YES     V          |                |        |
   |                   |                           doesn't start with image/* ======> FALLBACK     |                |        |
   |                   |                           and is not a plugin type?                       |                |        |
   |                   |                                          |                                |                |        |
   |                   |                                          | NO                             |                |        V
   V                   V                                          V                                V                V       Use
  Use                 Use                                        Use it (will be                  Use              Use      type=""
  Content-Type        text/plain                                 bitmap or plugin)                extension        TYPE     attribute
   |                   |                                          |                                |                |        |
   |                   V                                          V                                V                V        |
   `================->-+========================================>-+==============>-+-<============-+-<==============+-<======'
                                                                                   |
                                                                                   V
                                                                  Continue following rules in the spec, which might
                                                                  result in a plugin, a browsing context, an image,
                                                                  or using fallback, depending on the UA and the type.


   "Extension that is plugin type?" means "Is there an extension that matches one that a plugin supports?".
   Plugins are not allowed to register text/plain or application/octet-stream.

-->

      <ol><li>

        <p>Let the <var data-anolis-xref="">resource type</var> be unknown.</p>

       </li>

       <li>

        <p>If the <code><a href="#the-object-element">object</a></code> element has a <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code>
        attribute and a <code data-anolis-xref="attr-object-typemustmatch"><a href="#attr-object-typemustmatch">typemustmatch</a></code> attribute, and
        the resource has <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">associated Content-Type metadata</a>, and the
        type specified in <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">the resource's Content-Type metadata</a> is
        an <a href="infrastructure.html#ascii-case-insensitive">ASCII case-insensitive</a> match for the value of the element's <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute, then let <var data-anolis-xref="">resource type</var>
        be that type and jump to the step below labeled <i>handler</i>.</p>

        <!-- do we need to <span>strip leading and trailing whitespace</span> from anything here?
        collapse sequences of spaces? drop parameters? -->

       </li>

       <li>

        <p>If the <code><a href="#the-object-element">object</a></code> element has a <code data-anolis-xref="attr-object-typemustmatch"><a href="#attr-object-typemustmatch">typemustmatch</a></code> attribute, jump to the step below
        labeled <i>handler</i>.</p>

       </li>

       <li>

        <!-- by request: http://www.w3.org/Bugs/Public/show_bug.cgi?id=8479 -->

        <p>If the user agent is configured to strictly obey Content-Type headers for this resource,
        and the resource has <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">associated Content-Type metadata</a>,
        then let the <var data-anolis-xref="">resource type</var> be the type specified in <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">the resource's Content-Type metadata</a>, and jump to the step below
        labeled <i>handler</i>.</p>

        <p class="warning">This can introduce a vulnerability, wherein a site is trying to embed a
        resource that uses a particular plugin, but the remote site overrides that and instead
        furnishes the user agent with a resource that triggers a different plugin with different
        security characteristics. <!-- e.g. the example given above, where the site is expecting
        Flash with allowScriptAccess=never, and instead gets back Java with its unrestricted DOM
        access --></p>

       </li>

       <li>

        <p>If there is a <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute present on the
        <code><a href="#the-object-element">object</a></code> element, and that attribute's value is not a type that the user agent
        supports, but it <em>is</em> a type that a <a href="infrastructure.html#plugin">plugin</a> supports, then let the <var data-anolis-xref="">resource type</var> be the type specified in that <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute, and jump to the step below labeled
        <i>handler</i>.</p>

       </li>

       <li>

        <p>Run the appropriate set of steps from the following
        list:</p>

        <dl class="switch"><dt>If the resource has <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">associated Content-Type
         metadata</a></dt>

         <dd>

          <ol><li>

            <p>Let <var data-anolis-xref="">binary</var> be false.</p>

           </li>

           <li>

            <p>If the type specified in <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">the resource's Content-Type
            metadata</a> is "<code>text/plain</code>", and the result of applying the <a data-anolis-xref="Content-Type sniffing: text or binary" href="infrastructure.html#content-type-sniffing:-text-or-binary">rules for distinguishing if a resource is
            text or binary</a> to the resource is that the resource is not
            <code>text/plain</code>, then set <var data-anolis-xref="">binary</var> to true.</p>

           </li>

           <li>

            <p>If the type specified in <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">the resource's Content-Type
            metadata</a> is "<code>application/octet-stream</code>", then set <var data-anolis-xref="">binary</var> to true.</p>

           </li>

           <li>

            <p>If <var data-anolis-xref="">binary</var> is false, then let the <var data-anolis-xref="">resource
            type</var> be the type specified in <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">the resource's
            Content-Type metadata</a>, and jump to the step below labeled <i>handler</i>.</p>

           </li>

           <li>

            <p>If there is a <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute present on the
            <code><a href="#the-object-element">object</a></code> element, and its value is not <code>application/octet-stream</code>,
            then run the following steps:</p>

            <ol><li>

              <p>If the attribute's value is a type that a <a href="infrastructure.html#plugin">plugin</a> supports, or the
              attribute's value is a type that starts with "<code>image/</code>" that is not also an
              <a href="infrastructure.html#xml-mime-type">XML MIME type</a>, then let the <var data-anolis-xref="">resource type</var> be the type
              specified in that <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute.</p>

             </li>

             <li>

              <p>Jump to the step below labeled <i>handler</i>.</p>

             </li>

            </ol></li>

          </ol></dd>

         <dt>Otherwise, if the resource does not have <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">associated
         Content-Type metadata</a></dt>

         <dd>

          <ol><li>

            <p>If there is a <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute present on the
            <code><a href="#the-object-element">object</a></code> element, then let the <var data-anolis-xref="">tentative type</var> be the type
            specified in that <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute.</p>

            <p>Otherwise, let <var data-anolis-xref="">tentative type</var> be the <a data-anolis-xref="content-type
            sniffing" href="infrastructure.html#content-type-sniffing-0">sniffed type of the resource</a>.</p>

           </li>

           <li>

            <p>If <var data-anolis-xref="">tentative type</var> is <em>not</em>
            <code>application/octet-stream</code>, then let <var data-anolis-xref="">resource type</var> be
            <var data-anolis-xref="">tentative type</var> and jump to the step below labeled
            <i>handler</i>.</p>

           </li>

          </ol></dd>

        </dl></li>

       <li>

        <!-- if we get to this point we know we can successfully parsed the URL, since this
        algorithm is only used after fetching the resource in the steps above -->

        <p>If applying the <a href="infrastructure.html#url-parser-0">URL parser</a> algorithm to the <span>URL</span> of the
        specified resource (after any redirects) results in a <a href="infrastructure.html#parsed-url">parsed URL</a> whose <a data-anolis-xref="concept-url-path" href="infrastructure.html#concept-url-path">path</a> component matches a pattern that a <a href="infrastructure.html#plugin">plugin</a>
        supports, then let <var data-anolis-xref="">resource type</var> be the type that that plugin can
        handle.</p>

        <p class="example">For example, a plugin might say that it can handle resources with <a data-anolis-xref="concept-url-path" href="infrastructure.html#concept-url-path">path</a> components that end with the four character string
        "<code data-anolis-xref="">.swf</code>".</p>

        <!-- it's sad that we have to do extension sniffing. sigh. -->
        <!-- see also <embed> which has a similar step -->

       </li>

      </ol><p class="note">It is possible for this step to finish, or for one of the substeps above to
      jump straight to the next step, with <var data-anolis-xref="">resource type</var> still being unknown. In
      both cases, the next step will trigger fallback.</p>

     </li>

     <li><p><i>Handler</i>: Handle the content as given by the first of the following cases that
     matches:</p>

      <dl class="switch"><dt>If the <var data-anolis-xref="">resource type</var> is not a type that the user agent supports, but
       it <em>is</em> a type that a <a href="infrastructure.html#plugin">plugin</a> supports</dt>

       <dd>

        <p>If <a href="#sandboxPluginObject">plugins are being sandboxed</a> and the plugin that
        supports <var data-anolis-xref="">resource type</var> cannot be <a data-anolis-xref="concept-plugin-secure" href="infrastructure.html#concept-plugin-secure">secured</a>, jump to the step below labeled <i>fallback</i>.</p>

        <p>Otherwise, the user agent should <a href="#object-plugin">use the plugin that supports
        <var data-anolis-xref="">resource type</var></a> and pass the content of the resource to that
        <a href="infrastructure.html#plugin">plugin</a>. If the <a href="infrastructure.html#plugin">plugin</a> reports an error, then jump to the step
        below labeled <i>fallback</i>.</p>

       </dd>


       <dt>If the <var data-anolis-xref="">resource type</var> is an <a href="infrastructure.html#xml-mime-type">XML MIME type</a>, or
       <!-- (redundant with the next one) if the <var data-x="">resource type</var> is HTML, or -->
       if the <var data-anolis-xref="">resource type</var> does not start with "<code>image/</code>"</dt>

       <dd>

        <p>The <code><a href="#the-object-element">object</a></code> element must be associated with a newly created <a href="browsers.html#nested-browsing-context">nested
        browsing context</a>, if it does not already have one.</p>

        <p>If the <span>URL</span> of the given resource is not <code><a href="infrastructure.html#about:blank">about:blank</a></code>, the
        element's <a href="browsers.html#nested-browsing-context">nested browsing context</a> must then be <a data-anolis-xref="navigate" href="browsers.html#navigate">navigated</a><!--DONAV object--> to that resource, with
        <a href="browsers.html#replacement-enabled">replacement enabled</a>, and with the <code><a href="#the-object-element">object</a></code> element's document's
        <a href="browsers.html#browsing-context">browsing context</a> as the <a href="browsers.html#source-browsing-context">source browsing context</a>. (The <code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> attribute of the <code><a href="#the-object-element">object</a></code> element doesn't
        get updated if the browsing context gets further navigated to other locations.)</p>

        <p>If the <span>URL</span> of the given resource <em>is</em> <code><a href="infrastructure.html#about:blank">about:blank</a></code>, then,
        instead, the user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a>
        named <code data-anolis-xref="event-load">load</code> at the <code><a href="#the-object-element">object</a></code> element. <span class="note">No <code data-anolis-xref="event-load">load</code> event is fired at the
        <code><a href="infrastructure.html#about:blank">about:blank</a></code> document itself.</span></p>

        <p>The <code><a href="#the-object-element">object</a></code> element <a href="dom.html#represents">represents</a> the <a href="browsers.html#nested-browsing-context">nested browsing
        context</a>.</p>

        <p>If the <code data-anolis-xref="attr-object-name"><a href="#attr-object-name">name</a></code> attribute is present, the
        <a href="browsers.html#browsing-context-name">browsing context name</a> must be set to the value of this attribute; otherwise,
        the <a href="browsers.html#browsing-context-name">browsing context name</a> must be set to the empty string.</p>

        <p class="note">In certain situations, e.g. if the resource was <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a> from an <a href="browsers.html#application-cache">application cache</a> but it is an HTML file
        with a <code data-anolis-xref="attr-html-manifest"><a href="semantics.html#attr-html-manifest">manifest</a></code> attribute that points to a different
        <a data-anolis-xref="concept-appcache-manifest" href="browsers.html#concept-appcache-manifest">application cache manifest</a>, the <a data-anolis-xref="navigate" href="browsers.html#navigate">navigation</a> of the <a href="browsers.html#browsing-context">browsing context</a> will be restarted so
        as to load the resource afresh from the network or a different <a href="browsers.html#application-cache">application
        cache</a>. Even if the resource is then found to have a different type, it is still used
        as part of a <a href="browsers.html#nested-browsing-context">nested browsing context</a>: only the <a href="browsers.html#navigate">navigate</a> algorithm
        is restarted, not this <code><a href="#the-object-element">object</a></code> algorithm.</p>

        <!-- note that malformed XML files don't cause fallback -->

       </dd>


       <dt>If the <var data-anolis-xref="">resource type</var> starts with "<code>image/</code>", and support
       for images has not been disabled</dt>

       <dd>

        <p>Apply the <a data-anolis-xref="content-type sniffing: image" href="infrastructure.html#content-type-sniffing:-image">image sniffing</a> rules to
        determine the type of the image.</p>

        <p>The <code><a href="#the-object-element">object</a></code> element <a href="dom.html#represents">represents</a> the specified image. The image is
        not a <a href="browsers.html#nested-browsing-context">nested browsing context</a>.</p>

        <p>If the image cannot be rendered, e.g. because it is malformed or in an unsupported
        format, jump to the step below labeled <i>fallback</i>.</p>

       </dd>


       <dt>Otherwise</dt>

       <dd>

        <p>The given <var data-anolis-xref="">resource type</var> is not supported. Jump to the step below
        labeled <i>fallback</i>.</p>

        <p class="note">If the previous step ended with the <var data-anolis-xref="">resource type</var> being
        unknown, this is the case that is triggered.</p>

       </dd>

      </dl></li>

     <li><p>The element's contents are not part of what the <code><a href="#the-object-element">object</a></code> element
     represents.</p>

     <li>

      <p>Once the resource is completely loaded, <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
      event</a> named <code data-anolis-xref="event-load">load</code> at the element.</p>

      <p>The <a href="webappapis.html#task-source">task source</a> for this task<!--tasks mentioned in this section--> is the
      <a href="webappapis.html#dom-manipulation-task-source">DOM manipulation task source</a>.</p>

     </li>

    </ol></li>

   <li><p>If the <code data-anolis-xref="attr-object-data"><a href="#attr-object-data">data</a></code> attribute is absent but the <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute is present, and the user agent can find a
   <a href="infrastructure.html#plugin">plugin</a> suitable according to the value of the <code data-anolis-xref="attr-object-type"><a href="#attr-object-type">type</a></code> attribute, and either <a href="#sandboxPluginObject">plugins
   aren't being sandboxed</a> or the <a href="infrastructure.html#plugin">plugin</a> can be <a data-anolis-xref="concept-plugin-secure" href="infrastructure.html#concept-plugin-secure">secured</a>, then that <a href="infrastructure.html#plugin">plugin</a> <a href="#object-plugin">should be used</a>. If these conditions cannot be met, or if the
   <a href="infrastructure.html#plugin">plugin</a> reports an error, jump to the step below labeled <i>fallback</i>.</li>

   <li><p><i>Fallback</i>: The <code><a href="#the-object-element">object</a></code> element <a href="dom.html#represents">represents</a> the element's
   children, ignoring any leading <code><a href="#the-param-element">param</a></code> element children. This is the element's
   <a href="dom.html#fallback-content">fallback content</a>. If the element has an instantiated <a href="infrastructure.html#plugin">plugin</a>, then
   unload it.</li>

  </ol><p id="object-plugin">When the algorithm above instantiates a <a href="infrastructure.html#plugin">plugin</a>, the user agent
  should pass to the <a href="infrastructure.html#plugin">plugin</a> used the names and values of all the attributes on the
  element, in the order they were added to the element, with the attributes added by the parser
  being ordered in source order, followed by a parameter named "PARAM" whose value is null, followed
  by all the names and values of <a data-anolis-xref="concept-param-parameter" href="#concept-param-parameter">parameters</a> given by
  <code><a href="#the-param-element">param</a></code> elements that are children of the <code><a href="#the-object-element">object</a></code> element, in <a href="infrastructure.html#tree-order">tree
  order</a>. If the <a href="infrastructure.html#plugin">plugin</a> supports a scriptable interface, the
  <code><a href="#htmlobjectelement">HTMLObjectElement</a></code> object representing the element should expose that interface. The
  <code><a href="#the-object-element">object</a></code> element <a href="dom.html#represents">represents</a> the <a href="infrastructure.html#plugin">plugin</a>. The
  <a href="infrastructure.html#plugin">plugin</a> is not a nested <a href="browsers.html#browsing-context">browsing context</a>.</p>

  <p id="sandboxPluginObject">Plugins are considered sandboxed for the purpose of an
  <code><a href="#the-object-element">object</a></code> element if the <a href="browsers.html#sandboxed-plugins-browsing-context-flag">sandboxed plugins browsing context flag</a> is set on
  the <code><a href="#the-object-element">object</a></code> element's <code><a href="dom.html#document">Document</a></code>'s <a href="browsers.html#active-sandboxing-flag-set">active sandboxing flag
  set</a>.</p>

  <p>Due to the algorithm above, the contents of <code><a href="#the-object-element">object</a></code> elements act as <a href="dom.html#fallback-content">fallback
  content</a>, used only when referenced resources can't be shown (e.g. because it returned a 404
  error). This allows multiple <code><a href="#the-object-element">object</a></code> elements to be nested inside each other,
  targeting multiple user agents with different capabilities, with the user agent picking the first
  one it supports.</p>

  <p>Whenever the <code data-anolis-xref="attr-object-name"><a href="#attr-object-name">name</a></code> attribute is set, if the
  <code><a href="#the-object-element">object</a></code> element has a nested <a href="browsers.html#browsing-context">browsing context</a>, its <a data-anolis-xref="browsing
  context name" href="browsers.html#browsing-context-name">name</a> must be changed to the new value. If the attribute is removed, if the
  <code><a href="#the-object-element">object</a></code> element has a <a href="browsers.html#browsing-context">browsing context</a>, the <a href="browsers.html#browsing-context-name">browsing context
  name</a> must be set to the empty string.</p>

  </div>

  <p>The <code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> attribute, if present while the
  <code><a href="#the-object-element">object</a></code> element represents an image, can indicate that the object has an associated
  <a href="#image-map">image map</a>. <span class="impl">The attribute must be ignored if the
  <code><a href="#the-object-element">object</a></code> element doesn't represent an image.</span></p>

  <p>The <code data-anolis-xref="attr-fae-form"><a href="forms.html#attr-fae-form">form</a></code> attribute is used to explicitly associate the
  <code><a href="#the-object-element">object</a></code> element with its <a href="forms.html#form-owner">form owner</a>.</p>

  <div class="impl">

  <p><strong>Constraint validation</strong>: <code><a href="#the-object-element">object</a></code> elements are always <a href="forms.html#barred-from-constraint-validation">barred
  from constraint validation</a>.</p>

  </div>

  <p>The <code><a href="#the-object-element">object</a></code> element supports <a href="#dimension-attributes">dimension attributes</a>.</p>

  <div class="impl">

  <p>The IDL attributes <dfn data-anolis-xref="dom-object-data" id="dom-object-data"><code>data</code></dfn>, <dfn data-anolis-xref="dom-object-type" id="dom-object-type"><code>type</code></dfn> and <dfn data-anolis-xref="dom-object-name" id="dom-object-name"><code>name</code></dfn> each must <a href="infrastructure.html#reflect">reflect</a> the respective
  content attributes of the same name. The <dfn data-anolis-xref="dom-object-typeMustMatch" id="dom-object-typemustmatch"><code>typeMustMatch</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-object-typemustmatch"><a href="#attr-object-typemustmatch">typemustmatch</a></code> content
  attribute. The <dfn data-anolis-xref="dom-object-useMap" id="dom-object-usemap"><code>useMap</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> content attribute.</p>

  <p>The <dfn data-anolis-xref="dom-object-contentDocument" id="dom-object-contentdocument"><code>contentDocument</code></dfn> IDL attribute
  must return the <code><a href="dom.html#document">Document</a></code> object of the <a href="browsers.html#active-document">active document</a> of the
  <code><a href="#the-object-element">object</a></code> element's <a href="browsers.html#nested-browsing-context">nested browsing context</a>, if any and if its
  <a href="browsers.html#effective-script-origin">effective script origin</a> is the <a href="browsers.html#same-origin">same origin</a> as the <a href="browsers.html#effective-script-origin">effective script
  origin</a> specified by the <a href="webappapis.html#incumbent-settings-object">incumbent settings object</a>, or null otherwise.</p>

  <p>The <dfn data-anolis-xref="dom-object-contentWindow" id="dom-object-contentwindow"><code>contentWindow</code></dfn> IDL attribute must
  return the <code><a href="browsers.html#windowproxy">WindowProxy</a></code> object of the <code><a href="#the-object-element">object</a></code> element's <a href="browsers.html#nested-browsing-context">nested
  browsing context</a>, if it has one; otherwise, it must return null.</p>

  <p>The <code data-anolis-xref="dom-cva-willValidate"><a href="forms.html#dom-cva-willvalidate">willValidate</a></code>, <code data-anolis-xref="dom-cva-validity"><a href="forms.html#dom-cva-validity">validity</a></code>, and <code data-anolis-xref="dom-cva-validationMessage"><a href="forms.html#dom-cva-validationmessage">validationMessage</a></code> attributes, and the <code data-anolis-xref="dom-cva-checkValidity"><a href="forms.html#dom-cva-checkvalidity">checkValidity()</a></code>, and <code data-anolis-xref="dom-cva-setCustomValidity"><a href="forms.html#dom-cva-setcustomvalidity">setCustomValidity()</a></code> methods, are part of the
  <a href="forms.html#the-constraint-validation-api">constraint validation API</a>. The <code data-anolis-xref="dom-fae-form"><a href="forms.html#dom-fae-form">form</a></code> IDL attribute
  is part of the element's forms API.</p>

  <p>All <code><a href="#the-object-element">object</a></code> elements have a <dfn data-anolis-xref="dom-object-caller" id="dom-object-caller">legacy caller
  operation</dfn>. If the <code><a href="#the-object-element">object</a></code> element has an instantiated <a href="infrastructure.html#plugin">plugin</a> that
  supports a scriptable interface that defines a legacy caller operation, then that must be the
  behavior of the object's legacy caller operation. Otherwise, the object's legacy caller operation
  must be to throw a <code><a href="infrastructure.html#notsupportederror">NotSupportedError</a></code> exception.</p>

  </div>

  <div class="example">

   <p>In the following example, a Java applet is embedded in a page using the <code><a href="#the-object-element">object</a></code>
   element. (Generally speaking, it is better to avoid using applets like these and instead use
   native JavaScript and HTML to provide the functionality, since that way the application will work
   on all Web browsers without requiring a third-party plugin. Many devices, especially embedded
   devices, do not support third-party technologies like Java.)</p>

   <pre>&lt;figure&gt;
 &lt;object type="application/x-java-applet"&gt;
  &lt;param name="code" value="MyJavaClass"&gt;
  &lt;p&gt;You do not have Java available, or it is disabled.&lt;/p&gt;
 &lt;/object&gt;
 &lt;figcaption&gt;My Java Clock&lt;/figcaption&gt;
&lt;/figure&gt;</pre>

  </div>

  <div class="example">

   <p>In this example, an HTML page is embedded in another using the <code><a href="#the-object-element">object</a></code>
   element.</p>

   <pre>&lt;figure&gt;
 &lt;object data="clock.html"&gt;&lt;/object&gt;
 &lt;figcaption&gt;My HTML Clock&lt;/figcaption&gt;
&lt;/figure&gt;</pre>

  </div>

  <div class="example">

   <p>The following example shows how a plugin can be used in HTML (in this case the Flash plugin,
   to show a video file). Fallback is provided for users who do not have Flash enabled, in this case
   using the <code><a href="#the-video-element">video</a></code> element to show the video for those using user agents that support
   <code><a href="#the-video-element">video</a></code>, and finally providing a link to the video for those who have neither Flash
   nor a <code><a href="#the-video-element">video</a></code>-capable browser.</p>

   <pre>&lt;p&gt;Look at my video:
 &lt;object type="application/x-shockwave-flash"&gt;
  &lt;param name=movie value="http://video.example.com/library/watch.swf"&gt;
  &lt;param name=allowfullscreen value=true&gt;
  &lt;param name=flashvars value="http://video.example.com/vids/315981"&gt;
  &lt;video controls src="http://video.example.com/vids/315981"&gt;
   &lt;a href="http://video.example.com/vids/315981"&gt;View video&lt;/a&gt;.
  &lt;/video&gt;
 &lt;/object&gt;
&lt;/p&gt;</pre>

  </div>



  <h4 id="the-param-element"><span class="secno">4.7.5 </span>The <dfn><code>param</code></dfn> element</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd>None.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>As a child of an <code><a href="#the-object-element">object</a></code> element, before any <a href="dom.html#flow-content-1">flow content</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd>Empty.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
   <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-param-name"><a href="#attr-param-name">name</a></code> - Name of parameter</dd>
   <dd><code data-anolis-xref="attr-param-value"><a href="#attr-param-value">value</a></code> - Value of parameter</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">Tag omission in text/html</span>:</dt>
   <dd>No <a data-anolis-xref="syntax-end-tag" href="syntax.html#syntax-end-tag">end tag</a></dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd>None</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">interface <dfn id="htmlparamelement">HTMLParamElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a data-anolis-xref="dom-param-name" href="#dom-param-name">name</a>;
           attribute DOMString <a data-anolis-xref="dom-param-value" href="#dom-param-value">value</a>;
};</pre>
   </dd>
  </dl><!--TOPIC:HTML--><p>The <code><a href="#the-param-element">param</a></code> element defines parameters for plugins invoked by <code><a href="#the-object-element">object</a></code>
  elements. It does not <a data-anolis-xref="represents" href="dom.html#represents">represent</a> anything on its own.</p>

  <p>The <dfn data-anolis-xref="attr-param-name" id="attr-param-name"><code>name</code></dfn> attribute gives the name of the
  parameter.</p>

  <p>The <dfn data-anolis-xref="attr-param-value" id="attr-param-value"><code>value</code></dfn> attribute gives the value of the
  parameter.</p>

  <p>Both attributes must be present. They may have any value.</p>

  <div class="impl">

  <p>If both attributes are present, and if the parent element of the <code><a href="#the-param-element">param</a></code> is an
  <code><a href="#the-object-element">object</a></code> element, then the element defines a <dfn data-anolis-xref="concept-param-parameter" id="concept-param-parameter">parameter</dfn> with the given name-value pair.</p>

  <p>If either the name or value of a <a data-anolis-xref="concept-param-parameter" href="#concept-param-parameter">parameter</a> defined
  by a <code><a href="#the-param-element">param</a></code> element that is the child of an <code><a href="#the-object-element">object</a></code> element that
  <a href="dom.html#represents">represents</a> an instantiated <a href="infrastructure.html#plugin">plugin</a> changes, and if that
  <a href="infrastructure.html#plugin">plugin</a> is communicating with the user agent using an API that features the ability to
  update the <a href="infrastructure.html#plugin">plugin</a> when the name or value of a <a data-anolis-xref="concept-param-parameter" href="#concept-param-parameter">parameter</a> so changes, then the user agent must
  appropriately exercise that ability to notify the <a href="infrastructure.html#plugin">plugin</a> of the change.</p>

  <p>The IDL attributes <dfn data-anolis-xref="dom-param-name" id="dom-param-name"><code>name</code></dfn> and <dfn data-anolis-xref="dom-param-value" id="dom-param-value"><code>value</code></dfn> must both <a href="infrastructure.html#reflect">reflect</a> the respective
  content attributes of the same name.</p>

  </div>

  <div class="example">

   <p>The following example shows how the <code><a href="#the-param-element">param</a></code> element can be used to pass a parameter
   to a plugin, in this case the O3D plugin.</p>

   <pre>&lt;!DOCTYPE HTML&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
   &lt;title&gt;O3D Utah Teapot&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
   &lt;p&gt;
    &lt;object type="application/vnd.o3d.auto"&gt;
     <strong>&lt;param name="o3d_features" value="FloatingPointTextures"&gt;</strong>
     &lt;img src="o3d-teapot.png"
          title="3D Utah Teapot illustration rendered using O3D."
          alt="When O3D renders the Utah Teapot, it appears as a squat
          teapot with a shiny metallic finish on which the
          surroundings are reflected, with a faint shadow caused by
          the lighting."&gt;
     &lt;p&gt;To see the teapot actually rendered by O3D on your
     computer, please download and install the &lt;a
     href="http://code.google.com/apis/o3d/docs/gettingstarted.html#install"&gt;O3D plugin&lt;/a&gt;.&lt;/p&gt;
    &lt;/object&gt;
    &lt;script src="o3d-teapot.js"&gt;&lt;/script&gt;
   &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

  </div>

<!--TOPIC:Video and Audio-->
  <h4 id="the-video-element"><span class="secno">4.7.6 </span>The <dfn id="video"><code>video</code></dfn> element</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd><a href="dom.html#flow-content-1">Flow content</a>.</dd>
   <dd><a href="dom.html#phrasing-content-1">Phrasing content</a>.</dd>
   <dd><a href="dom.html#embedded-content-2">Embedded content</a>.</dd>
   <dd>If the element has a <code data-anolis-xref="attr-media-controls"><a href="#attr-media-controls">controls</a></code> attribute: <a href="dom.html#interactive-content-0">Interactive content</a>.</dd>
   <dd><a href="dom.html#palpable-content-0">Palpable content</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>Where <a href="dom.html#embedded-content-2">embedded content</a> is expected.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd>If the element has a <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute:
 zero or more <code><a href="#the-track-element">track</a></code> elements, then
 <a href="dom.html#transparent">transparent</a>, but with no <a href="#media-element">media element</a> descendants.</dd>
   <dd>If the element does not have a <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute: zero or more <code><a href="#the-source-element">source</a></code> elements, then
 zero or more <code><a href="#the-track-element">track</a></code> elements, then
 <a href="dom.html#transparent">transparent</a>, but with no <a href="#media-element">media element</a> descendants.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
    <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> - Address of the resource</dd>
   <dd><code data-anolis-xref="attr-media-crossorigin"><a href="#attr-media-crossorigin">crossorigin</a></code> - How the element handles crossorigin requests</dd>
   <dd><code data-anolis-xref="attr-video-poster"><a href="#attr-video-poster">poster</a></code> - Poster frame to show prior to video playback</dd>
   <dd><code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code> - Hints how much buffering the 
   <a href="#media-resource">media resource</a> will likely need</dd>
   <dd><code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code> - Hint that the <a href="#media-resource">media resource</a> 
   can be started automatically when the page is loaded</dd>
   <dd><code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> - Groups <a data-anolis-xref="media element" href="#media-element">media elements</a> 
   together with an implicit <code><a href="#mediacontroller">MediaController</a></code></dd>
   <dd><code data-anolis-xref="attr-media-loop"><a href="#attr-media-loop">loop</a></code> - Whether to loop the <a href="#media-resource">media resource</a></dd>
   <dd><code data-anolis-xref="attr-media-muted"><a href="#attr-media-muted">muted</a></code> - Whether to mute the <a href="#media-resource">media resource</a> by default</dd>
   <dd><code data-anolis-xref="attr-media-controls"><a href="#attr-media-controls">controls</a></code> - Show user agent controls</dd>
   <dd><code data-anolis-xref="attr-dim-width"><a href="#attr-dim-width">width</a></code> - Horizontal dimension</dd>
   <dd><code data-anolis-xref="attr-dim-height"><a href="#attr-dim-height">height</a></code> - Vertical dimension</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">Tag omission in text/html</span></dt>
   <dd>Neither tag is omissible</dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd><a href="dom.html#index-aria-application"><code title="">application</code></a>.</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dd>Any <code title="">aria-*</code> attributes 
   <a href="dom.html#allowed-aria-roles,-states-and-properties">applicable to the allowed roles</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
    <pre class="idl">interface <dfn id="htmlvideoelement">HTMLVideoElement</dfn> : <a href="#htmlmediaelement">HTMLMediaElement</a> {
           attribute unsigned long <a data-anolis-xref="dom-dim-width" href="#dom-dim-width">width</a>;
           attribute unsigned long <a data-anolis-xref="dom-dim-height" href="#dom-dim-height">height</a>;
  readonly attribute unsigned long <a data-anolis-xref="dom-video-videoWidth" href="#dom-video-videowidth">videoWidth</a>;
  readonly attribute unsigned long <a data-anolis-xref="dom-video-videoHeight" href="#dom-video-videoheight">videoHeight</a>;
           attribute DOMString <a data-anolis-xref="dom-video-poster" href="#dom-video-poster">poster</a>;
};</pre>
   </dd>
  </dl><!--TOPIC:HTML--><p>A <code><a href="#the-video-element">video</a></code> element is used for playing videos or movies, and audio files with
  captions.</p>

  <p>Content may be provided inside the <code><a href="#the-video-element">video</a></code> element<span class="impl">. User agents
  should not show this content to the user</span>; it is intended for older Web browsers which do
  not support <code><a href="#the-video-element">video</a></code>, so that legacy video plugins can be tried, or to show text to the
  users of these older browsers informing them of how to access the video contents.</p>

  <p class="note">In particular, this content is not intended to address accessibility concerns. To
  make video content accessible to the partially sighted, the blind, the hard-of-hearing, the deaf,
  and those with other physical or cognitive disabilities, a variety of features are available.
  Captions can be provided, either embedded in the video stream or as external files using the
  <code><a href="#the-track-element">track</a></code> element. Sign-language tracks can be provided, again either embedded in the
  video stream or by synchronizing multiple <code><a href="#the-video-element">video</a></code> elements using the <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> attribute or a <code><a href="#mediacontroller">MediaController</a></code>
  object. Audio descriptions can be provided, either as a separate track embedded in the video
  stream, or a separate audio track in an <code><a href="#the-audio-element">audio</a></code> element <a data-anolis-xref="slaved media
  elements" href="#slaved-media-elements">slaved</a> to the same controller as the <code><a href="#the-video-element">video</a></code> element(s), or in text
  form using a <a href="infrastructure.html#webvtt-file">WebVTT file</a> referenced using the <code><a href="#the-track-element">track</a></code> element and
  synthesized into speech by the user agent. WebVTT can also be used to provide chapter titles. For
  users who would rather not use a media element at all, transcripts or other textual alternatives
  can be provided by simply linking to them in the prose near the <code><a href="#the-video-element">video</a></code> element. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>

  <p>The <code><a href="#the-video-element">video</a></code> element is a <a href="#media-element">media element</a> whose <a href="#media-data">media data</a> is
  ostensibly video data, possibly with associated audio data.</p>

  <p>The <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code>, <code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code>,
  <code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code>, <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code>, <code data-anolis-xref="attr-media-loop"><a href="#attr-media-loop">loop</a></code>, <code data-anolis-xref="attr-media-muted"><a href="#attr-media-muted">muted</a></code>, and <code data-anolis-xref="attr-media-controls"><a href="#attr-media-controls">controls</a></code>
  attributes are <a data-anolis-xref="media element attributes" href="#media-element-attributes">the attributes common to all media
  elements</a>.</p>

  <p>The <dfn data-anolis-xref="attr-video-poster" id="attr-video-poster"><code>poster</code></dfn> attribute gives the address of an
  image file that the user agent can show while no video data is available. The attribute, if
  present, must contain a <a href="infrastructure.html#valid-non-empty-url-potentially-surrounded-by-spaces">valid non-empty URL potentially surrounded by spaces</a>.</p>

  <div class="impl">

  <p>If the specified resource is to be used, then, when the element is created or when the <code data-anolis-xref="attr-video-poster"><a href="#attr-video-poster">poster</a></code> attribute is set, changed, or removed, the user agent must
  run the following steps to determine the element's <dfn id="poster-frame">poster frame</dfn> (regardless of the
  value of the element's <a href="#show-poster-flag">show poster flag</a>):</p> <!-- thus it is unaffected by changes
  to the base URL. -->

  <ol><li><p>If there is an existing instance of this algorithm running for this <code><a href="#the-video-element">video</a></code>
   element, abort that instance of this algorithm without changing the <a href="#poster-frame">poster
   frame</a>.</li>

   <li><p>If the <code data-anolis-xref="attr-video-poster"><a href="#attr-video-poster">poster</a></code> attribute's value is the empty string
   or if the attribute is absent, then there is no <a href="#poster-frame">poster frame</a>; abort these
   steps.</li>

   <li><p><a data-anolis-xref="resolve a url" href="infrastructure.html#resolve-a-url">Resolve</a> the <code data-anolis-xref="attr-video-poster"><a href="#attr-video-poster">poster</a></code> attribute's value relative to the element. If this fails,
   then there is no <a href="#poster-frame">poster frame</a>; abort these steps.</li>

   <li><p><a href="infrastructure.html#fetch">Fetch</a><!--FETCH--> the resulting <a href="infrastructure.html#absolute-url">absolute URL</a>, from the element's
   <code><a href="dom.html#document">Document</a></code>'s <a href="browsers.html#origin-0">origin</a>. This must <a href="syntax.html#delay-the-load-event">delay the load event</a> of the
   element's document.</li>

   <!-- could define how to sniff for an image here -->

   <li><p>If an image is thus obtained, the <a href="#poster-frame">poster frame</a> is that image. Otherwise,
   there is no <a href="#poster-frame">poster frame</a>.</li>

  </ol></div>

  <p class="note">The image given by the <code data-anolis-xref="attr-video-poster"><a href="#attr-video-poster">poster</a></code> attribute,
  the <i><a href="#poster-frame">poster frame</a></i>, is intended to be a representative frame of the video (typically one of
  the first non-blank frames) that gives the user an idea of what the video is like.</p>

  <div class="impl">

  <hr><p>A <code><a href="#the-video-element">video</a></code> element represents what is given for the first matching condition in the
  list below:</p>

  <dl class="switch"><dt>When no video data is available (the element's <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute is either <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>, or <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> but no video data has yet been obtained at
   all, or the element's <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute is any
   subsequent value but the <a href="#media-resource">media resource</a> does not have a video channel)</dt>

   <dd>The <code><a href="#the-video-element">video</a></code> element <a href="dom.html#represents">represents</a> its <a href="#poster-frame">poster frame</a>, if any,
   or else transparent black with no intrinsic dimensions.</dd>

   <dt>When the <code><a href="#the-video-element">video</a></code> element is <a data-anolis-xref="dom-media-paused" href="#dom-media-paused">paused</a>, the <a data-anolis-xref="current playback position" href="#current-playback-position">current playback position</a> is the first frame of video,
   and the element's <a href="#show-poster-flag">show poster flag</a> is set</dt>

   <dd>The <code><a href="#the-video-element">video</a></code> element <a href="dom.html#represents">represents</a> its <a href="#poster-frame">poster frame</a>, if any,
   or else the first frame of the video.</dd>

   <dt>When the <code><a href="#the-video-element">video</a></code> element is <a data-anolis-xref="dom-media-paused" href="#dom-media-paused">paused</a>, and the
   frame of video corresponding to the <a data-anolis-xref="current playback position" href="#current-playback-position">current playback
   position</a> is not available (e.g. because the video is seeking or buffering)</dt>

   <dt>When the <code><a href="#the-video-element">video</a></code> element is neither <a href="#potentially-playing">potentially playing</a> nor <a data-anolis-xref="dom-media-paused" href="#dom-media-paused">paused</a> (e.g. when seeking or stalled)</dt>

   <dd>The <code><a href="#the-video-element">video</a></code> element <a href="dom.html#represents">represents</a> the last frame of the video to have
   been rendered.</dd>

   <dt>When the <code><a href="#the-video-element">video</a></code> element is <a data-anolis-xref="dom-media-paused" href="#dom-media-paused">paused</a></dt>

   <dd>The <code><a href="#the-video-element">video</a></code> element <a href="dom.html#represents">represents</a> the frame of video corresponding to
   the <a data-anolis-xref="current playback position" href="#current-playback-position">current playback position</a>.</dd>

   <dt>Otherwise (the <code><a href="#the-video-element">video</a></code> element has a video channel and is <a href="#potentially-playing">potentially
   playing</a>)</dt>

   <dd>The <code><a href="#the-video-element">video</a></code> element <a href="dom.html#represents">represents</a> the frame of video at the continuously
   increasing <a data-anolis-xref="current playback position" href="#current-playback-position">"current" position</a>. When the
   <a href="#current-playback-position">current playback position</a> changes such that the last frame rendered is no longer the
   frame corresponding to the <a href="#current-playback-position">current playback position</a> in the video, the new frame
   must be rendered.</dd>

  </dl><p class="note">Which frame in a video stream corresponds to a particular playback position is
  defined by the video stream's format.</p>

  <p>The <code><a href="#the-video-element">video</a></code> element also <a href="dom.html#represents">represents</a> any <a data-anolis-xref="text track
  cue" href="#text-track-cue">text track cues</a> whose <a href="#text-track-cue-active-flag">text track cue active flag</a> is set and whose
  <a href="#text-track">text track</a> is in the <a data-anolis-xref="text track showing" href="#text-track-showing">showing</a> mode, and any
  audio from the <a href="#media-resource">media resource</a>, at the <a href="#current-playback-position">current playback position</a>.</p>

  <p>Any audio associated with the <a href="#media-resource">media resource</a> must, if played, be played
  synchronized with the <a href="#current-playback-position">current playback position</a>, at the element's <a href="#effective-media-volume">effective
  media volume</a>.</p>

  <p>In addition to the above, the user agent may provide messages to the user (such as "buffering",
  "no video loaded", "error", or more detailed information) by overlaying text or icons on the video
  or other areas of the element's playback area, or in another appropriate manner.</p>

  <p>User agents that cannot render the video may instead make the element <a data-anolis-xref="represents" href="dom.html#represents">represent</a> a link to an external video playback utility or to the video
  data itself.</p>

  <p>When a <code><a href="#the-video-element">video</a></code> element's <a href="#media-resource">media resource</a> has a video channel, the
  element <a href="infrastructure.html#provides-a-paint-source">provides a paint source</a> whose width is the <a href="#media-resource">media resource</a>'s
  <a data-anolis-xref="concept-video-intrinsic-width" href="#concept-video-intrinsic-width">intrinsic width</a>, whose height is the
  <a href="#media-resource">media resource</a>'s <a data-anolis-xref="concept-video-intrinsic-height" href="#concept-video-intrinsic-height">intrinsic
  height</a>, and whose appearance is the frame of video corresponding to the <a data-anolis-xref="current playback position" href="#current-playback-position">current playback position</a>, if that is available, or else
  (e.g. when the video is seeking or buffering) its previous appearance, if any, or else (e.g.
  because the video is still loading the first frame) blackness.</p>

  <hr></div>

  <dl class="domintro"><dt><var data-anolis-xref="">video</var> . <code data-anolis-xref="dom-video-videoWidth"><a href="#dom-video-videowidth">videoWidth</a></code></dt>
   <dt><var data-anolis-xref="">video</var> . <code data-anolis-xref="dom-video-videoHeight"><a href="#dom-video-videoheight">videoHeight</a></code></dt>

   <dd>

    <p>These attributes return the intrinsic dimensions of the video,
    or zero if the dimensions are not known.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="concept-video-intrinsic-width" id="concept-video-intrinsic-width">intrinsic width</dfn> and <dfn data-anolis-xref="concept-video-intrinsic-height" id="concept-video-intrinsic-height">intrinsic height</dfn> of the <a href="#media-resource">media resource</a>
  are the dimensions of the resource in CSS pixels after taking into account the resource's
  dimensions, aspect ratio, clean aperture, resolution, and so forth, as defined for the format used
  by the resource. If an anamorphic format does not define how to apply the aspect ratio to the
  video data's dimensions to obtain the "correct" dimensions, then the user agent must apply the
  ratio by increasing one dimension and leaving the other unchanged.</p>

  <p>The <dfn data-anolis-xref="dom-video-videoWidth" id="dom-video-videowidth"><code>videoWidth</code></dfn> IDL attribute must return
  the <a data-anolis-xref="concept-video-intrinsic-width" href="#concept-video-intrinsic-width">intrinsic width</a> of the video in CSS pixels.
  The <dfn data-anolis-xref="dom-video-videoHeight" id="dom-video-videoheight"><code>videoHeight</code></dfn> IDL attribute must return
  the <a data-anolis-xref="concept-video-intrinsic-height" href="#concept-video-intrinsic-height">intrinsic height</a> of the video in CSS
  pixels. If the element's <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute is <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>, then the attributes must return 0.</p>

  <p id="dimUpdate">Whenever the <a data-anolis-xref="concept-video-intrinsic-width" href="#concept-video-intrinsic-width">intrinsic width</a>
  or <a data-anolis-xref="concept-video-intrinsic-height" href="#concept-video-intrinsic-height">intrinsic height</a> of the video changes
  (including, for example, because the <a data-anolis-xref="dom-VideoTrack-selected" href="#dom-videotrack-selected">selected video
  track</a> was changed), if the element's <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code>
  attribute is not <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>, the user agent must
  <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-resize"><a href="#event-media-resize">resize</a></code> at the <a href="#media-element">media element</a>.</p>

  </div>

  <p>The <code><a href="#the-video-element">video</a></code> element supports <a href="#dimension-attributes">dimension attributes</a>.</p>

  <div class="impl">

  <p>In the absence of style rules to the contrary, video content should be rendered inside the
  element's playback area such that the video content is shown centered in the playback area at the
  largest possible size that fits completely within it, with the video content's aspect ratio being
  preserved. Thus, if the aspect ratio of the playback area does not match the aspect ratio of the
  video, the video will be shown letterboxed or pillarboxed. Areas of the element's playback area
  that do not contain the video represent nothing.</p>

  <p class="note">In user agents that implement CSS, the above requirement can be implemented by
  using the <a href="rendering.html#video-object-fit">style rule suggested in the rendering section</a>.</p>

  <p>The intrinsic width of a <code><a href="#the-video-element">video</a></code> element's playback area is the intrinsic width of
  the <a href="#poster-frame">poster frame</a>, if that is available and the element currently
  <a href="dom.html#represents">represents</a> its poster frame; otherwise, it is the <a data-anolis-xref="concept-video-intrinsic-width" href="#concept-video-intrinsic-width">intrinsic width</a> of the video resource, if that is
  available; otherwise the intrinsic width is missing.</p>

  <p>The intrinsic height of a <code><a href="#the-video-element">video</a></code> element's playback area is the intrinsic height of
  the <a href="#poster-frame">poster frame</a>, if that is available and the element currently
  <a href="dom.html#represents">represents</a> its poster frame; otherwise it is the <a data-anolis-xref="concept-video-intrinsic-height" href="#concept-video-intrinsic-height">intrinsic height</a> of the video resource, if that is
  available; otherwise the intrinsic height is missing.</p>

  <p>The <a href="infrastructure.html#default-object-size">default object size</a> is a width of 300 CSS pixels and a height of 150 CSS
  pixels. <a href="references.html#refsCSSIMAGES">[CSSIMAGES]</a></p>

  <hr><p>User agents should provide controls to enable or disable the display of closed captions, audio
  description tracks, and other additional data associated with the video stream, though such
  features should, again, not interfere with the page's normal rendering.</p>

  <p>User agents may allow users to view the video content in manners more suitable to the user
  (e.g. full-screen or in an independent resizable window). As for the other user interface
  features, controls to enable this should not interfere with the page's normal rendering unless the
  user agent is <a data-anolis-xref="expose a user interface to the user" href="#expose-a-user-interface-to-the-user">exposing a user interface</a>.
  In such an independent context, however, user agents may make full user interfaces visible, with,
  e.g., play, pause, seeking, and volume controls, even if the <code data-anolis-xref="attr-media-controls"><a href="#attr-media-controls">controls</a></code> attribute is absent.</p>

  <p>User agents may allow video playback to affect system features that could interfere with the
  user's experience; for example, user agents could disable screensavers while video playback is in
  progress.</p>

  <hr><p>The <dfn data-anolis-xref="dom-video-poster" id="dom-video-poster"><code>poster</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-video-poster"><a href="#attr-video-poster">poster</a></code> content attribute.</p>

  </div>

  <div class="example">

   <p>This example shows how to detect when a video has failed to play correctly:</p>

   <pre>&lt;script&gt;
 function failed(e) {
   // video playback failed - show a message saying why
   switch (e.target.error.code) {
     case e.target.error.MEDIA_ERR_ABORTED:
       alert('You aborted the video playback.');
       break;
     case e.target.error.MEDIA_ERR_NETWORK:
       alert('A network error caused the video download to fail part-way.');
       break;
     case e.target.error.MEDIA_ERR_DECODE:
       alert('The video playback was aborted due to a corruption problem or because the video used features your browser did not support.');
       break;
     case e.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:
       alert('The video could not be loaded, either because the server or network failed or because the format is not supported.');
       break;
     default:
       alert('An unknown error occurred.');
       break;
   }
 }
&lt;/script&gt;
&lt;p&gt;&lt;video src="tgif.vid" autoplay controls onerror="failed(event)"&gt;&lt;/video&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href="tgif.vid"&gt;Download the video file&lt;/a&gt;.&lt;/p&gt;</pre>

  </div>




  <!--CODECS

  <div class="impl">

  <h5>Video and audio codecs for <code>video</code> elements</h5>

  <p>User agents may support any video and audio codecs and container formats.</p>

  <p class="note">Certain user agents might support no codecs at all, e.g. text browsers running
  over SSH connections.</p>

  <!- - similar note in audio codecs section - ->
  <p class="note">Implementations are free to implement support for video codecs either natively, or
  using platform-specific APIs, or using plugins: this specification does not specify how codecs are
  to be implemented.</p>

  </div>

  (when replacing this text, also fix "- -" nested comments)-->





  <h4 id="the-audio-element"><span class="secno">4.7.7 </span>The <dfn id="audio"><code>audio</code></dfn> element</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd><a href="dom.html#flow-content-1">Flow content</a>.</dd>
   <dd><a href="dom.html#phrasing-content-1">Phrasing content</a>.</dd>
   <dd><a href="dom.html#embedded-content-2">Embedded content</a>.</dd>
   <dd>If the element has a <code data-anolis-xref="attr-media-controls"><a href="#attr-media-controls">controls</a></code> attribute: <a href="dom.html#interactive-content-0">Interactive content</a>.</dd>
   <dd>If the element has a <code data-anolis-xref="attr-media-controls"><a href="#attr-media-controls">controls</a></code> attribute: <a href="dom.html#palpable-content-0">Palpable content</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>Where <a href="dom.html#embedded-content-2">embedded content</a> is expected.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd>If the element has a <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute: 
zero or more <code><a href="#the-track-element">track</a></code> elements, then 
<a href="dom.html#transparent">transparent</a>, but with no <a href="#media-element">media element</a> descendants.</dd>
   <dd>If the element does not have a <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute: zero or more <code><a href="#the-source-element">source</a></code> elements, then
 zero or more <code><a href="#the-track-element">track</a></code> elements, then
 <a href="dom.html#transparent">transparent</a>, but with no <a href="#media-element">media element</a> descendants.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
   <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> - Address of the resource</dd>
   <dd><code data-anolis-xref="attr-media-crossorigin"><a href="#attr-media-crossorigin">crossorigin</a></code> - How the element handles crossorigin requests</dd>
   <dd><code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code> - Hints how much buffering the 
   <a href="#media-resource">media resource</a> will likely need</dd>
   <dd><code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code> - Hint that the <a href="#media-resource">media resource</a> 
   can be started automatically when the page is loaded</dd>
   <dd><code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> - Groups <a data-anolis-xref="media element" href="#media-element">media elements</a> 
   together with an implicit <code><a href="#mediacontroller">MediaController</a></code></dd>
   <dd><code data-anolis-xref="attr-media-loop"><a href="#attr-media-loop">loop</a></code> - Whether to loop the <a href="#media-resource">media resource</a></dd>
   <dd><code data-anolis-xref="attr-media-muted"><a href="#attr-media-muted">muted</a></code> - Whether to mute the <a href="#media-resource">media resource</a> by default</dd>
   <dd><code data-anolis-xref="attr-media-controls"><a href="#attr-media-controls">controls</a></code> - Show user agent controls</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">Tag omission in text/html</span></dt>
   <dd>Neither tag is omissible</dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd><a href="dom.html#index-aria-application"><code title="">application</code></a>.</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dd>Any <code title="">aria-*</code> attributes 
   <a href="dom.html#allowed-aria-roles,-states-and-properties">applicable to the allowed roles</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
    <pre class="idl">[NamedConstructor=<a data-anolis-xref="dom-Audio" href="#dom-audio">Audio</a>(optional DOMString src)]
interface <dfn id="htmlaudioelement">HTMLAudioElement</dfn> : <a href="#htmlmediaelement">HTMLMediaElement</a> {};</pre>
   </dd>
  </dl><!--TOPIC:HTML--><p>An <code><a href="#the-audio-element">audio</a></code> element <a href="dom.html#represents">represents</a> a sound or audio stream.</p>

  <!-- v2 (actually v3) suggestions:
    * Audio syntesis. Use cases from Charles Pritchard:
      > Use a sound of varying pitch to hint to a user the location of their
      > mouse (is it hovering over a button, is it x/y pixels away from the edge
      > of the screen, how close is it to the center).
      >
      > Alter the pitch of a sound to make a very cheap midi instrument.
      >
      > Pre-mix a few generated sounds, because the client processor is slow.
      >
      > Alter the pitch of an actual audio recording, and pre-mix it, to give
      > different sounding voices to pre-recorded readings of a single text. As
      > has been tried for "male" "female" sound fonts.
      >
      > Support very simple audio codecs, and programmable synthesizers.
  -->

  <p>Content may be provided inside the <code><a href="#the-audio-element">audio</a></code> element<span class="impl">. User agents
  should not show this content to the user</span>; it is intended for older Web browsers which do
  not support <code><a href="#the-audio-element">audio</a></code>, so that legacy audio plugins can be tried, or to show text to the
  users of these older browsers informing them of how to access the audio contents.</p>

  <p class="note">In particular, this content is not intended to address accessibility concerns. To
  make audio content accessible to the deaf or to those with other physical or cognitive
  disabilities, a variety of features are available. If captions or a sign language video are
  available, the <code><a href="#the-video-element">video</a></code> element can be used instead of the <code><a href="#the-audio-element">audio</a></code> element to
  play the audio, allowing users to enable the visual alternatives. Chapter titles can be provided
  to aid navigation, using the <code><a href="#the-track-element">track</a></code> element and a <a href="infrastructure.html#webvtt-file">WebVTT file</a>. And,
  naturally, transcripts or other textual alternatives can be provided by simply linking to them in
  the prose near the <code><a href="#the-audio-element">audio</a></code> element. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>

  <p>The <code><a href="#the-audio-element">audio</a></code> element is a <a href="#media-element">media element</a> whose <a href="#media-data">media data</a> is
  ostensibly audio data.</p>

  <p>The <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code>, <code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code>,
  <code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code>, <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code>, <code data-anolis-xref="attr-media-loop"><a href="#attr-media-loop">loop</a></code>, <code data-anolis-xref="attr-media-muted"><a href="#attr-media-muted">muted</a></code>, and <code data-anolis-xref="attr-media-controls"><a href="#attr-media-controls">controls</a></code>
  attributes are <a data-anolis-xref="media element attributes" href="#media-element-attributes">the attributes common to all media
  elements</a>.</p>

  <div class="impl">

  <p>When an <code><a href="#the-audio-element">audio</a></code> element is <a href="#potentially-playing">potentially playing</a>, it must have its audio
  data played synchronized with the <a href="#current-playback-position">current playback position</a>, at the element's
  <a href="#effective-media-volume">effective media volume</a>.</p>

  <p>When an <code><a href="#the-audio-element">audio</a></code> element is not <a href="#potentially-playing">potentially playing</a>, audio must not play
  for the element.</p>

  </div>

  <dl class="domintro"><dt><var data-anolis-xref="">audio</var> = new <code data-anolis-xref="dom-Audio"><a href="#dom-audio">Audio</a></code>( [ <var data-anolis-xref="">url</var> ] )</dt>

   <dd>

    <p>Returns a new <code><a href="#the-audio-element">audio</a></code> element, with the <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code>
    attribute set to the value passed in the argument, if applicable.</p>

   </dd>

  </dl><div class="impl">

  <p>A constructor is provided for creating <code><a href="#htmlaudioelement">HTMLAudioElement</a></code> objects (in addition to
  the factory methods from DOM such as <code data-anolis-xref="">createElement()</code>): <dfn data-anolis-xref="dom-Audio" id="dom-audio"><code>Audio(<var data-anolis-xref="">src</var>)</code></dfn>. When invoked as a
  constructor, it must return a new <code><a href="#htmlaudioelement">HTMLAudioElement</a></code> object (a new <code><a href="#the-audio-element">audio</a></code>
  element). The element must have its <code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code> attribute set
  to the literal value "<code data-anolis-xref="attr-media-preload-auto"><a href="#attr-media-preload-auto">auto</a></code>". If the <var data-anolis-xref="">src</var> argument is present, the object created must have its <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> content attribute set to the provided value, and the user agent
  must invoke the object's <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection
  algorithm</a> before returning. The element's document must be the <a href="browsers.html#active-document">active document</a>
  of the <a href="browsers.html#browsing-context">browsing context</a> of the <code><a href="browsers.html#window">Window</a></code> object on which the interface
  object of the invoked constructor is found.</p>

  </div>



  <!--CODECS

  <div class="impl">

  <h5>Audio codecs for <code>audio</code> elements</h5>

  <p>User agents may support any audio codecs and container formats.</p>

  <p>User agents must support the WAVE container format with audio encoded using the 16 bit PCM (LE)
  codec, at sampling frequencies of 11.025kHz, 22.050kHz, and 44.100kHz, and for both mono and
  stereo. <a href="#- -refsWAVE">[WAVE]</a></p>

  <!- -
   <dt id="- -refsWAVE">WAVE</dt>
   <dd>http://en.wikipedia.org/wiki/WAV? </dd>
  - ->

  <!- - similar note in video codecs section - ->
  <p class="note">Implementations are free to implement support for audio codecs either natively, or
  using platform-specific APIs, or using plugins: this specification does not specify how codecs are
  to be implemented.</p>

  </div>

  (when replacing this text, also fix "- -" nested comments)-->



  <h4 id="the-source-element"><span class="secno">4.7.8 </span>The <dfn><code>source</code></dfn> element</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd>None.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>As a child of a <a href="#media-element">media element</a>, before any <a href="dom.html#flow-content-1">flow content</a>
 or <code><a href="#the-track-element">track</a></code> elements.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd>Empty.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
   <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-source-src"><a href="#attr-source-src">src</a></code> - Address of the resource</dd>
   <dd><code data-anolis-xref="attr-source-type"><a href="#attr-source-type">type</a></code> - Type of embedded resource</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">Tag omission in text/html</span>:</dt>
   <dd>No <a data-anolis-xref="syntax-end-tag" href="syntax.html#syntax-end-tag">end tag</a></dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd>None</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">interface <dfn id="htmlsourceelement">HTMLSourceElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a data-anolis-xref="dom-source-src" href="#dom-source-src">src</a>;
           attribute DOMString <a data-anolis-xref="dom-source-type" href="#dom-source-type">type</a>;
           attribute DOMString <a data-anolis-xref="dom-source-media" href="#dom-source-media">media</a>;
};</pre>
   </dd>
  </dl><!--TOPIC:HTML--><p>The <code><a href="#the-source-element">source</a></code> element allows authors to specify multiple alternative <a data-anolis-xref="media resource" href="#media-resource">media resources</a> for <a data-anolis-xref="media element" href="#media-element">media
  elements</a>. It does not <a data-anolis-xref="represents" href="dom.html#represents">represent</a> anything on its own.</p>

  <p>The <dfn data-anolis-xref="attr-source-src" id="attr-source-src"><code>src</code></dfn> attribute gives the address of the
  <a href="#media-resource">media resource</a>. The value must be a <a href="infrastructure.html#valid-non-empty-url-potentially-surrounded-by-spaces">valid non-empty URL potentially surrounded
  by spaces</a>. This attribute must be present.</p>

  <p class="note">Dynamically modifying a <code><a href="#the-source-element">source</a></code> element and its attribute when the
  element is already inserted in a <code><a href="#the-video-element">video</a></code> or <code><a href="#the-audio-element">audio</a></code> element will have no
  effect. To change what is playing, just use the <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute
  on the <a href="#media-element">media element</a> directly, possibly making use of the <code data-anolis-xref="dom-navigator-canPlayType"><a href="#dom-navigator-canplaytype">canPlayType()</a></code> method to pick from amongst available
  resources. Generally, manipulating <code><a href="#the-source-element">source</a></code> elements manually after the document has
  been parsed is an unnecessarily complicated approach.</p>

  <p>The <dfn data-anolis-xref="attr-source-type" id="attr-source-type"><code>type</code></dfn> attribute gives the type of the
  <a href="#media-resource">media resource</a>, to help the user agent determine if it can play this <a href="#media-resource">media
  resource</a> before fetching it. If specified, its value must be a <a href="infrastructure.html#valid-mime-type">valid MIME
  type</a>. The <code data-anolis-xref="">codecs</code> parameter, which certain MIME types define, might be
  necessary to specify exactly how the resource is encoded. <a href="references.html#refsRFC6381">[RFC6381]</a></p>

  <div class="example">

   <p>The following list shows some examples of how to use the <code data-anolis-xref="">codecs=</code> MIME
   parameter in the <code data-anolis-xref="attr-source-type"><a href="#attr-source-type">type</a></code> attribute.</p>

   <dl><dt>H.264 Constrained baseline profile video (main and extended video compatible) level 3 and Low-Complexity AAC audio in MP4 container</dt>
    <dd><pre>&lt;source src='video.mp4' type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'&gt;</pre></dd>

    <dt>H.264 Extended profile video (baseline-compatible) level 3 and Low-Complexity AAC audio in MP4 container</dt>
    <dd><pre>&lt;source src='video.mp4' type='video/mp4; codecs="avc1.58A01E, mp4a.40.2"'&gt;</pre></dd>

    <dt>H.264 Main profile video level 3 and Low-Complexity AAC audio in MP4 container</dt>
    <dd><pre>&lt;source src='video.mp4' type='video/mp4; codecs="avc1.4D401E, mp4a.40.2"'&gt;</pre></dd>

    <dt>H.264 'High' profile video (incompatible with main, baseline, or extended profiles) level 3 and Low-Complexity AAC audio in MP4 container</dt>
    <dd><pre>&lt;source src='video.mp4' type='video/mp4; codecs="avc1.64001E, mp4a.40.2"'&gt;</pre></dd>


    <dt>MPEG-4 Visual Simple Profile Level 0 video and Low-Complexity AAC audio in MP4 container</dt>
    <dd><pre>&lt;source src='video.mp4' type='video/mp4; codecs="mp4v.20.8, mp4a.40.2"'&gt;</pre></dd>

    <dt>MPEG-4 Advanced Simple Profile Level 0 video and Low-Complexity AAC audio in MP4 container</dt>
    <dd><pre>&lt;source src='video.mp4' type='video/mp4; codecs="mp4v.20.240, mp4a.40.2"'&gt;</pre></dd>

    <dt>MPEG-4 Visual Simple Profile Level 0 video and AMR audio in 3GPP container</dt>
    <dd><pre>&lt;source src='video.3gp' type='video/3gpp; codecs="mp4v.20.8, samr"'&gt;</pre></dd>


    <dt>Theora video and Vorbis audio in Ogg container</dt>
    <dd><pre>&lt;source src='video.ogv' type='video/ogg; codecs="theora, vorbis"'&gt;</pre></dd>

    <dt>Theora video and Speex audio in Ogg container</dt>
    <dd><pre>&lt;source src='video.ogv' type='video/ogg; codecs="theora, speex"'&gt;</pre></dd>

    <dt>Vorbis audio alone in Ogg container</dt>
    <dd><pre>&lt;source src='audio.ogg' type='audio/ogg; codecs=vorbis'&gt;</pre></dd>

    <dt>Speex audio alone in Ogg container</dt>
    <dd><pre>&lt;source src='audio.spx' type='audio/ogg; codecs=speex'&gt;</pre></dd>

    <dt>FLAC audio alone in Ogg container</dt>
    <dd><pre>&lt;source src='audio.oga' type='audio/ogg; codecs=flac'&gt;</pre></dd>

    <dt>Dirac video and Vorbis audio in Ogg container</dt>
    <dd><pre>&lt;source src='video.ogv' type='video/ogg; codecs="dirac, vorbis"'&gt;</pre></dd>

<!-- awaiting definition by the Matroska guys:
    <dt>Theora video and Vorbis audio in Matroska container</dt>
    <dd><pre>&lt;source src='video.mkv' type='video/x-matroska; codecs="theora, vorbis"'></pre></dd>
-->

<!-- awaiting definition by the Ogg or BBC guys:
    <dt>Dirac video and Vorbis audio in Matroska container</dt>
    <dd><pre>&lt;source src='video.mkv' type='video/x-matroska; codecs='></pre></dd>
-->

<!-- awaiting definition by the Microsoft guys:
    <dt>WMV9 video and WMA 2 audio in ASF container</dt>
    <dd><pre>&lt;source src='video.wmv' type='video/x-ms-wmv; codecs='></pre></dd>

    <dt>WMV8 video and WMA 2 audio in ASF container</dt>
    <dd><pre>&lt;source src='video.wmv' type='video/x-ms-wmv; codecs='></pre></dd>

    <dt>VC-1 video and WMA 10 Pro audio in ASF container</dt>
    <dd><pre>&lt;source src='video.wmv' type='video/x-ms-wmv; codecs='></pre></dd>

    <dt>XviD video and MP3 audio in AVI container</dt>
    <dd><pre>&lt;source src='video.avi' type='video/x-msvideo; codecs='></pre></dd>

    <dt>Motion-JPEG video and uncompressed PCM audio in AVI container</dt>
    <dd><pre>&lt;source src='video.avi' type='video/x-msvideo; codecs='></pre></dd>
-->

<!-- awaiting definition by Real:
    <dt>Real Video 10 video and High-Efficiency AAC audio in Real Media container</dt>
    <dd><pre>&lt;source src='video.rm' type='application/vnd.rn-realmedia; codecs='></pre></dd>
-->

<!--  undefined:
    <dt>MPEG-1 video and MPEG-1 Audio Layer II audio in MPEG-1 program stream</dt>
    <dd><pre>&lt;source src='video.mpg' type='video/mpeg; codecs='></pre></dd>
-->

   </dl></div>

  <p>The <dfn data-anolis-xref="attr-source-media" id="attr-source-media"><code>media</code></dfn> attribute gives the intended media
  type of the <a href="#media-resource">media resource</a>, to help the user agent determine if this <a href="#media-resource">media
  resource</a> is useful to the user before fetching it. Its value must be a <a href="infrastructure.html#valid-media-query">valid media
  query</a>.</p>

  <!-- for similar paragraphs, search for "The default, if the" -->
  <p class="note" id="source-default-media">The <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource
  selection algorithm</a> is defined in such a way that when the <code data-anolis-xref="attr-source-media"><a href="#attr-source-media">media</a></code> attribute is omitted the user agent acts the same as if the
  value was "<code data-anolis-xref="">all</code>", i.e. by default the <a href="#media-resource">media resource</a> is suitable
  for all media.</p>

  <div class="impl">

  <p>If a <code><a href="#the-source-element">source</a></code> element is inserted as a child of a <a href="#media-element">media element</a> that
  has no <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute and whose <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> has the value <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code>, the user agent must invoke the <a href="#media-element">media
  element</a>'s <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection
  algorithm</a>.</p>

  <p>The IDL attributes <dfn data-anolis-xref="dom-source-src" id="dom-source-src"><code>src</code></dfn>, <dfn data-anolis-xref="dom-source-type" id="dom-source-type"><code>type</code></dfn>, and <dfn data-anolis-xref="dom-source-media" id="dom-source-media"><code>media</code></dfn> must <a href="infrastructure.html#reflect">reflect</a> the respective content
  attributes of the same name.</p>

  </div>

  <div class="example">

   <p>If the author isn't sure if user agents will all be able to render the media resources
   provided, the author can listen to the <code data-anolis-xref="event-error">error</code> event on the last
   <code><a href="#the-source-element">source</a></code> element and trigger fallback behavior:</p>

   <pre>&lt;script&gt;
 function fallback(video) {
   // replace &lt;video&gt; with its contents
   while (video.hasChildNodes()) {
     if (video.firstChild instanceof HTMLSourceElement)
       video.removeChild(video.firstChild);
     else
       video.parentNode.insertBefore(video.firstChild, video);
   }
   video.parentNode.removeChild(video);
 }
&lt;/script&gt;
&lt;video controls autoplay&gt;
 &lt;source src='video.mp4' type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'&gt;
 &lt;source src='video.ogv' type='video/ogg; codecs="theora, vorbis"'
         onerror="fallback(parentNode)"&gt;
 ...
&lt;/video&gt;</pre>

  </div>


<!--TOPIC:Video Text Tracks-->
  <h4 id="the-track-element"><span class="secno">4.7.9 </span>The <dfn><code>track</code></dfn> element</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd>None.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>As a child of a <a href="#media-element">media element</a>, before any <a href="dom.html#flow-content-1">flow content</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd>Empty.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
   <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code> - The type of text track</dd>
   <dd><code data-anolis-xref="attr-track-src"><a href="#attr-track-src">src</a></code> - Address of the resource</dd>
   <dd><code data-anolis-xref="attr-track-srclang"><a href="#attr-track-srclang">srclang</a></code> - Language of the text track</dd>
   <dd><code data-anolis-xref="attr-track-label"><a href="#attr-track-label">label</a></code> - User-visible label</dd>
   <dd><code data-anolis-xref="attr-track-default"><a href="#attr-track-default">default</a></code> - Enable the track if no other <a href="#text-track">text track</a> is more suitable</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">Tag omission in text/html</span>:</dt>
   <dd>No <a data-anolis-xref="syntax-end-tag" href="syntax.html#syntax-end-tag">end tag</a></dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd>None</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">interface <dfn id="htmltrackelement">HTMLTrackElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a data-anolis-xref="dom-track-kind" href="#dom-track-kind">kind</a>;
           attribute DOMString <a data-anolis-xref="dom-track-src" href="#dom-track-src">src</a>;
           attribute DOMString <a data-anolis-xref="dom-track-srclang" href="#dom-track-srclang">srclang</a>;
           attribute DOMString <a data-anolis-xref="dom-track-label" href="#dom-track-label">label</a>;
           attribute boolean <a data-anolis-xref="dom-track-default" href="#dom-track-default">default</a>;

  const unsigned short <a data-anolis-xref="dom-track-NONE" href="#dom-track-none">NONE</a> = 0;
  const unsigned short <a data-anolis-xref="dom-track-LOADING" href="#dom-track-loading">LOADING</a> = 1;
  const unsigned short <a data-anolis-xref="dom-track-LOADED" href="#dom-track-loaded">LOADED</a> = 2;
  const unsigned short <a data-anolis-xref="dom-track-ERROR" href="#dom-track-error">ERROR</a> = 3;
  readonly attribute unsigned short <a data-anolis-xref="dom-track-readyState" href="#dom-track-readystate">readyState</a>;

  readonly attribute <a href="#texttrack">TextTrack</a> <a data-anolis-xref="dom-track-track" href="#dom-track-track">track</a>;
};</pre>
   </dd>
  </dl><!--TOPIC:HTML--><p>The <code><a href="#the-track-element">track</a></code> element allows authors to specify explicit external timed <a data-anolis-xref="text track" href="#text-track">text tracks</a> for <a data-anolis-xref="media element" href="#media-element">media elements</a>. It
  does not <a data-anolis-xref="represents" href="dom.html#represents">represent</a> anything on its own.</p>

  <p>The <dfn data-anolis-xref="attr-track-kind" id="attr-track-kind"><code>kind</code></dfn> attribute is an <a href="infrastructure.html#enumerated-attribute">enumerated
  attribute</a>. The following table lists the keywords defined for this attribute. The keyword
  given in the first cell of each row maps to the state given in the second cell.</p>

  <table><thead><tr><th>Keyword
     <th>State
     <th>Brief description
   <tbody><tr><td><dfn data-anolis-xref="attr-track-kind-keyword-subtitles" id="attr-track-kind-keyword-subtitles"><code>subtitles</code></dfn>
     <td><dfn data-anolis-xref="attr-track-kind-subtitles" id="attr-track-kind-subtitles">Subtitles</dfn>
     <td>
      Transcription or translation of the dialogue, suitable for when the sound is available but not understood (e.g. because the user does not understand the language of the <a href="#media-resource">media resource</a>'s audio track).
      Overlaid on the video.
    <tr><td><dfn data-anolis-xref="attr-track-kind-keyword-captions" id="attr-track-kind-keyword-captions"><code>captions</code></dfn>
     <td><dfn data-anolis-xref="attr-track-kind-captions" id="attr-track-kind-captions">Captions</dfn>
     <td>
      Transcription or translation of the dialogue, sound effects, relevant musical cues, and other relevant audio information, suitable for when sound is unavailable or not clearly audible (e.g. because it is muted, drowned-out by ambient noise, or because the user is deaf).
      Overlaid on the video; labeled as appropriate for the hard-of-hearing.
    <tr><td><dfn data-anolis-xref="attr-track-kind-keyword-descriptions" id="attr-track-kind-keyword-descriptions"><code>descriptions</code></dfn>
     <td><dfn data-anolis-xref="attr-track-kind-descriptions" id="attr-track-kind-descriptions">Descriptions</dfn>
     <td>
      Textual descriptions of the video component of the <a href="#media-resource">media resource</a>, intended for audio synthesis when the visual component is obscured, unavailable, or not usable (e.g. because the user is interacting with the application without a screen while driving, or because the user is blind).
      Synthesized as audio.
    <tr><td><dfn data-anolis-xref="attr-track-kind-keyword-chapters" id="attr-track-kind-keyword-chapters"><code>chapters</code></dfn>
     <td><dfn data-anolis-xref="attr-track-kind-chapters" id="attr-track-kind-chapters">Chapters</dfn>
     <td>
      Chapter titles, intended to be used for navigating the <a href="#media-resource">media resource</a>.
      Displayed as an interactive (potentially nested) list in the user agent's interface.
    <tr><td><dfn data-anolis-xref="attr-track-kind-keyword-metadata" id="attr-track-kind-keyword-metadata"><code>metadata</code></dfn>
     <td><dfn data-anolis-xref="attr-track-kind-metadata" id="attr-track-kind-metadata">Metadata</dfn>
     <td>
      Tracks intended for use from script.
      Not displayed by the user agent.
  </table><p>The attribute may be omitted. The <i>missing value default</i> is the <a data-anolis-xref="attr-track-kind-subtitles" href="#attr-track-kind-subtitles">subtitles</a> state.</p>

  <p>The <dfn data-anolis-xref="attr-track-src" id="attr-track-src"><code>src</code></dfn> attribute gives the address of the text
  track data. The value must be a <a href="infrastructure.html#valid-non-empty-url-potentially-surrounded-by-spaces">valid non-empty URL potentially surrounded by spaces</a>.
  This attribute must be present.</p>

  <div class="impl">

  <p>If the element has a <code data-anolis-xref="attr-track-src"><a href="#attr-track-src">src</a></code> attribute whose value is not the
  empty string and whose value, when the attribute was set, could be successfully <a data-anolis-xref="resolve a url" href="infrastructure.html#resolve-a-url">resolved</a> relative to the element, then the element's <dfn id="track-url">track
  URL</dfn> is the resulting <a href="infrastructure.html#absolute-url">absolute URL</a>. Otherwise, the element's <a href="#track-url">track
  URL</a> is the empty string.</p>

  </div>

  <p>If the element's <a href="#track-url">track URL</a> identifies a <a href="infrastructure.html#webvtt">WebVTT</a> resource, and the
  element's <code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code> attribute is not in the <a data-anolis-xref="attr-track-kind-metadata" href="#attr-track-kind-metadata">metadata</a> state, then the <a href="infrastructure.html#webvtt">WebVTT</a> file must be
  a <a href="infrastructure.html#webvtt-file-using-cue-text">WebVTT file using cue text</a>. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>

  <p>Furthermore, if the element's <a href="#track-url">track URL</a> identifies a <a href="infrastructure.html#webvtt">WebVTT</a> resource,
  and the element's <code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code> attribute is in the <a data-anolis-xref="attr-track-kind-chapters" href="#attr-track-kind-chapters">chapters</a> state, then the <a href="infrastructure.html#webvtt">WebVTT</a> file must be
  both a <a href="infrastructure.html#webvtt-file-using-chapter-title-text">WebVTT file using chapter title text</a> and a <a href="infrastructure.html#webvtt-file-using-only-nested-cues">WebVTT file using only nested
  cues</a>. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>

  <p>The <dfn data-anolis-xref="attr-track-srclang" id="attr-track-srclang"><code>srclang</code></dfn> attribute gives the language of
  the text track data. The value must be a valid BCP 47 language tag. This attribute must be present
  if the element's <code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code> attribute is in the <a data-anolis-xref="attr-track-kind-subtitles" href="#attr-track-kind-subtitles">subtitles</a> state. <a href="references.html#refsBCP47">[BCP47]</a></p>

  <div class="impl">

  <p>If the element has a <code data-anolis-xref="attr-track-srclang"><a href="#attr-track-srclang">srclang</a></code> attribute whose value is
  not the empty string, then the element's <dfn id="track-language">track language</dfn> is the value of the attribute.
  Otherwise, the element has no <a href="#track-language">track language</a>.</p>

  </div>

  <p>The <dfn data-anolis-xref="attr-track-label" id="attr-track-label"><code>label</code></dfn> attribute gives a user-readable
  title for the track. This title is used by user agents when listing <a data-anolis-xref="attr-track-kind-subtitles" href="#attr-track-kind-subtitles">subtitle</a>, <a data-anolis-xref="attr-track-kind-captions" href="#attr-track-kind-captions">caption</a>, and <a data-anolis-xref="attr-track-kind-descriptions" href="#attr-track-kind-descriptions">audio description</a> tracks in their user interface.</p>

  <p>The value of the <code data-anolis-xref="attr-track-label"><a href="#attr-track-label">label</a></code> attribute, if the attribute is
  present, must not be the empty string. Furthermore, there must not be two <code><a href="#the-track-element">track</a></code>
  element children of the same <a href="#media-element">media element</a> whose <code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code> attributes are in the same state, whose <code data-anolis-xref="attr-track-srclang"><a href="#attr-track-srclang">srclang</a></code> attributes are both missing or have values that
  represent the same language, and whose <code data-anolis-xref="attr-track-label"><a href="#attr-track-label">label</a></code> attributes are
  again both missing or both have the same value.</p>

  <div class="impl">

  <p>If the element has a <code data-anolis-xref="attr-track-label"><a href="#attr-track-label">label</a></code> attribute whose value is not
  the empty string, then the element's <dfn id="track-label">track label</dfn> is the value of the attribute.
  Otherwise, the element's <a href="#track-label">track label</a> is an empty string.</p>

  </div>

  <p>The <dfn data-anolis-xref="attr-track-default" id="attr-track-default"><code>default</code></dfn> attribute is a <a href="infrastructure.html#boolean-attribute">boolean
  attribute</a>, which, if specified, indicates that the track is to be enabled if the user's
  preferences do not indicate that another track would be more appropriate.</p>

  <p>Each <a href="#media-element">media element</a> must have no more than one <code><a href="#the-track-element">track</a></code> element child
  whose <code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code> attribute is in the <a data-anolis-xref="attr-track-kind-subtitles" href="#attr-track-kind-subtitles">subtitles</a> or <a data-anolis-xref="attr-track-kind-captions" href="#attr-track-kind-captions">captions</a> state and whose <code data-anolis-xref="attr-track-default"><a href="#attr-track-default">default</a></code> attribute is specified.</p>

  <p>Each <a href="#media-element">media element</a> must have no more than one <code><a href="#the-track-element">track</a></code> element child
  whose <code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code> attribute is in the <a data-anolis-xref="attr-track-kind-descriptions" href="#attr-track-kind-descriptions">description</a> state and whose <code data-anolis-xref="attr-track-default"><a href="#attr-track-default">default</a></code> attribute is specified.</p>

  <p>Each <a href="#media-element">media element</a> must have no more than one <code><a href="#the-track-element">track</a></code> element child
  whose <code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code> attribute is in the <a data-anolis-xref="attr-track-kind-chapters" href="#attr-track-kind-chapters">chapters</a> state and whose <code data-anolis-xref="attr-track-default"><a href="#attr-track-default">default</a></code> attribute is specified.</p>

  <p class="note">There is no limit on the number of <code><a href="#the-track-element">track</a></code> elements whose <code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code> attribute is in the <a data-anolis-xref="attr-track-kind-metadata" href="#attr-track-kind-metadata">metadata</a> state and whose <code data-anolis-xref="attr-track-default"><a href="#attr-track-default">default</a></code> attribute is specified.</p>

  <dl class="domintro"><dt><var data-anolis-xref="">track</var> . <code data-anolis-xref="dom-track-readyState"><a href="#dom-track-readystate">readyState</a></code></dt>
   <dd>
    <p>Returns the <a href="#text-track-readiness-state">text track readiness state</a>,
    represented by a number from the following list:</p>
    <dl><dt><var data-anolis-xref="">track</var> . <code data-anolis-xref="dom-track-NONE"><a href="#dom-track-none">NONE</a></code> (0)</dt>
     <dd>
      <p>The <a href="#text-track-not-loaded">text track not loaded</a> state.</p>
     </dd>
     <dt><var data-anolis-xref="">track</var> . <code data-anolis-xref="dom-track-LOADING"><a href="#dom-track-loading">LOADING</a></code> (1)</dt>
     <dd>
      <p>The <a href="#text-track-loading">text track loading</a> state.</p>
     </dd>
     <dt><var data-anolis-xref="">track</var> . <code data-anolis-xref="dom-track-LOADED"><a href="#dom-track-loaded">LOADED</a></code> (2)</dt>
     <dd>
      <p>The <a href="#text-track-loaded">text track loaded</a> state.</p>
     </dd>
     <dt><var data-anolis-xref="">track</var> . <code data-anolis-xref="dom-track-ERROR"><a href="#dom-track-error">ERROR</a></code> (3)</dt>
     <dd>
      <p>The <a href="#text-track-failed-to-load">text track failed to load</a> state.</p>
     </dd>
    </dl></dd>

   <dt><var data-anolis-xref="">track</var> . <code data-anolis-xref="dom-track-track"><a href="#dom-track-track">track</a></code></dt>

   <dd>

    <p>Returns the <code><a href="#texttrack">TextTrack</a></code> object corresponding to the <a href="#text-track">text track</a> of the <code><a href="#the-track-element">track</a></code> element.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-track-readyState" id="dom-track-readystate"><code>readyState</code></dfn> attribute must return the
  numeric value corresponding to the <a href="#text-track-readiness-state">text track readiness state</a> of the
  <code><a href="#the-track-element">track</a></code> element's <a href="#text-track">text track</a>, as defined by the following list:</p>

  <dl><dt><dfn data-anolis-xref="dom-track-NONE" id="dom-track-none"><code>NONE</code></dfn> (numeric value 0)</dt>
   <dd>The <a href="#text-track-not-loaded">text track not loaded</a> state.</dd>
   <dt><dfn data-anolis-xref="dom-track-LOADING" id="dom-track-loading"><code>LOADING</code></dfn> (numeric value 1)</dt>
   <dd>The <a href="#text-track-loading">text track loading</a> state.</dd>
   <dt><dfn data-anolis-xref="dom-track-LOADED" id="dom-track-loaded"><code>LOADED</code></dfn> (numeric value 2)</dt>
   <dd>The <a href="#text-track-loaded">text track loaded</a> state.</dd>
   <dt><dfn data-anolis-xref="dom-track-ERROR" id="dom-track-error"><code>ERROR</code></dfn> (numeric value 3)</dt>
   <dd>The <a href="#text-track-failed-to-load">text track failed to load</a> state.</dd>
  </dl><p>The <dfn data-anolis-xref="dom-track-track" id="dom-track-track"><code>track</code></dfn> IDL attribute must, on getting,
  return the <code><a href="#the-track-element">track</a></code> element's <a href="#text-track">text track</a>'s corresponding
  <code><a href="#texttrack">TextTrack</a></code> object.</p>

  <p>The <dfn data-anolis-xref="dom-track-src" id="dom-track-src"><code>src</code></dfn>, <dfn data-anolis-xref="dom-track-srclang" id="dom-track-srclang"><code>srclang</code></dfn>, <dfn data-anolis-xref="dom-track-label" id="dom-track-label"><code>label</code></dfn>, and <dfn data-anolis-xref="dom-track-default" id="dom-track-default"><code>default</code></dfn> IDL attributes must <a href="infrastructure.html#reflect">reflect</a> the
  respective content attributes of the same name. The <dfn data-anolis-xref="dom-track-kind" id="dom-track-kind"><code>kind</code></dfn> IDL attribute must <a href="infrastructure.html#reflect">reflect</a> the content
  attribute of the same name, <a href="infrastructure.html#limited-to-only-known-values">limited to only known values</a>.</p>

  </div>

  <div class="example">

   <p>This video has subtitles in several languages:</p>

   <pre>&lt;video src="brave.webm"&gt;
 &lt;track kind=subtitles src=brave.en.vtt srclang=en label="English"&gt;
 &lt;track kind=captions src=brave.en.hoh.vtt srclang=en label="English for the Hard of Hearing"&gt;
 &lt;track kind=subtitles src=brave.fr.vtt srclang=fr lang=fr label="Français"&gt;
 &lt;track kind=subtitles src=brave.de.vtt srclang=de lang=de label="Deutsch"&gt;
&lt;/video&gt;</pre>

   <p>(The <code data-anolis-xref="attr-lang"><a href="dom.html#attr-lang">lang</a></code> attributes on the last two describe the language of
   the <code data-anolis-xref="attr-track-label"><a href="#attr-track-label">label</a></code> attribute, not the language of the subtitles
   themselves. The language of the subtitles is given by the <code data-anolis-xref="attr-track-srclang"><a href="#attr-track-srclang">srclang</a></code> attribute.)</p>

  </div>

<!--TOPIC:Video and Audio-->
  <h4 id="media-elements"><span class="secno">4.7.10 </span>Media elements</h4>

  <p><dfn data-anolis-xref="media element" id="media-element">Media elements</dfn> (<code><a href="#the-audio-element">audio</a></code> and <code><a href="#the-video-element">video</a></code>, in
  this specification) implement the following interface:</p>

  <pre class="idl">enum <dfn id="canplaytypeenum">CanPlayTypeEnum</dfn> { "" /* <a data-anolis-xref="dom-CanPlayTypeEnum-nil" href="#dom-canplaytypeenum-nil">empty string</a> */, "<a data-anolis-xref="dom-CanPlayTypeEnum-maybe" href="#dom-canplaytypeenum-maybe">maybe</a>", "<a data-anolis-xref="dom-CanPlayTypeEnum-probably" href="#dom-canplaytypeenum-probably">probably</a>" };
interface <dfn id="htmlmediaelement">HTMLMediaElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {

  // error state
  readonly attribute <a href="#mediaerror">MediaError</a>? <a data-anolis-xref="dom-media-error" href="#dom-media-error">error</a>;

  // network state
           attribute DOMString <a data-anolis-xref="dom-media-src" href="#dom-media-src">src</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-media-currentSrc" href="#dom-media-currentsrc">currentSrc</a>;
           attribute DOMString <a data-anolis-xref="dom-media-crossOrigin" href="#dom-media-crossorigin">crossOrigin</a>;
  const unsigned short <a data-anolis-xref="dom-media-NETWORK_EMPTY" href="#dom-media-network_empty">NETWORK_EMPTY</a> = 0;
  const unsigned short <a data-anolis-xref="dom-media-NETWORK_IDLE" href="#dom-media-network_idle">NETWORK_IDLE</a> = 1;
  const unsigned short <a data-anolis-xref="dom-media-NETWORK_LOADING" href="#dom-media-network_loading">NETWORK_LOADING</a> = 2;
  const unsigned short <a data-anolis-xref="dom-media-NETWORK_NO_SOURCE" href="#dom-media-network_no_source">NETWORK_NO_SOURCE</a> = 3;
  readonly attribute unsigned short <a data-anolis-xref="dom-media-networkState" href="#dom-media-networkstate">networkState</a>;
           attribute DOMString <a data-anolis-xref="dom-media-preload" href="#dom-media-preload">preload</a>;
<!--v3BUF  readonly attribute double <span data-x="dom-media-bufferingRate">bufferingRate</span>;
  readonly attribute boolean <span data-x="dom-media-bufferingThrottled">bufferingThrottled</span>;
-->  readonly attribute <a href="#timeranges">TimeRanges</a> <a data-anolis-xref="dom-media-buffered" href="#dom-media-buffered">buffered</a>;
  void <a data-anolis-xref="dom-media-load" href="#dom-media-load">load</a>();
  <a href="#canplaytypeenum">CanPlayTypeEnum</a> <a data-anolis-xref="dom-navigator-canPlayType" href="#dom-navigator-canplaytype">canPlayType</a>(DOMString type);

  // ready state
  const unsigned short <a data-anolis-xref="dom-media-HAVE_NOTHING" href="#dom-media-have_nothing">HAVE_NOTHING</a> = 0;
  const unsigned short <a data-anolis-xref="dom-media-HAVE_METADATA" href="#dom-media-have_metadata">HAVE_METADATA</a> = 1;
  const unsigned short <a data-anolis-xref="dom-media-HAVE_CURRENT_DATA" href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a> = 2;
  const unsigned short <a data-anolis-xref="dom-media-HAVE_FUTURE_DATA" href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a> = 3;
  const unsigned short <a data-anolis-xref="dom-media-HAVE_ENOUGH_DATA" href="#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a> = 4;
  readonly attribute unsigned short <a data-anolis-xref="dom-media-readyState" href="#dom-media-readystate">readyState</a>;
  readonly attribute boolean <a data-anolis-xref="dom-media-seeking" href="#dom-media-seeking">seeking</a>;

  // playback state
           attribute double <a data-anolis-xref="dom-media-currentTime" href="#dom-media-currenttime">currentTime</a>;
  readonly attribute unrestricted double <a data-anolis-xref="dom-media-duration" href="#dom-media-duration">duration</a>;
  <span>Date</span> <a data-anolis-xref="dom-media-getStartDate" href="#dom-media-getstartdate">getStartDate</a>();
  readonly attribute boolean <a data-anolis-xref="dom-media-paused" href="#dom-media-paused">paused</a>;
           attribute double <a data-anolis-xref="dom-media-defaultPlaybackRate" href="#dom-media-defaultplaybackrate">defaultPlaybackRate</a>;
           attribute double <a data-anolis-xref="dom-media-playbackRate" href="#dom-media-playbackrate">playbackRate</a>;
  readonly attribute <a href="#timeranges">TimeRanges</a> <a data-anolis-xref="dom-media-played" href="#dom-media-played">played</a>;
  readonly attribute <a href="#timeranges">TimeRanges</a> <a data-anolis-xref="dom-media-seekable" href="#dom-media-seekable">seekable</a>;
  readonly attribute boolean <a data-anolis-xref="dom-media-ended" href="#dom-media-ended">ended</a>;
           attribute boolean <a data-anolis-xref="dom-media-autoplay" href="#dom-media-autoplay">autoplay</a>;
           attribute boolean <a data-anolis-xref="dom-media-loop" href="#dom-media-loop">loop</a>;
  void <a data-anolis-xref="dom-media-play" href="#dom-media-play">play</a>();
  void <a data-anolis-xref="dom-media-pause" href="#dom-media-pause">pause</a>();

  // media controller
           attribute DOMString <a data-anolis-xref="dom-media-mediaGroup" href="#dom-media-mediagroup">mediaGroup</a>;
           attribute <a href="#mediacontroller">MediaController</a>? <a data-anolis-xref="dom-media-controller" href="#dom-media-controller">controller</a>;

  // controls
           attribute boolean <a data-anolis-xref="dom-media-controls" href="#dom-media-controls">controls</a>;
           attribute double <a data-anolis-xref="dom-media-volume" href="#dom-media-volume">volume</a>;
           attribute boolean <a data-anolis-xref="dom-media-muted" href="#dom-media-muted">muted</a>;
           attribute boolean <a data-anolis-xref="dom-media-defaultMuted" href="#dom-media-defaultmuted">defaultMuted</a>;

  // tracks
  readonly attribute <a href="#audiotracklist">AudioTrackList</a> <a data-anolis-xref="dom-media-audioTracks" href="#dom-media-audiotracks">audioTracks</a>;
  readonly attribute <a href="#videotracklist">VideoTrackList</a> <a data-anolis-xref="dom-media-videoTracks" href="#dom-media-videotracks">videoTracks</a>;
  readonly attribute <a href="#texttracklist">TextTrackList</a> <a data-anolis-xref="dom-media-textTracks" href="#dom-media-texttracks">textTracks</a>;
  <a href="#texttrack">TextTrack</a> <a data-anolis-xref="dom-media-addTextTrack" href="#dom-media-addtexttrack">addTextTrack</a>(<a href="#texttrackkind">TextTrackKind</a> kind, optional DOMString label = "", optional DOMString language = "");
};</pre>

  <p>The <dfn id="media-element-attributes">media element attributes</dfn>, <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code>, <code data-anolis-xref="attr-media-crossorigin"><a href="#attr-media-crossorigin">crossorigin</a></code>, <code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code>, <code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code>,
  <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code>, <code data-anolis-xref="attr-media-loop"><a href="#attr-media-loop">loop</a></code>,
  <code data-anolis-xref="attr-media-muted"><a href="#attr-media-muted">muted</a></code>, and <code data-anolis-xref="attr-media-controls"><a href="#attr-media-controls">controls</a></code>, apply to all <a data-anolis-xref="media element" href="#media-element">media
  elements</a>. They are defined in this section.</p>

  <!-- proposed v2 (actually v3!) features:
    * frame forward / backwards / step(n) while paused
    * per-frame control: get current frame; set current frame
    * queue of content
      - pause current stream and insert content at front of queue to play immediately
      - pre-download another stream
      - add stream(s) to play at end of current stream
      - pause playback upon reaching a certain time
      - playlists, with the ability to get metadata out of them (e.g. xspf)
    * general meta data, implemented as getters (don't expose the whole thing)
      - getMetadata(key: string, language: string) => HTMLImageElement or string
      - onmetadatachanged (no context info)
      - general custom metadata store (ratings, etc.)
    * video: applying CSS filters
    * an event to notify people of when the video size changes
      (e.g. for chained Ogg streams of multiple independent videos)
      (or for when the current video track changes)
    * balance and 3D position audio
    * audio filters
    * audio synthesis (see <audio> section for use cases)
    * feedback to the script on how well the video is playing
       - frames per second?
       - skipped frames per second?
       - an event that reports playback difficulties?
       - an arbitrary quality metric?
    * bufferingRate/bufferingThrottled (see v3BUF)
    * events for when the user agent's controls get shown or hidden
      so that the author's controls can get away of the UA's
  -->

  <!-- v2 features that already have experimental implementations:
    * webkitPreservesPitch (for when playbackRate != 1.0)
  -->

  <p><a data-anolis-xref="media element" href="#media-element">Media elements</a> are used to present audio data, or video and
  audio data, to the user. This is referred to as <dfn id="media-data">media data</dfn> in this section, since this
  section applies equally to <a data-anolis-xref="media element" href="#media-element">media elements</a> for audio or for
  video.

  The term <dfn id="media-resource">media resource</dfn> is used to refer to the complete set of media data, e.g. the
  complete video file, or complete audio file.

  </p>

  <p>A <a href="#media-resource">media resource</a> can have multiple audio and video tracks. For the purposes of a
  <a href="#media-element">media element</a>, the video data of the <a href="#media-resource">media resource</a> is only that of the
  currently selected track (if any) given by the element's <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code> attribute, and the audio data of the <a href="#media-resource">media
  resource</a> is the result of mixing all the currently enabled tracks (if any) given by the
  element's <code data-anolis-xref="dom-media-audioTracks"><a href="#dom-media-audiotracks">audioTracks</a></code> attribute.</p>

  <p class="note">Both <code><a href="#the-audio-element">audio</a></code> and <code><a href="#the-video-element">video</a></code> elements can be used for both audio
  and video. The main difference between the two is simply that the <code><a href="#the-audio-element">audio</a></code> element has
  no playback area for visual content (such as video or captions), whereas the <code><a href="#the-video-element">video</a></code>
  element does.</p>

  <div class="impl">

  <p>Except where otherwise explicitly specified, the <a href="webappapis.html#task-source">task source</a> for all the tasks
  <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> in this section and its subsections is the <dfn id="media-element-event-task-source">media
  element event task source</dfn> of the <a href="#media-element">media element</a> in question.</p>

  </div>



  <h5 id="error-codes"><span class="secno">4.7.10.1 </span>Error codes</h5>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-error"><a href="#dom-media-error">error</a></code></dt>

   <dd>

    <p>Returns a <code><a href="#mediaerror">MediaError</a></code> object representing the current error state of the
    element.</p>

    <p>Returns null if there is no error.</p>

   </dd>

  </dl><div class="impl">

  <p>All <a data-anolis-xref="media element" href="#media-element">media elements</a> have an associated error status, which
  records the last error the element encountered since its <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection algorithm</a> was last invoked. The
  <dfn data-anolis-xref="dom-media-error" id="dom-media-error"><code>error</code></dfn> attribute, on getting, must return the
  <code><a href="#mediaerror">MediaError</a></code> object created for this last error, or null if there has not been an
  error.</p>

  </div>

  <pre class="idl">interface <dfn id="mediaerror">MediaError</dfn> {
  const unsigned short <a data-anolis-xref="dom-MediaError-MEDIA_ERR_ABORTED" href="#dom-mediaerror-media_err_aborted">MEDIA_ERR_ABORTED</a> = 1;
  const unsigned short <a data-anolis-xref="dom-MediaError-MEDIA_ERR_NETWORK" href="#dom-mediaerror-media_err_network">MEDIA_ERR_NETWORK</a> = 2;
  const unsigned short <a data-anolis-xref="dom-MediaError-MEDIA_ERR_DECODE" href="#dom-mediaerror-media_err_decode">MEDIA_ERR_DECODE</a> = 3;
  const unsigned short <a data-anolis-xref="dom-MediaError-MEDIA_ERR_SRC_NOT_SUPPORTED" href="#dom-mediaerror-media_err_src_not_supported">MEDIA_ERR_SRC_NOT_SUPPORTED</a> = 4;
  readonly attribute unsigned short <a data-anolis-xref="dom-MediaError-code" href="#dom-mediaerror-code">code</a>;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-error"><a href="#dom-media-error">error</a></code> . <code data-anolis-xref="dom-MediaError-code"><a href="#dom-mediaerror-code">code</a></code></dt>

   <dd>

    <p>Returns the current error's error code, from the list below.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-MediaError-code" id="dom-mediaerror-code"><code>code</code></dfn> attribute of a
  <code><a href="#mediaerror">MediaError</a></code> object must return the code for the error, which must be one of the
  following:</p>

  </div>

  <dl><dt><dfn data-anolis-xref="dom-MediaError-MEDIA_ERR_ABORTED" id="dom-mediaerror-media_err_aborted"><code>MEDIA_ERR_ABORTED</code></dfn> (numeric value 1)</dt>

   <dd>The fetching process for the <a href="#media-resource">media resource</a> was aborted by the user agent at the
   user's request.</dd>

   <dt><dfn data-anolis-xref="dom-MediaError-MEDIA_ERR_NETWORK" id="dom-mediaerror-media_err_network"><code>MEDIA_ERR_NETWORK</code></dfn> (numeric value 2)</dt>

   <dd>A network error of some description caused the user agent to stop fetching the <a href="#media-resource">media
   resource</a>, after the resource was established to be usable.</dd>

   <dt><dfn data-anolis-xref="dom-MediaError-MEDIA_ERR_DECODE" id="dom-mediaerror-media_err_decode"><code>MEDIA_ERR_DECODE</code></dfn> (numeric value 3)</dt>

   <dd>An error of some description occurred while decoding the <a href="#media-resource">media resource</a>, after
   the resource was established to be usable.</dd>

   <dt><dfn data-anolis-xref="dom-MediaError-MEDIA_ERR_SRC_NOT_SUPPORTED" id="dom-mediaerror-media_err_src_not_supported"><code>MEDIA_ERR_SRC_NOT_SUPPORTED</code></dfn> (numeric value 4)</dt>

   <dd>The <a href="#media-resource">media resource</a> indicated by the <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code>
   attribute was not suitable.</dd>

  </dl><h5 id="location-of-the-media-resource"><span class="secno">4.7.10.2 </span>Location of the media resource</h5>

  <p>The <dfn data-anolis-xref="attr-media-src" id="attr-media-src"><code>src</code></dfn> content attribute on <a data-anolis-xref="media
  element" href="#media-element">media elements</a> gives the address of the media resource (video, audio) to show. The
  attribute, if present, must contain a <a href="infrastructure.html#valid-non-empty-url-potentially-surrounded-by-spaces">valid non-empty URL potentially surrounded by
  spaces</a>.</p>

  <p>The <dfn data-anolis-xref="attr-media-crossorigin" id="attr-media-crossorigin"><code>crossorigin</code></dfn> content attribute on
  <a data-anolis-xref="media element" href="#media-element">media elements</a> is a <a href="infrastructure.html#cors-settings-attribute">CORS settings attribute</a>.</p>

  <div class="impl">

  <p>If a <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute of a <a href="#media-element">media element</a> is set
  or changed, the user agent must invoke the <a href="#media-element">media element</a>'s <a href="#media-element-load-algorithm">media element load
  algorithm</a>. (<em>Removing</em> the <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute does
  not do this, even if there are <code><a href="#the-source-element">source</a></code> elements present.)</p>

  <p>The <dfn data-anolis-xref="dom-media-src" id="dom-media-src"><code>src</code></dfn> IDL attribute on <a data-anolis-xref="media
  element" href="#media-element">media elements</a> must <a href="infrastructure.html#reflect">reflect</a> the content attribute of the same
  name.</p>

  <p>The <dfn data-anolis-xref="dom-media-crossOrigin" id="dom-media-crossorigin"><code>crossOrigin</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-media-crossorigin"><a href="#attr-media-crossorigin">crossorigin</a></code> content
  attribute, <a href="infrastructure.html#limited-to-only-known-values">limited to only known values</a>.</p>

  </div>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-currentSrc"><a href="#dom-media-currentsrc">currentSrc</a></code></dt>

   <dd>

    <p>Returns the address of the current <a href="#media-resource">media resource</a>.</p>

    <p>Returns the empty string when there is no <a href="#media-resource">media resource</a>.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-media-currentSrc" id="dom-media-currentsrc"><code>currentSrc</code></dfn> IDL attribute is initially
  the empty string. Its value is changed by the <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource
  selection algorithm</a> defined below.</p>

  </div>

  <p class="note">There are two ways to specify a <a href="#media-resource">media resource</a>, the <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute, or <code><a href="#the-source-element">source</a></code> elements. The attribute
  overrides the elements.</p>



  <h5 id="mime-types"><span class="secno">4.7.10.3 </span>MIME types</h5>

  <p>A <a href="#media-resource">media resource</a> can be described in terms of its <em>type</em>, specifically a
  <a href="infrastructure.html#mime-type">MIME type</a>, in some cases with a <code data-anolis-xref="">codecs</code> parameter. (Whether the
  <code data-anolis-xref="">codecs</code> parameter is allowed or not depends on the MIME type.) <a href="references.html#refsRFC6381">[RFC6381]</a></p>

  <p>Types are usually somewhat incomplete descriptions; for example "<code data-anolis-xref="">video/mpeg</code>" doesn't say anything except what the container type is, and even a
  type like "<code data-anolis-xref="">video/mp4; codecs="avc1.42E01E, mp4a.40.2"</code>" doesn't
  include information like the actual bitrate (only the maximum bitrate). Thus, given a type, a user
  agent can often only know whether it <em>might</em> be able to play media of that type (with
  varying levels of confidence), or whether it definitely <em>cannot</em> play media of that
  type.</p>

  <p><dfn id="a-type-that-the-user-agent-knows-it-cannot-render">A type that the user agent knows it cannot render</dfn> is one that describes a resource
  that the user agent definitely does not support, for example because it doesn't recognize the
  container type, or it doesn't support the listed codecs.</p>

  <p>The <a href="infrastructure.html#mime-type">MIME type</a> "<code>application/octet-stream</code>" with no parameters is never
  <a href="#a-type-that-the-user-agent-knows-it-cannot-render">a type that the user agent knows it cannot render</a>. User agents must treat that type
  as equivalent to the lack of any explicit <a data-anolis-xref="Content-Type" href="infrastructure.html#content-type">Content-Type metadata</a>
  when it is used to label a potential <a href="#media-resource">media resource</a>.</p>

  <p class="note">Only the <a href="infrastructure.html#mime-type">MIME type</a> "<code>application/octet-stream</code>" with no
  parameters is special-cased here; if any parameter appears with it, it will be treated just like
  any other <a href="infrastructure.html#mime-type">MIME type</a>. This is a deviation from the rule <!-- in RFC 2046, section 1,
  paragraph 3 --> that unknown <a href="infrastructure.html#mime-type">MIME type</a> parameters should be ignored.</p> <!-- but not
  really a "willful violation" since it's not that the types are not being ignored, just that before
  the type is handled as a type, there's a special case for a particular set of strings -->

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-navigator-canPlayType"><a href="#dom-navigator-canplaytype">canPlayType</a></code>(<var data-anolis-xref="">type</var>)</dt>

   <dd>

    <p>Returns the empty string (a negative response), "maybe", or "probably" based on how confident
    the user agent is that it can play media resources of the given type.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-navigator-canPlayType" id="dom-navigator-canplaytype"><code>canPlayType(<var data-anolis-xref="">type</var>)</code></dfn> method must return <dfn data-anolis-xref="dom-CanPlayTypeEnum-nil" id="dom-canplaytypeenum-nil">the
  empty string</dfn> if <var data-anolis-xref="">type</var> is <a href="#a-type-that-the-user-agent-knows-it-cannot-render">a type that the user agent knows it cannot
  render</a> or is the type "<code>application/octet-stream</code>"; it must return "<dfn data-anolis-xref="dom-CanPlayTypeEnum-probably" id="dom-canplaytypeenum-probably"><code>probably</code></dfn>" if the user agent is confident
  that the type represents a <a href="#media-resource">media resource</a> that it can render if used in with this
  <code><a href="#the-audio-element">audio</a></code> or <code><a href="#the-video-element">video</a></code> element; and it must return "<dfn data-anolis-xref="dom-CanPlayTypeEnum-maybe" id="dom-canplaytypeenum-maybe"><code>maybe</code></dfn>" otherwise. Implementors are encouraged
  to return "<code data-anolis-xref="dom-CanPlayTypeEnum-maybe"><a href="#dom-canplaytypeenum-maybe">maybe</a></code>" unless the type can be
  confidently established as being supported or not. Generally, a user agent should never return
  "<code data-anolis-xref="dom-CanPlayTypeEnum-probably"><a href="#dom-canplaytypeenum-probably">probably</a></code>" for a type that allows the <code data-anolis-xref="">codecs</code> parameter if that parameter is not present.</p>

  </div>

  <div class="example">

   <p>This script tests to see if the user agent supports a (fictional) new format to dynamically
   decide whether to use a <code><a href="#the-video-element">video</a></code> element or a plugin:</p>

   <pre>&lt;section id="video"&gt;
 &lt;p&gt;&lt;a href="playing-cats.nfv"&gt;Download video&lt;/a&gt;&lt;/p&gt;
&lt;/section&gt;
&lt;script&gt;
 var videoSection = document.getElementById('video');
 var videoElement = document.createElement('video');
 var support = videoElement.canPlayType('video/x-new-fictional-format;codecs="kittens,bunnies"');
 if (support != "probably" &amp;&amp; "New Fictional Video Plugin" in navigator.plugins) {
   // not confident of browser support
   // but we have a plugin
   // so use plugin instead
   videoElement = document.createElement("embed");
 } else if (support == "") {
   // no support from browser and no plugin
   // do nothing
   videoElement = null;
 }
 if (videoElement) {
   while (videoSection.hasChildNodes())
     videoSection.removeChild(videoSection.firstChild);
   videoElement.setAttribute("src", "playing-cats.nfv");
   videoSection.appendChild(videoElement);
 }
&lt;/script&gt;</pre>

  </div>

  <p class="note">The <code data-anolis-xref="attr-source-type"><a href="#attr-source-type">type</a></code> attribute of the
  <code><a href="#the-source-element">source</a></code> element allows the user agent to avoid downloading resources that use formats
  it cannot render.</p>


  <h5 id="network-states"><span class="secno">4.7.10.4 </span>Network states</h5>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code></dt>

   <dd>

    <p>Returns the current state of network activity for the element, from the codes in the list
    below.</p>

   </dd>

  </dl><div class="impl">

  <p>As <a data-anolis-xref="media element" href="#media-element">media elements</a> interact with the network, their current
  network activity is represented by the <dfn data-anolis-xref="dom-media-networkState" id="dom-media-networkstate"><code>networkState</code></dfn> attribute. On getting, it must
  return the current network state of the element, which must be one of the following values:</p>

  </div>

  <dl><dt><dfn data-anolis-xref="dom-media-NETWORK_EMPTY" id="dom-media-network_empty"><code>NETWORK_EMPTY</code></dfn> (numeric value 0)</dt>

   <dd>The element has not yet been initialized. All attributes are in their initial states.</dd>

   <dt><dfn data-anolis-xref="dom-media-NETWORK_IDLE" id="dom-media-network_idle"><code>NETWORK_IDLE</code></dfn> (numeric value 1)</dt>

   <dd>The element<span class="impl">'s <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource
   selection algorithm</a> is active and</span> has selected a <a data-anolis-xref="media
   resource" href="#media-resource">resource</a>, but it is not actually using the network at this time.</dd>

   <dt><dfn data-anolis-xref="dom-media-NETWORK_LOADING" id="dom-media-network_loading"><code>NETWORK_LOADING</code></dfn> (numeric value 2)</dt>

   <dd>The user agent is actively trying to download data.</dd>

   <dt><dfn data-anolis-xref="dom-media-NETWORK_NO_SOURCE" id="dom-media-network_no_source"><code>NETWORK_NO_SOURCE</code></dfn> (numeric value 3)</dt>

   <dd>The element<span class="impl">'s <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource
   selection algorithm</a> is active, but it</span> has not yet found a <a data-anolis-xref="media
   resource" href="#media-resource">resource</a> to use.</dd>

  </dl><div class="impl">

  <p>The <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection algorithm</a> defined
  below describes exactly when the <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code>
  attribute changes value and what events fire to indicate changes in this state.</p>

  </div>




  <h5 id="loading-the-media-resource"><span class="secno">4.7.10.5 </span>Loading the media resource</h5>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-load"><a href="#dom-media-load">load</a></code>()</dt>

   <dd>

    <p>Causes the element to reset and start selecting and loading a new <a href="#media-resource">media resource</a>
    from scratch.</p>

   </dd>

  </dl><div class="impl">

  <p>All <a data-anolis-xref="media element" href="#media-element">media elements</a> have an <dfn id="autoplaying-flag">autoplaying flag</dfn>,
  which must begin in the true state, and a <dfn id="delaying-the-load-event-flag">delaying-the-load-event flag</dfn>, which must
  begin in the false state. While the <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> is true, the element
  must <a href="syntax.html#delay-the-load-event">delay the load event</a> of its document.</p>

  <p>When the <dfn data-anolis-xref="dom-media-load" id="dom-media-load"><code>load()</code></dfn> method on a <a href="#media-element">media
  element</a> is invoked, the user agent must run the <a href="#media-element-load-algorithm">media element load
  algorithm</a>.</p>

  <p>The <dfn id="media-element-load-algorithm">media element load algorithm</dfn> consists of the following steps.</p>

  <ol><li><p>Abort any already-running instance of the <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection algorithm</a> for this
   element.</li>

   <li>

    <p>If there are any <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> from the <a href="#media-element">media
    element</a>'s <a href="#media-element-event-task-source">media element event task source</a> in one of the <a data-anolis-xref="task
    queue" href="webappapis.html#task-queue">task queues</a>, then remove those tasks.</p>

    <p>If there are any <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> that were <a data-anolis-xref="queue a
    task" href="webappapis.html#queue-a-task">queued</a> by the <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection
    algorithm</a> (including the algorithms that it itself invokes) for this same <a href="#media-element">media
    element</a> from the <a href="webappapis.html#dom-manipulation-task-source">DOM manipulation task source</a> in one of the <a data-anolis-xref="task queue" href="webappapis.html#task-queue">task queues</a>, then remove those tasks.</p>

    <p class="note">Basically, pending events and callbacks for the media element are discarded when
    the media element starts loading a new resource.</p>

   </li>

   <li><p>If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> is set to <code data-anolis-xref="dom-media-NETWORK_LOADING"><a href="#dom-media-network_loading">NETWORK_LOADING</a></code> or <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code>, <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a
   simple event</a> named <code data-anolis-xref="event-media-abort"><a href="#event-media-abort">abort</a></code> at the <a href="#media-element">media
   element</a>.</li>

   <li>

    <p>If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code>
    is not set to <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code>, then run these
    substeps:</p>

    <ol><li><p><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-emptied"><a href="#event-media-emptied">emptied</a></code> at the <a href="#media-element">media element</a>.</li>

     <li><p>If a fetching process is in progress for the <a href="#media-element">media
     element</a>, the user agent should stop it.</li>

     <!--(no point doing this, since we always call the resource selection algorithm synchronously
     at the end of this algorithm, and that switches it to NETWORK_NO_SOURCE and sets the flag)
     <li><p>Set the <code data-x="dom-media-networkState">networkState</code> attribute to <code
     data-x="dom-media-NETWORK_EMPTY">NETWORK_EMPTY</code>.</p></li>
     <li><p>Set the element's <span>show poster flag</span> to true.</p></li>
     -->

     <li><p><a href="#forget-the-media-element's-media-resource-specific-tracks">Forget the media element's media-resource-specific tracks</a>.</li>

     <li><p>If <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> is not set to <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>, then set it to that state.
     <!-- this can do the "report the controller state" thing -->
     </li>

     <li><p>If the <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute is false, then set it to
     true.</li>

     <li><p>If <code data-anolis-xref="dom-media-seeking"><a href="#dom-media-seeking">seeking</a></code> is true, set it to false.</li>

     <li>

      <p>Set the <a href="#current-playback-position">current playback position</a> to 0.</p>

      <p>Set the <a href="#official-playback-position">official playback position</a> to 0.</p>

      <p>If this changed the <a href="#official-playback-position">official playback position</a>, then <a href="webappapis.html#queue-a-task">queue a task</a>
      to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> at the <a href="#media-element">media element</a>.</p>

     </li>

     <li><p>Set the <a href="#initial-playback-position">initial playback position</a> to 0.</li>

     <li><p>Set the <a href="#timeline-offset">timeline offset</a> to Not-a-Number (NaN).</li>

     <li>

      <p>Update the <code data-anolis-xref="dom-media-duration"><a href="#dom-media-duration">duration</a></code> attribute to Not-a-Number
      (NaN).</p>

      <p class="note">The user agent <a href="#durationChange">will not</a> fire a <code data-anolis-xref="event-media-durationchange"><a href="#event-media-durationchange">durationchange</a></code> event for this particular change of
      the duration.</p>

     </li>

    </ol></li>

   <li><p>Set the <code data-anolis-xref="dom-media-playbackRate"><a href="#dom-media-playbackrate">playbackRate</a></code> attribute to the value of
   the <code data-anolis-xref="dom-media-defaultPlaybackRate"><a href="#dom-media-defaultplaybackrate">defaultPlaybackRate</a></code> attribute.</li>

   <li><p>Set the <code data-anolis-xref="dom-media-error"><a href="#dom-media-error">error</a></code> attribute to null and the
   <a href="#autoplaying-flag">autoplaying flag</a> to true.</li>

   <li><p>Invoke the <a href="#media-element">media element</a>'s <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection algorithm</a>.</li>

   <li>

    <p class="note">Playback of any previously playing <a href="#media-resource">media resource</a> for this element
    stops.</p>

   </li>

  </ol><p>The <dfn data-anolis-xref="concept-media-load-algorithm" id="concept-media-load-algorithm">resource selection algorithm</dfn> for a
  <a href="#media-element">media element</a> is as follows. This algorithm is always invoked synchronously, but one
  of the first steps in the algorithm is to return and continue running the remaining steps
  asynchronously, meaning that it runs in the background with scripts and other <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> running in parallel. In addition, this algorithm interacts
  closely with the <a href="webappapis.html#event-loop">event loop</a> mechanism; in particular, it has <a data-anolis-xref="synchronous
  section" href="webappapis.html#synchronous-section">synchronous sections</a> (which are triggered as part of the <a href="webappapis.html#event-loop">event loop</a>
  algorithm). Steps in such sections are marked with ⌛.</p>

  <ol><!-- precondition: networkState == NETWORK_EMPTY or we're coming straight from the algorithm above
                      (where setting it to empty is commented out) --><li><p>Set the element's <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute to
   the <code data-anolis-xref="dom-media-NETWORK_NO_SOURCE"><a href="#dom-media-network_no_source">NETWORK_NO_SOURCE</a></code> value.</li>

   <li><p>Set the element's <a href="#show-poster-flag">show poster flag</a> to true.</li>

   <li><p>Set the <a href="#media-element">media element</a>'s <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> to true
   (this <a data-anolis-xref="delay the load event" href="syntax.html#delay-the-load-event">delays the load event</a>).</li>

   <li><p>Asynchronously <a href="webappapis.html#await-a-stable-state">await a stable state</a>, allowing the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that invoked this algorithm to continue. The <a href="webappapis.html#synchronous-section">synchronous
   section</a> consists of all the remaining steps of this algorithm until the algorithm says the
   <a href="webappapis.html#synchronous-section">synchronous section</a> has ended. (Steps in <a data-anolis-xref="synchronous
   section" href="webappapis.html#synchronous-section">synchronous sections</a> are marked with ⌛.)</li>

   <li>

    <p>⌛ If the <a href="#media-element">media element</a>'s <a href="#blocked-on-parser">blocked-on-parser</a> flag is false,
    then <a href="#populate-the-list-of-pending-text-tracks">populate the list of pending text tracks</a>.</p>

   </li>

   <li>

    <p>⌛ If the <a href="#media-element">media element</a> has a <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code>
    attribute, then let <var data-anolis-xref="">mode</var> be <i data-anolis-xref="">attribute</i>.</p>

    <p>⌛ Otherwise, if the <a href="#media-element">media element</a> does not have a <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute but has a <code><a href="#the-source-element">source</a></code> element child, then
    let <var data-anolis-xref="">mode</var> be <i data-anolis-xref="">children</i> and let <var data-anolis-xref="">candidate</var>
    be the first such <code><a href="#the-source-element">source</a></code> element child in <a href="infrastructure.html#tree-order">tree order</a>.</p>

    <p>⌛ Otherwise the <a href="#media-element">media element</a> has neither a <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute nor a <code><a href="#the-source-element">source</a></code> element child: set the
    <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> to <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code><!-- no need to set the <span>show poster
    flag</span> to true since we set it up there already -->, and abort these steps; the
    <a href="webappapis.html#synchronous-section">synchronous section</a> ends.</p>

   </li>

   <li><p>⌛ Set the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> to <code data-anolis-xref="dom-media-NETWORK_LOADING"><a href="#dom-media-network_loading">NETWORK_LOADING</a></code>.</li>

   <li><p>⌛ <a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-loadstart"><a href="#event-media-loadstart">loadstart</a></code> at the <a href="#media-element">media element</a>.</li>

   <li>

    <p>If <var data-anolis-xref="">mode</var> is <i data-anolis-xref="">attribute</i>, then run these substeps:</p>

    <ol><li><p>⌛ If the <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code>
     attribute's value is the empty string, then end the <a href="webappapis.html#synchronous-section">synchronous section</a>, and jump
     down to the <i data-anolis-xref="">failed with attribute</i> step below.</li>

     <li><p>⌛ Let <var data-anolis-xref="">absolute URL</var> be the <a href="infrastructure.html#absolute-url">absolute URL</a> that
     would have resulted from <a data-anolis-xref="resolve a url" href="infrastructure.html#resolve-a-url">resolving</a> the <span>URL</span>
     specified by the <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute's value relative to the
     <a href="#media-element">media element</a> when the <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute was last
     changed.</p> <!-- i.e. changing xml:base or <base> after src="" has no effect -->

     <li><p>⌛ If <var data-anolis-xref="">absolute URL</var> was obtained successfully, set the <code data-anolis-xref="dom-media-currentSrc"><a href="#dom-media-currentsrc">currentSrc</a></code> attribute to <var data-anolis-xref="">absolute
     URL</var>.</li>

     <li><p>End the <a href="webappapis.html#synchronous-section">synchronous section</a>, continuing the remaining steps
     asynchronously.</li>

     <li><p>If <var data-anolis-xref="">absolute URL</var> was obtained successfully, run the <a data-anolis-xref="concept-media-load-resource" href="#concept-media-load-resource">resource fetch algorithm</a> with <var data-anolis-xref="">absolute
     URL</var>. If that algorithm returns without aborting <em>this</em> one, then the load
     failed.</li>

     <li>

      <p><i data-anolis-xref="">Failed with attribute</i>: Reaching this step indicates that the media resource
      failed to load or that the given <span>URL</span> could not be <a data-anolis-xref="resolve a
      url" href="infrastructure.html#resolve-a-url">resolved</a>. <a href="webappapis.html#queue-a-task">Queue a task</a> to run the following steps, using the
      <a href="webappapis.html#dom-manipulation-task-source">DOM manipulation task source</a>:</p>

      <ol><li><p>Set the <code data-anolis-xref="dom-media-error"><a href="#dom-media-error">error</a></code> attribute to a new
       <code><a href="#mediaerror">MediaError</a></code> object whose <code data-anolis-xref="dom-MediaError-code"><a href="#dom-mediaerror-code">code</a></code> attribute
       is set to <code data-anolis-xref="dom-MediaError-MEDIA_ERR_SRC_NOT_SUPPORTED"><a href="#dom-mediaerror-media_err_src_not_supported">MEDIA_ERR_SRC_NOT_SUPPORTED</a></code>.</li>

       <li><p><a href="#forget-the-media-element's-media-resource-specific-tracks">Forget the media element's media-resource-specific tracks</a>.</li>

       <li><p>Set the element's <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute
       to the <code data-anolis-xref="dom-media-NETWORK_NO_SOURCE"><a href="#dom-media-network_no_source">NETWORK_NO_SOURCE</a></code> value.</li>

       <li><p>Set the element's <a href="#show-poster-flag">show poster flag</a> to true.</li>

       <li><p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-media-error"><a href="#event-media-error">error</a></code> at
       the <a href="#media-element">media element</a>.</li>

       <li><p>Set the element's <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> to false. This stops <a data-anolis-xref="delay the load event" href="syntax.html#delay-the-load-event">delaying the load event</a>.</li>

      </ol></li>

     <li><p>Wait for the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> queued by the previous step to have
     executed.</li>

     <li><p>Abort these steps. Until the <code data-anolis-xref="dom-media-load"><a href="#dom-media-load">load()</a></code> method is
     invoked or the <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code> attribute is changed, the element won't
     attempt to load another resource.</li>
     <!-- it took its ball and went home, sulking. -->

    </ol><p>Otherwise, the <code><a href="#the-source-element">source</a></code> elements will be used; run these substeps:</p>

    <ol><li>

      <p>⌛ Let <var data-anolis-xref="">pointer</var> be a position defined by two adjacent nodes in the
      <a href="#media-element">media element</a>'s child list, treating the start of the list (before the first
      child in the list, if any) and end of the list (after the last child in the list, if any) as
      nodes in their own right. One node is the node before <var data-anolis-xref="">pointer</var>, and the
      other node is the node after <var data-anolis-xref="">pointer</var>. Initially, let <var data-anolis-xref="">pointer</var> be the position between the <var data-anolis-xref="">candidate</var> node and the
      next node, if there are any, or the end of the list, if it is the last node.</p>

      <p>As nodes are inserted and removed into the <a href="#media-element">media element</a>, <var data-anolis-xref="">pointer</var> must be updated as follows:</p>

      <dl><dt>If a new node is inserted between the two nodes that define <var data-anolis-xref="">pointer</var></dt>

       <dd>Let <var data-anolis-xref="">pointer</var> be the point between the node before <var data-anolis-xref="">pointer</var> and the new node. In other words, insertions at <var data-anolis-xref="">pointer</var> go after <var data-anolis-xref="">pointer</var>.</dd>

       <dt>If the node before <var data-anolis-xref="">pointer</var> is removed</dt>

       <dd>Let <var data-anolis-xref="">pointer</var> be the point between the node after <var data-anolis-xref="">pointer</var> and the node before the node after <var data-anolis-xref="">pointer</var>. In
       other words, <var data-anolis-xref="">pointer</var> doesn't move relative to the remaining nodes.</dd>

       <dt>If the node after <var data-anolis-xref="">pointer</var> is removed</dt>

       <dd>Let <var data-anolis-xref="">pointer</var> be the point between the node before <var data-anolis-xref="">pointer</var> and the node after the node before <var data-anolis-xref="">pointer</var>. Just
       as with the previous case, <var data-anolis-xref="">pointer</var> doesn't move relative to the remaining
       nodes.</dd>

      </dl><p>Other changes don't affect <var data-anolis-xref="">pointer</var>.</p>

     </li>

     <li><p>⌛ <i>Process candidate</i>: If <var data-anolis-xref="">candidate</var> does not have a
     <code data-anolis-xref="attr-source-src"><a href="#attr-source-src">src</a></code> attribute, or if its <code data-anolis-xref="attr-source-src"><a href="#attr-source-src">src</a></code> attribute's value is the empty string, then end the
     <a href="webappapis.html#synchronous-section">synchronous section</a>, and jump down to the <i data-anolis-xref="">failed with elements</i> step
     below.</li>

     <li><p>⌛ Let <var data-anolis-xref="">absolute URL</var> be the <a href="infrastructure.html#absolute-url">absolute URL</a> that
     would have resulted from <a data-anolis-xref="resolve a url" href="infrastructure.html#resolve-a-url">resolving</a> the <span>URL</span>
     specified by <var data-anolis-xref="">candidate</var>'s <code data-anolis-xref="attr-source-src"><a href="#attr-source-src">src</a></code>
     attribute's value relative to the <var data-anolis-xref="">candidate</var> when the <code data-anolis-xref="attr-source-src"><a href="#attr-source-src">src</a></code> attribute was last changed.</p> <!-- i.e. changing xml:base
     or <base> after src="" has no effect -->

     <li><p>⌛ If <var data-anolis-xref="">absolute URL</var> was not obtained successfully, then end the
     <a href="webappapis.html#synchronous-section">synchronous section</a>, and jump down to the <i data-anolis-xref="">failed with elements</i> step
     below.</li>

     <li><p>⌛ If <var data-anolis-xref="">candidate</var> has a <code data-anolis-xref="attr-source-type"><a href="#attr-source-type">type</a></code> attribute whose value, when parsed as a <a href="infrastructure.html#mime-type">MIME
     type</a> (including any codecs described by the <code data-anolis-xref="">codecs</code> parameter, for
     types that define that parameter), represents <a href="#a-type-that-the-user-agent-knows-it-cannot-render">a type that the user agent knows it cannot
     render</a>, then end the <a href="webappapis.html#synchronous-section">synchronous section</a>, and jump down to the <i data-anolis-xref="">failed with elements</i> step below.</li>

     <li><p>⌛ If <var data-anolis-xref="">candidate</var> has a <code data-anolis-xref="attr-source-media"><a href="#attr-source-media">media</a></code> attribute whose value does not <a data-anolis-xref="matches the
     environment" href="infrastructure.html#matches-the-environment">match the environment</a>, then end the <a href="webappapis.html#synchronous-section">synchronous section</a>, and
     jump down to the <i data-anolis-xref="">failed with elements</i> step below.</li>

     <li><p>⌛ Set the <code data-anolis-xref="dom-media-currentSrc"><a href="#dom-media-currentsrc">currentSrc</a></code> attribute to <var data-anolis-xref="">absolute URL</var>.</li>

     <li><p>End the <a href="webappapis.html#synchronous-section">synchronous section</a>, continuing the remaining steps
     asynchronously.</li>

     <li><p>Run the <a data-anolis-xref="concept-media-load-resource" href="#concept-media-load-resource">resource fetch algorithm</a> with
     <var data-anolis-xref="">absolute URL</var>. If that algorithm returns without aborting <em>this</em> one,
     then the load failed.</li>

     <li><p><i data-anolis-xref="">Failed with elements</i>: <a href="webappapis.html#queue-a-task">Queue a task</a>, using the <a href="webappapis.html#dom-manipulation-task-source">DOM
     manipulation task source</a>, to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-error">error</code> at the <var data-anolis-xref="">candidate</var> element.</li>

     <li><p>Asynchronously <a href="webappapis.html#await-a-stable-state">await a stable state</a>. The <a href="webappapis.html#synchronous-section">synchronous section</a>
     consists of all the remaining steps of this algorithm until the algorithm says the
     <a href="webappapis.html#synchronous-section">synchronous section</a> has ended. (Steps in <a data-anolis-xref="synchronous
     section" href="webappapis.html#synchronous-section">synchronous sections</a> are marked with ⌛.)</li>

     <li><p>⌛ <a href="#forget-the-media-element's-media-resource-specific-tracks">Forget the media element's media-resource-specific
     tracks</a>.</li>

     <li><p>⌛ <i data-anolis-xref="">Find next candidate</i>: Let <var data-anolis-xref="">candidate</var> be
     null.</li>

     <li><p>⌛ <i data-anolis-xref="">Search loop</i>: If the node after <var data-anolis-xref="">pointer</var> is
     the end of the list, then jump to the <i data-anolis-xref="">waiting</i> step below.</li>

     <li><p>⌛ If the node after <var data-anolis-xref="">pointer</var> is a <code><a href="#the-source-element">source</a></code> element,
     let <var data-anolis-xref="">candidate</var> be that element.</li>

     <li><p>⌛ Advance <var data-anolis-xref="">pointer</var> so that the node before <var data-anolis-xref="">pointer</var> is now the node that was after <var data-anolis-xref="">pointer</var>, and the node
     after <var data-anolis-xref="">pointer</var> is the node after the node that used to be after <var data-anolis-xref="">pointer</var>, if any.</li>

     <li><p>⌛ If <var data-anolis-xref="">candidate</var> is null, jump back to the <i data-anolis-xref="">search
     loop</i> step. Otherwise, jump back to the <i data-anolis-xref="">process candidate</i> step.</li>

     <li><p>⌛ <i data-anolis-xref="">Waiting</i>: Set the element's <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute to the <code data-anolis-xref="dom-media-NETWORK_NO_SOURCE"><a href="#dom-media-network_no_source">NETWORK_NO_SOURCE</a></code> value.</li>

     <li><p>⌛ Set the element's <a href="#show-poster-flag">show poster flag</a> to true.</li>

     <li><p>⌛ Set the element's <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> to false. This
     stops <a data-anolis-xref="delay the load event" href="syntax.html#delay-the-load-event">delaying the load event</a>.</li>

     <li><p>End the <a href="webappapis.html#synchronous-section">synchronous section</a>, continuing the remaining steps
     asynchronously.</li>

     <li><p>Wait until the node after <var data-anolis-xref="">pointer</var> is a node other than the end of
     the list. (This step might wait forever.)</li>

     <li><p>Asynchronously <a href="webappapis.html#await-a-stable-state">await a stable state</a>. The <a href="webappapis.html#synchronous-section">synchronous section</a>
     consists of all the remaining steps of this algorithm until the algorithm says the
     <a href="webappapis.html#synchronous-section">synchronous section</a> has ended. (Steps in <a data-anolis-xref="synchronous
     section" href="webappapis.html#synchronous-section">synchronous sections</a> are marked with ⌛.)</li>

     <li><p>⌛ Set the element's <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> back to true (this
     <a data-anolis-xref="delay the load event" href="syntax.html#delay-the-load-event">delays the load event</a> again, in case it hasn't been
     fired yet).</p>

     <li><p>⌛ Set the <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> back to <code data-anolis-xref="dom-media-NETWORK_LOADING"><a href="#dom-media-network_loading">NETWORK_LOADING</a></code>.</li>

     <li><p>⌛ Jump back to the <i data-anolis-xref="">find next candidate</i> step above.</li>

    </ol></li>

  </ol><p>The <dfn data-anolis-xref="concept-media-load-resource" id="concept-media-load-resource">resource fetch algorithm</dfn> for a <a href="#media-element">media
  element</a> and a given <a href="infrastructure.html#absolute-url">absolute URL</a> is as follows:</p>

  <ol><li><p>Let the <var data-anolis-xref="">current media resource</var> be the resource given by the
   <a href="infrastructure.html#absolute-url">absolute URL</a> passed to this algorithm. This is now the element's <a href="#media-resource">media
   resource</a>.</li>

   <li><p>Remove all <a data-anolis-xref="media-resource-specific text track" href="#media-resource-specific-text-track">media-resource-specific text
   tracks</a> from the <a href="#media-element">media element</a>'s <a href="#list-of-pending-text-tracks">list of pending text tracks</a>, if
   any.</p>

   <li><p>Optionally, run the following substeps. This is the expected behavior if the user agent
   intends to not attempt to fetch the resource until the user requests it explicitly (e.g. as a way
   to implement the <code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code> attribute's <code data-anolis-xref="attr-media-preload-none"><a href="#attr-media-preload-none">none</a></code> keyword).</p>

    <ol><li><p>Set the <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> to <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code>.</li>

     <li><p><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-suspend"><a href="#event-media-suspend">suspend</a></code> at the element, using the <a href="webappapis.html#dom-manipulation-task-source">DOM manipulation
     task source</a>.</li>

     <li><p>Set the element's <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> to false. This stops <a data-anolis-xref="delay the load event" href="syntax.html#delay-the-load-event">delaying the load event</a>.</li>

     <li><p>Wait for the task to be run.</li>

     <li><p>Wait for an implementation-defined event (e.g. the user requesting that the media
     element begin playback).</li>

     <li><p>Set the element's <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> back to true (this <a data-anolis-xref="delay the load event" href="syntax.html#delay-the-load-event">delays the load event</a> again, in case it hasn't been fired
     yet).</p>

     <li><p>Set the <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> to <code data-anolis-xref="dom-media-NETWORK_LOADING"><a href="#dom-media-network_loading">NETWORK_LOADING</a></code>.</li>

    </ol></li>

   <li>

    <p>Perform a <a href="infrastructure.html#potentially-cors-enabled-fetch">potentially CORS-enabled fetch</a><!--FETCH--> of the <var data-anolis-xref="">current media resource</var>'s <a href="infrastructure.html#absolute-url">absolute URL</a>, with the <i>mode</i> being
    the state of the <a href="#media-element">media element</a>'s <code data-anolis-xref="attr-media-crossorigin"><a href="#attr-media-crossorigin">crossorigin</a></code> content attribute, the <i data-anolis-xref="">origin</i>
    being the <a href="browsers.html#origin-0">origin</a> of the <a href="#media-element">media element</a>'s <code><a href="dom.html#document">Document</a></code>, and the
    <i>default origin behaviour</i> set to <i>taint</i>.</p>

    <p>The resource obtained in this fashion, if any, contains the <a href="#media-data">media data</a>. It can
    be <a href="infrastructure.html#cors-same-origin">CORS-same-origin</a> or <a href="infrastructure.html#cors-cross-origin">CORS-cross-origin</a>; this affects whether
    subtitles referenced in the <a href="#media-data">media data</a> are exposed in the API and, for
    <code><a href="#the-video-element">video</a></code> elements, whether a <code><a href="scripting-1.html#the-canvas-element">canvas</a></code> gets tainted when the video is drawn
    on it.</p>

    <p>While the load is not suspended (see below), every 350ms (±200ms) or for every byte
    received, whichever is <em>least</em> frequent, <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
    event</a> named <code data-anolis-xref="event-media-progress"><a href="#event-media-progress">progress</a></code> at the element.</p>

    <p>The <dfn id="stall-timeout">stall timeout</dfn> is a user-agent defined length of time, which should be about
    three seconds. When a <a href="#media-element">media element</a> that is actively attempting to obtain
    <a href="#media-data">media data</a> has failed to receive any data for a duration equal to the <a href="#stall-timeout">stall
    timeout</a>, the user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
    event</a> named <code data-anolis-xref="event-media-stalled"><a href="#event-media-stalled">stalled</a></code> at the element.</p>

    <p>User agents may allow users to selectively block or slow <a href="#media-data">media data</a> downloads.
    When a <a href="#media-element">media element</a>'s download has been blocked altogether, the user agent must
    act as if it was stalled (as opposed to acting as if the connection was closed). The rate of the
    download may also be throttled automatically by the user agent, e.g. to balance the download
    with other connections sharing the same bandwidth.</p>

    <p id="resourceSuspend">User agents may decide to not download more content at any time, e.g.
    after buffering five minutes of a one hour media resource, while waiting for the user to decide
    whether to play the resource or not, while waiting for user input in an interactive resource, or
    when the user navigates away from the page. When a <a href="#media-element">media element</a>'s download has
    been suspended, the user agent must <a href="webappapis.html#queue-a-task">queue a task</a>, using the <a href="webappapis.html#dom-manipulation-task-source">DOM manipulation
    task source</a>, to set the <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> to <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code> and <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named
    <code data-anolis-xref="event-media-suspend"><a href="#event-media-suspend">suspend</a></code> at the element. If and when downloading of the
    resource resumes, the user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to set the <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> to <code data-anolis-xref="dom-media-NETWORK_LOADING"><a href="#dom-media-network_loading">NETWORK_LOADING</a></code>. Between the queuing of these tasks,
    the load is suspended (so <code data-anolis-xref="event-media-progress"><a href="#event-media-progress">progress</a></code> events don't fire,
    as described above).</p>

    <p class="note">The <code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code> attribute provides a hint
    regarding how much buffering the author thinks is advisable, even in the absence of the <code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code> attribute.</p>

    <p>When a user agent decides to completely stall a download, e.g. if it is waiting until the
    user starts playback before downloading any further content, the element's
    <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> must be set to false. This stops <a data-anolis-xref="delay
    the load event" href="syntax.html#delay-the-load-event">delaying the load event</a>.</p>

    <p>The user agent may use whatever means necessary to fetch the resource (within the constraints
    put forward by this and other specifications); for example, reconnecting to the server in the
    face of network errors, using HTTP range retrieval requests, or switching to a streaming
    protocol. The user agent must consider a resource erroneous only if it has given up trying to
    fetch it.</p>

    <p class="critical">This specification does not currently say whether or how to check the MIME
    types of the media resources, or whether or how to perform file type sniffing using the actual
    file data. Implementors differ in their intentions on this matter and it is therefore unclear
    what the right solution is. In the absence of any requirement here, the HTTP specification's
    strict requirement to follow the Content-Type header prevails ("Content-Type specifies the media
    type of the underlying data." ... "If and only if the media type is not given by a Content-Type
    field, the recipient MAY attempt to guess the media type via inspection of its content
    and<!---->/<!---->or the name extension(s) of the URI used to identify the resource.").</p>

    <p>The <a href="webappapis.html#networking-task-source">networking task source</a> <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> to process
    the data as it is being fetched must, when appropriate, include the relevant substeps from the
    following list:</p>

    <dl class="switch"><dt>If the <a href="#media-data">media data</a> cannot be fetched at all, due to network errors, causing the
     user agent to give up trying to fetch the resource</dt>

     <dt>If the <a href="#media-data">media data</a> can be fetched but is found by inspection to be in an
     unsupported format, or can otherwise not be rendered at all</dt>

     <dd>

      <p>DNS errors, HTTP 4xx and 5xx errors (and equivalents in other protocols), and other fatal
      network errors that occur before the user agent has established whether the <var data-anolis-xref="">current media resource</var> is usable, as well as the file using an unsupported
      container format, or using unsupported codecs for all the data, must cause the user agent to
      execute the following steps:</p>

      <ol><li><p>The user agent should cancel the fetching process.</li>

       <li><p>Abort this subalgorithm, returning to the <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection algorithm</a>.</p>

      </ol></dd>


     <!-- insert content sniffing here if we want to define that -->
     <!-- (in practice I don't think that's necessary since it's not like you can do anything with
     the resource if you sniff it as the wrong type) -->


     <dt id="found-another-audio-track">If the <a href="#media-resource">media resource</a> is found to have an audio
     track</dt>

     <dd>

      <ol><li><p>Create an <code><a href="#audiotrack">AudioTrack</a></code> object to represent the audio track.</li>

       <li><p>Update the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-audioTracks"><a href="#dom-media-audiotracks">audioTracks</a></code> attribute's <code><a href="#audiotracklist">AudioTrackList</a></code>
       object with the new <code><a href="#audiotrack">AudioTrack</a></code> object.</li>

       <li><p><a data-anolis-xref="concept-event-fire" href="infrastructure.html#concept-event-fire">Fire</a> a <a data-anolis-xref="concept-events-trusted" href="infrastructure.html#concept-events-trusted">trusted</a> event with the name <code data-anolis-xref="event-media-addtrack"><a href="#event-media-addtrack">addtrack</a></code>, that does not bubble and is not cancelable, and
       that uses the <code><a href="#trackevent">TrackEvent</a></code> interface, with the <code data-anolis-xref="dom-TrackEvent-track"><a href="#dom-trackevent-track">track</a></code> attribute initialized to the new
       <code><a href="#audiotrack">AudioTrack</a></code> object, at this <code><a href="#audiotracklist">AudioTrackList</a></code> object.</li>

      </ol></dd>


     <dt id="found-another-video-track">If the <a href="#media-resource">media resource</a> is found to have a video
     track</dt>

     <dd>

      <ol><li><p>Create a <code><a href="#videotrack">VideoTrack</a></code> object to represent the video track.</li>

       <li><p>Update the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code> attribute's <code><a href="#videotracklist">VideoTrackList</a></code>
       object with the new <code><a href="#videotrack">VideoTrack</a></code> object.</li>

       <li><p><a data-anolis-xref="concept-event-fire" href="infrastructure.html#concept-event-fire">Fire</a> a <a data-anolis-xref="concept-events-trusted" href="infrastructure.html#concept-events-trusted">trusted</a> event with the name <code data-anolis-xref="event-media-addtrack"><a href="#event-media-addtrack">addtrack</a></code>, that does not bubble and is not cancelable, and that
       uses the <code><a href="#trackevent">TrackEvent</a></code> interface, with the <code data-anolis-xref="dom-TrackEvent-track"><a href="#dom-trackevent-track">track</a></code> attribute initialized to the new
       <code><a href="#videotrack">VideoTrack</a></code> object, at this <code><a href="#videotracklist">VideoTrackList</a></code> object.</li>

      </ol></dd>


     <dt id="getting-media-metadata">Once enough of the <a href="#media-data">media data</a> has been fetched to
     determine the duration of the <a href="#media-resource">media resource</a>, its dimensions, and other
     metadata</dt>

     <dd>

      <p>This indicates that the resource is usable. The user agent must follow these substeps:</p>

      <ol><li>

        <p><a href="#defineTimeline">Establish the media timeline</a> for the purposes of the <a href="#current-playback-position">current playback
        position</a>, the <a href="#earliest-possible-position">earliest possible position</a>, and the <a href="#initial-playback-position">initial playback
        position</a>, based on the <a href="#media-data">media data</a>.</p>

       </li>

       <li>

        <p>Update the <a href="#timeline-offset">timeline offset</a> to the date and time that corresponds to the zero
        time in the <a href="#media-timeline">media timeline</a> established in the previous step, if any. If no
        explicit time and date is given by the <a href="#media-resource">media resource</a>, the <a href="#timeline-offset">timeline
        offset</a> must be set to Not-a-Number (NaN).</p>

       </li>

       <li><p>Set the <a href="#current-playback-position">current playback position</a> and the <a href="#official-playback-position">official playback
       position</a> to the <a href="#earliest-possible-position">earliest possible position</a>.</li>

       <li>

        <p>Update the <code data-anolis-xref="dom-media-duration"><a href="#dom-media-duration">duration</a></code> attribute with the time of
        the last frame of the resource, if known, on the <a href="#media-timeline">media timeline</a> established
        above. If it is not known (e.g. a stream that is in principle infinite), update the <code data-anolis-xref="dom-media-duration"><a href="#dom-media-duration">duration</a></code> attribute to the value positive Infinity.</p>

        <p class="note">The user agent <a href="#durationChange">will</a> <a href="webappapis.html#queue-a-task">queue a task</a>
        to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-durationchange"><a href="#event-media-durationchange">durationchange</a></code> at the element at this point.</p>

       </li>

       <li>

        <p>For <code><a href="#the-video-element">video</a></code> elements, set the <code data-anolis-xref="dom-video-videoWidth"><a href="#dom-video-videowidth">videoWidth</a></code> and <code data-anolis-xref="dom-video-videoHeight"><a href="#dom-video-videoheight">videoHeight</a></code> attributes, and <a href="webappapis.html#queue-a-task">queue a task</a>
        to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-resize"><a href="#event-media-resize">resize</a></code> at
        the <a href="#media-element">media element</a>.</p>

        <p class="note">Further <code data-anolis-xref="event-media-resize"><a href="#event-media-resize">resize</a></code> events will be fired
        if the dimensions subsequently change.</p>

       </li>

       <li>

        <p>Set the <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute to <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code>.</p>

        <p class="note">A <code data-anolis-xref="event-media-loadedmetadata"><a href="#event-media-loadedmetadata">loadedmetadata</a></code> DOM event
        <a href="#fire-loadedmetadata">will be fired</a> as part of setting the <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute to a new value.</p>

        <!-- this can also do the "report the controller state" thing -->

       </li>

       <li><p>Let <var data-anolis-xref="">jumped</var> be false.</li>

       <li><p>If the <a href="#media-element">media element</a>'s <a href="#default-playback-start-position">default playback start position</a> is
       greater than zero, then <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seek</a> to that time, and let <var data-anolis-xref="">jumped</var> be true.</li>

       <li><p>Let the <a href="#media-element">media element</a>'s <a href="#default-playback-start-position">default playback
       start position</a> be zero.</li>

       <li>

        <p>If either the <a href="#media-resource">media resource</a> or the address of the <var data-anolis-xref="">current
        media resource</var> indicate a particular start time, then set the <a href="#initial-playback-position">initial playback
        position</a> to that time and, if <var data-anolis-xref="">jumped</var> is still false, <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seek</a> to that time and let <var data-anolis-xref="">jumped</var> be
        true.</p>

        <p class="example">For example, with media formats that support the <cite>Media Fragments
        URI</cite> fragment identifier syntax, the fragment identifier can be used to indicate a
        start position. <a href="references.html#refsMEDIAFRAG">[MEDIAFRAG]</a></p>

       </li>

       <li>

<!--CLEANUP-->
        <p>If either the <a href="#media-resource">media resource</a> or the address of the <var data-anolis-xref="">current
        media resource</var> indicate a particular set of audio or video tracks to enable,
        or if the user agent has information that would enable it to select specific tracks to improve the user's experience, then the
        relevant audio tracks must be enabled in the element's <code data-anolis-xref="dom-media-audioTracks"><a href="#dom-media-audiotracks">audioTracks</a></code> object, and, of the relevant video tracks,
        the one that is listed first in the element's <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code> object must be selected. All other tracks
        must be disabled.</p>

        <p class="example">This could again be triggered by <cite>Media Fragments URI</cite>
        fragment identifier syntax, but it could also be triggered e.g. by the user agent selecting
        a 5.1 surround sound audio track over a stereo audio track. <a href="references.html#refsMEDIAFRAG">[MEDIAFRAG]</a></p>

       </li>

       <li><p>If the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, then:
       if <var data-anolis-xref="">jumped</var> is true and the <a href="#initial-playback-position">initial playback position</a>,
       relative to the <a href="#current-media-controller">current media controller</a>'s timeline, is greater than the
       <a href="#current-media-controller">current media controller</a>'s <a href="#media-controller-position">media controller position</a>, then
       <a href="#seek-the-media-controller">seek the media controller</a> to the <a href="#media-element">media element</a>'s <a href="#initial-playback-position">initial
       playback position</a>, relative to the <a href="#current-media-controller">current media controller</a>'s timeline;
       otherwise, <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seek</a> the <a href="#media-element">media element</a> to the
       <a href="#media-controller-position">media controller position</a>, relative to the <a href="#media-element">media element</a>'s
       timeline.</li> <!-- i.e. "bring the media element up to speed with its new media
       controller" --> <!-- we do this because otherwise the fragment identifier initial position is
       lost. Basically this means that if you are attached to a media controller when you load your
       resource, and you have a fragment identifier with a start time, you'll jump the media
       controller to that time if it's not already past it. (So if there are several, you'll jump
       the media controller to the furthest one in the timeline.) --> <!-- note that this can also
       trigger "report the controller state" since it can change the element's readyState -->

      </ol><p>Once the <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute reaches <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code>, <a href="#fire-loadeddata">after
      the <code data-anolis-xref="event-media-loadeddata">loadeddata</code> event has been fired</a>, set the
      element's <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> to false. This stops <a data-anolis-xref="delay
      the load event" href="syntax.html#delay-the-load-event">delaying the load event</a>.</p>

      <p class="note">A user agent that is attempting to reduce network usage while still fetching
      the metadata for each <a href="#media-resource">media resource</a> would also stop buffering at this point,
      following <a href="#resourceSuspend">the rules described previously</a>, which involve the
      <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute switching to the <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code> value and a <code data-anolis-xref="event-suspend">suspend</code> event firing.</p>

      <p class="note">The user agent is <em>required</em> to determine the duration of the
      <a href="#media-resource">media resource</a> and go through this step before playing.</p> <!-- actually defined
      in the 'duration' section -->

     </dd>


     <dt>Once the entire <a href="#media-resource">media resource</a> has been <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetched</a>
     (but potentially before any of it has been decoded)</dt>

     <dd>

      <p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-media-progress"><a href="#event-media-progress">progress</a></code>
      at the <a href="#media-element">media element</a>.</p>

      <p>Set the <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> to <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code> and <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named
      <code data-anolis-xref="event-media-suspend"><a href="#event-media-suspend">suspend</a></code> at the <a href="#media-element">media element</a>.</p>

      <p>If the user agent ever discards any <a href="#media-data">media data</a> and then needs to resume the
      network activity to obtain it again, then it must <a href="webappapis.html#queue-a-task">queue a task</a> to set the <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> to <code data-anolis-xref="dom-media-NETWORK_LOADING"><a href="#dom-media-network_loading">NETWORK_LOADING</a></code>.</p>

      <p class="note">If the user agent can keep the <a href="#media-resource">media resource</a> loaded, then the
      algorithm will continue to its final step below, which aborts the algorithm.</p><!-- see FINAL
      STEP below -->

     </dd>


     <dt>If the connection is interrupted after some <a href="#media-data">media data</a> has been received,
     causing the user agent to give up trying to fetch the resource</dt>

     <dd>

      <p>Fatal network errors that occur after the user agent has established whether the <var data-anolis-xref="">current media resource</var> is usable (i.e. once the <a href="#media-element">media element</a>'s
      <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute is no longer <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>) must cause the user agent to execute the
      following steps:</p>

      <ol><li><p>The user agent should cancel the fetching process.</li>

       <li><p>Set the <code data-anolis-xref="dom-media-error"><a href="#dom-media-error">error</a></code> attribute to a new
       <code><a href="#mediaerror">MediaError</a></code> object whose <code data-anolis-xref="dom-MediaError-code"><a href="#dom-mediaerror-code">code</a></code> attribute
       is set to <code data-anolis-xref="dom-MediaError-MEDIA_ERR_NETWORK"><a href="#dom-mediaerror-media_err_network">MEDIA_ERR_NETWORK</a></code>.</li>

       <li><p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-media-error"><a href="#event-media-error">error</a></code> at
       the <a href="#media-element">media element</a>.</li>

       <li><p>Set the element's <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute
       to the <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code> value.</li>

       <li><p>Set the element's <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> to false. This stops <a data-anolis-xref="delay the load event" href="syntax.html#delay-the-load-event">delaying the load event</a>.</li>

       <li><p>Abort the overall <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection
       algorithm</a>.</li>

      </ol></dd>


     <dt id="fatal-decode-error">If the <a href="#media-data">media data</a> is corrupted</dt>

     <dd>

      <p>Fatal errors in decoding the <a href="#media-data">media data</a> that occur after the user agent has
      established whether the <var data-anolis-xref="">current media resource</var> is usable must cause the
      user agent to execute the following steps:</p>

      <ol><li><p>The user agent should cancel the fetching process.</li>

       <li><p>Set the <code data-anolis-xref="dom-media-error"><a href="#dom-media-error">error</a></code> attribute to a new
       <code><a href="#mediaerror">MediaError</a></code> object whose <code data-anolis-xref="dom-MediaError-code"><a href="#dom-mediaerror-code">code</a></code> attribute
       is set to <code data-anolis-xref="dom-MediaError-MEDIA_ERR_DECODE"><a href="#dom-mediaerror-media_err_decode">MEDIA_ERR_DECODE</a></code>.</li>

       <li><p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-media-error"><a href="#event-media-error">error</a></code> at
       the <a href="#media-element">media element</a>.</li>

       <li>

        <p>If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code>
        attribute has a value equal to <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>, set
        the element's <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute to the
        <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code> value, set the element's
        <a href="#show-poster-flag">show poster flag</a> to true, and <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-emptied"><a href="#event-media-emptied">emptied</a></code> at the element.</p>

        <p>Otherwise, set the element's <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code>
        attribute to the <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code> value.</p>

       </li>

       <li><p>Set the element's <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> to false. This stops <a data-anolis-xref="delay the load event" href="syntax.html#delay-the-load-event">delaying the load event</a>.</li>

       <li><p>Abort the overall <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection
       algorithm</a>.</li>

      </ol></dd>


     <dt>If the <a href="#media-data">media data</a> fetching process is aborted by the user</dt>

     <dd>

      <p>The fetching process is aborted by the user, e.g. because the user 
      pressed a "stop" button, the user agent must execute the following steps. These steps are not
      followed if the <code data-anolis-xref="dom-media-load"><a href="#dom-media-load">load()</a></code> method itself is invoked while
      these steps are running, as the steps above handle that particular kind of abort.</p>

      <ol><li><p>The user agent should cancel the fetching process.</li>

       <li><p>Set the <code data-anolis-xref="dom-media-error"><a href="#dom-media-error">error</a></code> attribute to a new
       <code><a href="#mediaerror">MediaError</a></code> object whose <code data-anolis-xref="dom-MediaError-code"><a href="#dom-mediaerror-code">code</a></code> attribute
       is set to <code data-anolis-xref="dom-MediaError-MEDIA_ERR_ABORTED"><a href="#dom-mediaerror-media_err_aborted">MEDIA_ERR_ABORTED</a></code>.</li>

       <li><p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-media-abort"><a href="#event-media-abort">abort</a></code> at
       the <a href="#media-element">media element</a>.</li>

       <li>

        <p>If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code>
        attribute has a value equal to <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>, set
        the element's <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute to the
        <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code> value, set the element's
        <a href="#show-poster-flag">show poster flag</a> to true, and <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-emptied"><a href="#event-media-emptied">emptied</a></code> at the element.</p>

        <p>Otherwise, set the element's <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code>
        attribute to the <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code> value.</p>

       </li>

       <li><p>Set the element's <a href="#delaying-the-load-event-flag">delaying-the-load-event flag</a> to false. This stops <a data-anolis-xref="delay the load event" href="syntax.html#delay-the-load-event">delaying the load event</a>.</li>

       <li><p>Abort the overall <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection
       algorithm</a>.</li>

      </ol></dd>


     <dt id="non-fatal-media-error">If the <a href="#media-data">media data</a> can be fetched but has non-fatal
     errors or uses, in part, codecs that are unsupported, preventing the user agent from rendering
     the content completely correctly but not preventing playback altogether</dt>

     <dd>

      <p>The server returning data that is partially usable but cannot be optimally rendered must
      cause the user agent to render just the bits it can handle, and ignore the rest.</p>

      <!-- v2: fire a 'warning' event and set the 'error' flag to 'MEDIA_ERR_SUBOPTIMAL' or something -->

     </dd>


     <dt id="found-a-media-resource-specific-timed-track">If the <a href="#media-resource">media resource</a> is
     found to declare a <a href="#media-resource-specific-text-track">media-resource-specific text track</a> that the user agent
     supports</dt>

     <dd>

      <p>If the <a href="#media-data">media data</a> is <a href="infrastructure.html#cors-same-origin">CORS-same-origin</a>, run the <a href="#steps-to-expose-a-media-resource-specific-text-track">steps to
      expose a media-resource-specific text track</a> with the relevant data.</p>

      <p class="note">Cross-origin videos do not expose their subtitles, since that would allow
      attacks such as hostile sites reading subtitles from confidential videos on a user's
      intranet.</p>

     </dd>

    </dl><p>When the <a href="webappapis.html#networking-task-source">networking task source</a> has <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> the
    last <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> as part of <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching</a> the
    <a href="#media-resource">media resource</a> (i.e. once the download has completed), if the fetching process
    completes without errors, including decoding the media data, and if all of the data is available
    to the user agent without network access, then, the user agent must move on to the next step.
    This might never happen, e.g. when streaming an infinite resource such as Web radio, or if the
    resource is longer than the user agent's ability to cache data.</p>

    <p>While the user agent might still need network access to obtain parts of the <a href="#media-resource">media
    resource</a>, the user agent must remain on this step.</p>

    <p class="example">For example, if the user agent has discarded the first half of a video, the
    user agent will remain at this step even once the <a data-anolis-xref="ended playback" href="#ended-playback">playback has
    ended</a>, because there is always the chance the user will seek back to the start. In fact,
    in this situation, once <a data-anolis-xref="ended playback" href="#ended-playback">playback has ended</a>, the user agent
    will end up firing a <code data-anolis-xref="event-media-suspend"><a href="#event-media-suspend">suspend</a></code> event, as described
    earlier.</p>

   </li>

   <!-- this step is mentioned above, search for "FINAL STEP" -->
   <li><p>If the user agent ever reaches this step (which can only happen if the entire resource
   gets loaded and kept available): abort the overall <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection algorithm</a>.</li>

  </ol><p>When a <a href="#media-element">media element</a> is to <dfn id="forget-the-media-element's-media-resource-specific-tracks">forget the media element's media-resource-specific
  tracks</dfn>, the user agent must remove from the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text
  tracks</a> all the <a data-anolis-xref="media-resource-specific text track" href="#media-resource-specific-text-track">media-resource-specific
  text tracks</a>, then empty the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-audioTracks"><a href="#dom-media-audiotracks">audioTracks</a></code> attribute's <code><a href="#audiotracklist">AudioTrackList</a></code> object,
  then empty the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code>
  attribute's <code><a href="#videotracklist">VideoTrackList</a></code> object. No events (in particular, no <code data-anolis-xref="event-media-removetrack"><a href="#event-media-removetrack">removetrack</a></code> events) are fired as part of this; the <code data-anolis-xref="event-media-error"><a href="#event-media-error">error</a></code> and <code data-anolis-xref="event-media-emptied"><a href="#event-media-emptied">emptied</a></code>
  events, fired by the algorithms that invoke this one, can be used instead.</p>

  </div>

  <hr><p>The <dfn data-anolis-xref="attr-media-preload" id="attr-media-preload"><code>preload</code></dfn> attribute is an <a href="infrastructure.html#enumerated-attribute">enumerated
  attribute</a>. The following table lists the keywords and states for the attribute — the
  keywords in the left column map to the states in the cell in the second column on the same row as
  the keyword. The attribute can be changed even once the <a href="#media-resource">media resource</a> is being
  buffered or played; the descriptions in the table below are to be interpreted with that in
  mind.</p>

  <table><thead><tr><th> Keyword
     <th> State
     <th> Brief description
   <tbody><tr><td><dfn data-anolis-xref="attr-media-preload-none" id="attr-media-preload-none"><code>none</code></dfn>
     <td><dfn data-anolis-xref="attr-media-preload-none-state" id="attr-media-preload-none-state">None</dfn>
     <td>Hints to the user agent that either the author does not expect the user to need the media resource, or that the server wants to minimize unnecessary traffic.
         This state does not provide a hint regarding how aggressively to actually download the media resource if buffering starts anyway (e.g. once the user hits "play").
    <tr><td><dfn data-anolis-xref="attr-media-preload-metadata" id="attr-media-preload-metadata"><code>metadata</code></dfn>
     <td><dfn data-anolis-xref="attr-media-preload-metadata-state" id="attr-media-preload-metadata-state">Metadata</dfn>
     <td>Hints to the user agent that the author does not expect the user to need the media resource, but that fetching the resource metadata (dimensions, track list, duration, etc), and maybe even the first few frames, is reasonable. If the user agent precisely fetches no more than the metadata, then the <a href="#media-element">media element</a> will end up with its <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute set to <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code>; typically though, some frames will be obtained as well and it will probably be <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> or <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code>.
         When the media resource is playing, hints to the user agent that bandwidth is to be considered scarce, e.g. suggesting throttling the download so that the media data is obtained at the slowest possible rate that still maintains consistent playback.
    <tr><td><dfn data-anolis-xref="attr-media-preload-auto" id="attr-media-preload-auto"><code>auto</code></dfn>
     <td><dfn data-anolis-xref="attr-media-preload-auto-state" id="attr-media-preload-auto-state">Automatic</dfn>
     <td>Hints to the user agent that the user agent can put the user's needs first without risk to the server, up to and including optimistically downloading the entire resource.
  </table><p>The empty string is also a valid keyword, and maps to the <a data-anolis-xref="attr-media-preload-auto-state" href="#attr-media-preload-auto-state">Automatic</a> state. The attribute's <i>missing value
  default</i> is user-agent defined, though the <a data-anolis-xref="attr-media-preload-metadata-state" href="#attr-media-preload-metadata-state">Metadata</a> state is suggested as a compromise
  between reducing server load and providing an optimal user experience.</p>

  <p class="note">Authors might switch the attribute from "<code data-anolis-xref="attr-media-preload-none"><a href="#attr-media-preload-none">none</a></code>" or "<code data-anolis-xref="attr-media-preload-metadata"><a href="#attr-media-preload-metadata">metadata</a></code>" to "<code data-anolis-xref="attr-media-preload-auto"><a href="#attr-media-preload-auto">auto</a></code>" dynamically once the user begins playback. For
  example, on a page with many videos this might be used to indicate that the many videos are not to
  be downloaded unless requested, but that once one <em>is</em> requested it is to be downloaded
  aggressively.</p>

  <div class="impl">

  <p>The <code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code> attribute is intended to provide a hint to
  the user agent about what the author thinks will lead to the best user experience. The attribute
  may be ignored altogether, for example based on explicit user preferences or based on the
  available connectivity.</p>

  <p>The <dfn data-anolis-xref="dom-media-preload" id="dom-media-preload"><code>preload</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the content attribute of the same name, <a href="infrastructure.html#limited-to-only-known-values">limited to only known
  values</a>.</p>

  </div>

  <p class="note">The <code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code> attribute can override the
  <code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code> attribute (since if the media plays, it naturally
  has to buffer first, regardless of the hint given by the <code data-anolis-xref="attr-media-preload"><a href="#attr-media-preload">preload</a></code> attribute). Including both is not an error, however.</p>

  <hr><!--v3BUF (when readding this, also add a domintro block)
  <p>The <dfn data-x="dom-media-bufferingRate"><code>bufferingRate</code></dfn> attribute must return
  the average number of bits received per second for the current download over the past few seconds.
  If there is no download in progress, the attribute must return 0.</p>

  <p>The <dfn data-x="dom-media-bufferingThrottled"><code>bufferingThrottled</code></dfn> attribute
  must return true if the user agent is intentionally throttling the bandwidth used by the download
  (including when throttling to zero to pause the download altogether), and false otherwise.</p>

  <hr>
--><dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-buffered"><a href="#dom-media-buffered">buffered</a></code></dt>

   <dd>

    <p>Returns a <code><a href="#timeranges">TimeRanges</a></code> object that represents the ranges of the <a href="#media-resource">media
    resource</a> that the user agent has buffered.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-media-buffered" id="dom-media-buffered"><code>buffered</code></dfn> attribute must return a new
  static <a href="#normalized-timeranges-object">normalized <code>TimeRanges</code> object</a> that represents the ranges of the
  <a href="#media-resource">media resource</a>, if any, that the user agent has buffered, at the time the attribute
  is evaluated. Users agents must accurately determine the ranges available, even for media streams
  where this can only be determined by tedious inspection.</p>

  <p class="note">Typically this will be a single range anchored at the zero point, but if, e.g. the
  user agent uses HTTP range requests in response to seeking, then there could be multiple
  ranges.</p>

  <p>User agents may discard previously buffered data.</p>

  <p class="note">Thus, a time position included within a range of the objects return by the <code data-anolis-xref="dom-media-buffered"><a href="#dom-media-buffered">buffered</a></code> attribute at one time can end up being not included in
  the range(s) of objects returned by the same attribute at later times.</p>

  </div>



  <h5 id="offsets-into-the-media-resource"><span class="secno">4.7.10.6 </span>Offsets into the media resource</h5>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-duration"><a href="#dom-media-duration">duration</a></code></dt>

   <dd>

    <p>Returns the length of the <a href="#media-resource">media resource</a>, in seconds, assuming that the start of
    the <a href="#media-resource">media resource</a> is at time zero.</p>

    <p>Returns NaN if the duration isn't available.</p>

    <p>Returns Infinity for unbounded streams.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-currentTime"><a href="#dom-media-currenttime">currentTime</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns the <a href="#official-playback-position">official playback position</a>, in seconds.</p>

    <p>Can be set, to seek to the given time.</p>

    <p>Will throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception if there is no selected <a href="#media-resource">media
    resource</a> or if there is a <a href="#current-media-controller">current media controller</a>.</p>

   </dd>

  </dl><div class="impl">

  <p>A <a href="#media-resource">media resource</a> has a <dfn id="media-timeline">media timeline</dfn> that maps times (in seconds) to
  positions in the <a href="#media-resource">media resource</a>. The origin of a timeline is its earliest defined
  position. The duration of a timeline is its last defined position.</p>

  <p><dfn data-anolis-xref="establish the media timeline" id="defineTimeline">Establishing the media
  timeline</dfn>: If the <a href="#media-resource">media resource</a> somehow specifies an explicit timeline whose
  origin is not negative (i.e. gives each frame a specific time offset and gives the first frame a
  zero or positive offset), then the <a href="#media-timeline">media timeline</a> should be that timeline. (Whether
  the <a href="#media-resource">media resource</a> can specify a timeline or not depends on the <a data-anolis-xref="media
  resource" href="#media-resource">media resource's</a> format.) If the <a href="#media-resource">media resource</a> specifies an
  explicit start time <em>and date</em>, then that time and date should be considered the zero point
  in the <a href="#media-timeline">media timeline</a>; the <a href="#timeline-offset">timeline offset</a> will be the time and date,
  exposed using the <code data-anolis-xref="dom-media-getStartDate"><a href="#dom-media-getstartdate">getStartDate()</a></code> method.</p>

  <p>If the <a href="#media-resource">media resource</a> has a discontinuous timeline, the user agent must extend the
  timeline used at the start of the resource across the entire resource, so that the <a href="#media-timeline">media
  timeline</a> of the <a href="#media-resource">media resource</a> increases linearly starting from the
  <a href="#earliest-possible-position">earliest possible position</a> (as defined below), even if the underlying <a href="#media-data">media
  data</a> has out-of-order or even overlapping time codes.</p>

  <p class="example">For example, if two clips have been concatenated into one video file, but the
  video format exposes the original times for the two clips, the video data might expose a timeline
  that goes, say, 00:15..00:29 and then 00:05..00:38. However, the user agent would not expose those
  times; it would instead expose the times as 00:15..00:29 and 00:29..01:02, as a single video.</p>

  <p>In the rare case of a <a href="#media-resource">media resource</a> that does not have an explicit timeline, the
  zero time on the <a href="#media-timeline">media timeline</a> should correspond to the first frame of the
  <a href="#media-resource">media resource</a>. In the even rarer case of a <a href="#media-resource">media resource</a> with no
  explicit timings of any kind, not even frame durations, the user agent must itself determine the
  time for each frame in a user-agent-defined manner.
  <a class="fingerprint" data-anolis-xref="fingerprinting vector" href="introduction.html#fingerprinting-vector"><img alt="(This is a fingerprinting vector.)" height="21" src="images/fingerprint.png" width="15"></a>
  </p>

  <p class="note">An example of a file format with no explicit timeline but with explicit frame
  durations is the Animated GIF format. An example of a file format with no explicit timings at all
  is the JPEG-push format (<code><a href="iana.html#multipart/x-mixed-replace">multipart/x-mixed-replace</a></code> with JPEG frames, often
  used as the format for MJPEG streams).</p>

  <p>If, in the case of a resource with no timing information, the user agent will nonetheless be
  able to seek to an earlier point than the first frame originally provided by the server, then the
  zero time should correspond to the earliest seekable time of the <a href="#media-resource">media resource</a>;
  otherwise, it should correspond to the first frame received from the server (the point in the
  <a href="#media-resource">media resource</a> at which the user agent began receiving the stream).</p>

  <p class="note">At the time of writing, there is no known format that lacks explicit frame time
  offsets yet still supports seeking to a frame before the first frame sent by the server.</p>

  <div class="example">

   <p>Consider a stream from a TV broadcaster, which begins streaming on a sunny Friday afternoon in
   October, and always sends connecting user agents the media data on the same media timeline, with
   its zero time set to the start of this stream. Months later, user agents connecting to this
   stream will find that the first frame they receive has a time with millions of seconds. The <code data-anolis-xref="dom-media-getStartDate"><a href="#dom-media-getstartdate">getStartDate()</a></code> method would always return the date that the
   broadcast started; this would allow controllers to display real times in their scrubber (e.g.
   "2:30pm") rather than a time relative to when the broadcast began ("8 months, 4 hours, 12
   minutes, and 23 seconds").</p>

   <p>Consider a stream that carries a video with several concatenated fragments, broadcast by a
   server that does not allow user agents to request specific times but instead just streams the
   video data in a predetermined order, with the first frame delivered always being identified as
   the frame with time zero. If a user agent connects to this stream and receives fragments defined
   as covering timestamps 2010-03-20 23:15:00 UTC to 2010-03-21 00:05:00 UTC and 2010-02-12 14:25:00
   UTC to 2010-02-12 14:35:00 UTC, it would expose this with a <a href="#media-timeline">media timeline</a> starting
   at 0s and extending to 3,600s (one hour). Assuming the streaming server disconnected at the end
   of the second clip, the <code data-anolis-xref="dom-media-duration"><a href="#dom-media-duration">duration</a></code> attribute would then
   return 3,600. The <code data-anolis-xref="dom-media-getStartDate"><a href="#dom-media-getstartdate">getStartDate()</a></code> method would return a
   <code>Date</code> object with a time corresponding to 2010-03-20 23:15:00 UTC. However, if a
   different user agent connected five minutes later, <em>it</em> would (presumably) receive
   fragments covering timestamps 2010-03-20 23:20:00 UTC to 2010-03-21 00:05:00 UTC and 2010-02-12
   14:25:00 UTC to 2010-02-12 14:35:00 UTC, and would expose this with a <a href="#media-timeline">media timeline</a>
   starting at 0s and extending to 3,300s (fifty five minutes). In this case, the <code data-anolis-xref="dom-media-getStartDate"><a href="#dom-media-getstartdate">getStartDate()</a></code> method would return a <code>Date</code> object
   with a time corresponding to 2010-03-20 23:20:00 UTC.</p>

   <p>In both of these examples, the <code data-anolis-xref="dom-media-seekable"><a href="#dom-media-seekable">seekable</a></code> attribute
   would give the ranges that the controller would want to actually display in its UI; typically, if
   the servers don't support seeking to arbitrary times, this would be the range of time from the
   moment the user agent connected to the stream up to the latest frame that the user agent has
   obtained; however, if the user agent starts discarding earlier information, the actual range
   might be shorter.</p>

  </div>

  <p>In any case, the user agent must ensure that the <a href="#earliest-possible-position">earliest possible position</a> (as
  defined below) using the established <a href="#media-timeline">media timeline</a>, is greater than or equal to
  zero.</p>

  <p>The <a href="#media-timeline">media timeline</a> also has an associated clock. Which clock is used is user-agent
  defined, and may be <a href="#media-resource">media resource</a>-dependent, but it should approximate the user's
  wall clock.</p>

  <p class="note">All the <a data-anolis-xref="media element" href="#media-element">media elements</a> that share <a href="#current-media-controller">current
  media controller</a> use the same clock for their <a href="#media-timeline">media timeline</a>.</p>

  <p><a data-anolis-xref="media element" href="#media-element">Media elements</a> have a <dfn id="current-playback-position">current playback position</dfn>,
  which must initially (i.e. in the absence of <a href="#media-data">media data</a>) be zero seconds. The
  <a href="#current-playback-position">current playback position</a> is a time on the <a href="#media-timeline">media timeline</a>.</p>

  <p><a data-anolis-xref="media element" href="#media-element">Media elements</a> also have an <dfn id="official-playback-position">official playback
  position</dfn>, which must initially be set to zero seconds. The <a href="#official-playback-position">official playback
  position</a> is an approximation of the <a href="#current-playback-position">current playback position</a> that is kept
  stable while scripts are running.</p>

  <p><a data-anolis-xref="media element" href="#media-element">Media elements</a> also have a <dfn id="default-playback-start-position">default playback start
  position</dfn>, which must initially be set to zero seconds. This time is used to allow the
  element to be seeked even before the media is loaded.</p>

  <p>Each <a href="#media-element">media element</a> has a <dfn id="show-poster-flag">show poster flag</dfn>. When a <a href="#media-element">media
  element</a> is created, this flag must be set to true. This flag is used to control when the
  user agent is to show a poster frame for a <code><a href="#the-video-element">video</a></code> element instead of showing the video
  contents.</p>

  <p>The <dfn data-anolis-xref="dom-media-currentTime" id="dom-media-currenttime"><code>currentTime</code></dfn> attribute must, on
  getting, return the <a href="#media-element">media element</a>'s <a href="#default-playback-start-position">default playback start position</a>,
  unless that is zero, in which case it must return the element's <a href="#official-playback-position">official playback
  position</a>. The returned value must be expressed in seconds. On setting, if the <a href="#media-element">media
  element</a> has a <a href="#current-media-controller">current media controller</a>, then the user agent must throw an
  <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code> exception; otherwise, if the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> is <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>, then it must set the <a href="#media-element">media
  element</a>'s <a href="#default-playback-start-position">default playback start position</a> to the new value; otherwise, it must
  set the <a href="#official-playback-position">official playback position</a> to the new value and then <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seek</a> to the new value. The new value must be interpreted as being in
  seconds.</p>

  <p><a data-anolis-xref="media element" href="#media-element">Media elements</a> have an <dfn id="initial-playback-position">initial playback position</dfn>,
  which must initially (i.e. in the absence of <a href="#media-data">media data</a>) be zero seconds. The
  <a href="#initial-playback-position">initial playback position</a> is updated when a <a href="#media-resource">media resource</a> is loaded.
  The <a href="#initial-playback-position">initial playback position</a> is a time on the <a href="#media-timeline">media timeline</a>.</p>

  <p>If the <a href="#media-resource">media resource</a> is a streaming resource, then the user agent might be unable
  to obtain certain parts of the resource after it has expired from its buffer. Similarly, some
  <a data-anolis-xref="media resource" href="#media-resource">media resources</a> might have a <a href="#media-timeline">media timeline</a> that
  doesn't start at zero. The <dfn id="earliest-possible-position">earliest possible position</dfn> is the earliest position in the
  stream or resource that the user agent can ever obtain again. It is also a time on the <a href="#media-timeline">media
  timeline</a>.</p>

  <p class="note">The <a href="#earliest-possible-position">earliest possible position</a> is not explicitly exposed in the API;
  it corresponds to the start time of the first range in the <code data-anolis-xref="dom-media-seekable"><a href="#dom-media-seekable">seekable</a></code> attribute's <code><a href="#timeranges">TimeRanges</a></code> object, if any, or
  the <a href="#current-playback-position">current playback position</a> otherwise.</p>

  <p>When the <a href="#earliest-possible-position">earliest possible position</a> changes, then: if the <a href="#current-playback-position">current playback
  position</a> is before the <a href="#earliest-possible-position">earliest possible position</a>, the user agent must <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seek</a> to the <a href="#earliest-possible-position">earliest possible position</a>; otherwise, if
  the user agent has not fired a <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> event at the
  element in the past 15 to 250ms and is not still running event handlers for such an event, then
  the user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> at the element.</p>

  <p class="note">Because of the above requirement and the requirement in the <a data-anolis-xref="concept-media-load-resource" href="#concept-media-load-resource">resource fetch algorithm</a> that kicks in <a href="#getting-media-metadata">when the metadata of the clip becomes known</a>, the <a href="#current-playback-position">current
  playback position</a> can never be less than the <a href="#earliest-possible-position">earliest possible position</a>.</p>

  <!-- see https://www.w3.org/Bugs/Public/show_bug.cgi?id=14492 -->
  <!-- basically this is to handle very-long-running streams that use different video and audio
       tracks per TV show -->

  <p>If at any time the user agent learns that an audio or video track has ended and all <a href="#media-data">media
  data</a> relating to that track corresponds to parts of the <a href="#media-timeline">media timeline</a> that
  are <em>before</em> the <a href="#earliest-possible-position">earliest possible position</a>, the user agent may <a href="webappapis.html#queue-a-task">queue a
  task</a> to first remove the track from the <code data-anolis-xref="dom-media-audioTracks"><a href="#dom-media-audiotracks">audioTracks</a></code>
  attribute's <code><a href="#audiotracklist">AudioTrackList</a></code> object or the <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code> attribute's <code><a href="#videotracklist">VideoTrackList</a></code> object as
  appropriate and then <a data-anolis-xref="concept-event-fire" href="infrastructure.html#concept-event-fire">fire</a> a <a data-anolis-xref="concept-events-trusted" href="infrastructure.html#concept-events-trusted">trusted</a> event with the name <code data-anolis-xref="event-media-removetrack"><a href="#event-media-removetrack">removetrack</a></code>, that does not bubble and is not cancelable, and that
  uses the <code><a href="#trackevent">TrackEvent</a></code> interface, with the <code data-anolis-xref="dom-TrackEvent-track"><a href="#dom-trackevent-track">track</a></code> attribute initialized to the <code><a href="#audiotrack">AudioTrack</a></code> or
  <code><a href="#videotrack">VideoTrack</a></code> object representing the track, at the <a href="#media-element">media element</a>'s
  aforementioned <code><a href="#audiotracklist">AudioTrackList</a></code> or <code><a href="#videotracklist">VideoTrackList</a></code> object.</p>

  <p>The <dfn data-anolis-xref="dom-media-duration" id="dom-media-duration"><code>duration</code></dfn> attribute must return the time
  of the end of the <a href="#media-resource">media resource</a>, in seconds, on the <a href="#media-timeline">media timeline</a>. If
  no <a href="#media-data">media data</a> is available, then the attributes must return the Not-a-Number (NaN)
  value. If the <a href="#media-resource">media resource</a> is not known to be bounded (e.g. streaming radio, or a
  live event with no announced end time), then the attribute must return the positive Infinity
  value.</p>

  <p>The user agent must determine the duration of the <a href="#media-resource">media resource</a> before playing
  any part of the <a href="#media-data">media data</a> and before setting <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> to a value equal to or greater than <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code>, even if doing so requires fetching multiple
  parts of the resource.</p>

  <p id="durationChange">When the length of the <a href="#media-resource">media resource</a> changes to a known value
  (e.g. from being unknown to known, or from a previously established length to a new length) the
  user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-durationchange"><a href="#event-media-durationchange">durationchange</a></code> at the <a href="#media-element">media element</a>. (The
  event is not fired when the duration is reset as part of loading a new media resource.) If the
  duration is changed such that the <a href="#current-playback-position">current playback position</a> ends up being greater
  than the time of the end of the <a href="#media-resource">media resource</a>, then the user agent must also <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seek</a> to the time of the end of the <a href="#media-resource">media resource</a>.</p>

  <p class="example">If an "infinite" stream ends for some reason, then the duration would change
  from positive Infinity to the time of the last frame or sample in the stream, and the <code data-anolis-xref="event-media-durationchange"><a href="#event-media-durationchange">durationchange</a></code> event would be fired. Similarly, if the
  user agent initially estimated the <a href="#media-resource">media resource</a>'s duration instead of determining
  it precisely, and later revises the estimate based on new information, then the duration would
  change and the <code data-anolis-xref="event-media-durationchange"><a href="#event-media-durationchange">durationchange</a></code> event would be
  fired.</p>

  <p>Some video files also have an explicit date and time corresponding to the zero time in the
  <a href="#media-timeline">media timeline</a>, known as the <dfn id="timeline-offset">timeline offset</dfn>. Initially, the
  <a href="#timeline-offset">timeline offset</a> must be set to Not-a-Number (NaN).</p>

  <p>The <dfn data-anolis-xref="dom-media-getStartDate" id="dom-media-getstartdate"><code>getStartDate()</code></dfn> method must return <a data-anolis-xref="create a Date object" href="infrastructure.html#create-a-date-object">a new <code>Date</code> object</a> representing the current
  <a href="#timeline-offset">timeline offset</a>.</p>

  </div>

  <hr><p>The <dfn data-anolis-xref="attr-media-loop" id="attr-media-loop"><code>loop</code></dfn> attribute is a <a href="infrastructure.html#boolean-attribute">boolean
  attribute</a> that, if specified, indicates that the <a href="#media-element">media element</a> is to seek back
  to the start of the <a href="#media-resource">media resource</a> upon reaching the end.</p>

  <p>The <code data-anolis-xref="attr-media-loop"><a href="#attr-media-loop">loop</a></code> attribute has no effect while the element has a
  <a href="#current-media-controller">current media controller</a>.</p>

  <div class="impl">

  <p>The <dfn data-anolis-xref="dom-media-loop" id="dom-media-loop"><code>loop</code></dfn> IDL attribute must <a href="infrastructure.html#reflect">reflect</a>
  the content attribute of the same name.</p>

  </div>



  <h5 id="ready-states"><span class="secno">4.7.10.7 </span>Ready states</h5>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code></dt>

   <dd>

    <p>Returns a value that expresses the current state of the element with respect to rendering the
    <a href="#current-playback-position">current playback position</a>, from the codes in the list below.</p>

   </dd>

  </dl><div class="impl">

  <p><a data-anolis-xref="media element" href="#media-element">Media elements</a> have a <i>ready state</i>, which describes to
  what degree they are ready to be rendered at the <a href="#current-playback-position">current playback position</a>. The
  possible values are as follows; the ready state of a media element at any particular time is the
  greatest value describing the state of the element:</p>

  </div>

  <dl><dt><dfn data-anolis-xref="dom-media-HAVE_NOTHING" id="dom-media-have_nothing"><code>HAVE_NOTHING</code></dfn> (numeric value 0)</dt>

   <dd><p>No information regarding the <a href="#media-resource">media resource</a> is available. No data for the
   <a href="#current-playback-position">current playback position</a> is available. <a data-anolis-xref="media element" href="#media-element">Media
   elements</a> whose <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute are set
   to <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code> are always in the <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code> state.</dd>

   <dt><dfn data-anolis-xref="dom-media-HAVE_METADATA" id="dom-media-have_metadata"><code>HAVE_METADATA</code></dfn> (numeric value 1)</dt>

   <dd><p>Enough of the resource has been obtained that the duration of the resource is available.
   In the case of a <code><a href="#the-video-element">video</a></code> element, the dimensions of the video are also available. The
   API will no longer throw an exception when seeking. No <a href="#media-data">media data</a> is available for
   the immediate <a href="#current-playback-position">current playback position</a>.</dd>

   <dt><dfn data-anolis-xref="dom-media-HAVE_CURRENT_DATA" id="dom-media-have_current_data"><code>HAVE_CURRENT_DATA</code></dfn> (numeric value 2)</dt>

   <dd><p>Data for the immediate <a href="#current-playback-position">current playback position</a> is available, but either not
   enough data is available that the user agent could successfully advance the <a href="#current-playback-position">current
   playback position</a> in the <a href="#direction-of-playback">direction of playback</a> at all without immediately
   reverting to the <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> state, or there is no
   more data to obtain in the <a href="#direction-of-playback">direction of playback</a>. For example, in video this
   corresponds to the user agent having data from the current frame, but not the next frame, when
   the <a href="#current-playback-position">current playback position</a> is at the end of the current frame; and to when <a data-anolis-xref="ended playback" href="#ended-playback">playback has ended</a>.</dd>

   <dt><dfn data-anolis-xref="dom-media-HAVE_FUTURE_DATA" id="dom-media-have_future_data"><code>HAVE_FUTURE_DATA</code></dfn> (numeric value 3)</dt>

   <dd><p>Data for the immediate <a href="#current-playback-position">current playback position</a> is available, as well as
   enough data for the user agent to advance the <a href="#current-playback-position">current playback position</a> in the
   <a href="#direction-of-playback">direction of playback</a> at least a little without immediately reverting to the <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> state, and <a href="#the-text-tracks-are-ready">the text tracks are
   ready</a>. For example, in video this corresponds to the user agent having data for at least
   the current frame and the next frame when the <a href="#current-playback-position">current playback position</a> is at the
   instant in time between the two frames, or to the user agent having the video data for the
   current frame and audio data to keep playing at least a little when the <a href="#current-playback-position">current playback
   position</a> is in the middle of a frame. The user agent cannot be in this state if <a data-anolis-xref="ended playback" href="#ended-playback">playback has ended</a>, as the <a href="#current-playback-position">current playback position</a>
   can never advance in this case.</dd>

   <dt><dfn data-anolis-xref="dom-media-HAVE_ENOUGH_DATA" id="dom-media-have_enough_data"><code>HAVE_ENOUGH_DATA</code></dfn> (numeric value 4)</dt>

   <dd>

   <p>All the conditions described for the <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> state are met, and, in addition,
    either of the following conditions is also true:</p>

    <ul><li>The user agent estimates that data is being fetched at a rate where the <a href="#current-playback-position">current
     playback position</a>, if it were to advance at the <a href="#effective-playback-rate">effective playback rate</a>,
     would not overtake the available data before playback reaches the end of the <a href="#media-resource">media
     resource</a>.</li>

     <li>The user agent has entered a state where waiting longer will not result in further data
     being obtained, and therefore nothing would be gained by delaying playback any further. (For
     example, the buffer might be full.)</li>

    </ul></dd>

  </dl><p class="note">In practice, the difference between <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> and <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> is negligible. Really the only time
  the difference is relevant is when painting a <code><a href="#the-video-element">video</a></code> element onto a
  <code><a href="scripting-1.html#the-canvas-element">canvas</a></code>, where it distinguishes the case where something will be drawn (<code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> or greater) from the case where
  nothing is drawn (<code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> or less). Similarly,
  the difference between <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> (only
  the current frame) and <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> (at least
  this frame and the next) can be negligible (in the extreme, only one frame). The only time that
  distinction really matters is when a page provides an interface for "frame-by-frame"
  navigation.</p>

  <div class="impl">

  <p>When the ready state of a <a href="#media-element">media element</a> whose <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> is not <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code> changes, the user agent must follow the steps
  given below:</p>

  <ol><li>

    <p>Apply the first applicable set of substeps from the following list:</p>


    <dl class="switch"><!-- going up to metadata --><dt>If the previous ready state was <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>,
     and the new ready state is <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code></dt>

     <dd id="fire-loadedmetadata">

      <p><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-loadedmetadata"><a href="#event-media-loadedmetadata">loadedmetadata</a></code> at the element.</p>

      <p class="note">Before this task is run, as part of the <a href="webappapis.html#event-loop">event loop</a> mechanism, the
      rendering will have been updated to resize the <code><a href="#the-video-element">video</a></code> element if appropriate.</p>

     </dd>

     <!-- going up to current for the first time -->

     <dt id="handling-first-frame-available">If the previous ready state was <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> and the new ready state is <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> or greater</dt>

     <dd>

      <p id="fire-loadeddata">If this is the first time this occurs for this <a href="#media-element">media
      element</a> since the <code data-anolis-xref="dom-media-load"><a href="#dom-media-load">load()</a></code> algorithm was last
      invoked, the user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a>
      named <code data-anolis-xref="event-media-loadeddata"><a href="#event-media-loadeddata">loadeddata</a></code> at the element.</p>

      <p>If the new ready state is <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code>
      or <code data-anolis-xref="dom-media-HAVE_ENOUGH_DATA"><a href="#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a></code>, then the relevant steps
      below must then be run also.</p>

     </dd>

     <!-- going down -->
     <dt>If the previous ready state was <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> or more, and the new ready state is
     <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> or less</dt>

     <dd>

      <p id="fire-waiting-when-waiting">If the <a href="#media-element">media element</a> was <a href="#potentially-playing">potentially
      playing</a> before its <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute
      changed to a value lower than <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code>, and the element has not
      <a href="#ended-playback">ended playback</a>, and playback has not <a href="#stopped-due-to-errors">stopped due to errors</a>,
      <a href="#paused-for-user-interaction">paused for user interaction</a>, or <a href="#paused-for-in-band-content">paused for in-band content</a>, the user
      agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> at the element, and <a href="webappapis.html#queue-a-task">queue a task</a>
      to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-waiting"><a href="#event-media-waiting">waiting</a></code> at
      the element.</p>

     </dd>

     <!-- going up to future -->
     <dt>If the previous ready state was <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> or less, and the new ready state
     is <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code></dt>

     <dd>

      <p>The user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named
      <code data-anolis-xref="event-media-canplay"><a href="#event-media-canplay">canplay</a></code> at the element.</p>

      <p>If the element's <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute is false, the user
      agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-playing"><a href="#event-media-playing">playing</a></code> at the element.</p>

     </dd>

     <!-- going up to enough -->
     <dt>If the new ready state is <code data-anolis-xref="dom-media-HAVE_ENOUGH_DATA"><a href="#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a></code></dt>

     <dd>

      <p>If the previous ready state was <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> or less, the user agent must
      <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-canplay"><a href="#event-media-canplay">canplay</a></code> at the element, and, if the element's <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute is false, <a href="webappapis.html#queue-a-task">queue a task</a> to
      <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-playing"><a href="#event-media-playing">playing</a></code>
      at the element.</p>

      <p>If the <a href="#autoplaying-flag">autoplaying flag</a> is true, and the <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute is true, and the <a href="#media-element">media element</a>
      has an <code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code> attribute specified, and the
      <a href="#media-element">media element</a>'s <code><a href="dom.html#document">Document</a></code>'s <a href="browsers.html#active-sandboxing-flag-set">active sandboxing flag set</a>
      does not have the <a href="browsers.html#sandboxed-automatic-features-browsing-context-flag">sandboxed automatic features browsing context flag</a> set, then
      the user agent may also run the following substeps:</p>

      <ol><li>Set the <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute to false.</li>

       <li>If the element's <a href="#show-poster-flag">show poster flag</a> is true, set it to false and run the
       <i><a href="#time-marches-on">time marches on</a></i> steps.</li>

       <li><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-play"><a href="#event-media-play">play</a></code> at the element.</li>

       <li><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-playing"><a href="#event-media-playing">playing</a></code> at the element.</li>

      </ol><p class="note">User agents do not need to support autoplay, and it is suggested that user
      agents honor user preferences on the matter. Authors are urged to use the <code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code> attribute rather than using script to force the
      video to play, so as to allow the user to override the behavior if so desired.</p>

      <p>In any case, the user agent must finally <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
      event</a> named <code data-anolis-xref="event-media-canplaythrough"><a href="#event-media-canplaythrough">canplaythrough</a></code> at the element.</p>

     </dd>

    </dl></li>

   <li><p>If the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, then
   <a href="#report-the-controller-state">report the controller state</a> for the <a href="#media-element">media element</a>'s <a href="#current-media-controller">current media
   controller</a>.</li>

  </ol></div>

  <p class="note">It is possible for the ready state of a media element to jump between these states
  discontinuously. For example, the state of a media element can jump straight from <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> to <code data-anolis-xref="dom-media-HAVE_ENOUGH_DATA"><a href="#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a></code> without passing through the <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> and <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> states.</p>

  <div class="impl">

  <p>The <dfn data-anolis-xref="dom-media-readyState" id="dom-media-readystate"><code>readyState</code></dfn> IDL attribute must, on
  getting, return the value described above that describes the current ready state of the
  <a href="#media-element">media element</a>.</p>

  </div>

  <p>The <dfn data-anolis-xref="attr-media-autoplay" id="attr-media-autoplay"><code>autoplay</code></dfn> attribute is a <a href="infrastructure.html#boolean-attribute">boolean
  attribute</a>. When present, the user agent <span class="impl">(as described in the algorithm
  described herein)</span> will automatically begin playback of the <a href="#media-resource">media resource</a> as
  soon as it can do so without stopping.</p>

  <p class="note">Authors are urged to use the <code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code>
  attribute rather than using script to trigger automatic playback, as this allows the user to
  override the automatic playback when it is not desired, e.g. when using a screen reader. Authors
  are also encouraged to consider not using the automatic playback behavior at all, and instead to
  let the user agent wait for the user to start playback explicitly.</p>

  <div class="impl">

  <p>The <dfn data-anolis-xref="dom-media-autoplay" id="dom-media-autoplay"><code>autoplay</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the content attribute of the same name.</p>

  </div>



  <h5 id="playing-the-media-resource"><span class="secno">4.7.10.8 </span>Playing the media resource</h5>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code></dt>

   <dd>

    <p>Returns true if playback is paused; false otherwise.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-ended"><a href="#dom-media-ended">ended</a></code></dt>

   <dd>

    <p>Returns true if playback has reached the end of the <a href="#media-resource">media resource</a>.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-defaultPlaybackRate"><a href="#dom-media-defaultplaybackrate">defaultPlaybackRate</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns the default rate of playback, for when the user is not fast-forwarding or reversing
    through the <a href="#media-resource">media resource</a>.</p>

    <p>Can be set, to change the default rate of playback.</p>

    <p>The default rate has no direct effect on playback, but if the user switches to a fast-forward
    mode, when they return to the normal playback mode, it is expected that the rate of playback
    will be returned to the default rate of playback.</p>

    <p>When the element has a <a href="#current-media-controller">current media controller</a>, the <code data-anolis-xref="dom-media-defaultPlaybackRate"><a href="#dom-media-defaultplaybackrate">defaultPlaybackRate</a></code> attribute is ignored and the
    <a href="#current-media-controller">current media controller</a>'s <code data-anolis-xref="dom-MediaController-defaultPlaybackRate"><a href="#dom-mediacontroller-defaultplaybackrate">defaultPlaybackRate</a></code> is used instead.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-playbackRate"><a href="#dom-media-playbackrate">playbackRate</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns the current rate playback, where 1.0 is normal speed.</p>

    <p>Can be set, to change the rate of playback.</p>

    <p>When the element has a <a href="#current-media-controller">current media controller</a>, the <code data-anolis-xref="dom-media-playbackRate"><a href="#dom-media-playbackrate">playbackRate</a></code> attribute is ignored and the <a href="#current-media-controller">current
    media controller</a>'s <code data-anolis-xref="dom-MediaController-playbackRate"><a href="#dom-mediacontroller-playbackrate">playbackRate</a></code> is
    used instead.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-played"><a href="#dom-media-played">played</a></code></dt>

   <dd>

    <p>Returns a <code><a href="#timeranges">TimeRanges</a></code> object that represents the ranges of the <a href="#media-resource">media
    resource</a> that the user agent has played.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-play"><a href="#dom-media-play">play</a></code>()</dt>

   <dd>

    <p>Sets the <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute to false, loading the
    <a href="#media-resource">media resource</a> and beginning playback if necessary. If the playback had ended, will
    restart it from the start.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-pause"><a href="#dom-media-pause">pause</a></code>()</dt>

   <dd>

    <p>Sets the <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute to true, loading the
    <a href="#media-resource">media resource</a> if necessary.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-media-paused" id="dom-media-paused"><code>paused</code></dfn> attribute represents whether the
  <a href="#media-element">media element</a> is paused or not. The attribute must initially be true.</p>

  <p>A <a href="#media-element">media element</a> is a <dfn id="blocked-media-element">blocked media element</dfn> if its <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute is in the <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code> state, the <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> state, or the <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> state, or if the element has
  <a href="#paused-for-user-interaction">paused for user interaction</a> or <a href="#paused-for-in-band-content">paused for in-band content</a>.</p>

  <p>A <a href="#media-element">media element</a> is said to be <dfn id="potentially-playing">potentially playing</dfn> when its <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute is false, the element has not <a href="#ended-playback">ended
  playback</a>, playback has not <a href="#stopped-due-to-errors">stopped due to errors</a>, the element either has no
  <a href="#current-media-controller">current media controller</a> or has a <a href="#current-media-controller">current media controller</a> but is not
  <a href="#blocked-on-its-media-controller">blocked on its media controller</a>, and the element is not a <a href="#blocked-media-element">blocked media
  element</a>.</p>

  <p class="note">A <code data-anolis-xref="event-media-waiting"><a href="#event-media-waiting">waiting</a></code> DOM event <a href="#fire-waiting-when-waiting">can be fired</a> as a result of an element that is
  <a href="#potentially-playing">potentially playing</a> stopping playback due to its <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute changing to a value lower than <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code>.</p>

  <p>A <a href="#media-element">media element</a> is said to have <dfn id="ended-playback">ended playback</dfn> when:</p>

  <ul><li>The element's <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute is <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> or greater, and

   <li>

    <p>Either:

    <ul><li>The <a href="#current-playback-position">current playback position</a> is the end of the <a href="#media-resource">media resource</a>,
     and

     <li>The <a href="#direction-of-playback">direction of playback</a> is forwards, and

     <li>Either the <a href="#media-element">media element</a> does not have a <code data-anolis-xref="attr-media-loop"><a href="#attr-media-loop">loop</a></code> attribute specified, or the <a href="#media-element">media element</a> has
     a <a href="#current-media-controller">current media controller</a>.

    </ul><p>Or:

    <ul><li>The <a href="#current-playback-position">current playback position</a> is the <a href="#earliest-possible-position">earliest possible position</a>,
     and

     <li>The <a href="#direction-of-playback">direction of playback</a> is backwards.

    </ul></li>

  </ul><p>The <dfn data-anolis-xref="dom-media-ended" id="dom-media-ended"><code>ended</code></dfn> attribute must return true if, the
  last time the <a href="webappapis.html#event-loop">event loop</a> reached step 1, the <a href="#media-element">media element</a> had
  <a href="#ended-playback">ended playback</a> and the <a href="#direction-of-playback">direction of playback</a> was forwards, and false
  otherwise.</p>

  <p>A <a href="#media-element">media element</a> is said to have <dfn id="stopped-due-to-errors">stopped due to errors</dfn> when the
  element's <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute is <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> or greater, and the user agent <a href="#non-fatal-media-error">encounters a non-fatal error</a> during the processing of the
  <a href="#media-data">media data</a>, and due to that error, is not able to play the content at the
  <a href="#current-playback-position">current playback position</a>.</p>

  <p>A <a href="#media-element">media element</a> is said to have <dfn id="paused-for-user-interaction">paused for user interaction</dfn> when its
  <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute is false, the <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute is either <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> or <code data-anolis-xref="dom-media-HAVE_ENOUGH_DATA"><a href="#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a></code> and the user agent has reached a point
  in the <a href="#media-resource">media resource</a> where the user has to make a selection for the resource to
  continue. If the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a> when this
  happens, then the user agent must <a href="#report-the-controller-state">report the controller state</a> for the <a href="#media-element">media
  element</a>'s <a href="#current-media-controller">current media controller</a>. If the <a href="#media-element">media element</a> has a
  <a href="#current-media-controller">current media controller</a> when the user makes a selection, allowing playback to
  resume, the user agent must similarly <a href="#report-the-controller-state">report the controller state</a> for the <a href="#media-element">media
  element</a>'s <a href="#current-media-controller">current media controller</a>.</p>

  <p>It is possible for a <a href="#media-element">media element</a> to have both <a href="#ended-playback">ended playback</a> and
  <a href="#paused-for-user-interaction">paused for user interaction</a> at the same time.</p>

  <p>When a <a href="#media-element">media element</a> that is <a href="#potentially-playing">potentially playing</a> stops playing
  because it has <a href="#paused-for-user-interaction">paused for user interaction</a>, the user agent must <a href="webappapis.html#queue-a-task">queue a
  task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> at the element.</p>

  <p>A <a href="#media-element">media element</a> is said to have <dfn id="paused-for-in-band-content">paused for in-band content</dfn> when its
  <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute is false, the <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute is either <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> or <code data-anolis-xref="dom-media-HAVE_ENOUGH_DATA"><a href="#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a></code> and the user agent has suspended
  playback of the <a href="#media-resource">media resource</a> in order to play content that is temporally anchored
  to the <a href="#media-resource">media resource</a> and has a non-zero length, or to play content that is
  temporally anchored to a segment of the <a href="#media-resource">media resource</a> but has a length longer than
  that segment. If the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a> when
  this happens, then the user agent must <a href="#report-the-controller-state">report the controller state</a> for the
  <a href="#media-element">media element</a>'s <a href="#current-media-controller">current media controller</a>. If the <a href="#media-element">media
  element</a> has a <a href="#current-media-controller">current media controller</a> when the user agent unsuspends
  playback, the user agent must similarly <a href="#report-the-controller-state">report the controller state</a> for the
  <a href="#media-element">media element</a>'s <a href="#current-media-controller">current media controller</a>.</p>

  <p class="example">One example of when a <a href="#media-element">media element</a> would be <a href="#paused-for-in-band-content">paused for
  in-band content</a> is when the user agent is playing <a data-anolis-xref="attr-track-kind-descriptions" href="#attr-track-kind-descriptions">audio descriptions</a> from an external WebVTT file, and
  the synthesized speech generated for a cue is longer than the time between the <a href="#text-track-cue-start-time">text track
  cue start time</a> and the <a href="#text-track-cue-end-time">text track cue end time</a>.</p>

  <hr><p>When the <a href="#current-playback-position">current playback position</a> reaches the end of the <a href="#media-resource">media
  resource</a> when the <a href="#direction-of-playback">direction of playback</a> is forwards, then the user agent must
  follow these steps:</p>

  <ol><li><p>If the <a href="#media-element">media element</a> has a <code data-anolis-xref="attr-media-loop"><a href="#attr-media-loop">loop</a></code>
   attribute specified and does not have a <a href="#current-media-controller">current media controller</a>, then <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seek</a> to the <a href="#earliest-possible-position">earliest possible position</a> of the
   <a href="#media-resource">media resource</a> and abort these steps.</li> <!-- v2/v3: We should fire a
   'looping' event here to explain why this immediately fires a 'playing' event, otherwise the
   'playing' event that fires from the readyState going from HAVE_CURRENT_DATA back to
   HAVE_FUTURE_DATA will seem inexplicable (since the normally matching 'ended' given below event
   doesn't fire in the loop case). -->

   <li><p>As defined above, the <code data-anolis-xref="dom-media-ended"><a href="#dom-media-ended">ended</a></code> IDL attribute starts
   returning true once the <a href="webappapis.html#event-loop">event loop</a>'s current <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a>
   ends.</li>

   <li><p><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> at the <a href="#media-element">media element</a>.</li>

   <li><p><a href="webappapis.html#queue-a-task">Queue a task</a> that, if the <a href="#media-element">media element</a> does not have a
   <a href="#current-media-controller">current media controller</a>, and the <a href="#media-element">media element</a> has still <a href="#ended-playback">ended
   playback</a>, and the <a href="#direction-of-playback">direction of playback</a> is still forwards, and <a data-anolis-xref="dom-media-paused" href="#dom-media-paused">paused</a> is false, changes <a data-anolis-xref="dom-media-paused" href="#dom-media-paused">paused</a> to true and <a data-anolis-xref="fire a simple event" href="webappapis.html#fire-a-simple-event">fires a
   simple event</a> named <code data-anolis-xref="event-media-pause"><a href="#event-media-pause">pause</a></code> at the <a href="#media-element">media
   element</a>.</li>

   <li><p><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-ended"><a href="#event-media-ended">ended</a></code> at the <a href="#media-element">media element</a>.</li>

   <li><p>If the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, then
   <a href="#report-the-controller-state">report the controller state</a> for the <a href="#media-element">media element</a>'s <a href="#current-media-controller">current media
   controller</a>.</li>

  </ol><p>When the <a href="#current-playback-position">current playback position</a> reaches the <a href="#earliest-possible-position">earliest possible
  position</a> of the <a href="#media-resource">media resource</a> when the <a href="#direction-of-playback">direction of playback</a> is
  backwards, then the user agent must only <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
  event</a> named <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> at the element.</p>

  <hr><p>The <dfn data-anolis-xref="dom-media-defaultPlaybackRate" id="dom-media-defaultplaybackrate"><code>defaultPlaybackRate</code></dfn> attribute
  gives the desired speed at which the <a href="#media-resource">media resource</a> is to play, as a multiple of its
  intrinsic speed. The attribute is mutable: on getting it must return the last value it was set to,
  or 1.0 if it hasn't yet been set; on setting the attribute must be set to the new value.</p>

  <p class="note">The <code data-anolis-xref="dom-media-defaultPlaybackRate"><a href="#dom-media-defaultplaybackrate">defaultPlaybackRate</a></code> is used
  by the user agent when it <a data-anolis-xref="expose a user interface to the user" href="#expose-a-user-interface-to-the-user">exposes a user
  interface to the user</a>.</p>

  <p>The <dfn data-anolis-xref="dom-media-playbackRate" id="dom-media-playbackrate"><code>playbackRate</code></dfn> attribute gives the
  <a href="#effective-playback-rate">effective playback rate</a> (assuming there is no <a href="#current-media-controller">current media controller</a>
  overriding it), which is the speed at which the <a href="#media-resource">media resource</a> plays, as a multiple
  of its intrinsic speed. If it is not equal to the <code data-anolis-xref="dom-media-defaultPlaybackRate"><a href="#dom-media-defaultplaybackrate">defaultPlaybackRate</a></code>, then the implication is that the
  user is using a feature such as fast forward or slow motion playback. The attribute is mutable: on
  getting it must return the last value it was set to, or 1.0 if it hasn't yet been set; on setting
  the attribute must be set to the new value, and the playback will change speed (if the element is
  <a href="#potentially-playing">potentially playing</a> and there is no <a href="#current-media-controller">current media controller</a>).</p>

  <p id="rateUpdate">When the <code data-anolis-xref="dom-media-defaultPlaybackRate"><a href="#dom-media-defaultplaybackrate">defaultPlaybackRate</a></code>
  or <code data-anolis-xref="dom-media-playbackRate"><a href="#dom-media-playbackrate">playbackRate</a></code> attributes change value (either by
  being set by script or by being changed directly by the user agent, e.g. in response to user
  control) the user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named
  <code data-anolis-xref="event-media-ratechange"><a href="#event-media-ratechange">ratechange</a></code> at the <a href="#media-element">media element</a>.</p>

  <p class="note">The <code data-anolis-xref="dom-media-defaultPlaybackRate"><a href="#dom-media-defaultplaybackrate">defaultPlaybackRate</a></code> and
  <code data-anolis-xref="dom-media-playbackRate"><a href="#dom-media-playbackrate">playbackRate</a></code> attributes have no effect when the
  <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>; the namesake attributes on
  the <code><a href="#mediacontroller">MediaController</a></code> object are used instead in that situation.</p>

  <hr><p>The <dfn data-anolis-xref="dom-media-played" id="dom-media-played"><code>played</code></dfn> attribute must return a new static
  <a href="#normalized-timeranges-object">normalized <code>TimeRanges</code> object</a> that represents the ranges of points on the
  <a href="#media-timeline">media timeline</a> of the <a href="#media-resource">media resource</a> reached through the usual monotonic
  increase of the <a href="#current-playback-position">current playback position</a> during normal playback, if any, at the time
  the attribute is evaluated.</p>

  <hr><p>When the <dfn data-anolis-xref="dom-media-play" id="dom-media-play"><code>play()</code></dfn> method on a <a href="#media-element">media
  element</a> is invoked, the user agent must run the following steps.</p>

  <ol><li><p>If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute has the value <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code>, invoke the <a href="#media-element">media element</a>'s
   <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection algorithm</a>.</li>

   <li>

    <p>If the <a data-anolis-xref="ended playback" href="#ended-playback">playback has ended</a> and the <a href="#direction-of-playback">direction of
    playback</a> is forwards, and the <a href="#media-element">media element</a> does not have a <a href="#current-media-controller">current
    media controller</a>, <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seek</a> to the <a href="#earliest-possible-position">earliest possible
    position</a> of the <a href="#media-resource">media resource</a>.</p>

    <p class="note">This <a href="#seekUpdate">will cause</a> the user agent to <a href="webappapis.html#queue-a-task">queue a
    task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> at the <a href="#media-element">media element</a>.</p>
    <!-- if we're already playing at this point, it might also fire 'waiting' -->

   </li>

   <li><p>If the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, then
   <a href="#bring-the-media-element-up-to-speed-with-its-new-media-controller">bring the media element up to speed with its new media controller</a>.</p>

   <li>

    <p>If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute is
    true, run the following substeps:</p>

    <ol><li><p>Change the value of <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> to false.</li>

     <li><p>If the <a href="#show-poster-flag">show poster flag</a> is true, set the element's <a href="#show-poster-flag">show poster
     flag</a> to false and run the <i><a href="#time-marches-on">time marches on</a></i> steps.</li>

     <li><p><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-play"><a href="#event-media-play">play</a></code> at the element.</li>

     <li>

      <p>If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code>
      attribute has the value <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>, <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code>, or <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code>, <a href="webappapis.html#queue-a-task">queue a task</a> to
      <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-waiting"><a href="#event-media-waiting">waiting</a></code> at the
      element.</p>

      <p>Otherwise, the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute has the value <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> or <code data-anolis-xref="dom-media-HAVE_ENOUGH_DATA"><a href="#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a></code>: <a href="webappapis.html#queue-a-task">queue a task</a> to
      <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-playing"><a href="#event-media-playing">playing</a></code> at the
      element.</p>

     </li>

    </ol></li>

   <li><p>Set the <a href="#media-element">media element</a>'s <a href="#autoplaying-flag">autoplaying flag</a> to false.</li>

   <li><p>If the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, then
   <a href="#report-the-controller-state">report the controller state</a> for the <a href="#media-element">media element</a>'s <a href="#current-media-controller">current media
   controller</a>.</li>

  </ol><hr><p>When the <dfn data-anolis-xref="dom-media-pause" id="dom-media-pause"><code>pause()</code></dfn> method is invoked, and when
  the user agent is required to pause the <a href="#media-element">media element</a>, the user agent must run the
  following steps:</p>

  <ol><li><p>If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute has the value <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code>, invoke the <a href="#media-element">media element</a>'s
   <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection algorithm</a>.</li>

   <li><p>Set the <a href="#media-element">media element</a>'s <a href="#autoplaying-flag">autoplaying flag</a> to false.</li>

   <li><p>If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute
   is false, run the following steps:</p>

    <ol><li><p>Change the value of <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> to true.</li>

     <li><p><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
     event</a> named <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> at the
     element.</li>

     <li><p><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
     event</a> named <code data-anolis-xref="event-media-pause"><a href="#event-media-pause">pause</a></code>
     at the element.</li>

     <li><p>Set the <a href="#official-playback-position">official playback position</a> to the <a href="#current-playback-position">current playback
     position</a>.</li>

    </ol></li>

   <li><p>If the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, then
   <a href="#report-the-controller-state">report the controller state</a> for the <a href="#media-element">media element</a>'s <a href="#current-media-controller">current media
   controller</a>.</li>

  </ol><hr><p>The <dfn id="effective-playback-rate">effective playback rate</dfn> is not necessarily the element's <code data-anolis-xref="dom-media-playbackRate"><a href="#dom-media-playbackrate">playbackRate</a></code>. When a <a href="#media-element">media element</a> has a
  <a href="#current-media-controller">current media controller</a>, its <a href="#effective-playback-rate">effective playback rate</a> is the
  <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-playback-rate">media controller playback rate</a>. Otherwise, the
  <a href="#effective-playback-rate">effective playback rate</a> is just the element's <code data-anolis-xref="dom-media-playbackRate"><a href="#dom-media-playbackrate">playbackRate</a></code>. Thus, the <a href="#current-media-controller">current media
  controller</a> overrides the <a href="#media-element">media element</a>.</p>

  <p>If the <a href="#effective-playback-rate">effective playback rate</a> is positive or zero, then the <dfn id="direction-of-playback">direction of
  playback</dfn> is forwards. Otherwise, it is backwards.</p>

  <p id="media-playback">When a <a href="#media-element">media element</a> is <a href="#potentially-playing">potentially playing</a> and
  its <code><a href="dom.html#document">Document</a></code> is a <a href="browsers.html#fully-active">fully active</a> <code><a href="dom.html#document">Document</a></code>, its <a href="#current-playback-position">current
  playback position</a> must increase monotonically at <a href="#effective-playback-rate">effective playback rate</a> units
  of media time per unit time of the <a href="#media-timeline">media timeline</a>'s clock. (This specification always
  refers to this as an <i>increase</i>, but that increase could actually be a <em>de</em>crease if
  the <a href="#effective-playback-rate">effective playback rate</a> is negative.)</p>

  <p class="note">The <a href="#effective-playback-rate">effective playback rate</a> can be 0.0, in which case the
  <a href="#current-playback-position">current playback position</a> doesn't move, despite playback not being paused (<code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> doesn't become true, and the <code data-anolis-xref="event-media-pause"><a href="#event-media-pause">pause</a></code> event doesn't fire).</p>

  <p class="note">This specification doesn't define how the user agent achieves the appropriate
  playback rate — depending on the protocol and media available, it is plausible that the user
  agent could negotiate with the server to have the server provide the media data at the appropriate
  rate, so that (except for the period between when the rate is changed and when the server updates
  the stream's playback rate) the client doesn't actually have to drop or interpolate any
  frames.</p>
 
  <p>Any time the user agent <a data-anolis-xref="provide a stable state" href="webappapis.html#provide-a-stable-state">provides a stable state</a>,
  the <a href="#official-playback-position">official playback position</a> must be set to the <a href="#current-playback-position">current playback
  position</a>.</p>

  <p>When the <a href="#direction-of-playback">direction of playback</a> is backwards, any corresponding audio must be
  muted. When the <a href="#effective-playback-rate">effective playback rate</a> is so low or so high that the user agent
  cannot play audio usefully, the corresponding audio must also be muted. If the <a href="#effective-playback-rate">effective
  playback rate</a> is not 1.0, the user agent may apply pitch adjustments to the audio as
  necessary to render it faithfully.</p>

  <p><a data-anolis-xref="media element" href="#media-element">Media elements</a> that are <a href="#potentially-playing">potentially playing</a>
  while not <a href="infrastructure.html#in-a-document">in a <code>Document</code></a> must not play any video, but should play any
  audio component. Media elements must not stop playing just because all references to them have
  been removed; only once a media element is in a state where no further audio could ever be played
  by that element may the element be garbage collected.</p>

  <p class="note">It is possible for an element to which no explicit references exist to play audio,
  even if such an element is not still actively playing: for instance, it could have a <a href="#current-media-controller">current
  media controller</a> that still has references and can still be unpaused, or it could be
  unpaused but stalled waiting for content to buffer.</p>

  <hr><p>Each <a href="#media-element">media element</a> has a <dfn id="list-of-newly-introduced-cues">list of newly introduced cues</dfn>, which must be
  initially empty. Whenever a <a href="#text-track-cue">text track cue</a> is added to the <a data-anolis-xref="text track
  list of cues" href="#text-track-list-of-cues">list of cues</a> of a <a href="#text-track">text track</a> that is in the <a href="#list-of-text-tracks">list of text
  tracks</a> for a <a href="#media-element">media element</a>, that <a data-anolis-xref="text track cue" href="#text-track-cue">cue</a> must
  be added to the <a href="#media-element">media element</a>'s <a href="#list-of-newly-introduced-cues">list of newly introduced cues</a>. Whenever
  a <a href="#text-track">text track</a> is added to the <a href="#list-of-text-tracks">list of text tracks</a> for a <a href="#media-element">media
  element</a>, all of the <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> in that <a href="#text-track">text
  track</a>'s <a data-anolis-xref="text track list of cues" href="#text-track-list-of-cues">list of cues</a> must be added to the
  <a href="#media-element">media element</a>'s <a href="#list-of-newly-introduced-cues">list of newly introduced cues</a>. When a <a href="#media-element">media
  element</a>'s <a href="#list-of-newly-introduced-cues">list of newly introduced cues</a> has new cues added while the
  <a href="#media-element">media element</a>'s <a href="#show-poster-flag">show poster flag</a> is not set, then the user agent must
  run the <i><a href="#time-marches-on">time marches on</a></i> steps.</p>

  <p>When a <a href="#text-track-cue">text track cue</a> is removed from the <a data-anolis-xref="text track list of
  cues" href="#text-track-list-of-cues">list of cues</a> of a <a href="#text-track">text track</a> that is in the <a href="#list-of-text-tracks">list of text
  tracks</a> for a <a href="#media-element">media element</a>, and whenever a <a href="#text-track">text track</a> is removed
  from the <a href="#list-of-text-tracks">list of text tracks</a> of a <a href="#media-element">media element</a>, if the <a href="#media-element">media
  element</a>'s <a href="#show-poster-flag">show poster flag</a> is not set, then the user agent must run the
  <i><a href="#time-marches-on">time marches on</a></i> steps.</p>

  <p>When the <a href="#current-playback-position">current playback position</a> of a <a href="#media-element">media element</a> changes (e.g.
  due to playback or seeking), the user agent must run the <i><a href="#time-marches-on">time marches on</a></i> steps. If the
  <a href="#current-playback-position">current playback position</a> changes while the steps are running, then the user agent
  must wait for the steps to complete, and then must immediately rerun the steps. (These steps are
  thus run as often as possible or needed — if one iteration takes a long time, this can cause
  certain <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> to be skipped over as the user agent rushes ahead
  to "catch up".)</p>

  <p>The <dfn id="time-marches-on"><i>time marches on</i></dfn> steps are as follows:</p>

  <ol><li><p>Let <var data-anolis-xref="">current cues</var> be a list of <a data-anolis-xref="text track
   cue" href="#text-track-cue">cues</a>, initialized to contain all the <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> of all
   the <a data-anolis-xref="text track hidden" href="#text-track-hidden">hidden</a> or <a data-anolis-xref="text track
   showing" href="#text-track-showing">showing</a> <a data-anolis-xref="text track" href="#text-track">text tracks</a> of the <a href="#media-element">media
   element</a> (not the <a data-anolis-xref="text track disabled" href="#text-track-disabled">disabled</a> ones) whose <a data-anolis-xref="text track cue start time" href="#text-track-cue-start-time">start times</a> are less than or equal to the <a href="#current-playback-position">current
   playback position</a> and whose <a data-anolis-xref="text track cue end time" href="#text-track-cue-end-time">end times</a> are
   greater than the <a href="#current-playback-position">current playback position</a>.</li>

   <li><p>Let <var data-anolis-xref="">other cues</var> be a list of <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a>,
   initialized to contain all the <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> of <a data-anolis-xref="text
   track hidden" href="#text-track-hidden">hidden</a> and <a data-anolis-xref="text track showing" href="#text-track-showing">showing</a> <a data-anolis-xref="text
   track" href="#text-track">text tracks</a> of the <a href="#media-element">media element</a> that are not present in <var data-anolis-xref="">current cues</var>.</li>

   <li><p>Let <var data-anolis-xref="">last time</var> be the <a href="#current-playback-position">current playback position</a> at the
   time this algorithm was last run for this <a href="#media-element">media element</a>, if this is not the first
   time it has run.</li>

   <li><p>If the <a href="#current-playback-position">current playback position</a> has, since the last time this algorithm was
   run, only changed through its usual monotonic increase during normal playback, then let <var data-anolis-xref="">missed cues</var> be the list of <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> in <var data-anolis-xref="">other cues</var> whose <a data-anolis-xref="text track cue start time" href="#text-track-cue-start-time">start times</a> are
   greater than or equal to <var data-anolis-xref="">last time</var> and whose <a data-anolis-xref="text track cue end
   time" href="#text-track-cue-end-time">end times</a> are less than or equal to the <a href="#current-playback-position">current playback position</a>.
   Otherwise, let <var data-anolis-xref="">missed cues</var> be an empty list.</li>

   <li><p>Remove all the <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> in <var data-anolis-xref="">missed cues</var>
   that are also in the <a href="#media-element">media element</a>'s <a href="#list-of-newly-introduced-cues">list of newly introduced cues</a>, and
   then empty the element's <a href="#list-of-newly-introduced-cues">list of newly introduced cues</a>.</li>

   <li><p>If the time was reached through the usual monotonic increase of the <a href="#current-playback-position">current playback
   position</a> during normal playback, and if the user agent has not fired a <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> event at the element in the past 15 to 250ms and
   is not still running event handlers for such an event, then the user agent must <a href="webappapis.html#queue-a-task">queue a
   task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> at the element. (In the other cases, such as
   explicit seeks, relevant events get fired as part of the overall process of changing the
   <a href="#current-playback-position">current playback position</a>.)</p>

   <p class="note">The event thus is not to be fired faster than about 66Hz or slower than 4Hz
   (assuming the event handlers don't take longer than 250ms to run). User agents are encouraged to
   vary the frequency of the event based on the system load and the average cost of processing the
   event each time, so that the UI updates are not any more frequent than the user agent can
   comfortably handle while decoding the video.</li>

   <li><p>If all of the <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> in <var data-anolis-xref="">current cues</var>
   have their <a href="#text-track-cue-active-flag">text track cue active flag</a> set, none of the <a data-anolis-xref="text track
   cue" href="#text-track-cue">cues</a> in <var data-anolis-xref="">other cues</var> have their <a href="#text-track-cue-active-flag">text track cue active
   flag</a> set, and <var data-anolis-xref="">missed cues</var> is empty, then abort these steps.</li>

   <li>

    <p>If the time was reached through the usual monotonic increase of the <a href="#current-playback-position">current playback
    position</a> during normal playback, and there are <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a>
    in <var data-anolis-xref="">other cues</var> that have their <a href="#text-track-cue-pause-on-exit-flag">text track cue pause-on-exit flag</a>
    set and that either have their <a href="#text-track-cue-active-flag">text track cue active flag</a> set or are also in <var data-anolis-xref="">missed cues</var>, then immediately <a data-anolis-xref="dom-media-pause" href="#dom-media-pause">pause</a> the
    <a href="#media-element">media element</a>. <!-- "pause" can in theory call load(), but never can it do so as
    part of this invocation, since we wouldn't be in this algorithm if the media element was empty.
    So, no need to couch all this in a task. --></p>

    <p class="note">In the other cases, such as explicit seeks, playback is not paused by going past
    the end time of a <a data-anolis-xref="text track cue" href="#text-track-cue">cue</a>, even if that <a data-anolis-xref="text track
    cue" href="#text-track-cue">cue</a> has its <a href="#text-track-cue-pause-on-exit-flag">text track cue pause-on-exit flag</a> set.</p>

   </li>

   <li>

    <p>Let <var data-anolis-xref="">events</var> be a list of <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a>,
    initially empty. Each <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> in this list will be associated
    with a <a href="#text-track">text track</a>, a <a href="#text-track-cue">text track cue</a>, and a time, which are used to
    sort the list before the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> are queued.</p>

    <p>Let <var data-anolis-xref="">affected tracks</var> be a list of <a data-anolis-xref="text track" href="#text-track">text
    tracks</a>, initially empty.</p>

    <p>When the steps below say to <dfn id="prepare-an-event">prepare an event</dfn> named <var data-anolis-xref="">event</var> for a
    <a href="#text-track-cue">text track cue</a> <var data-anolis-xref="">target</var> with a time <var data-anolis-xref="">time</var>, the
    user agent must run these substeps:</p>

    <ol><li><p>Let <var data-anolis-xref="">track</var> be the <a href="#text-track">text track</a> with which the <a href="#text-track-cue">text
     track cue</a> <var data-anolis-xref="">target</var> is associated.</li>

     <li><p>Create a <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a>
     named <var data-anolis-xref="">event</var> at <var data-anolis-xref="">target</var>.</li>

     <li><p>Add the newly created <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> to <var data-anolis-xref="">events</var>, associated with the time <var data-anolis-xref="">time</var>, the <a href="#text-track">text
     track</a> <var data-anolis-xref="">track</var>, and the <a href="#text-track-cue">text track cue</a> <var data-anolis-xref="">target</var>.</li>

     <li><p>Add <var data-anolis-xref="">track</var> to <var data-anolis-xref="">affected tracks</var>.</li>

    </ol></li>

   <li><p>For each <a data-anolis-xref="text track cue" href="#text-track-cue">text track cue</a> in <var data-anolis-xref="">missed
   cues</var>, <a href="#prepare-an-event">prepare an event</a> named <code data-anolis-xref="event-enter">enter</code> for the
   <code><a href="#texttrackcue">TextTrackCue</a></code> object with the <a href="#text-track-cue-start-time">text track cue start time</a>.</li>

   <li><p>For each <a data-anolis-xref="text track cue" href="#text-track-cue">text track cue</a> in <var data-anolis-xref="">other
   cues</var> that either has its <a href="#text-track-cue-active-flag">text track cue active flag</a> set or is in <var data-anolis-xref="">missed cues</var>, <a href="#prepare-an-event">prepare an event</a> named <code data-anolis-xref="event-exit">exit</code> for the <code><a href="#texttrackcue">TextTrackCue</a></code> object with the later of the
   <a href="#text-track-cue-end-time">text track cue end time</a> and the <a href="#text-track-cue-start-time">text track cue start time</a>.</li>

   <li><p>For each <a data-anolis-xref="text track cue" href="#text-track-cue">text track cue</a> in <var data-anolis-xref="">current
   cues</var> that does not have its <a href="#text-track-cue-active-flag">text track cue active flag</a> set, <a href="#prepare-an-event">prepare an
   event</a> named <code data-anolis-xref="event-enter">enter</code> for the <code><a href="#texttrackcue">TextTrackCue</a></code>
   object with the <a href="#text-track-cue-start-time">text track cue start time</a>.</li>

   <li>

    <p>Sort the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> in <var data-anolis-xref="">events</var> in ascending
    time order (<a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> with earlier times first).</p>

    <p>Further sort <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> in <var data-anolis-xref="">events</var> that have
    the same time by the relative <a href="#text-track-cue-order">text track cue order</a> of the <a data-anolis-xref="text track
    cue" href="#text-track-cue">text track cues</a> associated with these <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a>.</p>

    <p>Finally, sort <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> in <var data-anolis-xref="">events</var> that have
    the same time and same <a href="#text-track-cue-order">text track cue order</a> by placing <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> that fire <code data-anolis-xref="event-enter">enter</code> events before
    those that fire <code data-anolis-xref="event-exit">exit</code> events.</p>

   </li>

   <li><p><a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">Queue</a> each <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> in
   <var data-anolis-xref="">events</var>, in list order.</li>

   <li><p>Sort <var data-anolis-xref="">affected tracks</var> in the same order as the <a data-anolis-xref="text
   track" href="#text-track">text tracks</a> appear in the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text
   tracks</a>, and remove duplicates.</p>

   <li><p>For each <a href="#text-track">text track</a> in <var data-anolis-xref="">affected tracks</var>, in the list
   order, <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-cuechange">cuechange</code> at the <code><a href="#texttrack">TextTrack</a></code> object, and, if the
   <a href="#text-track">text track</a> has a corresponding <code><a href="#the-track-element">track</a></code> element, to then <a href="webappapis.html#fire-a-simple-event">fire a
   simple event</a> named <code data-anolis-xref="event-cuechange">cuechange</code> at the
   <code><a href="#the-track-element">track</a></code> element as well.</li>

   <li><p>Set the <a href="#text-track-cue-active-flag">text track cue active flag</a> of all the <a data-anolis-xref="text track
   cue" href="#text-track-cue">cues</a> in the <var data-anolis-xref="">current cues</var>, and unset the <a href="#text-track-cue-active-flag">text track cue
   active flag</a> of all the <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> in the <var data-anolis-xref="">other
   cues</var>.</li>

   <li><p>Run the <a href="#rules-for-updating-the-text-track-rendering">rules for updating the text track rendering</a> of each of the <a data-anolis-xref="text track" href="#text-track">text tracks</a> in <var data-anolis-xref="">affected tracks</var> that are <a data-anolis-xref="text track showing" href="#text-track-showing">showing</a>. For example, for <a data-anolis-xref="text track" href="#text-track">text
   tracks</a> based on <a href="infrastructure.html#webvtt">WebVTT</a>, the <a href="infrastructure.html#rules-for-updating-the-display-of-webvtt-text-tracks">rules for updating the display of WebVTT
   text tracks</a>. <a href="references.html#refsWEBVTT">[WEBVTT]</a> </li>

  </ol><p>For the purposes of the algorithm above, a <a href="#text-track-cue">text track cue</a> is considered to be part
  of a <a href="#text-track">text track</a> only if it is listed in the <a href="#text-track-list-of-cues">text track list of cues</a>, not
  merely if it is associated with the <a href="#text-track">text track</a>.</p>

  <p class="note">If the <a href="#media-element">media element</a>'s <code><a href="dom.html#document">Document</a></code> stops being a
  <a href="browsers.html#fully-active">fully active</a> document, then the playback will <a href="#media-playback">stop</a>
  until the document is active again.</p>

  <p>When a <a href="#media-element">media element</a> is <a data-anolis-xref="remove an element from a document" href="infrastructure.html#remove-an-element-from-a-document">removed
  from a <code>Document</code></a>, the user agent must run the following steps:</p>

  <ol><li><p>Asynchronously <a href="webappapis.html#await-a-stable-state">await a stable state</a>, allowing the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that removed the <a href="#media-element">media element</a> from the
   <code><a href="dom.html#document">Document</a></code> to continue. The <a href="webappapis.html#synchronous-section">synchronous section</a> consists of all the
   remaining steps of this algorithm. (Steps in the <a href="webappapis.html#synchronous-section">synchronous section</a> are marked with
   ⌛.)</li>

   <li><p>⌛ If the <a href="#media-element">media element</a> is <a href="infrastructure.html#in-a-document">in a <code>Document</code></a>,
   abort these steps.</li>

   <li><p>⌛ If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> attribute has the value <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code>, abort these steps.</li>

   <li><p>⌛ <a data-anolis-xref="dom-media-pause" href="#dom-media-pause">Pause</a> the <a href="#media-element">media element</a>.</p>

  </ol></div>



  <h5 id="seeking"><span class="secno">4.7.10.9 </span>Seeking</h5>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-seeking"><a href="#dom-media-seeking">seeking</a></code></dt>

   <dd>

    <p>Returns true if the user agent is currently seeking.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-seekable"><a href="#dom-media-seekable">seekable</a></code></dt>

   <dd>

    <p>Returns a <code><a href="#timeranges">TimeRanges</a></code> object that represents the ranges of the <a href="#media-resource">media
    resource</a> to which it is possible for the user agent to seek.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-media-seeking" id="dom-media-seeking"><code>seeking</code></dfn> attribute must initially have the
  value false.</p>

  <p>When the user agent is required to <dfn data-anolis-xref="dom-media-seek" id="dom-media-seek">seek</dfn> to a particular <var data-anolis-xref="">new playback position</var> in the <a href="#media-resource">media resource</a>, optionally with the
  <i>approximate-for-speed</i> flag set, it means that the user agent must run the following steps.
  This algorithm interacts closely with the <a href="webappapis.html#event-loop">event loop</a> mechanism; in particular, it has
  a <a href="webappapis.html#synchronous-section">synchronous section</a> (which is triggered as part of the <a href="webappapis.html#event-loop">event loop</a>
  algorithm). Steps in that section are marked with ⌛.</p>

  <ol><li><p>Set the <a href="#media-element">media element</a>'s <a href="#show-poster-flag">show poster flag</a> to false.</li>

   <li><p>If the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code>
   is <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>, abort these steps.</li>

   <li><p>If the element's <code data-anolis-xref="dom-media-seeking"><a href="#dom-media-seeking">seeking</a></code> IDL attribute is true,
   then another instance of this algorithm is already running. Abort that other instance of the
   algorithm without waiting for the step that it is running to complete.</li>

   <li><p>Set the <code data-anolis-xref="dom-media-seeking"><a href="#dom-media-seeking">seeking</a></code> IDL attribute to true.</li>

   <li><p>If the seek was in response to a DOM method call or setting of an IDL attribute, then
   continue the script. The remainder of these steps must be run asynchronously. With the exception
   of the steps marked with ⌛, they could be aborted at any time by another instance of this
   algorithm being invoked.</li>

   <li><p>If the <var data-anolis-xref="">new playback position</var> is later than the end of the <a href="#media-resource">media
   resource</a>, then let it be the end of the <a href="#media-resource">media resource</a> instead.</li>

   <li><p>If the <var data-anolis-xref="">new playback position</var> is less than the <a href="#earliest-possible-position">earliest possible
   position</a>, let it be that position instead.</li>

   <li><p>If the (possibly now changed) <var data-anolis-xref="">new playback position</var> is not in one of
   the ranges given in the <code data-anolis-xref="dom-media-seekable"><a href="#dom-media-seekable">seekable</a></code> attribute, then let it
   be the position in one of the ranges given in the <code data-anolis-xref="dom-media-seekable"><a href="#dom-media-seekable">seekable</a></code> attribute that is the nearest to the <var data-anolis-xref="">new
   playback position</var>. If two positions both satisfy that constraint (i.e. the <var data-anolis-xref="">new playback position</var> is exactly in the middle between two ranges in the <code data-anolis-xref="dom-media-seekable"><a href="#dom-media-seekable">seekable</a></code> attribute) then use the position that is closest to
   the <a href="#current-playback-position">current playback position</a>. If there are no ranges given in the <code data-anolis-xref="dom-media-seekable"><a href="#dom-media-seekable">seekable</a></code> attribute then set the <code data-anolis-xref="dom-media-seeking"><a href="#dom-media-seeking">seeking</a></code> IDL attribute to false and abort these steps.</li>

   <li>

    <p>If the <i>approximate-for-speed</i> flag is set, adjust the <var data-anolis-xref="">new playback
    position</var> to a value that will allow for playback to resume promptly. If <var data-anolis-xref="">new
    playback position</var> before this step is before <a href="#current-playback-position">current playback position</a>, then
    the adjusted <var data-anolis-xref="">new playback position</var> must also be before the <a href="#current-playback-position">current
    playback position</a>. Similarly, if the <var data-anolis-xref="">new playback position</var> before
    this step is after <a href="#current-playback-position">current playback position</a>, then the adjusted <var data-anolis-xref="">new
    playback position</var> must also be after the <a href="#current-playback-position">current playback position</a>.</p>

    <p class="example">For example, the user agent could snap to the nearest key frame, so that it
    doesn't have to spend time decoding then discarding intermediate frames before resuming
    playback.</p>

    </li>

   <li><p><a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-seeking"><a href="#event-media-seeking">seeking</a></code> at the element.</li>

   <li>

    <p>Set the <a href="#current-playback-position">current playback position</a> to the given <var data-anolis-xref="">new playback
    position</var>.</p>

    <p class="note">If the <a href="#media-element">media element</a> was <a href="#potentially-playing">potentially playing</a>
    immediately before it started seeking, but seeking caused its <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute to change to a value lower than <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code>, then a <code data-anolis-xref="event-media-waiting"><a href="#event-media-waiting">waiting</a></code> <a href="#fire-waiting-when-waiting">will be
    fired</a> at the element.</p> <!-- also, timeupdate -->
    <!-- also, it will do the "report the controller state" thing -->

    <p class="note">The <code data-anolis-xref="dom-media-currentTime"><a href="#dom-media-currenttime">currentTime</a></code> attribute does not
    get updated asynchronously, as it returns the <a href="#official-playback-position">official playback position</a>, not the
    <a href="#current-playback-position">current playback position</a>.</p>

   </li>

   <li><p>Wait until the user agent has established whether or not the <a href="#media-data">media data</a> for
   the <var data-anolis-xref="">new playback position</var> is available, and, if it is, until it has decoded
   enough data to play back that position.</p>
   <!-- at which point, it will do the "port the controller state"
   thing again -->
   </li>

   <li><p><a href="webappapis.html#await-a-stable-state">Await a stable state</a>. The <a href="webappapis.html#synchronous-section">synchronous section</a> consists of all
   the remaining steps of this algorithm. (Steps in the <a href="webappapis.html#synchronous-section">synchronous section</a> are marked
   with ⌛.)</li>

   <li><p>⌛ Set the <code data-anolis-xref="dom-media-seeking"><a href="#dom-media-seeking">seeking</a></code> IDL attribute to
   false.</li>

   <li><p>⌛ Run the <a href="#time-marches-on">time marches on</a> steps.</li>

   <li id="seekUpdate"><p>⌛ <a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a>
   named <code data-anolis-xref="event-media-timeupdate"><a href="#event-media-timeupdate">timeupdate</a></code> at the element.</li>

   <li><p>⌛ <a href="webappapis.html#queue-a-task">Queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-seeked"><a href="#event-media-seeked">seeked</a></code> at the element.</li>

  </ol><hr><p>The <dfn data-anolis-xref="dom-media-seekable" id="dom-media-seekable"><code>seekable</code></dfn> attribute must return a new
  static <a href="#normalized-timeranges-object">normalized <code>TimeRanges</code> object</a> that represents the ranges of the
  <a href="#media-resource">media resource</a>, if any, that the user agent is able to seek to, at the time the
  attribute is evaluated.</p>

  <p class="note">If the user agent can seek to anywhere in the <a href="#media-resource">media resource</a>, e.g.
  because it is a simple movie file and the user agent and the server support HTTP Range requests,
  then the attribute would return an object with one range, whose start is the time of the first
  frame (the <a href="#earliest-possible-position">earliest possible position</a>, typically zero), and whose end is the same as
  the time of the first frame plus the <code data-anolis-xref="dom-media-duration"><a href="#dom-media-duration">duration</a></code> attribute's
  value (which would equal the time of the last frame, and might be positive Infinity).</p>

  <p class="note">The range might be continuously changing, e.g. if the user agent is buffering a
  sliding window on an infinite stream. This is the behavior seen with DVRs viewing live TV, for
  instance.</p>

  <p><a data-anolis-xref="media resource" href="#media-resource">Media resources</a> might be internally scripted or
  interactive. Thus, a <a href="#media-element">media element</a> could play in a non-linear fashion. If this
  happens, the user agent must act as if the algorithm for <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seeking</a> was used whenever the <a href="#current-playback-position">current playback position</a>
  changes in a discontinuous fashion (so that the relevant events fire). If the <a href="#media-element">media
  element</a> has a <a href="#current-media-controller">current media controller</a>, then the user agent must <a href="#seek-the-media-controller">seek
  the media controller</a> appropriately instead. </p>

  </div>


  <h5 id="media-resources-with-multiple-media-tracks"><span class="secno">4.7.10.10 </span>Media resources with multiple media tracks</h5>

  <p>A <a href="#media-resource">media resource</a> can have multiple embedded audio and video tracks. For example,
  in addition to the primary video and audio tracks, a <a href="#media-resource">media resource</a> could have
  foreign-language dubbed dialogues, director's commentaries, audio descriptions, alternative
  angles, or sign-language overlays.</p>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-audioTracks"><a href="#dom-media-audiotracks">audioTracks</a></code></dt>

   <dd>

    <p>Returns an <code><a href="#audiotracklist">AudioTrackList</a></code> object representing the audio tracks available in the
    <a href="#media-resource">media resource</a>.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code></dt>

   <dd>

    <p>Returns a <code><a href="#videotracklist">VideoTrackList</a></code> object representing the video tracks available in the
    <a href="#media-resource">media resource</a>.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-media-audioTracks" id="dom-media-audiotracks"><code>audioTracks</code></dfn> attribute of a
  <a href="#media-element">media element</a> must return a <a href="infrastructure.html#live">live</a> <code><a href="#audiotracklist">AudioTrackList</a></code> object
  representing the audio tracks available in the <a href="#media-element">media element</a>'s <a href="#media-resource">media
  resource</a>. The same object must be returned each time.</p>

  <p>The <dfn data-anolis-xref="dom-media-videoTracks" id="dom-media-videotracks"><code>videoTracks</code></dfn> attribute of a
  <a href="#media-element">media element</a> must return a <a href="infrastructure.html#live">live</a> <code><a href="#videotracklist">VideoTrackList</a></code> object
  representing the video tracks available in the <a href="#media-element">media element</a>'s <a href="#media-resource">media
  resource</a>. The same object must be returned each time.</p>

  <p class="note">There are only ever one <code><a href="#audiotracklist">AudioTrackList</a></code> object and one
  <code><a href="#videotracklist">VideoTrackList</a></code> object per <a href="#media-element">media element</a>, even if another <a href="#media-resource">media
  resource</a> is loaded into the element: the objects are reused. (The <code><a href="#audiotrack">AudioTrack</a></code>
  and <code><a href="#videotrack">VideoTrack</a></code> objects are not, though.)</p>

  </div>

  <div class="example">

   <p>In this example, a script defines a function that takes a URL to a video and a reference to an
   element where the video is to be placed. That function then tries to load the video, and, once it
   is loaded, checks to see if there is a sign-language track available. If there is, it also
   displays that track. Both tracks are just placed in the given container; it's assumed that styles
   have been applied to make this work in a pretty way!</p>

   <pre>&lt;script&gt;
 function loadVideo(url, container) {
   var controller = new MediaController();
   var video = document.createElement('video');
   video.src = url;
   video.autoplay = true;
   video.controls = true;
   video.controller = controller;
   container.appendChild(video);
   video.onloadedmetadata = function (event) {
     for (var i = 0; i &lt; video.videoTracks.length; i += 1) {
       if (video.videoTracks[i].kind == 'sign') {
         var sign = document.createElement('video');
         sign.src = url + '#track=' + video.videoTracks[i].id; <!-- should escape this probably -->
         sign.autoplay = true;
         sign.controller = controller;
         container.appendChild(sign);
         return;
       }
     }
   };
 }
&lt;/script&gt;</pre>

  </div>


  <h6 id="audiotracklist-and-videotracklist-objects"><span class="secno">4.7.10.10.1 </span><code><a href="#audiotracklist">AudioTrackList</a></code> and <code><a href="#videotracklist">VideoTrackList</a></code> objects</h6>

  <p>The <code><a href="#audiotracklist">AudioTrackList</a></code> and <code><a href="#videotracklist">VideoTrackList</a></code> interfaces are used by
  attributes defined in the previous section.</p>

  <pre class="idl">interface <dfn id="audiotracklist">AudioTrackList</dfn> : <a href="infrastructure.html#eventtarget">EventTarget</a> {
  readonly attribute unsigned long <a data-anolis-xref="dom-AudioTrackList-length" href="#dom-audiotracklist-length">length</a>;
  getter <a href="#audiotrack">AudioTrack</a> (unsigned long index);
  <a href="#audiotrack">AudioTrack</a>? <a data-anolis-xref="dom-AudioTrackList-getTrackById" href="#dom-audiotracklist-gettrackbyid">getTrackById</a>(DOMString id);

           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TrackList-onchange" href="#handler-tracklist-onchange">onchange</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TrackList-onaddtrack" href="#handler-tracklist-onaddtrack">onaddtrack</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TrackList-onremovetrack" href="#handler-tracklist-onremovetrack">onremovetrack</a>;
};

interface <dfn id="audiotrack">AudioTrack</dfn> {
  readonly attribute DOMString <a data-anolis-xref="dom-AudioTrack-id" href="#dom-audiotrack-id">id</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-AudioTrack-kind" href="#dom-audiotrack-kind">kind</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-AudioTrack-label" href="#dom-audiotrack-label">label</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-AudioTrack-language" href="#dom-audiotrack-language">language</a>;
           attribute boolean <a data-anolis-xref="dom-AudioTrack-enabled" href="#dom-audiotrack-enabled">enabled</a>;
};

interface <dfn id="videotracklist">VideoTrackList</dfn> : <a href="infrastructure.html#eventtarget">EventTarget</a> {
  readonly attribute unsigned long <a data-anolis-xref="dom-VideoTrackList-length" href="#dom-videotracklist-length">length</a>;
  getter <a href="#videotrack">VideoTrack</a> (unsigned long index);
  <a href="#videotrack">VideoTrack</a>? <a data-anolis-xref="dom-VideoTrackList-getTrackById" href="#dom-videotracklist-gettrackbyid">getTrackById</a>(DOMString id);
  readonly attribute long <a data-anolis-xref="dom-VideoTrackList-selectedIndex" href="#dom-videotracklist-selectedindex">selectedIndex</a>;

           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TrackList-onchange" href="#handler-tracklist-onchange">onchange</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TrackList-onaddtrack" href="#handler-tracklist-onaddtrack">onaddtrack</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TrackList-onremovetrack" href="#handler-tracklist-onremovetrack">onremovetrack</a>;
};

interface <dfn id="videotrack">VideoTrack</dfn> {
  readonly attribute DOMString <a data-anolis-xref="dom-VideoTrack-id" href="#dom-videotrack-id">id</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-VideoTrack-kind" href="#dom-videotrack-kind">kind</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-VideoTrack-label" href="#dom-videotrack-label">label</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-VideoTrack-language" href="#dom-videotrack-language">language</a>;
           attribute boolean <a data-anolis-xref="dom-VideoTrack-selected" href="#dom-videotrack-selected">selected</a>;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-audioTracks"><a href="#dom-media-audiotracks">audioTracks</a></code> . <code data-anolis-xref="dom-AudioTrackList-length"><a href="#dom-audiotracklist-length">length</a></code></dt>
   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code> . <code data-anolis-xref="dom-VideoTrackList-length"><a href="#dom-videotracklist-length">length</a></code></dt>

   <dd>

    <p>Returns the number of tracks in the list.</p>

   </dd>

   <dt><var data-anolis-xref="">audioTrack</var> = <var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-audioTracks"><a href="#dom-media-audiotracks">audioTracks</a></code>[<var data-anolis-xref="">index</var>]</dt>
   <dt><var data-anolis-xref="">videoTrack</var> = <var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code>[<var data-anolis-xref="">index</var>]</dt>

   <dd>

    <p>Returns the specified <code><a href="#audiotrack">AudioTrack</a></code> or <code><a href="#videotrack">VideoTrack</a></code> object.</p>

   </dd>

   <dt><var data-anolis-xref="">audioTrack</var> = <var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-audioTracks"><a href="#dom-media-audiotracks">audioTracks</a></code> . <code data-anolis-xref="dom-AudioTrackList-getTrackById"><a href="#dom-audiotracklist-gettrackbyid">getTrackById</a></code>( <var data-anolis-xref="">id</var> )</dt>
   <dt><var data-anolis-xref="">videoTrack</var> = <var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code> . <code data-anolis-xref="dom-VideoTrackList-getTrackById"><a href="#dom-videotracklist-gettrackbyid">getTrackById</a></code>( <var data-anolis-xref="">id</var> )</dt>

   <dd>

    <p>Returns the <code><a href="#audiotrack">AudioTrack</a></code> or <code><a href="#videotrack">VideoTrack</a></code> object with the given identifier, or null if no track has that identifier.</p>

   </dd>

   <dt><var data-anolis-xref="">audioTrack</var> . <code data-anolis-xref="dom-AudioTrack-id"><a href="#dom-audiotrack-id">id</a></code></dt>
   <dt><var data-anolis-xref="">videoTrack</var> . <code data-anolis-xref="dom-VideoTrack-id"><a href="#dom-videotrack-id">id</a></code></dt>

   <dd>

    <p>Returns the ID of the given track. This is the ID that can be used with a fragment identifier
    if the format supports the <cite>Media Fragments URI</cite> syntax, and that can be used with
    the <code data-anolis-xref="">getTrackById()</code> method. <a href="references.html#refsMEDIAFRAG">[MEDIAFRAG]</a></p>

   </dd>

   <dt><var data-anolis-xref="">audioTrack</var> . <code data-anolis-xref="dom-AudioTrack-kind"><a href="#dom-audiotrack-kind">kind</a></code></dt>
   <dt><var data-anolis-xref="">videoTrack</var> . <code data-anolis-xref="dom-VideoTrack-kind"><a href="#dom-videotrack-kind">kind</a></code></dt>

   <dd>

    <p>Returns the category the given track falls into. The <a href="#dom-TrackList-getKind-categories">possible track categories</a> are given below.</p>

   </dd>

   <dt><var data-anolis-xref="">audioTrack</var> . <code data-anolis-xref="dom-AudioTrack-label"><a href="#dom-audiotrack-label">label</a></code></dt>
   <dt><var data-anolis-xref="">videoTrack</var> . <code data-anolis-xref="dom-VideoTrack-label"><a href="#dom-videotrack-label">label</a></code></dt>

   <dd>

    <p>Returns the label of the given track, if known, or the empty string otherwise.</p>

   </dd>

   <dt><var data-anolis-xref="">audioTrack</var> . <code data-anolis-xref="dom-AudioTrack-language"><a href="#dom-audiotrack-language">language</a></code></dt>
   <dt><var data-anolis-xref="">videoTrack</var> . <code data-anolis-xref="dom-VideoTrack-language"><a href="#dom-videotrack-language">language</a></code></dt>

   <dd>

    <p>Returns the language of the given track, if known, or the empty string otherwise.</p>

   </dd>

   <dt><var data-anolis-xref="">audioTrack</var> . <code data-anolis-xref="dom-AudioTrack-enabled"><a href="#dom-audiotrack-enabled">enabled</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns true if the given track is active, and false otherwise.</p>

    <p>Can be set, to change whether the track is enabled or not. If multiple audio tracks are
    enabled simultaneously, they are mixed.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code> . <code data-anolis-xref="dom-VideoTrackList-selectedIndex"><a href="#dom-videotracklist-selectedindex">selectedIndex</a></code></dt>

   <dd>

    <p>Returns the index of the currently selected track, if any, or −1 otherwise.</p>

   </dd>

   <dt><var data-anolis-xref="">videoTrack</var> . <code data-anolis-xref="dom-VideoTrack-selected"><a href="#dom-videotrack-selected">selected</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns true if the given track is active, and false otherwise.</p>

    <p>Can be set, to change whether the track is selected or not. Either zero or one video track is
    selected; selecting a new track while a previous one is selected will unselect the previous
    one.</p>

   </dd>

  </dl><div class="impl">

  <p>An <code><a href="#audiotracklist">AudioTrackList</a></code> object represents a dynamic list of zero or more audio tracks,
  of which zero or more can be enabled at a time. Each audio track is represented by an
  <code><a href="#audiotrack">AudioTrack</a></code> object.</p>

  <p>A <code><a href="#videotracklist">VideoTrackList</a></code> object represents a dynamic list of zero or more video tracks, of
  which zero or one can be selected at a time. Each video track is represented by a
  <code><a href="#videotrack">VideoTrack</a></code> object.</p>

  <p>Tracks in <code><a href="#audiotracklist">AudioTrackList</a></code> and <code><a href="#videotracklist">VideoTrackList</a></code> objects must be
  consistently ordered. If the <a href="#media-resource">media resource</a> is in a format that defines an order,
  then that order must be used; otherwise, the order must be the relative order in which the tracks
  are declared in the <a href="#media-resource">media resource</a>. The order used is called the <i>natural order</i>
  of the list.</p>

  <p class="note">Each track in a <code>TrackList</code> thus has an index; the first has the index
  0, and each subsequent track is numbered one higher than the previous one. If a <a href="#media-resource">media
  resource</a> dynamically adds or removes audio or video tracks, then the indices of the tracks
  will change dynamically. If the <a href="#media-resource">media resource</a> changes entirely, then all the
  previous tracks will be removed and replaced with new tracks.</p>

  <p>The <dfn data-anolis-xref="dom-AudioTrackList-length" id="dom-audiotracklist-length"><code>AudioTrackList.length</code></dfn> and <dfn data-anolis-xref="dom-VideoTrackList-length" id="dom-videotracklist-length"><code>VideoTrackList.length</code></dfn> attributes must return
  the number of tracks represented by their objects at the time of getting.</p>

  <p>The <a href="infrastructure.html#supported-property-indices">supported property indices</a> of <code><a href="#audiotracklist">AudioTrackList</a></code> and
  <code><a href="#videotracklist">VideoTrackList</a></code> objects at any instant are the numbers from zero to the number of
  tracks represented by the respective object minus one, if any tracks are represented. If an
  <code><a href="#audiotracklist">AudioTrackList</a></code> or <code><a href="#videotracklist">VideoTrackList</a></code> object represents no tracks, it has no
  <a href="infrastructure.html#supported-property-indices">supported property indices</a>.</p>

  <p>To <a href="infrastructure.html#determine-the-value-of-an-indexed-property">determine the value of an indexed property</a> for a given index <var data-anolis-xref="">index</var> in an <code><a href="#audiotracklist">AudioTrackList</a></code> or <code><a href="#videotracklist">VideoTrackList</a></code> object <var data-anolis-xref="">list</var>, the user agent must return the <code><a href="#audiotrack">AudioTrack</a></code> or
  <code><a href="#videotrack">VideoTrack</a></code> object that represents the <var data-anolis-xref="">index</var>th track in <var data-anolis-xref="">list</var>.</p>

  <p>The <dfn data-anolis-xref="dom-AudioTrackList-getTrackById" id="dom-audiotracklist-gettrackbyid"><code>AudioTrackList.getTrackById(<var data-anolis-xref="">id</var>)</code></dfn> and <dfn data-anolis-xref="dom-VideoTrackList-getTrackById" id="dom-videotracklist-gettrackbyid"><code>VideoTrackList.getTrackById(<var data-anolis-xref="">id</var>)</code></dfn> methods must return the first <code><a href="#audiotrack">AudioTrack</a></code> or
  <code><a href="#videotrack">VideoTrack</a></code> object (respectively) in the <code><a href="#audiotracklist">AudioTrackList</a></code> or
  <code><a href="#videotracklist">VideoTrackList</a></code> object (respectively) whose identifier is equal to the value of the
  <var data-anolis-xref="">id</var> argument (in the natural order of the list, as defined above). When no
  tracks match the given argument, the methods must return null.</p>

  <p>The <code><a href="#audiotrack">AudioTrack</a></code> and <code><a href="#videotrack">VideoTrack</a></code> objects represent specific tracks of a
  <a href="#media-resource">media resource</a>. Each track can have an identifier, category, label, and language.
  These aspects of a track are permanent for the lifetime of the track; even if a track is removed
  from a <a href="#media-resource">media resource</a>'s <code><a href="#audiotracklist">AudioTrackList</a></code> or <code><a href="#videotracklist">VideoTrackList</a></code>
  objects, those aspects do not change.</p>

  <p>In addition, <code><a href="#audiotrack">AudioTrack</a></code> objects can each be enabled or disabled; this is the audio
  track's <i>enabled state</i>. When an <code><a href="#audiotrack">AudioTrack</a></code> is created, its <i>enabled state</i>
  must be set to false (disabled). The <a data-anolis-xref="concept-media-load-resource" href="#concept-media-load-resource">resource fetch
  algorithm</a> can override this.</p>

  <p>Similarly, a single <code><a href="#videotrack">VideoTrack</a></code> object per <code><a href="#videotracklist">VideoTrackList</a></code> object can
  be selected, this is the video track's <i>selection state</i>. When a <code><a href="#videotrack">VideoTrack</a></code> is
  created, its <i>selection state</i> must be set to false (not selected). The <a data-anolis-xref="concept-media-load-resource" href="#concept-media-load-resource">resource fetch algorithm</a> can override this.</p>

  <p>The <dfn data-anolis-xref="dom-AudioTrack-id" id="dom-audiotrack-id"><code>AudioTrack.id</code></dfn> and <dfn data-anolis-xref="dom-VideoTrack-id" id="dom-videotrack-id"><code>VideoTrack.id</code></dfn> attributes must return the identifier
  of the track, if it has one, or the empty string otherwise. If the <a href="#media-resource">media resource</a> is
  in a format that supports the <cite>Media Fragments URI</cite> fragment identifier syntax, the
  identifier returned for a particular track must be the same identifier that would enable the track
  if used as the name of a track in the track dimension of such a fragment identifier. <a href="references.html#refsMEDIAFRAG">[MEDIAFRAG]</a></p>

  <p class="example">For example, in Ogg files, this would be the Name header field of the track. <a href="references.html#refsOGGSKELETONHEADERS">[OGGSKELETONHEADERS]</a></p>

  <p>The <dfn data-anolis-xref="dom-AudioTrack-kind" id="dom-audiotrack-kind"><code>AudioTrack.kind</code></dfn> and <dfn data-anolis-xref="dom-VideoTrack-kind" id="dom-videotrack-kind"><code>VideoTrack.kind</code></dfn> attributes must return the category
  of the track, if it has one, or the empty string otherwise.</p>

  <p>The category of a track is the string given in the first column of the table below that is the
  most appropriate for the track based on the definitions in the table's second and third columns,
  as determined by the metadata included in the track in the <a href="#media-resource">media resource</a>. The cell
  in the third column of a row says what the category given in the cell in the first column of that
  row applies to; a category is only appropriate for an audio track if it applies to audio tracks,
  and a category is only appropriate for video tracks if it applies to video tracks. Categories must
  only be returned for <code><a href="#audiotrack">AudioTrack</a></code> objects if they are appropriate for audio, and must
  only be returned for <code><a href="#videotrack">VideoTrack</a></code> objects if they are appropriate for video.</p>

  </div>

  <table id="dom-TrackList-getKind-categories"><caption>Return values for <code data-anolis-xref="dom-AudioTrack-kind"><a href="#dom-audiotrack-kind">AudioTrack.kind()</a></code> and <code data-anolis-xref="dom-VideoTrack-kind"><a href="#dom-videotrack-kind">VideoTrack.kind()</a></code></caption>
   <thead><tr><th>Category
     <th>Definition
     <th>Applies to...</th>
   <tbody><tr><td>"<dfn data-anolis-xref="value-track-kind-alternate" id="value-track-kind-alternate"><code>alternative</code></dfn>"
     <td>A possible alternative to the main track, e.g. a different take of a song (audio), or a different angle (video).
     <td>Audio and video.

    <tr><td>"<dfn data-anolis-xref="value-track-kind-caption" id="value-track-kind-caption"><code>captions</code></dfn>"
     <td>A version of the main video track with captions burnt in. (For legacy content; new content would use text tracks.)
     <td>Video only.

    <tr><td>"<dfn data-anolis-xref="value-track-kind-descriptions" id="value-track-kind-descriptions"><code>descriptions</code></dfn>"
     <td>An audio description of a video track.
     <td>Audio only.

    <tr><td>"<dfn data-anolis-xref="value-track-kind-main" id="value-track-kind-main"><code>main</code></dfn>"
     <td>The primary audio or video track.
     <td>Audio and video.

    <tr><td>"<dfn data-anolis-xref="value-track-kind-main-desc" id="value-track-kind-main-desc"><code>main-desc</code></dfn>"
     <td>The primary audio track, mixed with audio descriptions.
     <td>Audio only.

    <tr><td>"<dfn data-anolis-xref="value-track-kind-sign" id="value-track-kind-sign"><code>sign</code></dfn>"
     <td>A sign-language interpretation of an audio track.
     <td>Video only.

    <tr><td>"<dfn data-anolis-xref="value-track-kind-subtitle" id="value-track-kind-subtitle"><code>subtitles</code></dfn>"
     <td>A version of the main video track with subtitles burnt in. (For legacy content; new content would use text tracks.)
     <td>Video only.

    <tr><td>"<dfn data-anolis-xref="value-track-kind-translation" id="value-track-kind-translation"><code>translation</code></dfn>"
     <td>A translated version of the main audio track.
     <td>Audio only.

    <tr><td>"<dfn data-anolis-xref="value-track-kind-commentary" id="value-track-kind-commentary"><code>commentary</code></dfn>"
     <td>Commentary on the primary audio or video track, e.g. a director's commentary.
     <td>Audio and video.

    <tr><td>"<dfn data-anolis-xref="value-track-kind-none" id="value-track-kind-none"><code></code></dfn>" (empty string)
     <td>No explicit kind, or the kind given by the track's metadata is not recognised by the user agent.
     <td>Audio and video.

  </table><div class="impl">

  <p>The <dfn data-anolis-xref="dom-AudioTrack-label" id="dom-audiotrack-label"><code>AudioTrack.label</code></dfn> and <dfn data-anolis-xref="dom-VideoTrack-label" id="dom-videotrack-label"><code>VideoTrack.label</code></dfn> attributes must return the label
  of the track, if it has one, or the empty string otherwise.</p>

  <p>The <dfn data-anolis-xref="dom-AudioTrack-language" id="dom-audiotrack-language"><code>AudioTrack.language</code></dfn> and <dfn data-anolis-xref="dom-VideoTrack-language" id="dom-videotrack-language"><code>VideoTrack.language</code></dfn> attributes must return the
  BCP 47 language tag of the language of the track, if it has one, or the empty string otherwise. If
  the user agent is not able to express that language as a BCP 47 language tag (for example because
  the language information in the <a href="#media-resource">media resource</a>'s format is a free-form string without
  a defined interpretation), then the method must return the empty string, as if the track had no
  language.</p>

  <p>Source attribute values for id, kind, label and language of multitrack audio and video tracks as
  described for the relevant <a href="#media-resource">media resource</a> format. <a href="references.html#refsINBANDTRACKS">[INBANDTRACKS]</a></p>

  <p>The <dfn data-anolis-xref="dom-AudioTrack-enabled" id="dom-audiotrack-enabled"><code>AudioTrack.enabled</code></dfn> attribute, on
  getting, must return true if the track is currently enabled, and false otherwise. On setting, it
  must enable the track if the new value is true, and disable it otherwise. (If the track is no
  longer in an <code><a href="#audiotracklist">AudioTrackList</a></code> object, then the track being enabled or disabled has no
  effect beyond changing the value of the attribute on the <code><a href="#audiotrack">AudioTrack</a></code> object.)</p>

  <p>Whenever an audio track in an <code><a href="#audiotracklist">AudioTrackList</a></code> is enabled or disabled, the user
  agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-change"><a href="#event-media-change">change</a></code> at the <code><a href="#audiotracklist">AudioTrackList</a></code> object.</p>

  <p>The <dfn data-anolis-xref="dom-VideoTrackList-selectedIndex" id="dom-videotracklist-selectedindex"><code>VideoTrackList.selectedIndex</code></dfn> attribute
  must return the index of the currently selected track, if any. If the <code><a href="#videotracklist">VideoTrackList</a></code>
  object does not currently represent any tracks, or if none of the tracks are selected, it must
  instead return −1.</p>

  <p>The <dfn data-anolis-xref="dom-VideoTrack-selected" id="dom-videotrack-selected"><code>VideoTrack.selected</code></dfn> attribute, on
  getting, must return true if the track is currently selected, and false otherwise. On setting, it
  must select the track if the new value is true, and unselect it otherwise. If the track is in a
  <code><a href="#videotracklist">VideoTrackList</a></code>, then all the other <code><a href="#videotrack">VideoTrack</a></code> objects in that list must
  be unselected. (If the track is no longer in a <code><a href="#videotracklist">VideoTrackList</a></code> object, then the track
  being selected or unselected has no effect beyond changing the value of the attribute on the
  <code><a href="#videotrack">VideoTrack</a></code> object.)</p>

  <p>Whenever a track in a <code><a href="#videotracklist">VideoTrackList</a></code> that was previously not selected is selected,
  the user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-media-change"><a href="#event-media-change">change</a></code> at the <code><a href="#videotracklist">VideoTrackList</a></code> object. This <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> must be <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> before the
  <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that fires the <code data-anolis-xref="event-media-resize"><a href="#event-media-resize">resize</a></code> event, if any.</p>

  <hr><p>The following are the <a href="webappapis.html#event-handlers">event handlers</a> (and their corresponding <a data-anolis-xref="event
  handler event type" href="webappapis.html#event-handler-event-type">event handler event types</a>) <span class="impl">that must be</span> supported, as <a href="webappapis.html#event-handler-idl-attributes">event handler IDL attributes</a>,
  by all objects implementing the <code><a href="#audiotracklist">AudioTrackList</a></code> and <code><a href="#videotracklist">VideoTrackList</a></code>
  interfaces:</p>

  <table><thead><tr><th><a data-anolis-xref="event handlers" href="webappapis.html#event-handlers">Event handler</a> <th><a href="webappapis.html#event-handler-event-type">Event handler event type</a>
   <tbody><tr><td><dfn data-anolis-xref="handler-TrackList-onchange" id="handler-tracklist-onchange"><code>onchange</code></dfn> <td> <code data-anolis-xref="event-media-change"><a href="#event-media-change">change</a></code>
    <tr><td><dfn data-anolis-xref="handler-TrackList-onaddtrack" id="handler-tracklist-onaddtrack"><code>onaddtrack</code></dfn> <td> <code data-anolis-xref="event-media-addtrack"><a href="#event-media-addtrack">addtrack</a></code>
    <tr><td><dfn data-anolis-xref="handler-TrackList-onremovetrack" id="handler-tracklist-onremovetrack"><code>onremovetrack</code></dfn> <td> <code data-anolis-xref="event-media-removetrack"><a href="#event-media-removetrack">removetrack</a></code>
  </table><hr><p>The <a href="webappapis.html#task-source">task source</a> for the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> listed in this
  section is the <a href="webappapis.html#dom-manipulation-task-source">DOM manipulation task source</a>.</p>

  <!-- v2 should also fire an event when the list changes (but note that that should be on the media element event task source) -->

  </div>


  <h6 id="selecting-specific-audio-and-video-tracks-declaratively"><span class="secno">4.7.10.10.2 </span>Selecting specific audio and video tracks declaratively</h6>

  <p>The <code data-anolis-xref="dom-media-audioTracks"><a href="#dom-media-audiotracks">audioTracks</a></code> and <code data-anolis-xref="dom-media-videoTracks"><a href="#dom-media-videotracks">videoTracks</a></code> attributes allow scripts to select which track
  should play, but it is also possible to select specific tracks declaratively, by specifying
  particular tracks in the fragment identifier of the <span>URL</span> of the <a href="#media-resource">media
  resource</a>. The format of the fragment identifier depends on the <a href="infrastructure.html#mime-type">MIME type</a> of
  the <a href="#media-resource">media resource</a>. <a href="references.html#refsRFC2046">[RFC2046]</a> <a href="references.html#refsURL">[URL]</a></p>

  <div class="example">

   <p>In this example, a video that uses a format that supports the <cite>Media Fragments URI</cite>
   fragment identifier syntax is embedded in such a way that the alternative angles labeled
   "Alternative" are enabled instead of the default video track. <a href="references.html#refsMEDIAFRAG">[MEDIAFRAG]</a></p>

   <pre>&lt;video src="myvideo#track=Alternative"&gt;&lt;/video&gt;</pre>

  </div>


  <h5 id="synchronising-multiple-media-elements"><span class="secno">4.7.10.11 </span>Synchronising multiple media elements</h5>

  <h6 id="introduction-0"><span class="secno">4.7.10.11.1 </span>Introduction</h6>

  <p>Each <a href="#media-element">media element</a> can have a <code><a href="#mediacontroller">MediaController</a></code>. A
  <code><a href="#mediacontroller">MediaController</a></code> is an object that coordinates the playback of multiple <a data-anolis-xref="media element" href="#media-element">media elements</a>, for instance so that a sign-language interpreter
  track can be overlaid on a video track, with the two being kept in sync.</p>

  <p>By default, a <a href="#media-element">media element</a> has no <code><a href="#mediacontroller">MediaController</a></code>. An implicit
  <code><a href="#mediacontroller">MediaController</a></code> can be assigned using the <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> content attribute. An explicit
  <code><a href="#mediacontroller">MediaController</a></code> can be assigned directly using the <code data-anolis-xref="dom-media-controller"><a href="#dom-media-controller">controller</a></code> IDL attribute.</p>

  <p><a data-anolis-xref="media element" href="#media-element">Media elements</a> with a <code><a href="#mediacontroller">MediaController</a></code> are said
  to be <i>slaved</i> to their controller. The <code><a href="#mediacontroller">MediaController</a></code> modifies the playback
  rate and the playback volume of each of the <a data-anolis-xref="media element" href="#media-element">media elements</a>
  slaved to it, and ensures that when any of its slaved <a data-anolis-xref="media element" href="#media-element">media
  elements</a> unexpectedly stall, the others are stopped at the same time.</p>

  <p>When a <a href="#media-element">media element</a> is slaved to a <code><a href="#mediacontroller">MediaController</a></code>, its playback
  rate is fixed to that of the other tracks in the same <code><a href="#mediacontroller">MediaController</a></code>, and any
  looping is disabled.</p>

<!-- v2: add control to loop, add control to playback rate
  <div class="example">

   <p>In this example, two audio elements are slaved to the same (implicit) controller so that a
   waltz played by one audio element is kept exactly synchronised to the "tick tock tock" sound of
   the metronome played by the second element:</p>

   <pre>&lt;audio src="The%20Amelia%20Earhart%20Waltz.wav" controls autoplay mediagroup="song">&lt;/audio>
&lt;audio src="metronomes/3-4.wav" autoplay loop mediagroup="song">&lt;/audio></pre>

   <p>Assuming the song keeps a regular tempo throughout and assuming the metronome has the same
   tempo, this works even though if the metronome file only has one measure's worth of "tick tock
   tock", because the controller (implied by the <code
   data-x="attr-media-mediagroup">mediagroup</code> attribute) guarantees that the two elements will
   be kept synchronised, even if the user rewinds, jumps to a different part of the song, etc (the
   user agent controls made available by the <code data-x="attr-media-controls">controls</code>
   attribute on the song's <code>audio</code> element affect the <code>MediaController</code>'s
   state).</p>

   <p>If the metronome has the wrong rate, its rate can be adjusted by script separately from the
   song's (using the <code data-x="dom-media-playbackRate">audio.playbackRate</code> IDL attribute).
   The two elements will play back their <span>media data</span> at different rates, but the ratio
   will again be controlled by the <code>MediaController</code>.</p>

  </div>
-->


  <h6 id="media-controllers"><span class="secno">4.7.10.11.2 </span>Media controllers</h6>

  <pre class="idl">enum <dfn id="mediacontrollerplaybackstate">MediaControllerPlaybackState</dfn> { "<a data-anolis-xref="dom-MediaController-waiting" href="#dom-mediacontroller-waiting">waiting</a>", "<a data-anolis-xref="dom-MediaController-playing" href="#dom-mediacontroller-playing">playing</a>", "<a data-anolis-xref="dom-MediaController-ended" href="#dom-mediacontroller-ended">ended</a>" };
[<a data-anolis-xref="dom-MediaController" href="#dom-mediacontroller">Constructor</a>]
interface <dfn id="mediacontroller">MediaController</dfn> : <a href="infrastructure.html#eventtarget">EventTarget</a> {
  readonly attribute unsigned short <a data-anolis-xref="dom-MediaController-readyState" href="#dom-mediacontroller-readystate">readyState</a>; // uses <a href="#htmlmediaelement">HTMLMediaElement</a>.<a data-anolis-xref="dom-media-readyState" href="#dom-media-readystate">readyState</a>'s values

  readonly attribute <a href="#timeranges">TimeRanges</a> <a data-anolis-xref="dom-MediaController-buffered" href="#dom-mediacontroller-buffered">buffered</a>;
  readonly attribute <a href="#timeranges">TimeRanges</a> <a data-anolis-xref="dom-MediaController-seekable" href="#dom-mediacontroller-seekable">seekable</a>;
  readonly attribute unrestricted double <a data-anolis-xref="dom-MediaController-duration" href="#dom-mediacontroller-duration">duration</a>;
           attribute double <a data-anolis-xref="dom-MediaController-currentTime" href="#dom-mediacontroller-currenttime">currentTime</a>;

  readonly attribute boolean <a data-anolis-xref="dom-MediaController-paused" href="#dom-mediacontroller-paused">paused</a>;
  readonly attribute <a href="#mediacontrollerplaybackstate">MediaControllerPlaybackState</a> <a data-anolis-xref="dom-MediaController-playbackState" href="#dom-mediacontroller-playbackstate">playbackState</a>;
  readonly attribute <a href="#timeranges">TimeRanges</a> <a data-anolis-xref="dom-MediaController-played" href="#dom-mediacontroller-played">played</a>;
  void <a data-anolis-xref="dom-MediaController-pause" href="#dom-mediacontroller-pause">pause</a>();
  void <a data-anolis-xref="dom-MediaController-unpause" href="#dom-mediacontroller-unpause">unpause</a>();
  void <a data-anolis-xref="dom-MediaController-play" href="#dom-mediacontroller-play">play</a>(); // calls play() on all media elements as well

           attribute double <a data-anolis-xref="dom-MediaController-defaultPlaybackRate" href="#dom-mediacontroller-defaultplaybackrate">defaultPlaybackRate</a>;
           attribute double <a data-anolis-xref="dom-MediaController-playbackRate" href="#dom-mediacontroller-playbackrate">playbackRate</a>;

           attribute double <a data-anolis-xref="dom-MediaController-volume" href="#dom-mediacontroller-volume">volume</a>;
           attribute boolean <a data-anolis-xref="dom-MediaController-muted" href="#dom-mediacontroller-muted">muted</a>;

           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-onemptied" href="#handler-mediacontroller-onemptied">onemptied</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-onloadedmetadata" href="#handler-mediacontroller-onloadedmetadata">onloadedmetadata</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-onloadeddata" href="#handler-mediacontroller-onloadeddata">onloadeddata</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-oncanplay" href="#handler-mediacontroller-oncanplay">oncanplay</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-oncanplaythrough" href="#handler-mediacontroller-oncanplaythrough">oncanplaythrough</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-onplaying" href="#handler-mediacontroller-onplaying">onplaying</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-onended" href="#handler-mediacontroller-onended">onended</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-onwaiting" href="#handler-mediacontroller-onwaiting">onwaiting</a>;

           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-ondurationchange" href="#handler-mediacontroller-ondurationchange">ondurationchange</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-ontimeupdate" href="#handler-mediacontroller-ontimeupdate">ontimeupdate</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-onplay" href="#handler-mediacontroller-onplay">onplay</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-onpause" href="#handler-mediacontroller-onpause">onpause</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-onratechange" href="#handler-mediacontroller-onratechange">onratechange</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-MediaController-onvolumechange" href="#handler-mediacontroller-onvolumechange">onvolumechange</a>;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">controller</var> = new <code data-anolis-xref="dom-MediaController"><a href="#dom-mediacontroller">MediaController</a></code>()</dt>

   <dd>

    <p>Returns a new <code><a href="#mediacontroller">MediaController</a></code> object.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-controller"><a href="#dom-media-controller">controller</a></code> [ = <var data-anolis-xref="">controller</var> ]</dt>

   <dd>

    <p>Returns the current <code><a href="#mediacontroller">MediaController</a></code> for the <a href="#media-element">media element</a>, if any;
    returns null otherwise.</p>

    <p>Can be set, to set an explicit <code><a href="#mediacontroller">MediaController</a></code>. Doing so removes the <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> attribute, if any.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-readyState"><a href="#dom-mediacontroller-readystate">readyState</a></code></dt>

   <dd>

    <p>Returns the state that the <code><a href="#mediacontroller">MediaController</a></code> was in the last time it fired events
    as a result of <a data-anolis-xref="report the controller state" href="#report-the-controller-state">reporting the controller state</a>.
    The values of this attribute are the same as for the <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> attribute of <a data-anolis-xref="media element" href="#media-element">media
    elements</a>.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-buffered"><a href="#dom-mediacontroller-buffered">buffered</a></code></dt>

   <dd>

    <p>Returns a <code><a href="#timeranges">TimeRanges</a></code> object that represents the intersection of the time ranges
    for which the user agent has all relevant media data for all the slaved <a data-anolis-xref="media
    element" href="#media-element">media elements</a>.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-seekable"><a href="#dom-mediacontroller-seekable">seekable</a></code></dt>

   <dd>

    <p>Returns a <code><a href="#timeranges">TimeRanges</a></code> object that represents the intersection of the time ranges
    into which the user agent can seek for all the slaved <a data-anolis-xref="media element" href="#media-element">media
    elements</a>.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-duration"><a href="#dom-mediacontroller-duration">duration</a></code></dt>

   <dd>

    <p>Returns the difference between the earliest playable moment and the latest playable moment
    (not considering whether the data in question is actually buffered or directly seekable, but not
    including time in the future for infinite streams). Will return zero if there is no media.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-currentTime"><a href="#dom-mediacontroller-currenttime">currentTime</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns the <a href="#current-playback-position">current playback position</a>, in seconds, as a position between zero
    time and the current <code data-anolis-xref="dom-MediaController-duration"><a href="#dom-mediacontroller-duration">duration</a></code>.</p>

    <p>Can be set, to seek to the given time.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-paused"><a href="#dom-mediacontroller-paused">paused</a></code></dt>

   <dd>

    <p>Returns true if playback is paused; false otherwise. When this attribute is true, any
    <a href="#media-element">media element</a> slaved to this controller will be stopped.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-playbackState"><a href="#dom-mediacontroller-playbackstate">playbackState</a></code></dt>

   <dd>

    <p>Returns the state that the <code><a href="#mediacontroller">MediaController</a></code> was in the last time it fired events
    as a result of <a data-anolis-xref="report the controller state" href="#report-the-controller-state">reporting the controller state</a>.
    The value of this attribute is either "<code data-anolis-xref="dom-MediaController-playing"><a href="#dom-mediacontroller-playing">playing</a></code>", indicating that the media is actively
    playing, "<code data-anolis-xref="dom-MediaController-ended"><a href="#dom-mediacontroller-ended">ended</a></code>", indicating that the media is
    not playing because playback has reached the end of all the <a href="#slaved-media-elements">slaved media elements</a>,
    or "<code data-anolis-xref="dom-MediaController-waiting"><a href="#dom-mediacontroller-waiting">waiting</a></code>", indicating that the media is not
    playing for some other reason (e.g. the <code><a href="#mediacontroller">MediaController</a></code> is paused).</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-pause"><a href="#dom-mediacontroller-pause">pause</a></code>()</dt>

   <dd>

    <p>Sets the <code data-anolis-xref="dom-MediaController-paused"><a href="#dom-mediacontroller-paused">paused</a></code> attribute to true.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-unpause"><a href="#dom-mediacontroller-unpause">unpause</a></code>()</dt>

   <dd>

    <p>Sets the <code data-anolis-xref="dom-MediaController-paused"><a href="#dom-mediacontroller-paused">paused</a></code> attribute to false.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-play"><a href="#dom-mediacontroller-play">play</a></code>()</dt>

   <dd>

    <p>Sets the <code data-anolis-xref="dom-MediaController-paused"><a href="#dom-mediacontroller-paused">paused</a></code> attribute to false and
    invokes the <code data-anolis-xref="dom-media-play"><a href="#dom-media-play">play()</a></code> method of each <a data-anolis-xref="slaved media
    elements" href="#slaved-media-elements">slaved media element</a>.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-played"><a href="#dom-mediacontroller-played">played</a></code></dt>

   <dd>

    <p>Returns a <code><a href="#timeranges">TimeRanges</a></code> object that represents the union of the time ranges in all
    the slaved <a data-anolis-xref="media element" href="#media-element">media elements</a> that have been played.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-defaultPlaybackRate"><a href="#dom-mediacontroller-defaultplaybackrate">defaultPlaybackRate</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns the default rate of playback.</p>

    <p>Can be set, to change the default rate of playback.</p>

    <p>This default rate has no direct effect on playback, but if the user switches to a
    fast-forward mode, when they return to the normal playback mode, it is expected that rate of
    playback (<code data-anolis-xref="dom-MediaController-playbackRate"><a href="#dom-mediacontroller-playbackrate">playbackRate</a></code>) will be returned
    to this default rate.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-playbackRate"><a href="#dom-mediacontroller-playbackrate">playbackRate</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns the current rate of playback.</p>

    <p>Can be set, to change the rate of playback.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-volume"><a href="#dom-mediacontroller-volume">volume</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns the current playback volume multiplier, as a number in the range 0.0 to 1.0, where
    0.0 is the quietest and 1.0 the loudest.</p>

    <p>Can be set, to change the volume multiplier.</p>

    <p>Throws an <code><a href="infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception if the new value is not in the range 0.0 .. 1.0.</p>

   </dd>

   <dt><var data-anolis-xref="">controller</var> . <code data-anolis-xref="dom-MediaController-muted"><a href="#dom-mediacontroller-muted">muted</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns true if all audio is muted (regardless of other attributes either on the controller
    or on any <a data-anolis-xref="media element" href="#media-element">media elements</a> slaved to this controller), and
    false otherwise.</p>

    <p>Can be set, to change whether the audio is muted or not.</p>

   </dd>

  </dl><div class="impl">

  <p>A <a href="#media-element">media element</a> can have a <dfn id="current-media-controller">current media controller</dfn>, which is a
  <code><a href="#mediacontroller">MediaController</a></code> object. When a <a href="#media-element">media element</a> is created without a <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> attribute, it does not have a <a href="#current-media-controller">current media
  controller</a>. (If it is created <em>with</em> such an attribute, then that attribute
  initializes the <a href="#current-media-controller">current media controller</a>, as defined below.)</p>

  <p>The <dfn id="slaved-media-elements">slaved media elements</dfn> of a <code><a href="#mediacontroller">MediaController</a></code> are the <a data-anolis-xref="media element" href="#media-element">media elements</a> whose <a href="#current-media-controller">current media controller</a> is that
  <code><a href="#mediacontroller">MediaController</a></code>. All the <a href="#slaved-media-elements">slaved media elements</a> of a
  <code><a href="#mediacontroller">MediaController</a></code> must use the same clock for their definition of their <a href="#media-timeline">media
  timeline</a>'s unit time. When the user agent is required to act on each <a data-anolis-xref="slaved
  media elements" href="#slaved-media-elements">slaved media element</a> in turn, they must be processed in the order that they
  were last associated with the <code><a href="#mediacontroller">MediaController</a></code>.</p>

  <hr><p>The <dfn data-anolis-xref="dom-media-controller" id="dom-media-controller"><code>controller</code></dfn> attribute on a <a href="#media-element">media
  element</a>, on getting, must return the element's <a href="#current-media-controller">current media controller</a>, if
  any, or null otherwise. On setting, the user agent must run the following steps:</p>

  <ol><!-- very similar to the algorithm below for setting the content attribute --><li><p>Let <var data-anolis-xref="">m</var> be the <a href="#media-element">media element</a> in question.</li>

   <li><p>Let <var data-anolis-xref="">old controller</var> be <var data-anolis-xref="">m</var>'s <a href="#current-media-controller">current media
   controller</a>, if it currently has one, and null otherwise.</li>

   <li><p>Let <var data-anolis-xref="">new controller</var> be null.</li>

   <li><p>Let <var data-anolis-xref="">m</var> have no <a href="#current-media-controller">current media controller</a>, if it currently
   has one.</li>

   <li><p>Remove the element's <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> content
   attribute, if any.</li>

   <li><p>If the new value is null, then jump to the <i>update controllers</i> step below.</li>

   <li><p>Let <var data-anolis-xref="">m</var>'s <a href="#current-media-controller">current media controller</a> be the new
   value.</li>

   <li><p>Let <var data-anolis-xref="">new controller</var> be <var data-anolis-xref="">m</var>'s <a href="#current-media-controller">current media
   controller</a>.</li>

   <li><p><a href="#bring-the-media-element-up-to-speed-with-its-new-media-controller">Bring the media element up to speed with its new media controller</a>.</li>

   <li><p><i>Update controllers</i>: If <var data-anolis-xref="">old controller</var> and <var data-anolis-xref="">new
   controller</var> are the same (whether both null or both the same controller) then abort these
   steps.</li>

   <li><p>If <var data-anolis-xref="">old controller</var> is not null and still has one or more <a href="#slaved-media-elements">slaved
   media elements</a>, then <a href="#report-the-controller-state">report the controller state</a> for <var data-anolis-xref="">old
   controller</var>.</li>

   <li><p>If <var data-anolis-xref="">new controller</var> is not null, then <a href="#report-the-controller-state">report the controller
   state</a> for <var data-anolis-xref="">new controller</var>.</li>

  </ol><hr><p>The <dfn data-anolis-xref="dom-MediaController" id="dom-mediacontroller"><code>MediaController()</code></dfn> constructor, when
  invoked, must return a newly created <code><a href="#mediacontroller">MediaController</a></code> object.</p>

  <hr><p>The <dfn data-anolis-xref="dom-MediaController-readyState" id="dom-mediacontroller-readystate"><code>readyState</code></dfn> attribute must
  return the value to which it was most recently set. When the <code><a href="#mediacontroller">MediaController</a></code> object
  is created, the attribute must be set to the value 0 (<code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>). The value is updated by the <a href="#report-the-controller-state">report the
  controller state</a> algorithm below.</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-seekable" id="dom-mediacontroller-seekable"><code>seekable</code></dfn> attribute must return
  a new static <a href="#normalized-timeranges-object">normalized <code>TimeRanges</code> object</a> that represents the
  intersection of the ranges of the <a data-anolis-xref="media resource" href="#media-resource">media resources</a> of the
  <a href="#slaved-media-elements">slaved media elements</a> that the user agent is able to seek to, at the time the
  attribute is evaluated.</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-buffered" id="dom-mediacontroller-buffered"><code>buffered</code></dfn> attribute must return
  a new static <a href="#normalized-timeranges-object">normalized <code>TimeRanges</code> object</a> that represents the
  intersection of the ranges of the <a data-anolis-xref="media resource" href="#media-resource">media resources</a> of the
  <a href="#slaved-media-elements">slaved media elements</a> that the user agent has buffered, at the time the attribute is
  evaluated. Users agents must accurately determine the ranges available, even for media streams
  where this can only be determined by tedious inspection.</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-duration" id="dom-mediacontroller-duration"><code>duration</code></dfn> attribute must return
  the <a href="#media-controller-duration">media controller duration</a>.</p>

  <p>Every 15 to 250ms, or whenever the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-duration">media controller
  duration</a> changes, whichever happens least often, the user agent must <a href="webappapis.html#queue-a-task">queue a
  task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-MediaController-durationchange"><a href="#event-mediacontroller-durationchange">durationchange</a></code> at the
  <code><a href="#mediacontroller">MediaController</a></code>. If the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-duration">media controller
  duration</a> decreases such that the <a href="#media-controller-position">media controller position</a> is greater than the
  <a href="#media-controller-duration">media controller duration</a>, the user agent must immediately <a href="#seek-the-media-controller">seek the media
  controller</a> to <a href="#media-controller-duration">media controller duration</a>.</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-currentTime" id="dom-mediacontroller-currenttime"><code>currentTime</code></dfn> attribute must
  return the <a href="#media-controller-position">media controller position</a> on getting, and on setting must <a href="#seek-the-media-controller">seek the
  media controller</a> to the new value.</p>

  <p>Every 15 to 250ms, or whenever the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-position">media controller
  position</a> changes, whichever happens least often, the user agent must <a href="webappapis.html#queue-a-task">queue a
  task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-MediaController-timeupdate"><a href="#event-mediacontroller-timeupdate">timeupdate</a></code> at the
  <code><a href="#mediacontroller">MediaController</a></code>.</p>

  <hr><p>When a <code><a href="#mediacontroller">MediaController</a></code> is created it is a <dfn id="playing-media-controller">playing media controller</dfn>. It
  can be changed into a <dfn id="paused-media-controller">paused media controller</dfn> and back either via the user agent's user
  interface (when the element is <a data-anolis-xref="expose a user interface to the user" href="#expose-a-user-interface-to-the-user">exposing a user
  interface to the user</a>) or by script using the APIs defined in this section (see below).</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-paused" id="dom-mediacontroller-paused"><code>paused</code></dfn> attribute must return
  true if the <code><a href="#mediacontroller">MediaController</a></code> object is a <a href="#paused-media-controller">paused media controller</a>, and
  false otherwise.</p>

  <p>When the <dfn data-anolis-xref="dom-MediaController-pause" id="dom-mediacontroller-pause"><code>pause()</code></dfn> method is invoked,
  if the <code><a href="#mediacontroller">MediaController</a></code> is a <a href="#playing-media-controller">playing media controller</a> then the user agent
  must change the <code><a href="#mediacontroller">MediaController</a></code> into a <a href="#paused-media-controller">paused media controller</a>,
  <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-MediaController-pause"><a href="#event-mediacontroller-pause">pause</a></code> at the <code><a href="#mediacontroller">MediaController</a></code>, and then
  <a href="#report-the-controller-state">report the controller state</a> of the <code><a href="#mediacontroller">MediaController</a></code>.</p>

  <p>When the <dfn data-anolis-xref="dom-MediaController-unpause" id="dom-mediacontroller-unpause"><code>unpause()</code></dfn> method is
  invoked, if the <code><a href="#mediacontroller">MediaController</a></code> is a <a href="#paused-media-controller">paused media controller</a>, the user
  agent must change the <code><a href="#mediacontroller">MediaController</a></code> into a <a href="#playing-media-controller">playing media controller</a>,
  <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-MediaController-play"><a href="#event-mediacontroller-play">play</a></code> at the <code><a href="#mediacontroller">MediaController</a></code>, and then
  <a href="#report-the-controller-state">report the controller state</a> of the <code><a href="#mediacontroller">MediaController</a></code>.</p>

  <p>When the <dfn data-anolis-xref="dom-MediaController-play" id="dom-mediacontroller-play"><code>play()</code></dfn> method is invoked, the
  user agent must invoke the <code data-anolis-xref="dom-media-play"><a href="#dom-media-play">play()</a></code> method of each <a data-anolis-xref="slaved media elements" href="#slaved-media-elements">slaved media element</a> in turn, and then invoke the <code data-anolis-xref="dom-MediaController-unpause"><a href="#dom-mediacontroller-unpause">unpause</a></code> method of the <code><a href="#mediacontroller">MediaController</a></code>.</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-playbackState" id="dom-mediacontroller-playbackstate"><code>playbackState</code></dfn> attribute
  must return the value to which it was most recently set. When the <code><a href="#mediacontroller">MediaController</a></code>
  object is created, the attribute must be set to the value "<code data-anolis-xref="dom-MediaController-waiting"><a href="#dom-mediacontroller-waiting">waiting</a></code>". The value is updated by the <a href="#report-the-controller-state">report the
  controller state</a> algorithm below.</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-played" id="dom-mediacontroller-played"><code>played</code></dfn> attribute must return a
  new static <a href="#normalized-timeranges-object">normalized <code>TimeRanges</code> object</a> that represents the union of the
  ranges of points on the <a data-anolis-xref="media timeline" href="#media-timeline">media timelines</a> of the <a data-anolis-xref="media resource" href="#media-resource">media resources</a> of the <a href="#slaved-media-elements">slaved media elements</a> that the
  user agent has so far reached through the usual monotonic increase of their <a data-anolis-xref="current
  playback position" href="#current-playback-position">current playback positions</a> during normal playback, at the time the
  attribute is evaluated.</p>

  <hr><p>A <code><a href="#mediacontroller">MediaController</a></code> has a <dfn id="media-controller-default-playback-rate">media controller default playback rate</dfn> and a
  <dfn id="media-controller-playback-rate">media controller playback rate</dfn>, which must both be set to 1.0 when the
  <code><a href="#mediacontroller">MediaController</a></code> object is created.</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-defaultPlaybackRate" id="dom-mediacontroller-defaultplaybackrate"><code>defaultPlaybackRate</code></dfn>
  attribute, on getting, must return the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-default-playback-rate">media controller
  default playback rate</a>, and on setting, must set the <code><a href="#mediacontroller">MediaController</a></code>'s
  <a href="#media-controller-default-playback-rate">media controller default playback rate</a> to the new value, then <a href="webappapis.html#queue-a-task">queue a
  task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-MediaController-ratechange"><a href="#event-mediacontroller-ratechange">ratechange</a></code> at the
  <code><a href="#mediacontroller">MediaController</a></code>.</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-playbackRate" id="dom-mediacontroller-playbackrate"><code>playbackRate</code></dfn> attribute, on
  getting, must return the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-playback-rate">media controller playback
  rate</a>, and on setting, must set the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-playback-rate">media controller
  playback rate</a> to the new value, then <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple
  event</a> named <code data-anolis-xref="event-MediaController-ratechange"><a href="#event-mediacontroller-ratechange">ratechange</a></code> at the
  <code><a href="#mediacontroller">MediaController</a></code>.</p>

  <hr><p>A <code><a href="#mediacontroller">MediaController</a></code> has a <dfn id="media-controller-volume-multiplier">media controller volume multiplier</dfn>, which must
  be set to 1.0 when the <code><a href="#mediacontroller">MediaController</a></code> object is created, and a <dfn id="media-controller-mute-override">media controller
  mute override</dfn>, much must initially be false.</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-volume" id="dom-mediacontroller-volume"><code>volume</code></dfn> attribute, on getting,
  must return the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-volume-multiplier">media controller volume multiplier</a>,
  and on setting, if the new value is in the range 0.0 to 1.0 inclusive, must set the
  <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-volume-multiplier">media controller volume multiplier</a> to the new value
  and <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-MediaController-volumechange"><a href="#event-mediacontroller-volumechange">volumechange</a></code> at the
  <code><a href="#mediacontroller">MediaController</a></code>. If the new value is outside the range 0.0 to 1.0 inclusive, then, on
  setting, an <code><a href="infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception must be thrown instead.</p>

  <p>The <dfn data-anolis-xref="dom-MediaController-muted" id="dom-mediacontroller-muted"><code>muted</code></dfn> attribute, on getting, must
  return the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-mute-override">media controller mute override</a>, and on
  setting, must set the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-mute-override">media controller mute override</a>
  to the new value and <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-MediaController-volumechange"><a href="#event-mediacontroller-volumechange">volumechange</a></code> at the
  <code><a href="#mediacontroller">MediaController</a></code>.</p>

  <hr><p>The <a data-anolis-xref="media resource" href="#media-resource">media resources</a> of all the <a href="#slaved-media-elements">slaved media
  elements</a> of a <code><a href="#mediacontroller">MediaController</a></code> have a defined temporal relationship which
  provides relative offsets between the zero time of each such <a href="#media-resource">media resource</a>: for
  <a data-anolis-xref="media resource" href="#media-resource">media resources</a> with a <a href="#timeline-offset">timeline offset</a>, their
  relative offsets are the difference between their <a href="#timeline-offset">timeline offset</a>; the zero times of
  all the <a data-anolis-xref="media resource" href="#media-resource">media resources</a> without a <a href="#timeline-offset">timeline offset</a>
  are not offset from each other (i.e. the origins of their timelines are cotemporal); and finally,
  the zero time of the <a href="#media-resource">media resource</a> with the earliest <a href="#timeline-offset">timeline offset</a>
  (if any) is not offset from the zero times of the <a data-anolis-xref="media resource" href="#media-resource">media
  resources</a> without a <a href="#timeline-offset">timeline offset</a> (i.e. the origins of <a data-anolis-xref="media
  resource" href="#media-resource">media resources</a> without a <a href="#timeline-offset">timeline offset</a> are further cotemporal
  with the earliest defined point on the timeline of the <a href="#media-resource">media resource</a> with the
  earliest <a href="#timeline-offset">timeline offset</a>).</p>

  <p>The <dfn id="media-resource-end-position">media resource end position</dfn> of a <a href="#media-resource">media resource</a> in a <a href="#media-element">media
  element</a> is defined as follows: if the <a href="#media-resource">media resource</a> has a finite and known
  duration, the <a href="#media-resource-end-position">media resource end position</a> is the duration of the <a href="#media-resource">media
  resource</a>'s timeline (the last defined position on that timeline); otherwise, the
  <a href="#media-resource">media resource</a>'s duration is infinite or unknown, and the <a href="#media-resource-end-position">media resource end
  position</a> is the time of the last frame of <a href="#media-data">media data</a> currently available for
  that <a href="#media-resource">media resource</a>.</p>

  <p>Each <code><a href="#mediacontroller">MediaController</a></code> also has its own defined timeline. On this timeline, all the
  <a data-anolis-xref="media resource" href="#media-resource">media resources</a> of all the <a href="#slaved-media-elements">slaved media elements</a>
  of the <code><a href="#mediacontroller">MediaController</a></code> are temporally aligned according to their defined offsets. The
  <dfn id="media-controller-duration">media controller duration</dfn> of that <code><a href="#mediacontroller">MediaController</a></code> is the time from the
  earliest <a href="#earliest-possible-position">earliest possible position</a>, relative to this <code><a href="#mediacontroller">MediaController</a></code>
  timeline, of any of the <a data-anolis-xref="media resource" href="#media-resource">media resources</a> of the <a href="#slaved-media-elements">slaved
  media elements</a> of the <code><a href="#mediacontroller">MediaController</a></code>, to the time of the latest <a href="#media-resource-end-position">media
  resource end position</a> of the <a data-anolis-xref="media resource" href="#media-resource">media resources</a> of the
  <a href="#slaved-media-elements">slaved media elements</a> of the <code><a href="#mediacontroller">MediaController</a></code>, again relative to this
  <code><a href="#mediacontroller">MediaController</a></code> timeline.</p>

  <p>Each <code><a href="#mediacontroller">MediaController</a></code> has a <dfn id="media-controller-position">media controller position</dfn>. This is the time
  on the <code><a href="#mediacontroller">MediaController</a></code>'s timeline at which the user agent is trying to play the
  <a href="#slaved-media-elements">slaved media elements</a>. When a <code><a href="#mediacontroller">MediaController</a></code> is created, its
  <a href="#media-controller-position">media controller position</a> is initially zero.</p>

  <p>When the user agent is to <dfn data-anolis-xref="bring the media element up to speed with its new media
  controller" id="bring-the-media-element-up-to-speed-with-its-new-media-controller">bring a media element up to speed with its new media controller</dfn>, it must <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seek</a> that <a href="#media-element">media element</a> to the
  <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-position">media controller position</a> relative to the <a href="#media-element">media
  element</a>'s timeline.</p>

  <p>When the user agent is to <dfn id="seek-the-media-controller">seek the media controller</dfn> to a particular <var data-anolis-xref="">new playback position</var>, it must follow these steps:</p>

  <ol><li><p>If the <var data-anolis-xref="">new playback position</var> is less than zero, then set it to
   zero.</li>

   <li><p>If the <var data-anolis-xref="">new playback position</var> is greater than the <a href="#media-controller-duration">media
   controller duration</a>, then set it to the <a href="#media-controller-duration">media controller duration</a>.</li>

   <li><p>Set the <a href="#media-controller-position">media controller position</a> to the <var data-anolis-xref="">new playback
   position</var>.</li>

   <li><p><a data-anolis-xref="dom-media-seek" href="#dom-media-seek">Seek</a> each <a data-anolis-xref="slaved media elements" href="#slaved-media-elements">slaved
   media element</a> to the <var data-anolis-xref="">new playback position</var> relative to the <a href="#media-element">media
   element</a> timeline.</li> <!-- i.e. "bring the media element up to speed with its new
   media controller" -->

  </ol><p>A <code><a href="#mediacontroller">MediaController</a></code> is a <dfn id="restrained-media-controller">restrained media controller</dfn> if the
  <code><a href="#mediacontroller">MediaController</a></code> is a <a href="#playing-media-controller">playing media controller</a>, and none of its
  <a href="#slaved-media-elements">slaved media elements</a> are <a data-anolis-xref="blocked media element" href="#blocked-media-element">blocked media
  elements</a>, but either at least one of its <a href="#slaved-media-elements">slaved media elements</a> whose
  <a href="#autoplaying-flag">autoplaying flag</a> is true still has its <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code>
  attribute set to true, or, all of its <a href="#slaved-media-elements">slaved media elements</a> have their <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute set to true.</p>

  <p>A <code><a href="#mediacontroller">MediaController</a></code> is a <dfn id="blocked-media-controller">blocked media controller</dfn> if the
  <code><a href="#mediacontroller">MediaController</a></code> is a <a href="#paused-media-controller">paused media controller</a>, or if any of its
  <a href="#slaved-media-elements">slaved media elements</a> are <a data-anolis-xref="blocked media element" href="#blocked-media-element">blocked media
  elements</a>, or if any of its <a href="#slaved-media-elements">slaved media elements</a> whose <a href="#autoplaying-flag">autoplaying
  flag</a> is true still have their <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute set to
  true, or if all of its <a href="#slaved-media-elements">slaved media elements</a> have their <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute set to true.</p>

  <p>A <a href="#media-element">media element</a> is <dfn id="blocked-on-its-media-controller">blocked on its media controller</dfn> if the
  <code><a href="#mediacontroller">MediaController</a></code> is a <a href="#blocked-media-controller">blocked media controller</a>, or if its <a href="#media-controller-position">media
  controller position</a> is either before the <a href="#media-resource">media resource</a>'s <a href="#earliest-possible-position">earliest
  possible position</a> relative to the <code><a href="#mediacontroller">MediaController</a></code>'s timeline or after the end
  of the <a href="#media-resource">media resource</a> relative to the <code><a href="#mediacontroller">MediaController</a></code>'s timeline.</p>

  <p id="controller-playback">When a <code><a href="#mediacontroller">MediaController</a></code> is not a <a href="#blocked-media-controller">blocked media
  controller</a> and it has at least one <a data-anolis-xref="slaved media elements" href="#slaved-media-elements">slaved media
  element</a> whose <code><a href="dom.html#document">Document</a></code> is a <a href="browsers.html#fully-active">fully active</a> <code><a href="dom.html#document">Document</a></code>,
  the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-position">media controller position</a> must increase
  monotonically at <a href="#media-controller-playback-rate">media controller playback rate</a> units of time on the
  <code><a href="#mediacontroller">MediaController</a></code>'s timeline per unit time of the clock used by its <a href="#slaved-media-elements">slaved media
  elements</a>.</p>

  <p>When the zero point on the timeline of a <code><a href="#mediacontroller">MediaController</a></code> moves relative to the
  timelines of the <a href="#slaved-media-elements">slaved media elements</a> by a time difference <var data-anolis-xref="">ΔT</var>, the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#media-controller-position">media controller
  position</a> must be decremented by <var data-anolis-xref="">ΔT</var>.</p>

  <p class="note">In some situations, e.g. when playing back a live stream without buffering
  anything, the <a href="#media-controller-position">media controller position</a> would increase monotonically as described
  above at the same rate as the <var data-anolis-xref="">ΔT</var> described in the previous paragraph
  decreases it, with the end result that for all intents and purposes, the <a href="#media-controller-position">media controller
  position</a> would appear to remain constant (probably with the value 0).</p>

  <hr><p>A <code><a href="#mediacontroller">MediaController</a></code> has a <dfn id="most-recently-reported-readiness-state">most recently reported readiness state</dfn>, which
  is a number from 0 to 4 derived from the numbers used for the <a href="#media-element">media element</a> <code data-anolis-xref="attr-media-readyState">readyState</code> attribute, and a <dfn id="most-recently-reported-playback-state">most recently reported
  playback state</dfn>, which is either <i>playing</i>, <i>waiting</i>, or <i>ended</i>.</p>

  <p>When a <code><a href="#mediacontroller">MediaController</a></code> is created, its <a href="#most-recently-reported-readiness-state">most recently reported readiness
  state</a> must be set to 0, and its <a href="#most-recently-reported-playback-state">most recently reported playback state</a> must be
  set to <i>waiting</i>.</p>

  <p>When a user agent is required to <dfn id="report-the-controller-state">report the controller state</dfn> for a
  <code><a href="#mediacontroller">MediaController</a></code>, the user agent must run the following steps:</p>

  <ol><li>

    <p>If the <code><a href="#mediacontroller">MediaController</a></code> has no <a href="#slaved-media-elements">slaved media elements</a>, let <var data-anolis-xref="">new readiness state</var> be 0.</p>

    <p>Otherwise, let it have the lowest value of the <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> IDL attributes of all of its <a href="#slaved-media-elements">slaved media
    elements</a>.</p>

   </li>

   <li>

    <p>If the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#most-recently-reported-readiness-state">most recently reported readiness state</a> is
    less than the <var data-anolis-xref="">new readiness state</var>, then run these substeps:</p>

    <ol><li><p>Let <var data-anolis-xref="">next state</var> be the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#most-recently-reported-readiness-state">most
     recently reported readiness state</a>.</li>

     <li><p><i>Loop</i>: Increment <var data-anolis-xref="">next state</var> by one.</li>

     <li>

      <p><a href="webappapis.html#queue-a-task">Queue a task</a> to run the following steps:</p>

      <ol><li><p>Set the <code><a href="#mediacontroller">MediaController</a></code>'s <code data-anolis-xref="dom-MediaController-readyState"><a href="#dom-mediacontroller-readystate">readyState</a></code> attribute to the value <var data-anolis-xref="">next state</var>.</li>

       <li><p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> at the <code><a href="#mediacontroller">MediaController</a></code> object, whose
       name is the event name corresponding to the value of <var data-anolis-xref="">next state</var> given in
       the table below.</li>

      </ol></li>

     <li><p>If <var data-anolis-xref="">next state</var> is less than <var data-anolis-xref="">new readiness state</var>,
     then return to the step labeled <i>loop</i>.</li>

    </ol><p>Otherwise, if the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#most-recently-reported-readiness-state">most recently reported readiness
    state</a> is greater than <var data-anolis-xref="">new readiness state</var> then <a href="webappapis.html#queue-a-task">queue a
    task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> at the <code><a href="#mediacontroller">MediaController</a></code> object,
    whose name is the event name corresponding to the value of <var data-anolis-xref="">new readiness
    state</var> given in the table below.</p>

    <table><thead><tr><th>Value of <var data-anolis-xref="">new readiness state</var>
       <th>Event name

     <tbody><tr><td> 0
       <td> <code data-anolis-xref="event-MediaController-emptied"><a href="#event-mediacontroller-emptied">emptied</a></code>

      <tr><td> 1
       <td> <code data-anolis-xref="event-MediaController-loadedmetadata"><a href="#event-mediacontroller-loadedmetadata">loadedmetadata</a></code>

      <tr><td> 2
       <td> <code data-anolis-xref="event-MediaController-loadeddata"><a href="#event-mediacontroller-loadeddata">loadeddata</a></code>

      <tr><td> 3
       <td> <code data-anolis-xref="event-MediaController-canplay"><a href="#event-mediacontroller-canplay">canplay</a></code>

      <tr><td> 4
       <td> <code data-anolis-xref="event-MediaController-canplaythrough"><a href="#event-mediacontroller-canplaythrough">canplaythrough</a></code>

    </table></li>

   <li><p>Let the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#most-recently-reported-readiness-state">most recently reported readiness state</a>
   be <var data-anolis-xref="">new readiness state</var>.</li>

   <li>

    <p>Initialize <var data-anolis-xref="">new playback state</var> by setting it to the state given for the
    first matching condition from the following list:</p>

    <dl class="switch"><dt>If the <code><a href="#mediacontroller">MediaController</a></code> has no <a href="#slaved-media-elements">slaved media elements</a></dt>

     <dd>Let <var data-anolis-xref="">new playback state</var> be <i>waiting</i>.</dd>

     <dt>If all of the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#slaved-media-elements">slaved media elements</a> have
     <a href="#ended-playback">ended playback</a> and the <a href="#media-controller-playback-rate">media controller playback rate</a> is positive or
     zero</dt>

     <dd>Let <var data-anolis-xref="">new playback state</var> be <i>ended</i>.</dd>

     <dt>If the <code><a href="#mediacontroller">MediaController</a></code> is a <a href="#blocked-media-controller">blocked media controller</a></dt>

     <dd>Let <var data-anolis-xref="">new playback state</var> be <i>waiting</i>.</dd>

     <dt>Otherwise</dt>

     <dd>Let <var data-anolis-xref="">new playback state</var> be <i>playing</i>.</dd>

    </dl></li>

   <li><p>If the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#most-recently-reported-playback-state">most recently reported playback state</a>
   is not equal to <var data-anolis-xref="">new playback state</var> and the <var data-anolis-xref="">new playback
   state</var> is <i>ended</i>, then <a href="webappapis.html#queue-a-task">queue a task</a> that, if the
   <code><a href="#mediacontroller">MediaController</a></code> object is a <a href="#playing-media-controller">playing media controller</a>, and all of the
   <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#slaved-media-elements">slaved media elements</a> have still <a href="#ended-playback">ended
   playback</a>, and the <a href="#media-controller-playback-rate">media controller playback rate</a> is still positive or zero,
   changes the <code><a href="#mediacontroller">MediaController</a></code> object to a <a href="#paused-media-controller">paused media controller</a> and
   then <a data-anolis-xref="fire a simple event" href="webappapis.html#fire-a-simple-event">fires a simple event</a> named <code data-anolis-xref="event-MediaController-pause"><a href="#event-mediacontroller-pause">pause</a></code> at the <code><a href="#mediacontroller">MediaController</a></code>
   object.</li>

   <li>

    <p>If the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#most-recently-reported-playback-state">most recently reported playback state</a> is
    not equal to <var data-anolis-xref="">new playback state</var> then <a href="webappapis.html#queue-a-task">queue a task</a> to run the
    following steps:</p>

    <ol><li><p>Set the <code><a href="#mediacontroller">MediaController</a></code>'s <code data-anolis-xref="dom-MediaController-playbackState"><a href="#dom-mediacontroller-playbackstate">playbackState</a></code> attribute to the value given in
     the second column of the row of the following table whose first column contains the <var data-anolis-xref="">new playback state</var>.</li>

     <li><p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> at the <code><a href="#mediacontroller">MediaController</a></code> object, whose name
     is the value given in the third column of the row of the following table whose first column
     contains the <var data-anolis-xref="">new playback state</var>.</li>

    </ol><table><thead><tr><th>New playback state
       <th>New value for <code data-anolis-xref="dom-MediaController-playbackState"><a href="#dom-mediacontroller-playbackstate">playbackState</a></code>
       <th>Event name
     <tbody><tr><td><i>playing</i>
       <td>"<dfn data-anolis-xref="dom-MediaController-playing" id="dom-mediacontroller-playing"><code>playing</code></dfn>"
       <td><code data-anolis-xref="event-MediaController-playing"><a href="#event-mediacontroller-playing">playing</a></code>
      <tr><td><i>waiting</i>
       <td>"<dfn data-anolis-xref="dom-MediaController-waiting" id="dom-mediacontroller-waiting"><code>waiting</code></dfn>"
       <td><code data-anolis-xref="event-MediaController-waiting"><a href="#event-mediacontroller-waiting">waiting</a></code>
      <tr><td><i>ended</i>
       <td>"<dfn data-anolis-xref="dom-MediaController-ended" id="dom-mediacontroller-ended"><code>ended</code></dfn>"
       <td><code data-anolis-xref="event-MediaController-ended"><a href="#event-mediacontroller-ended">ended</a></code>
    </table></li>

   <li><p>Let the <code><a href="#mediacontroller">MediaController</a></code>'s <a href="#most-recently-reported-playback-state">most recently reported playback state</a>
   be <var data-anolis-xref="">new playback state</var>.</li>

  </ol><hr><p>The following are the <a href="webappapis.html#event-handlers">event handlers</a> (and their corresponding <a data-anolis-xref="event
  handler event type" href="webappapis.html#event-handler-event-type">event handler event types</a>) <span class="impl">that must be</span> supported, as <a href="webappapis.html#event-handler-idl-attributes">event handler IDL attributes</a>,
  by all objects implementing the <code><a href="#mediacontroller">MediaController</a></code> interface:</p>

  <table><thead><tr><th><a data-anolis-xref="event handlers" href="webappapis.html#event-handlers">Event handler</a> <th><a href="webappapis.html#event-handler-event-type">Event handler event type</a>
   <tbody><tr><td><dfn data-anolis-xref="handler-MediaController-onemptied" id="handler-mediacontroller-onemptied"><code>onemptied</code></dfn> <td> <code data-anolis-xref="event-MediaController-emptied"><a href="#event-mediacontroller-emptied">emptied</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-onloadedmetadata" id="handler-mediacontroller-onloadedmetadata"><code>onloadedmetadata</code></dfn> <td> <code data-anolis-xref="event-MediaController-loadedmetadata"><a href="#event-mediacontroller-loadedmetadata">loadedmetadata</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-onloadeddata" id="handler-mediacontroller-onloadeddata"><code>onloadeddata</code></dfn> <td> <code data-anolis-xref="event-MediaController-loadeddata"><a href="#event-mediacontroller-loadeddata">loadeddata</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-oncanplay" id="handler-mediacontroller-oncanplay"><code>oncanplay</code></dfn> <td> <code data-anolis-xref="event-MediaController-canplay"><a href="#event-mediacontroller-canplay">canplay</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-oncanplaythrough" id="handler-mediacontroller-oncanplaythrough"><code>oncanplaythrough</code></dfn> <td> <code data-anolis-xref="event-MediaController-canplaythrough"><a href="#event-mediacontroller-canplaythrough">canplaythrough</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-onplaying" id="handler-mediacontroller-onplaying"><code>onplaying</code></dfn> <td> <code data-anolis-xref="event-MediaController-playing"><a href="#event-mediacontroller-playing">playing</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-onended" id="handler-mediacontroller-onended"><code>onended</code></dfn> <td> <code data-anolis-xref="event-MediaController-ended"><a href="#event-mediacontroller-ended">ended</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-onwaiting" id="handler-mediacontroller-onwaiting"><code>onwaiting</code></dfn> <td> <code data-anolis-xref="event-MediaController-waiting"><a href="#event-mediacontroller-waiting">waiting</a></code>
   <tbody><tr><td><dfn data-anolis-xref="handler-MediaController-ondurationchange" id="handler-mediacontroller-ondurationchange"><code>ondurationchange</code></dfn> <td> <code data-anolis-xref="event-MediaController-durationchange"><a href="#event-mediacontroller-durationchange">durationchange</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-ontimeupdate" id="handler-mediacontroller-ontimeupdate"><code>ontimeupdate</code></dfn> <td> <code data-anolis-xref="event-MediaController-timeupdate"><a href="#event-mediacontroller-timeupdate">timeupdate</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-onplay" id="handler-mediacontroller-onplay"><code>onplay</code></dfn> <td> <code data-anolis-xref="event-MediaController-play"><a href="#event-mediacontroller-play">play</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-onpause" id="handler-mediacontroller-onpause"><code>onpause</code></dfn> <td> <code data-anolis-xref="event-MediaController-pause"><a href="#event-mediacontroller-pause">pause</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-onratechange" id="handler-mediacontroller-onratechange"><code>onratechange</code></dfn> <td> <code data-anolis-xref="event-MediaController-ratechange"><a href="#event-mediacontroller-ratechange">ratechange</a></code>
    <tr><td><dfn data-anolis-xref="handler-MediaController-onvolumechange" id="handler-mediacontroller-onvolumechange"><code>onvolumechange</code></dfn> <td> <code data-anolis-xref="event-MediaController-volumechange"><a href="#event-mediacontroller-volumechange">volumechange</a></code>
  </table><hr><p>The <a href="webappapis.html#task-source">task source</a> for the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> listed in this
  section is the <a href="webappapis.html#dom-manipulation-task-source">DOM manipulation task source</a>.</p>

  </div>


  <h6 id="assigning-a-media-controller-declaratively"><span class="secno">4.7.10.11.3 </span>Assigning a media controller declaratively</h6>

  <p>The <dfn data-anolis-xref="attr-media-mediagroup" id="attr-media-mediagroup"><code>mediagroup</code></dfn> content attribute on <a data-anolis-xref="media element" href="#media-element">media elements</a> can be used to link multiple <a data-anolis-xref="media
  element" href="#media-element">media elements</a> together by implicitly creating a <code><a href="#mediacontroller">MediaController</a></code>. The
  value is text; <a data-anolis-xref="media element" href="#media-element">media elements</a> with the same value are
  automatically linked by the user agent.</p>

  <div class="impl">

  <p>When a <a href="#media-element">media element</a> is created with a <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> attribute, and when a <a href="#media-element">media element</a>'s
  <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> attribute is set, changed, or removed, the
  user agent must run the following steps:</p>

  <ol><!-- very similar to the algorithm above for setting the IDL attribute --><li><p>Let <var data-anolis-xref="">m</var> be the <a href="#media-element">media element</a> in question.</li>

   <li><p>Let <var data-anolis-xref="">old controller</var> be <var data-anolis-xref="">m</var>'s <a href="#current-media-controller">current media
   controller</a>, if it currently has one, and null otherwise.</li>

   <li><p>Let <var data-anolis-xref="">new controller</var> be null.</li>

   <li><p>Let <var data-anolis-xref="">m</var> have no <a href="#current-media-controller">current media controller</a>, if it currently
   has one.</li>

   <li><p>If <var data-anolis-xref="">m</var>'s <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> attribute
   is being removed, then jump to the <i>update controllers</i> step below.</li>

   <li>

    <p>If there is another <a href="#media-element">media element</a> whose <code><a href="dom.html#document">Document</a></code> is the same as
    <var data-anolis-xref="">m</var>'s <code><a href="dom.html#document">Document</a></code> (even if one or both of these elements are not
    actually <a data-anolis-xref="in a Document" href="infrastructure.html#in-a-document"><em>in</em> the <code>Document</code></a>), and which
    also has a <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> attribute, and whose <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> attribute has the same value as the new value of
    <var data-anolis-xref="">m</var>'s <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> attribute, then
    let <var data-anolis-xref="">controller</var> be that <a href="#media-element">media element</a>'s <a href="#current-media-controller">current media
    controller</a>.</p>

    <p>Otherwise, let <var data-anolis-xref="">controller</var> be a newly created
    <code><a href="#mediacontroller">MediaController</a></code>.</p>

   </li>

   <li><p>Let <var data-anolis-xref="">m</var>'s <a href="#current-media-controller">current media controller</a> be <var data-anolis-xref="">controller</var>.</li>

   <li><p>Let <var data-anolis-xref="">new controller</var> be <var data-anolis-xref="">m</var>'s <a href="#current-media-controller">current media
   controller</a>.</li>

   <li><p><a href="#bring-the-media-element-up-to-speed-with-its-new-media-controller">Bring the media element up to speed with its new media
   controller</a>.</li>

   <li><p><i>Update controllers</i>: If <var data-anolis-xref="">old
   controller</var> and <var data-anolis-xref="">new controller</var> are the
   same (whether both null or both the same controller) then abort
   these steps.</li>

   <li><p>If <var data-anolis-xref="">old controller</var> is not null and still has one or more <a href="#slaved-media-elements">slaved
   media elements</a>, then <a href="#report-the-controller-state">report the controller state</a> for <var data-anolis-xref="">old
   controller</var>.</li>

   <li><p>If <var data-anolis-xref="">new controller</var> is not null, then <a href="#report-the-controller-state">report the controller
   state</a> for <var data-anolis-xref="">new controller</var>.</li>

  </ol><p>The <dfn data-anolis-xref="dom-media-mediaGroup" id="dom-media-mediagroup"><code>mediaGroup</code></dfn> IDL attribute on <a data-anolis-xref="media element" href="#media-element">media elements</a> must <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> content attribute.</p>

  </div>

  <div class="example">

   <p>Multiple <a data-anolis-xref="media element" href="#media-element">media elements</a> referencing the same <a href="#media-resource">media
   resource</a> will share a single network request. This can be used to efficiently play two
   (video) tracks from the same <a href="#media-resource">media resource</a> in two different places on the screen.
   Used with the <code data-anolis-xref="attr-media-mediagroup"><a href="#attr-media-mediagroup">mediagroup</a></code> attribute, these elements can
   also be kept synchronised.</p>

   <p>In this example, a sign-languge interpreter track from a movie file is overlaid on the primary
   video track of that same video file using two <code><a href="#the-video-element">video</a></code> elements, some CSS, and an
   implicit <code><a href="#mediacontroller">MediaController</a></code>:</p>

   <pre>&lt;article&gt;
 &lt;style&gt;
  div { margin: 1em auto; position: relative; width: 400px; height: 300px; }
  video { position; absolute; bottom: 0; right: 0; }
  video:first-child { width: 100%; height: 100%; }
  video:last-child { width: 30%; }
 &lt;/style&gt;
 &lt;div&gt;
  &lt;video src="movie.vid#track=Video&amp;amp;track=English" autoplay controls mediagroup=movie&gt;&lt;/video&gt;
  &lt;video src="movie.vid#track=sign" autoplay mediagroup=movie&gt;&lt;/video&gt;
 &lt;/div&gt;
&lt;/article&gt;</pre>

  </div>


<!--v2:
  <h6>Ducking</h6>

  <p><dfn>Ducking</dfn> is the process of reducing the volume of one audio track when another audio
  track is playing, for example occasionally reducing the volume of a soundtrack to allow the viewer
  to hear an intermittent commentary track.</p>

  (add an "autoduck" attribute that reduces the volume of other media elements with the same
  <span>current media controller</span> whenever this media element is playing audio)

   <video src="movie.vid#track=Video&amp;amp;track=English" autoplay controls mediagroup=main></video>
   <audio src="movie.vid#track=Descriptions" mediagroup=main autoduck></audio>
-->

<!--TOPIC:Video Text Tracks-->
  <h5 id="timed-text-tracks"><span class="secno">4.7.10.12 </span>Timed text tracks</h5>

  <h6 id="text-track-model"><span class="secno">4.7.10.12.1 </span>Text track model</h6>

  <p>A <a href="#media-element">media element</a> can have a group of associated <dfn data-anolis-xref="text track" id="text-track">text
  tracks</dfn>, known as the <a href="#media-element">media element</a>'s <dfn id="list-of-text-tracks">list of text tracks</dfn>. The <a data-anolis-xref="text track" href="#text-track">text tracks</a> are sorted as follows:</p>

  <ol class="brief"><li>The <a data-anolis-xref="text track" href="#text-track">text tracks</a> corresponding to <code><a href="#the-track-element">track</a></code> element
   children of the <a href="#media-element">media element</a>, in <a href="infrastructure.html#tree-order">tree order</a>.</li>

   <li>Any <a data-anolis-xref="text track" href="#text-track">text tracks</a> added using the <code data-anolis-xref="dom-media-addTextTrack"><a href="#dom-media-addtexttrack">addTextTrack()</a></code> method, in the order they were added, oldest
   first.</li>

   <li>Any <a data-anolis-xref="media-resource-specific text track" href="#media-resource-specific-text-track">media-resource-specific text
   tracks</a> (<a data-anolis-xref="text track" href="#text-track">text tracks</a> corresponding to data in the
   <a href="#media-resource">media resource</a>), in the order defined by the <a href="#media-resource">media resource</a>'s format
   specification.</li>

  </ol><p>A <a href="#text-track">text track</a> consists of:</p>

  <dl><dt><dfn data-anolis-xref="text track kind" id="text-track-kind">The kind of text track</dfn>

   <dd>

    <p>This decides how the track is handled by the user agent. The kind is represented by a string.
    The possible strings are:</p>

    <ul class="brief"><li><dfn data-anolis-xref="dom-TextTrack-kind-subtitles" id="dom-texttrack-kind-subtitles"><code>subtitles</code></dfn>
     <li><dfn data-anolis-xref="dom-TextTrack-kind-captions" id="dom-texttrack-kind-captions"><code>captions</code></dfn>
     <li><dfn data-anolis-xref="dom-TextTrack-kind-descriptions" id="dom-texttrack-kind-descriptions"><code>descriptions</code></dfn>
     <li><dfn data-anolis-xref="dom-TextTrack-kind-chapters" id="dom-texttrack-kind-chapters"><code>chapters</code></dfn>
     <li><dfn data-anolis-xref="dom-TextTrack-kind-metadata" id="dom-texttrack-kind-metadata"><code>metadata</code></dfn>
    </ul><p>The <a data-anolis-xref="text track kind" href="#text-track-kind">kind of track</a> can change dynamically, in the case of
    a <a href="#text-track">text track</a> corresponding to a <code><a href="#the-track-element">track</a></code> element.</p>

   </dd>

   <dt><dfn data-anolis-xref="text track label" id="text-track-label">A label</dfn>

   <dd>

    <p>This is a human-readable string intended to identify the track for the user.</p>

    <p>The <a data-anolis-xref="text track label" href="#text-track-label">label of a track</a> can change dynamically, in the
    case of a <a href="#text-track">text track</a> corresponding to a <code><a href="#the-track-element">track</a></code> element.</p>

    <p>When a <a href="#text-track-label">text track label</a> is the empty string, the user agent should automatically
    generate an appropriate label from the text track's other properties (e.g. the kind of text
    track and the text track's language) for use in its user interface. This automatically-generated
    label is not exposed in the API.</p>

   </dd>

   <dt><dfn data-anolis-xref="text track in-band metadata track dispatch type" id="text-track-in-band-metadata-track-dispatch-type">An in-band metadata track dispatch type</dfn>

   <dd>

    <p>This is a string extracted from the <a href="#media-resource">media resource</a> specifically for in-band
    metadata tracks to enable such tracks to be dispatched to different scripts in the document.</p>

    <p class="example">For example, a traditional TV station broadcast streamed on the Web and
    augmented with Web-specific interactive features could include text tracks with metadata for ad
    targeting, trivia game data during game shows, player states during sports games, recipe
    information during food programs, and so forth. As each program starts and ends, new tracks
    might be added or removed from the stream, and as each one is added, the user agent could bind
    them to dedicated script modules using the value of this attribute.</p>

    <p>Other than for in-band metadata text tracks, the <a data-anolis-xref="text track in-band metadata
    track dispatch type" href="#text-track-in-band-metadata-track-dispatch-type">in-band metadata track dispatch type</a> is the empty string. How this
    value is populated for different media formats is described in <a href="#steps-to-expose-a-media-resource-specific-text-track">steps to expose a
    media-resource-specific text track</a>.</p>

   </dd>

   <dt><dfn data-anolis-xref="text track language" id="text-track-language">A language</dfn>

   <dd>

    <p>This is a string (a BCP 47 language tag) representing the language of the text track's cues.
    <a href="references.html#refsBCP47">[BCP47]</a></p>

    <p>The <a data-anolis-xref="text track language" href="#text-track-language">language of a text track</a> can change dynamically,
    in the case of a <a href="#text-track">text track</a> corresponding to a <code><a href="#the-track-element">track</a></code> element.</p>

   </dd>

   <dt><dfn data-anolis-xref="text track readiness state" id="text-track-readiness-state">A readiness state</dfn>

   <dd>

    <p>One of the following:</p>

    <dl><dt><dfn data-anolis-xref="text track not loaded" id="text-track-not-loaded">Not loaded</dfn>

     <dd>

      <p>Indicates that the text track's cues have not been obtained.</p>

     </dd>

     <dt><dfn data-anolis-xref="text track loading" id="text-track-loading">Loading</dfn>

     <dd>

      <p>Indicates that the text track is loading and there have been no fatal errors encountered so
      far. Further cues might still be added to the track by the parser.</p>

     </dd>

     <dt><dfn data-anolis-xref="text track loaded" id="text-track-loaded">Loaded</dfn>

     <dd>

      <p>Indicates that the text track has been loaded with no fatal errors.</p>

     </dd>

     <dt><dfn data-anolis-xref="text track failed to load" id="text-track-failed-to-load">Failed to load</dfn>

     <dd>

      <p>Indicates that the text track was enabled, but when the user agent attempted to obtain it,
      this failed in some way (e.g. <span>URL</span> could not be <a data-anolis-xref="resolve a
      url" href="infrastructure.html#resolve-a-url">resolved</a>, network error, unknown text track format). Some or all of the cues are
      likely missing and will not be obtained.</p>

     </dd>

    </dl><p>The <a data-anolis-xref="text track readiness state" href="#text-track-readiness-state">readiness state</a> of a <a href="#text-track">text
    track</a> changes dynamically as the track is obtained.</p>

   </dd>

   <dt><dfn data-anolis-xref="text track mode" id="text-track-mode">A mode</dfn>

   <dd>

    <p>One of the following:</p>

    <dl><dt><dfn data-anolis-xref="text track disabled" id="text-track-disabled">Disabled</dfn>

     <dd>

      <p>Indicates that the text track is not active. Other than for the purposes of exposing the
      track in the DOM, the user agent is ignoring the text track. No cues are active, no events are
      fired, and the user agent will not attempt to obtain the track's cues.</p>

     </dd>

     <dt><dfn data-anolis-xref="text track hidden" id="text-track-hidden">Hidden</dfn>

     <dd>

      <p>Indicates that the text track is active, but that the user agent is not actively displaying
      the cues. If no attempt has yet been made to obtain the track's cues, the user agent will
      perform such an attempt momentarily. The user agent is maintaining a list of which cues are
      active, and events are being fired accordingly.</p>

     </dd>

     <dt><dfn data-anolis-xref="text track showing" id="text-track-showing">Showing</dfn>

     <dd>

      <p>Indicates that the text track is active. If no attempt has yet been made to obtain the
      track's cues, the user agent will perform such an attempt momentarily. The user agent is
      maintaining a list of which cues are active, and events are being fired accordingly. In
      addition, for text tracks whose <a data-anolis-xref="text track kind" href="#text-track-kind">kind</a> is <code data-anolis-xref="dom-TextTrack-kind-subtitles"><a href="#dom-texttrack-kind-subtitles">subtitles</a></code> or <code data-anolis-xref="dom-TextTrack-kind-captions"><a href="#dom-texttrack-kind-captions">captions</a></code>, the cues are being overlaid on the video
      as appropriate; for text tracks whose <a data-anolis-xref="text track kind" href="#text-track-kind">kind</a> is <code data-anolis-xref="dom-TextTrack-kind-descriptions"><a href="#dom-texttrack-kind-descriptions">descriptions</a></code>, the user agent is making the
      cues available to the user in a non-visual fashion; and for text tracks whose <a data-anolis-xref="text track kind" href="#text-track-kind">kind</a> is <code data-anolis-xref="dom-TextTrack-kind-chapters"><a href="#dom-texttrack-kind-chapters">chapters</a></code>, the user agent is making available to
      the user a mechanism by which the user can navigate to any point in the <a href="#media-resource">media
      resource</a> by selecting a cue.</p>

     </dd>

    </dl></dd>

   <dt><dfn data-anolis-xref="text track list of cues" id="text-track-list-of-cues">A list of zero or more cues</dfn>

   <dd>

    <p>A list of <a data-anolis-xref="text track cue" href="#text-track-cue">text track cues</a>, along with <dfn id="rules-for-updating-the-text-track-rendering">rules for
    updating the text track rendering</dfn>. For example, for <a href="infrastructure.html#webvtt">WebVTT</a>, the <a href="infrastructure.html#rules-for-updating-the-display-of-webvtt-text-tracks">rules
    for updating the display of WebVTT text tracks</a>. <a href="references.html#refsWEBVTT">[WEBVTT]</a> </p>

    <p>The <a data-anolis-xref="text track list of cues" href="#text-track-list-of-cues">list of cues of a text track</a> can change
    dynamically, either because the <a href="#text-track">text track</a> has <a data-anolis-xref="text track not
    loaded" href="#text-track-not-loaded">not yet been loaded</a> or is still <a data-anolis-xref="text track loading" href="#text-track-loading">loading</a>,
    or due to DOM manipulation.</p>

   </dd>

  </dl><p>Each <a href="#text-track">text track</a> has a corresponding <code><a href="#texttrack">TextTrack</a></code> object.</p>

  <hr><p>Each <a href="#media-element">media element</a> has a <dfn id="list-of-pending-text-tracks">list of pending text tracks</dfn>, which must
  initially be empty, a <dfn id="blocked-on-parser">blocked-on-parser</dfn> flag, which must initially be false, and a
  <dfn id="did-perform-automatic-track-selection">did-perform-automatic-track-selection</dfn> flag, which must also initially be false.</p>

  <p>When the user agent is required to <dfn id="populate-the-list-of-pending-text-tracks">populate the list of pending text tracks</dfn> of a
  <a href="#media-element">media element</a>, the user agent must add to the element's <a href="#list-of-pending-text-tracks">list of pending text
  tracks</a> each <a href="#text-track">text track</a> in the element's <a href="#list-of-text-tracks">list of text tracks</a> whose
  <a href="#text-track-mode">text track mode</a> is not <a data-anolis-xref="text track disabled" href="#text-track-disabled">disabled</a> and whose
  <a href="#text-track-readiness-state">text track readiness state</a> is <!--either <span data-x="text track not loaded">not
  loaded</span> or [there can't be any in the 'not loaded' state that are not 'disabled']--> <a data-anolis-xref="text track loading" href="#text-track-loading">loading</a>.</p>

  <p>Whenever a <code><a href="#the-track-element">track</a></code> element's parent node changes, the user agent must remove the
  corresponding <a href="#text-track">text track</a> from any <a href="#list-of-pending-text-tracks">list of pending text tracks</a> that it is
  in.</p>

  <p>Whenever a <a href="#text-track">text track</a>'s <a href="#text-track-readiness-state">text track readiness state</a> changes to either
  <a data-anolis-xref="text track loaded" href="#text-track-loaded">loaded</a> or <a data-anolis-xref="text track failed to load" href="#text-track-failed-to-load">failed to
  load</a>, the user agent must remove it from any <a href="#list-of-pending-text-tracks">list of pending text tracks</a> that
  it is in.</p>

  <p>When a <a href="#media-element">media element</a> is created by an <a href="syntax.html#html-parser">HTML parser</a> or <a href="the-xhtml-syntax.html#xml-parser">XML
  parser</a>, the user agent must set the element's <a href="#blocked-on-parser">blocked-on-parser</a> flag to true.
  When a <a href="#media-element">media element</a> is popped off the <a href="syntax.html#stack-of-open-elements">stack of open elements</a> of an
  <a href="syntax.html#html-parser">HTML parser</a> or <a href="the-xhtml-syntax.html#xml-parser">XML parser</a>, the user agent must <a href="#honor-user-preferences-for-automatic-text-track-selection">honor user
  preferences for automatic text track selection</a>, <a href="#populate-the-list-of-pending-text-tracks">populate the list of pending text
  tracks</a>, and set the element's <a href="#blocked-on-parser">blocked-on-parser</a> flag to false.</p>

  <p>The <a data-anolis-xref="text track" href="#text-track">text tracks</a> of a <a href="#media-element">media element</a> are <dfn data-anolis-xref="the text tracks are ready" id="the-text-tracks-are-ready">ready</dfn> when both the element's <a href="#list-of-pending-text-tracks">list of pending text
  tracks</a> is empty and the element's <a href="#blocked-on-parser">blocked-on-parser</a> flag is false.</p>

  <p>Each <a href="#media-element">media element</a> has a <dfn id="pending-text-track-change-notification-flag">pending text track change notification flag</dfn>,
  which must initially be unset.</p>

  <p>Whenever a <a href="#text-track">text track</a> that is in a <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text
  tracks</a> has its <a href="#text-track-mode">text track mode</a> change value, the user agent must run the
  following steps for the <a href="#media-element">media element</a>:</p>

  <ol><li><p>If the <a href="#media-element">media element</a>'s <a href="#pending-text-track-change-notification-flag">pending text track change notification
   flag</a> is set, abort these steps.</li>

   <li><p>Set the <a href="#media-element">media element</a>'s <a href="#pending-text-track-change-notification-flag">pending text track change notification
   flag</a>.</li>

   <li>

    <p><a href="webappapis.html#queue-a-task">Queue a task</a> that runs the following substeps:</p>

    <ol><li><p>Unset the <a href="#media-element">media element</a>'s <a href="#pending-text-track-change-notification-flag">pending text track change notification
     flag</a>.</li>

     <li><p><a href="webappapis.html#fire-a-simple-event">Fire a simple event</a> named <code data-anolis-xref="event-media-change"><a href="#event-media-change">change</a></code> at
     the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-textTracks"><a href="#dom-media-texttracks">textTracks</a></code>
     attribute's <code><a href="#texttracklist">TextTrackList</a></code> object.</li>

    </ol></li>

   <li><p>If the <a href="#media-element">media element</a>'s <a href="#show-poster-flag">show poster flag</a> is not set, run the
   <i><a href="#time-marches-on">time marches on</a></i> steps.</li>

  </ol><p>The <a href="webappapis.html#task-source">task source</a> for the <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> listed in this
  section is the <a href="webappapis.html#dom-manipulation-task-source">DOM manipulation task source</a>.</p>

  <hr><p>A <dfn id="text-track-cue">text track cue</dfn> is the unit of time-sensitive data in a <a href="#text-track">text track</a>,
  corresponding for instance for subtitles and captions to the text that appears at a particular
  time and disappears at another time.</p>

  <p>Each <a href="#text-track-cue">text track cue</a> consists of:</p>

  <dl><dt><dfn data-anolis-xref="text track cue identifier" id="text-track-cue-identifier">An identifier</dfn>
   <dd>
    <p>An arbitrary string.</p>
   </dd>

   <dt><dfn data-anolis-xref="text track cue start time" id="text-track-cue-start-time">A start time</dfn>
   <dd>
    <p>The time, in seconds and fractions of a second, that describes the beginning of the range of
    the <a href="#media-data">media data</a> to which the cue applies.</p>
   </dd>

   <dt><dfn data-anolis-xref="text track cue end time" id="text-track-cue-end-time">An end time</dfn>
   <dd>
    <p>The time, in seconds and fractions of a second, that describes the end of the range of the
    <a href="#media-data">media data</a> to which the cue applies.</p>
   </dd>

   <dt><dfn data-anolis-xref="text track cue pause-on-exit flag" id="text-track-cue-pause-on-exit-flag">A pause-on-exit flag</dfn>
   <dd>
    <p>A boolean indicating whether playback of the <a href="#media-resource">media resource</a> is to pause when the
    end of the range to which the cue applies is reached.</p>
   </dd>

   <dt>Some additional format-specific data</dt>
   <dd>
    <p>Additional fields, as needed for the format. For example, WebVTT has a <a href="infrastructure.html#text-track-cue-writing-direction">text track cue
    writing direction</a> and so forth. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>
   </dd>

   <dt><dfn data-anolis-xref="text track cue data" id="text-track-cue-data">The data of the cue</dfn>
   <dd>
    <p>The raw data of the cue, and <dfn id="rules-for-rendering-the-cue-in-isolation">rules for rendering the cue in isolation</dfn>.</p>
    <p>The precise nature of this data is defined by the format. For example, WebVTT uses text.</p>
   </dd>

  </dl><p class="note">The <a href="#text-track-cue-start-time">text track cue start time</a> and <a href="#text-track-cue-end-time">text track cue end
  time</a> can be negative. (The <a href="#current-playback-position">current playback position</a> can never be negative,
  though, so cues entirely before time zero cannot be active.)</p>

  <p>Each <a href="#text-track-cue">text track cue</a> has a corresponding <code><a href="#texttrackcue">TextTrackCue</a></code> object (or more
  specifically, an object that inherits from <code><a href="#texttrackcue">TextTrackCue</a></code> — for example, WebVTT
  cues use the <code>VTTCue</code> interface). A <a href="#text-track-cue">text track cue</a>'s in-memory
  representation can be dynamically changed through this <code><a href="#texttrackcue">TextTrackCue</a></code> API. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>

  <p>A <a href="#text-track-cue">text track cue</a> is associated with <a href="#rules-for-updating-the-text-track-rendering">rules for updating the text track
  rendering</a>, as defined by the specification for the specific kind of <a href="#text-track-cue">text track
  cue</a>. These rules are used specifically when the object representing the cue is added to a
  <code><a href="#texttrack">TextTrack</a></code> object using the <code data-anolis-xref="dom-TextTrack-addCue"><a href="#dom-texttrack-addcue">addCue()</a></code>
  method.</p>

  <p>In addition, each <a href="#text-track-cue">text track cue</a> has two pieces of dynamic information:</p>

  <dl><dt>The <dfn data-anolis-xref="text track cue active flag" id="text-track-cue-active-flag">active flag</dfn>
   <dd>

    <p>This flag must be initially unset. The flag is used to ensure events are fired appropriately
    when the cue becomes active or inactive, and to make sure the right cues are rendered.</p>

    <p>The user agent must synchronously unset this flag whenever the <a href="#text-track-cue">text track cue</a> is
    removed from its <a href="#text-track">text track</a>'s <a href="#text-track-list-of-cues">text track list of cues</a>; whenever the
    <a href="#text-track">text track</a> itself is removed from its <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of
    text tracks</a> or has its <a href="#text-track-mode">text track mode</a> changed to <a data-anolis-xref="text track
    disabled" href="#text-track-disabled">disabled</a>; and whenever the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> is changed back to <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>. When the flag is unset in this way for one
    or more cues in <a data-anolis-xref="text track" href="#text-track">text tracks</a> that were <a data-anolis-xref="text track
    showing" href="#text-track-showing">showing</a> prior to the relevant incident, the user agent must, after having unset
    the flag for all the affected cues, apply the <a href="#rules-for-updating-the-text-track-rendering">rules for updating the text track
    rendering</a> of those <a data-anolis-xref="text track" href="#text-track">text tracks</a>. For example, for <a data-anolis-xref="text track" href="#text-track">text tracks</a> based on <a href="infrastructure.html#webvtt">WebVTT</a>, the <a href="infrastructure.html#rules-for-updating-the-display-of-webvtt-text-tracks">rules for updating
    the display of WebVTT text tracks</a>. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p> </dd>

   <dt>The <dfn data-anolis-xref="text track cue display state" id="text-track-cue-display-state">display state</dfn>
   <dd>

    <p>This is used as part of the rendering model, to keep cues in a consistent position. It must
    initially be empty. Whenever the <a href="#text-track-cue-active-flag">text track cue active flag</a> is unset, the user
    agent must empty the <a href="#text-track-cue-display-state">text track cue display state</a>.</p>

   </dd>

  </dl><p>The <a data-anolis-xref="text track cue" href="#text-track-cue">text track cues</a> of a <a href="#media-element">media element</a>'s <a data-anolis-xref="text track" href="#text-track">text tracks</a> are ordered relative to each other in the <dfn id="text-track-cue-order">text track
  cue order</dfn>, which is determined as follows: first group the <a data-anolis-xref="text track
  cue" href="#text-track-cue">cues</a> by their <a href="#text-track">text track</a>, with the groups being sorted in the same order
  as their <a data-anolis-xref="text track" href="#text-track">text tracks</a> appear in the <a href="#media-element">media element</a>'s
  <a href="#list-of-text-tracks">list of text tracks</a>; then, within each group, <a data-anolis-xref="text track
  cue" href="#text-track-cue">cues</a> must be sorted by their <a data-anolis-xref="text track cue start time" href="#text-track-cue-start-time">start
  time</a>, earliest first; then, any <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> with the same
  <a data-anolis-xref="text track cue start time" href="#text-track-cue-start-time">start time</a> must be sorted by their <a data-anolis-xref="text track cue end time" href="#text-track-cue-end-time">end time</a>, latest first; and finally, any <a data-anolis-xref="text
  track cue" href="#text-track-cue">cues</a> with identical <a data-anolis-xref="text track cue end time" href="#text-track-cue-end-time">end times</a> must
  be sorted in the order they were last added to their respective <a href="#text-track-list-of-cues">text track list of
  cues</a>, oldest first (so e.g. for cues from a <a href="infrastructure.html#webvtt">WebVTT</a> file, that would initially
  be the order in which the cues were listed in the file). <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>


  <h6 id="sourcing-in-band-text-tracks"><span class="secno">4.7.10.12.2 </span>Sourcing in-band text tracks</h6>

  <p>A <dfn id="media-resource-specific-text-track">media-resource-specific text track</dfn> is a <a href="#text-track">text track</a> that corresponds
  to data found in the <a href="#media-resource">media resource</a>.</p>


  <div class="impl">

  <p>Rules for processing and rendering such data are defined by the relevant specifications, e.g.
  the specification of the video format if the <a href="#media-resource">media resource</a> is a video.</p>

  <p>When a <a href="#media-resource">media resource</a> contains data that the user agent recognises and supports as
  being equivalent to a <a href="#text-track">text track</a>, the user agent <a href="#found-a-media-resource-specific-timed-track">runs</a> the <dfn id="steps-to-expose-a-media-resource-specific-text-track">steps to expose a
  media-resource-specific text track</dfn> with the relevant data, as follows.</p>

  <!-- this runs synchronously from a fetch task -->

  <ol><li><p>Associate the relevant data with a new <a href="#text-track">text track</a> and its corresponding new
   <code><a href="#texttrack">TextTrack</a></code> object. The <a href="#text-track">text track</a> is a <a href="#media-resource-specific-text-track">media-resource-specific
   text track</a>.</li>

   <li><p>Set the new <a href="#text-track">text track</a>'s <a data-anolis-xref="text track kind" href="#text-track-kind">kind</a>, <a data-anolis-xref="text track label" href="#text-track-label">label</a>, and <a data-anolis-xref="text track language" href="#text-track-language">language</a>
   based on the semantics of the relevant data, as defined for the relevant format <a href="references.html#refsINBANDTRACKS">[INBANDTRACKS]</a>. If there is no label in that data, then the <a data-anolis-xref="text track label" href="#text-track-label">label</a> must be set to the empty string.</li>

   <li><p>Associate the <a href="#text-track-list-of-cues">text track list of cues</a> with the <a href="#rules-for-updating-the-text-track-rendering">rules for updating the
   text track rendering</a> appropriate for the format in question.</p>

   <li>

    <p>If the new <a href="#text-track">text track</a>'s <a data-anolis-xref="text track kind" href="#text-track-kind">kind</a> is <code data-anolis-xref="dom-TextTrack-kind-metadata"><a href="#dom-texttrack-kind-metadata">metadata</a></code>, then set the <a href="#text-track-in-band-metadata-track-dispatch-type">text track in-band
    metadata track dispatch type</a> as follows, based on the type of the <a href="#media-resource">media
    resource</a>:</p>

    <dl class="switch"><dt>If the <a href="#media-resource">media resource</a> is an Ogg file</dt>

     <dd>The <a href="#text-track-in-band-metadata-track-dispatch-type">text track in-band metadata track dispatch type</a> must be set to the value
     of the Role header field. <a href="references.html#refsOGGSKELETONHEADERS">[OGGSKELETONHEADERS]</a></dd>

     <dt>If the <a href="#media-resource">media resource</a> is a WebM file</dt>

     <dd>The <a href="#text-track-in-band-metadata-track-dispatch-type">text track in-band metadata track dispatch type</a> must be set to the value
     of the <code data-anolis-xref="">CodecID</code> element. <a href="references.html#refsWEBMCG">[WEBMCG]</a></dd>

     <dt>If the <a href="#media-resource">media resource</a> is an MPEG-2 file</dt>

     <dd>Let <var data-anolis-xref="">stream type</var> be the value of the "stream_type" field describing the
     text track's type in the file's program map section, interpreted as an 8-bit unsigned integer.
     Let <var data-anolis-xref="">length</var> be the value of the "ES_info_length" field for the track in the
     same part of the program map section, interpreted as an integer as defined by the MPEG-2
     specification. Let <var data-anolis-xref="">descriptor bytes</var> be the <var data-anolis-xref="">length</var> bytes
     following the "ES_info_length" field. The <a href="#text-track-in-band-metadata-track-dispatch-type">text track in-band metadata track dispatch
     type</a> must be set to the concatenation of the <var data-anolis-xref="">stream type</var> byte and
     the zero or more <var data-anolis-xref="">descriptor bytes</var> bytes, expressed in hexadecimal using
     <a href="infrastructure.html#uppercase-ascii-hex-digits">uppercase ASCII hex digits</a>. <a href="references.html#refsMPEG2">[MPEG2]</a>

     </dd>

     <dt>If the <a href="#media-resource">media resource</a> is an MPEG-4 file</dt>

     <dd>Let the 
     first <code data-anolis-xref="">stsd</code> box of the
     first <code data-anolis-xref="">stbl</code> box of the
     first <code data-anolis-xref="">minf</code> box of the
     first <code data-anolis-xref="">mdia</code> box of the
     <a href="#text-track">text track</a>'s <code data-anolis-xref="">trak</code> box in the
     first <code data-anolis-xref="">moov</code> box
     of the file be the <i>stsd box</i>, if any.

     If the file has no <i>stsd box</i>, or if the <i>stsd box</i> has neither a <code data-anolis-xref="">mett</code> box nor a <code data-anolis-xref="">metx</code> box, then the <a href="#text-track-in-band-metadata-track-dispatch-type">text track
     in-band metadata track dispatch type</a> must be set to the empty string.

     Otherwise, if the <i>stsd box</i> has a <code data-anolis-xref="">mett</code> box then the <a href="#text-track-in-band-metadata-track-dispatch-type">text
     track in-band metadata track dispatch type</a> must be set to the concatenation of the
     string "<code data-anolis-xref="">mett</code>", a U+0020 SPACE character, and the value of the first <code data-anolis-xref="">mime_format</code> field of the first <code data-anolis-xref="">mett</code> box of the <i>stsd
     box</i>, or the empty string if that field is absent in that box.

     Otherwise, if the <i>stsd box</i> has no <code data-anolis-xref="">mett</code> box but has a <code data-anolis-xref="">metx</code> box then the <a href="#text-track-in-band-metadata-track-dispatch-type">text track in-band metadata track dispatch type</a>
     must be set to the concatenation of the string "<code data-anolis-xref="">metx</code>", a U+0020 SPACE
     character, and the value of the first <code data-anolis-xref="">namespace</code> field of the first <code data-anolis-xref="">metx</code> box of the <i>stsd box</i>, or the empty string if that field is absent in
     that box.

     <a href="references.html#refsMPEG4">[MPEG4]</a>

     </dd>

     <dt>If the <a href="#media-resource">media resource</a> is a DASH media resource</dt>

     <dd>The <a href="#text-track-in-band-metadata-track-dispatch-type">text track in-band metadata track dispatch type</a> must be set to the concatenation
      of the "AdaptationSet" element attributes and all child Role descriptors.

      <a href="references.html#refsDASH">[DASH]</a>

     </dd>

    </dl></li>

   <li><p>Populate the new <a href="#text-track">text track</a>'s <a data-anolis-xref="text track list of cues" href="#text-track-list-of-cues">list of
   cues</a> with the cues parsed so far, following the <a href="#guidelines-for-exposing-cues-in-various-formats-as-text-track-cues">guidelines for exposing
   cues</a>, and begin updating it dynamically as necessary.</li>

   <li><p>Set the new <a href="#text-track">text track</a>'s <a data-anolis-xref="text track readiness state" href="#text-track-readiness-state">readiness
   state</a> to <a data-anolis-xref="text track loaded" href="#text-track-loaded">loaded</a>.</li> <!-- otherwise, you'll
   have to load the whole media file just to start playing the first frame... -->

   <li><p>Set the new <a href="#text-track">text track</a>'s <a data-anolis-xref="text track mode" href="#text-track-mode">mode</a> to the
   mode consistent with the user's preferences and the requirements of the relevant specification
   for the data.</li> <!-- it's too late to apply the normal heuristic, so we don't bother -->

   <li><p>Add the new <a href="#text-track">text track</a> to the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text
   tracks</a>.</li>

   <li><p><a data-anolis-xref="concept-event-fire" href="infrastructure.html#concept-event-fire">Fire</a> a <a data-anolis-xref="concept-events-trusted" href="infrastructure.html#concept-events-trusted">trusted</a> event with the name <code data-anolis-xref="event-media-addtrack"><a href="#event-media-addtrack">addtrack</a></code>, that does not bubble and is not cancelable, and that uses
   the <code><a href="#trackevent">TrackEvent</a></code> interface, with the <code data-anolis-xref="dom-TrackEvent-track"><a href="#dom-trackevent-track">track</a></code>
   attribute initialized to the <a href="#text-track">text track</a>'s <code><a href="#texttrack">TextTrack</a></code> object, at the
   <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-textTracks"><a href="#dom-media-texttracks">textTracks</a></code> attribute's
   <code><a href="#texttracklist">TextTrackList</a></code> object.</li>

  </ol><!-- removetrack: we don't currently ever remove an in-band text track, because it might have been
  manipulated or might be about to be manipulated. If we made in-band text tracks readonly, we could
  probably get away with cleaning them up when they fall into the time before the earliest possible
  position and are known to be over and done with. --><!-- if, after in-band text tracks have been found, there's no out-of-band text tracks, then apply
  user prefs? --></div>



  <div class="impl">

  <h6 id="sourcing-out-of-band-text-tracks"><span class="secno">4.7.10.12.3 </span>Sourcing out-of-band text tracks</h6>

  <p>When a <code><a href="#the-track-element">track</a></code> element is created, it must be associated with a new <a href="#text-track">text
  track</a> (with its value set as defined below) and its corresponding new
  <code><a href="#texttrack">TextTrack</a></code> object.</p>

  <p>The <a href="#text-track-kind">text track kind</a> is determined from the state of the element's <code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code> attribute according to the following table; for a state given
  in a cell of the first column, the <a data-anolis-xref="text track kind" href="#text-track-kind">kind</a> is the string given
  in the second column:</p>

  <table><thead><tr><th>State
     <th>String
   <tbody><tr><td><a data-anolis-xref="attr-track-kind-subtitles" href="#attr-track-kind-subtitles">Subtitles</a>
     <td><code data-anolis-xref="dom-TextTrack-kind-subtitles"><a href="#dom-texttrack-kind-subtitles">subtitles</a></code>
    <tr><td><a data-anolis-xref="attr-track-kind-captions" href="#attr-track-kind-captions">Captions</a>
     <td><code data-anolis-xref="dom-TextTrack-kind-captions"><a href="#dom-texttrack-kind-captions">captions</a></code>
    <tr><td><a data-anolis-xref="attr-track-kind-descriptions" href="#attr-track-kind-descriptions">Descriptions</a>
     <td><code data-anolis-xref="dom-TextTrack-kind-descriptions"><a href="#dom-texttrack-kind-descriptions">descriptions</a></code>
    <tr><td><a data-anolis-xref="attr-track-kind-chapters" href="#attr-track-kind-chapters">Chapters</a>
     <td><code data-anolis-xref="dom-TextTrack-kind-chapters"><a href="#dom-texttrack-kind-chapters">chapters</a></code>
    <tr><td><a data-anolis-xref="attr-track-kind-metadata" href="#attr-track-kind-metadata">Metadata</a>
     <td><code data-anolis-xref="dom-TextTrack-kind-metadata"><a href="#dom-texttrack-kind-metadata">metadata</a></code>
  </table><p>The <a href="#text-track-label">text track label</a> is the element's <a href="#track-label">track label</a>.</p>

  <p>The <a href="#text-track-language">text track language</a> is the element's <a href="#track-language">track language</a>, if any, or
  the empty string otherwise.</p>

  <p>As the <code data-anolis-xref="attr-track-kind"><a href="#attr-track-kind">kind</a></code>, <code data-anolis-xref="attr-track-label"><a href="#attr-track-label">label</a></code>,
  and <code data-anolis-xref="attr-track-srclang"><a href="#attr-track-srclang">srclang</a></code> attributes are set, changed, or removed, the
  <a href="#text-track">text track</a> must update accordingly, as per the definitions above.</p>

  <p class="note">Changes to the <a href="#track-url">track URL</a> are handled in the algorithm below.</p>

  <p>The <a href="#text-track-readiness-state">text track readiness state</a> is initially <a data-anolis-xref="text track not
  loaded" href="#text-track-not-loaded">not loaded</a>, and the <a href="#text-track-mode">text track mode</a> is initially <a data-anolis-xref="text
  track disabled" href="#text-track-disabled">disabled</a>.</p>

  <p>The <a href="#text-track-list-of-cues">text track list of cues</a> is initially empty. It is dynamically modified when
  the referenced file is parsed. Associated with the list are the <a href="#rules-for-updating-the-text-track-rendering">rules for updating the text
  track rendering</a> appropriate for the format in question; for <a href="infrastructure.html#webvtt">WebVTT</a>, this is
  the <a href="infrastructure.html#rules-for-updating-the-display-of-webvtt-text-tracks">rules for updating the display of WebVTT text tracks</a>. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>

  <p>When a <code><a href="#the-track-element">track</a></code> element's parent element changes and the new parent is a <a href="#media-element">media
  element</a>, then the user agent must add the <code><a href="#the-track-element">track</a></code> element's corresponding
  <a href="#text-track">text track</a> to the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>, and
  then <a href="webappapis.html#queue-a-task">queue a task</a> to <a data-anolis-xref="concept-event-fire" href="infrastructure.html#concept-event-fire">fire</a> a <a data-anolis-xref="concept-events-trusted" href="infrastructure.html#concept-events-trusted">trusted</a> event with the name <code data-anolis-xref="event-media-addtrack"><a href="#event-media-addtrack">addtrack</a></code>, that does not bubble and is not cancelable, and that uses
  the <code><a href="#trackevent">TrackEvent</a></code> interface, with the <code data-anolis-xref="dom-TrackEvent-track"><a href="#dom-trackevent-track">track</a></code>
  attribute initialized to the <a href="#text-track">text track</a>'s <code><a href="#texttrack">TextTrack</a></code> object, at the
  <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-textTracks"><a href="#dom-media-texttracks">textTracks</a></code> attribute's
  <code><a href="#texttracklist">TextTrackList</a></code> object.</p>

  <p>When a <code><a href="#the-track-element">track</a></code> element's parent element changes and the old parent was a <a href="#media-element">media
  element</a>, then the user agent must remove the <code><a href="#the-track-element">track</a></code> element's corresponding
  <a href="#text-track">text track</a> from the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>,
  and then <a href="webappapis.html#queue-a-task">queue a task</a> to <a data-anolis-xref="concept-event-fire" href="infrastructure.html#concept-event-fire">fire</a> a <a data-anolis-xref="concept-events-trusted" href="infrastructure.html#concept-events-trusted">trusted</a> event with the name <code data-anolis-xref="event-media-removetrack"><a href="#event-media-removetrack">removetrack</a></code>, that does not bubble and is not cancelable, and that
  uses the <code><a href="#trackevent">TrackEvent</a></code> interface, with the <code data-anolis-xref="dom-TrackEvent-track"><a href="#dom-trackevent-track">track</a></code> attribute initialized to the <a href="#text-track">text track</a>'s
  <code><a href="#texttrack">TextTrack</a></code> object, at the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-textTracks"><a href="#dom-media-texttracks">textTracks</a></code> attribute's <code><a href="#texttracklist">TextTrackList</a></code> object.</p>
  <!-- removetrack -->

  <hr><p>When a <a href="#text-track">text track</a> corresponding to a <code><a href="#the-track-element">track</a></code> element is added to a
  <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>, the user agent must <a href="webappapis.html#queue-a-task">queue a
  task</a> to run the following steps for the <a href="#media-element">media element</a>:</p>

  <ol><li><p>If the element's <a href="#blocked-on-parser">blocked-on-parser</a> flag is true, abort these steps.</li>

   <li><p>If the element's <a href="#did-perform-automatic-track-selection">did-perform-automatic-track-selection</a> flag is true, abort
   these steps.</li>

   <li><p><a href="#honor-user-preferences-for-automatic-text-track-selection">Honor user preferences for automatic text track selection</a> for this
   element.</li>

  </ol><p>When the user agent is required to <dfn id="honor-user-preferences-for-automatic-text-track-selection">honor user preferences for automatic text track
  selection</dfn> for a <a href="#media-element">media element</a>, the user agent must run the following steps:</p>

  <ol><li><p><a href="#perform-automatic-text-track-selection">Perform automatic text track selection</a> for <code data-anolis-xref="dom-TextTrack-kind-subtitles"><a href="#dom-texttrack-kind-subtitles">subtitles</a></code> and <code data-anolis-xref="dom-TextTrack-kind-captions"><a href="#dom-texttrack-kind-captions">captions</a></code>.</li>

   <li><p><a href="#perform-automatic-text-track-selection">Perform automatic text track selection</a> for <code data-anolis-xref="dom-TextTrack-kind-descriptions"><a href="#dom-texttrack-kind-descriptions">descriptions</a></code>.</li>

   <li><p><a href="#perform-automatic-text-track-selection">Perform automatic text track selection</a> for <code data-anolis-xref="dom-TextTrack-kind-chapters"><a href="#dom-texttrack-kind-chapters">chapters</a></code>.</li>

   <li><p>If there are any <a data-anolis-xref="text track" href="#text-track">text tracks</a> in the <a href="#media-element">media
   element</a>'s <a href="#list-of-text-tracks">list of text tracks</a> whose <a href="#text-track-kind">text track kind</a> is <code data-anolis-xref="dom-TextTrack-kind-metadata"><a href="#dom-texttrack-kind-metadata">metadata</a></code> that correspond to <code><a href="#the-track-element">track</a></code>
   elements with a <code data-anolis-xref="attr-track-default"><a href="#attr-track-default">default</a></code> attribute set whose <a href="#text-track-mode">text
   track mode</a> is set to <a data-anolis-xref="text track disabled" href="#text-track-disabled">disabled</a>, then set the
   <a href="#text-track-mode">text track mode</a> of all such tracks to <a data-anolis-xref="text track
   hidden" href="#text-track-hidden">hidden</a></li>

   <li><p>Set the element's <a href="#did-perform-automatic-track-selection">did-perform-automatic-track-selection</a> flag to
   true.</li>

  </ol><p>When the steps above say to <dfn id="perform-automatic-text-track-selection">perform automatic text track selection</dfn> for one or more
  <a data-anolis-xref="text track kind" href="#text-track-kind">text track kinds</a>, it means to run the following steps:</p>

  <ol><li><p>Let <var data-anolis-xref="">candidates</var> be a list consisting of the <a data-anolis-xref="text
   track" href="#text-track">text tracks</a> in the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>
   whose <a href="#text-track-kind">text track kind</a> is one of the kinds that were passed to the algorithm, if any,
   in the order given in the <a href="#list-of-text-tracks">list of text tracks</a>.</li>

   <li><p>If <var data-anolis-xref="">candidates</var> is empty, then abort these steps.</li>

   <li><p>If any of the <a data-anolis-xref="text track" href="#text-track">text tracks</a> in <var data-anolis-xref="">candidates</var> have a <a href="#text-track-mode">text track mode</a> set to <a data-anolis-xref="text track
   showing" href="#text-track-showing">showing</a>, abort these steps.</li>

   <li>

    <p>If the user has expressed an interest in having a track from <var data-anolis-xref="">candidates</var>
    enabled based on its <a href="#text-track-kind">text track kind</a>, <a href="#text-track-language">text track language</a>, and
    <a href="#text-track-label">text track label</a>, then set its <a href="#text-track-mode">text track mode</a> to <a data-anolis-xref="text
    track showing" href="#text-track-showing">showing</a><!--, and if there are any <span data-x="text track">text
    tracks</span> in <var data-x="">candidates</var> that correspond to <code>track</code> elements
    with a <code data-x="attr-track-default">default</code> attribute set whose <span>text track
    mode</span> is set to <span data-x="text track disabled">disabled</span>, then additionally set
    the <span>text track mode</span> of the first such track to <span data-x="text track
    hidden">hidden</span>-->.</p> <!-- the idea behind the commented out stuff is that we still get
    events and stuff: we can expect authors to forget that default doesn't mean that it'll always be
    turned on, and that they'll still rely on events firing even if it doesn't show. But it is
    commented out, because we can equally expect authors to expect only one track is getting events,
    so we've got problems either way, and might as well go with the simpler behaviour. -->

    <p class="note">For example, the user could have set a browser preference to the effect of "I
    want French captions whenever possible", or "If there is a subtitle track with 'Commentary' in
    the title, enable it", or "If there are audio description tracks available, enable one, ideally
    in Swiss German, but failing that in Standard Swiss German or Standard German".</p>

    <p>Otherwise, if there are any <a data-anolis-xref="text track" href="#text-track">text tracks</a> in <var data-anolis-xref="">candidates</var> that correspond to <code><a href="#the-track-element">track</a></code> elements with a <code data-anolis-xref="attr-track-default"><a href="#attr-track-default">default</a></code> attribute set whose <a href="#text-track-mode">text track mode</a> is
    set to <a data-anolis-xref="text track disabled" href="#text-track-disabled">disabled</a>, then set the <a href="#text-track-mode">text track
    mode</a> of the first such track to <a data-anolis-xref="text track showing" href="#text-track-showing">showing</a>.</p>

   </li>

  </ol><p>When a <a href="#text-track">text track</a> corresponding to a <code><a href="#the-track-element">track</a></code> element experiences any of
  the following circumstances, the user agent must <a href="#start-the-track-processing-model">start the <code>track</code> processing
  model</a> for that <a href="#text-track">text track</a> and its <code><a href="#the-track-element">track</a></code> element:

  <ul><li>The <code><a href="#the-track-element">track</a></code> element is created.</li>

   <li>The <a href="#text-track">text track</a> has its <a href="#text-track-mode">text track mode</a> changed.</li>

   <li>The <code><a href="#the-track-element">track</a></code> element's parent element changes and the new parent is a <a href="#media-element">media
   element</a>.</li>

  </ul><p>When a user agent is to <dfn id="start-the-track-processing-model">start the <code>track</code> processing model</dfn> for a
  <a href="#text-track">text track</a> and its <code><a href="#the-track-element">track</a></code> element, it must run the following algorithm.
  This algorithm interacts closely with the <a href="webappapis.html#event-loop">event loop</a> mechanism; in particular, it has
  a <a href="webappapis.html#synchronous-section">synchronous section</a> (which is triggered as part of the <a href="webappapis.html#event-loop">event loop</a>
  algorithm). The steps in that section are marked with ⌛.</p>

  <ol><li><p>If another occurrence of this algorithm is already running for this <a href="#text-track">text
   track</a> and its <code><a href="#the-track-element">track</a></code> element, abort these steps, letting that other algorithm
   take care of this element.</li>

   <li><p>If the <a href="#text-track">text track</a>'s <a href="#text-track-mode">text track mode</a> is not set to one of <a data-anolis-xref="text track hidden" href="#text-track-hidden">hidden</a> or <a data-anolis-xref="text track showing" href="#text-track-showing">showing</a>, abort
   these steps.</li>

   <li><p>If the <a href="#text-track">text track</a>'s <code><a href="#the-track-element">track</a></code> element does not have a <a href="#media-element">media
   element</a> as a parent, abort these steps.</li>

   <li><p>Run the remainder of these steps asynchronously, allowing whatever caused these steps to
   run to continue.</li>

   <li><p><i>Top</i>: <a href="webappapis.html#await-a-stable-state">Await a stable state</a>. The <a href="webappapis.html#synchronous-section">synchronous section</a>
   consists of the following steps. (The steps in the <a href="webappapis.html#synchronous-section">synchronous section</a> are marked
   with ⌛.)</li>

   <li><p>⌛ Set the <a href="#text-track-readiness-state">text track readiness state</a> to <a data-anolis-xref="text track
   loading" href="#text-track-loading">loading</a>.</li>

   <li><p>⌛ Let <var data-anolis-xref="">URL</var> be the <a href="#track-url">track URL</a> of the
   <code><a href="#the-track-element">track</a></code> element.</li>

   <li><p>⌛ If the <code><a href="#the-track-element">track</a></code> element's parent is a <a href="#media-element">media element</a> then
   let <var data-anolis-xref="">CORS mode</var> be the state of the parent <a href="#media-element">media element</a>'s <code data-anolis-xref="attr-media-crossorigin"><a href="#attr-media-crossorigin">crossorigin</a></code> content attribute. Otherwise, let <var data-anolis-xref="">CORS mode</var> be <a data-anolis-xref="attr-crossorigin-none" href="infrastructure.html#attr-crossorigin-none">No CORS</a>.</li>

   <li><p>End the <a href="webappapis.html#synchronous-section">synchronous section</a>, continuing the remaining steps
   asynchronously.</li>

   <li>

    <p>If <var data-anolis-xref="">URL</var> is not the empty string, perform a <a href="infrastructure.html#potentially-cors-enabled-fetch">potentially CORS-enabled
    fetch</a><!--FETCH--> of <var data-anolis-xref="">URL</var>, with the <i>mode</i> being <var data-anolis-xref="">CORS mode</var>, the <i data-anolis-xref="">origin</i> being the <a href="browsers.html#origin-0">origin</a> of the
    <code><a href="#the-track-element">track</a></code> element's <code><a href="dom.html#document">Document</a></code>, and the <i>default origin behaviour</i> set
    to <i>fail</i>.</p>

    <p>The resource obtained in this fashion, if any, contains the text track data. If any data is
    obtained, it is by definition <a href="infrastructure.html#cors-same-origin">CORS-same-origin</a> (cross-origin resources that are not
    suitably CORS-enabled do not get this far).</p>

    <p>The <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> by the
    <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching algorithm</a> on the <a href="webappapis.html#networking-task-source">networking task source</a> to
    process the data as it is being fetched must <!--<span data-x="Content-Type
    sniffing">-->determine the <!--sniffed--> type of the resource<!--</span>-->. If the
    <!--sniffed--> type of the resource is not a supported text track format, the load will fail, as
    described below. Otherwise, the resource's data must be passed to the appropriate parser (e.g.
    the <a href="infrastructure.html#webvtt-parser">WebVTT parser</a><!-- if the file starts with the "<code data-x="">WEBVTT</code>"
    signature-->) as it is received, with the <a href="#text-track-list-of-cues">text track list of cues</a> being used for
    that parser's output. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p><!-- see also critical block below,
    and the word "sniffed" in the paragraph after that -->

    <p class="note">The appropriate parser will synchronously (during these <a href="webappapis.html#networking-task-source">networking task
    source</a> <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a>) and incrementally (as each such task is
    run with whatever data has been received from the network) update the <a href="#text-track-list-of-cues">text track list of
    cues</a>.</p>

    <p class="critical">This specification does not currently say whether or how to check the MIME
    types of text tracks, or whether or how to perform file type sniffing using the actual file
    data. Implementors differ in their intentions on this matter and it is therefore unclear what
    the right solution is. In the absence of any requirement here, the HTTP specification's strict
    requirement to follow the Content-Type header prevails ("Content-Type specifies the media type
    of the underlying data." ... "If and only if the media type is not given by a Content-Type
    field, the recipient MAY attempt to guess the media type via inspection of its content
    and<!---->/<!---->or the name extension(s) of the URI used to identify the resource.").</p>

    <p>If the <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching algorithm</a> fails for any reason (network error, the
    server returns an error code, a cross-origin check fails, etc), if <var data-anolis-xref="">URL</var> is
    the empty string, or if the <!--sniffed--> type of the resource is not a supported text track
    format, then run these steps:</p>

    <ol><li><p><a href="webappapis.html#queue-a-task">Queue a task</a> to first change the <a href="#text-track-readiness-state">text track readiness state</a> to
     <a data-anolis-xref="text track failed to load" href="#text-track-failed-to-load">failed to load</a> and then <a href="webappapis.html#fire-a-simple-event">fire a simple
     event</a> named <code data-anolis-xref="event-error">error</code> at the <code><a href="#the-track-element">track</a></code>
     element.</li>

     <li><p>Wait until the <a href="#text-track-readiness-state">text track readiness state</a> is no longer set to <a data-anolis-xref="text track loading" href="#text-track-loading">loading</a>.</li>

     <li><p>Wait until the <a href="#track-url">track URL</a> is no longer equal to <var data-anolis-xref="">URL</var>, at
     the same time as the <a href="#text-track-mode">text track mode</a> is set to <a data-anolis-xref="text track
     hidden" href="#text-track-hidden">hidden</a> or <a data-anolis-xref="text track showing" href="#text-track-showing">showing</a>.</li>

     <li><p>Jump to the step labeled <i>top</i>.</li>

    </ol><p>If the <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching algorithm</a> does not fail, then the final <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">task</a> that is <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> by the
    <a href="webappapis.html#networking-task-source">networking task source</a> must run the following steps after it has tried to parse the
    data:</p>

    <ol><li><p>Change the <a href="#text-track-readiness-state">text track readiness state</a> to <a data-anolis-xref="text track
     loaded" href="#text-track-loaded">loaded</a>.</li>

     <li>

      <p>If the file was successfully processed, <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-load">load</code> at the <code><a href="#the-track-element">track</a></code> element.</p>

      <p>Otherwise, the file was not successfully processed (e.g. the format in question is an XML
      format and the file contained a well-formedness error that the XML specification requires be
      detected and reported to the application); <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named <code data-anolis-xref="event-error">error</code> at the <code><a href="#the-track-element">track</a></code> element.</p>

     </li>

     <li><p>Wait until the <a href="#track-url">track URL</a> is no longer equal to <var data-anolis-xref="">URL</var>, at
     the same time as the <a href="#text-track-mode">text track mode</a> is set to <a data-anolis-xref="text track
     hidden" href="#text-track-hidden">hidden</a> or <a data-anolis-xref="text track showing" href="#text-track-showing">showing</a>.</li>

     <li><p>Jump back to the step labeled <i>top</i>.</li>

    </ol><p>If, while the <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching algorithm</a> is active, either:</p>

    <ul><li>the <a href="#track-url">track URL</a> changes so that it is no longer equal to <var data-anolis-xref="">URL</var>, while the <a href="#text-track-mode">text track mode</a> is set to <a data-anolis-xref="text track
     hidden" href="#text-track-hidden">hidden</a> or <a data-anolis-xref="text track showing" href="#text-track-showing">showing</a>; or</li>

     <li>the <a href="#text-track-mode">text track mode</a> changes to <a data-anolis-xref="text track hidden" href="#text-track-hidden">hidden</a>
     or <a data-anolis-xref="text track showing" href="#text-track-showing">showing</a>, while the <a href="#track-url">track URL</a> is not
     equal to <var data-anolis-xref="">URL</var></li>

    </ul><p>...then the user agent must run the following steps:</p>

    <ol><li><p>Abort the <a data-anolis-xref="fetch" href="infrastructure.html#fetch">fetching algorithm</a>, discarding any pending <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> generated by that algorithm (and in particular, not adding
     any cues to the <a href="#text-track-list-of-cues">text track list of cues</a> after the moment the URL
     changed).</li>

     <li><p>Jump back to the step labeled <i>top</i>.</li>

    </ol><p>Until one of the above circumstances occurs, the user agent must remain on this step.</p>

   </li>

  </ol><p>Whenever a <code><a href="#the-track-element">track</a></code> element has its <code data-anolis-xref="attr-track-src"><a href="#attr-track-src">src</a></code> attribute
  set, changed, or removed, the user agent must synchronously empty the element's <a href="#text-track">text
  track</a>'s <a href="#text-track-list-of-cues">text track list of cues</a>. (This also causes the algorithm above to stop
  adding cues from the resource being obtained using the previously given URL, if any.)</p>

  </div>


  <div class="impl">

  <h6 id="guidelines-for-exposing-cues-in-various-formats-as-text-track-cues"><span class="secno">4.7.10.12.4 </span><dfn>Guidelines for exposing cues</dfn> in various formats as <a data-anolis-xref="text track
  cue" href="#text-track-cue">text track cues</a></h6>

  <p>How a specific format's text track cues are to be interpreted for the purposes of processing by
  an HTML user agent is defined by that format <a href="references.html#refsINBANDTRACKS">[INBANDTRACKS]</a>. In the
  absence of such a specification, this section provides some constraints within which implementations can
  attempt to consistently expose such formats.</p>

  <p>To support the <a href="#text-track">text track</a> model of HTML, each unit of timed data is converted to a
  <a href="#text-track-cue">text track cue</a>. Where the mapping of the format's features to the aspects of a
  <a href="#text-track-cue">text track cue</a> as defined in this specification are not defined, implementations must
  ensure that the mapping is consistent with the definitions of the aspects of a <a href="#text-track-cue">text track
  cue</a> as defined above, as well as with the following constraints:</p>

  <dl><dt>The <a href="#text-track-cue-identifier">text track cue identifier</a>
   <dd>
    <p>Should be set to the empty string if the format has no obvious analogue to a per-cue
    identifier.</p>
   </dd>

   <dt>The <a href="#text-track-cue-pause-on-exit-flag">text track cue pause-on-exit flag</a>
   <dd>
    <p>Should be set to false.</p>
   </dd>

  </dl></div>


  <h6 id="text-track-api"><span class="secno">4.7.10.12.5 </span>Text track API</h6>

  <pre class="idl">interface <dfn id="texttracklist">TextTrackList</dfn> : <a href="infrastructure.html#eventtarget">EventTarget</a> {
  readonly attribute unsigned long <a data-anolis-xref="dom-TextTrackList-length" href="#dom-texttracklist-length">length</a>;
  getter <a href="#texttrack">TextTrack</a> (unsigned long index);
  <a href="#texttrack">TextTrack</a>? <a data-anolis-xref="dom-TextTrackList-getTrackById" href="#dom-texttracklist-gettrackbyid">getTrackById</a>(DOMString id);

           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TextTrackList-onchange" href="#handler-texttracklist-onchange">onchange</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TextTrackList-onaddtrack" href="#handler-texttracklist-onaddtrack">onaddtrack</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TextTrackList-onremovetrack" href="#handler-texttracklist-onremovetrack">onremovetrack</a>;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-textTracks"><a href="#dom-media-texttracks">textTracks</a></code> . <code data-anolis-xref="">length</code></dt>
   <dd>
    <p>Returns the number of <a data-anolis-xref="text track" href="#text-track">text tracks</a> associated with the <a href="#media-element">media element</a> (e.g. from <code><a href="#the-track-element">track</a></code> elements). This is the number of <a data-anolis-xref="text track" href="#text-track">text tracks</a> in the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>.</p>
   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-textTracks"><a href="#dom-media-texttracks">textTracks[</a></code> <var data-anolis-xref="">n</var> <code data-anolis-xref="">]</code></dt>
   <dd>
    <p>Returns the <code><a href="#texttrack">TextTrack</a></code> object representing the <var data-anolis-xref="">n</var>th <a href="#text-track">text track</a> in the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>.</p>
   </dd>

   <dt><var data-anolis-xref="">textTrack</var> = <var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-textTracks"><a href="#dom-media-texttracks">textTracks</a></code> . <code data-anolis-xref="dom-TextTrackList-getTrackById"><a href="#dom-texttracklist-gettrackbyid">getTrackById</a></code>( <var data-anolis-xref="">id</var> )</dt>

   <dd>

    <p>Returns the <code><a href="#texttrack">TextTrack</a></code> object with the given identifier, or null if no track has that identifier.</p>

   </dd>

   <dt><var data-anolis-xref="">track</var> . <code data-anolis-xref="dom-track-track"><a href="#dom-track-track">track</a></code></dt>
   <dd>
    <p>Returns the <code><a href="#texttrack">TextTrack</a></code> object representing the <code><a href="#the-track-element">track</a></code> element's <a href="#text-track">text track</a>.</p>
   </dd>

  </dl><div class="impl">

  <p>A <code><a href="#texttracklist">TextTrackList</a></code> object represents a dynamically updating list of <a data-anolis-xref="text
  track" href="#text-track">text tracks</a> in a given order.</p>

  <p>The <dfn data-anolis-xref="dom-media-textTracks" id="dom-media-texttracks"><code>textTracks</code></dfn> attribute of <a data-anolis-xref="media element" href="#media-element">media elements</a> must return a <code><a href="#texttracklist">TextTrackList</a></code> object
  representing the <code><a href="#texttrack">TextTrack</a></code> objects of the <a data-anolis-xref="text track" href="#text-track">text tracks</a>
  in the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>, in the same order as in the
  <a href="#list-of-text-tracks">list of text tracks</a>. The same object must be returned each time the attribute is
  accessed. <a href="references.html#refsWEBIDL">[WEBIDL]</a></p>

  <p>The <dfn data-anolis-xref="dom-TextTrackList-length" id="dom-texttracklist-length"><code>length</code></dfn> attribute of a
  <code><a href="#texttracklist">TextTrackList</a></code> object must return the number of <a data-anolis-xref="text track" href="#text-track">text
  tracks</a> in the list represented by the <code><a href="#texttracklist">TextTrackList</a></code> object.</p>

  <p>The <a href="infrastructure.html#supported-property-indices">supported property indices</a> of a <code><a href="#texttracklist">TextTrackList</a></code> object at any
  instant are the numbers from zero to the number of <a data-anolis-xref="text track" href="#text-track">text tracks</a> in
  the list represented by the <code><a href="#texttracklist">TextTrackList</a></code> object minus one, if any. If there are no
  <a data-anolis-xref="text track" href="#text-track">text tracks</a> in the list, there are no <a href="infrastructure.html#supported-property-indices">supported property
  indices</a>.</p>

  <p>To <a href="infrastructure.html#determine-the-value-of-an-indexed-property">determine the value of an indexed property</a> of a <code><a href="#texttracklist">TextTrackList</a></code>
  object for a given index <var data-anolis-xref="">index</var>, the user agent must return the <var data-anolis-xref="">index</var>th <a href="#text-track">text track</a> in the list represented by the
  <code><a href="#texttracklist">TextTrackList</a></code> object.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrackList-getTrackById" id="dom-texttracklist-gettrackbyid"><code>getTrackById(<var data-anolis-xref="">id</var>)</code></dfn> method must return the first <code><a href="#texttrack">TextTrack</a></code> in the
  <code><a href="#texttracklist">TextTrackList</a></code> object whose <code data-anolis-xref="dom-TextTrack-id"><a href="#dom-texttrack-id">id</a></code> IDL attribute
  would return a value equal to the value of the <var data-anolis-xref="">id</var> argument. When no tracks
  match the given argument, the method must return null.</p>

  </div>

  <hr><pre class="idl">enum <dfn id="texttrackmode">TextTrackMode</dfn> {<!--
   --> "<a data-anolis-xref="dom-TextTrack-disabled" href="#dom-texttrack-disabled">disabled</a>", <!--
   --> "<a data-anolis-xref="dom-TextTrack-hidden" href="#dom-texttrack-hidden">hidden</a>", <!--
   --> "<a data-anolis-xref="dom-TextTrack-showing" href="#dom-texttrack-showing">showing</a>" };
enum <dfn id="texttrackkind">TextTrackKind</dfn> {<!--
   --> "<a data-anolis-xref="dom-TextTrack-kind-subtitles" href="#dom-texttrack-kind-subtitles">subtitles</a>", <!--
   --> "<a data-anolis-xref="dom-TextTrack-kind-captions" href="#dom-texttrack-kind-captions">captions</a>", <!--
   --> "<a data-anolis-xref="dom-TextTrack-kind-descriptions" href="#dom-texttrack-kind-descriptions">descriptions</a>", <!--
   --> "<a data-anolis-xref="dom-TextTrack-kind-chapters" href="#dom-texttrack-kind-chapters">chapters</a>", <!--
   --> "<a data-anolis-xref="dom-TextTrack-kind-metadata" href="#dom-texttrack-kind-metadata">metadata</a>" };
interface <dfn id="texttrack">TextTrack</dfn> : <a href="infrastructure.html#eventtarget">EventTarget</a> {
  readonly attribute <a href="#texttrackkind">TextTrackKind</a> <a data-anolis-xref="dom-TextTrack-kind" href="#dom-texttrack-kind">kind</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-TextTrack-label" href="#dom-texttrack-label">label</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-TextTrack-language" href="#dom-texttrack-language">language</a>;

  readonly attribute DOMString <a data-anolis-xref="dom-TextTrack-id" href="#dom-texttrack-id">id</a>;
  readonly attribute DOMString <a data-anolis-xref="dom-TextTrack-inBandMetadataTrackDispatchType" href="#dom-texttrack-inbandmetadatatrackdispatchtype">inBandMetadataTrackDispatchType</a>;

           attribute <a href="#texttrackmode">TextTrackMode</a> <a data-anolis-xref="dom-TextTrack-mode" href="#dom-texttrack-mode">mode</a>;

  readonly attribute <a href="#texttrackcuelist">TextTrackCueList</a>? <a data-anolis-xref="dom-TextTrack-cues" href="#dom-texttrack-cues">cues</a>;
  readonly attribute <a href="#texttrackcuelist">TextTrackCueList</a>? <a data-anolis-xref="dom-TextTrack-activeCues" href="#dom-texttrack-activecues">activeCues</a>;

  void <a data-anolis-xref="dom-TextTrack-addCue" href="#dom-texttrack-addcue">addCue</a>(<a href="#texttrackcue">TextTrackCue</a> cue);
  void <a data-anolis-xref="dom-TextTrack-removeCue" href="#dom-texttrack-removecue">removeCue</a>(<a href="#texttrackcue">TextTrackCue</a> cue);

           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TextTrack-oncuechange" href="#handler-texttrack-oncuechange">oncuechange</a>;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">textTrack</var> = <var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-addTextTrack"><a href="#dom-media-addtexttrack">addTextTrack</a></code>( <var data-anolis-xref="">kind</var> [, <var data-anolis-xref="">label</var> [, <var data-anolis-xref="">language</var> ] ] )</dt>
   <dd>

    <p>Creates and returns a new <code><a href="#texttrack">TextTrack</a></code> object, which is also added to the
    <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>.</p>

   </dd>

   <dt><var data-anolis-xref="">textTrack</var> . <code data-anolis-xref="dom-TextTrack-kind"><a href="#dom-texttrack-kind">kind</a></code></dt>
   <dd>

    <p>Returns the <a href="#text-track-kind">text track kind</a> string.</p>

   </dd>

   <dt><var data-anolis-xref="">textTrack</var> . <code data-anolis-xref="dom-TextTrack-label"><a href="#dom-texttrack-label">label</a></code></dt>
   <dd>

    <p>Returns the <a href="#text-track-label">text track label</a>, if there is one, or the empty string otherwise
    (indicating that a custom label probably needs to be generated from the other attributes of the
    object if the object is exposed to the user).</p>

   </dd>

   <dt><var data-anolis-xref="">textTrack</var> . <code data-anolis-xref="dom-TextTrack-language"><a href="#dom-texttrack-language">language</a></code></dt>
   <dd>
    <p>Returns the <a href="#text-track-language">text track language</a> string.</p>
   </dd>

   <dt><var data-anolis-xref="">textTrack</var> . <code data-anolis-xref="dom-TextTrack-id"><a href="#dom-texttrack-id">id</a></code></dt>
   <dd>

    <p>Returns the ID of the given track.</p>

    <p>For in-band tracks, this is the ID that can be used with a fragment identifier if the format
    supports the <cite>Media Fragments URI</cite> syntax, and that can be used with the <code data-anolis-xref="dom-TextTrackList-getTrackById"><a href="#dom-texttracklist-gettrackbyid">getTrackById()</a></code> method. <a href="references.html#refsMEDIAFRAG">[MEDIAFRAG]</a></p>

    <p>For <code><a href="#texttrack">TextTrack</a></code> objects corresponding to <code><a href="#the-track-element">track</a></code> elements, this is the
    ID of the <code><a href="#the-track-element">track</a></code> element.</p>

   </dd>

   <dt><var data-anolis-xref="">textTrack</var> . <code data-anolis-xref="dom-TextTrack-inBandMetadataTrackDispatchType"><a href="#dom-texttrack-inbandmetadatatrackdispatchtype">inBandMetadataTrackDispatchType</a></code></dt>
   <dd>

    <p>Returns the <a href="#text-track-in-band-metadata-track-dispatch-type">text track in-band metadata track dispatch type</a> string.</p>

   </dd>

   <dt><var data-anolis-xref="">textTrack</var> . <code data-anolis-xref="dom-TextTrack-mode"><a href="#dom-texttrack-mode">mode</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>
   <dd>

    <p>Returns the <a href="#text-track-mode">text track mode</a>, represented by a string from the following
    list:</p>

    <dl><dt>"<code data-anolis-xref="dom-TextTrack-disabled"><a href="#dom-texttrack-disabled">disabled</a></code>"</dt>
     <dd>
      <p>The <a href="#text-track-disabled">text track disabled</a> mode.</p>
     </dd>
     <dt>"<code data-anolis-xref="dom-TextTrack-hidden"><a href="#dom-texttrack-hidden">hidden</a></code>"</dt>
     <dd>
      <p>The <a href="#text-track-hidden">text track hidden</a> mode.</p>
     </dd>
     <dt>"<code data-anolis-xref="dom-TextTrack-showing"><a href="#dom-texttrack-showing">showing</a></code>"</dt>
     <dd>
      <p>The <a href="#text-track-showing">text track showing</a> mode.</p>
     </dd>
    </dl><p>Can be set, to change the mode.</p>

   </dd>

   <dt><var data-anolis-xref="">textTrack</var> . <code data-anolis-xref="dom-TextTrack-cues"><a href="#dom-texttrack-cues">cues</a></code></dt>
   <dd>
    <p>Returns the <a href="#text-track-list-of-cues">text track list of cues</a>, as a <code><a href="#texttrackcuelist">TextTrackCueList</a></code> object.</p>
   </dd>

   <dt><var data-anolis-xref="">textTrack</var> . <code data-anolis-xref="dom-TextTrack-activeCues"><a href="#dom-texttrack-activecues">activeCues</a></code></dt>
   <dd>

    <p>Returns the <a data-anolis-xref="text track cue" href="#text-track-cue">text track cues</a> from the <a href="#text-track-list-of-cues">text track
    list of cues</a> that are currently active (i.e. that start before the <a href="#current-playback-position">current playback
    position</a> and end after it), as a <code><a href="#texttrackcuelist">TextTrackCueList</a></code> object.</p>

   </dd>

   <dt><var data-anolis-xref="">textTrack</var> . <code data-anolis-xref="dom-TextTrack-addCue"><a href="#dom-texttrack-addcue">addCue</a></code>( <var data-anolis-xref="">cue</var> )</dt>
   <dd>
    <p>Adds the given cue to <var data-anolis-xref="">textTrack</var>'s <a href="#text-track-list-of-cues">text track list of cues</a>.</p>
   </dd>

   <dt><var data-anolis-xref="">textTrack</var> . <code data-anolis-xref="dom-TextTrack-removeCue"><a href="#dom-texttrack-removecue">removeCue</a></code>( <var data-anolis-xref="">cue</var> )</dt>
   <dd>
    <p>Removes the given cue from <var data-anolis-xref="">textTrack</var>'s <a href="#text-track-list-of-cues">text track list of cues</a>.</p>
   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-media-addTextTrack" id="dom-media-addtexttrack"><code>addTextTrack(<var data-anolis-xref="">kind</var>, <var data-anolis-xref="">label</var>, <var data-anolis-xref="">language</var>)</code></dfn> method of <a data-anolis-xref="media
  element" href="#media-element">media elements</a>, when invoked, must run the following steps:</p>

  <ol><li>

    <p>Create a new <code><a href="#texttrack">TextTrack</a></code> object.</p>

   </li>

   <li>

    <p>Create a new <a href="#text-track">text track</a> corresponding to the new object, and set its <a href="#text-track-kind">text
    track kind</a> to <var data-anolis-xref="">kind</var>, its <a href="#text-track-label">text track label</a> to <var data-anolis-xref="">label</var>, its <a href="#text-track-language">text track language</a> to <var data-anolis-xref="">language</var>, its
    <a href="#text-track-readiness-state">text track readiness state</a> to the <a href="#text-track-loaded">text track loaded</a> state, its
    <a href="#text-track-mode">text track mode</a> to the <a href="#text-track-hidden">text track hidden</a> mode, and its <a href="#text-track-list-of-cues">text
    track list of cues</a> to an empty list.</p>

    <p>Initially, the <a href="#text-track-list-of-cues">text track list of cues</a> is not associated with any <a href="#rules-for-updating-the-text-track-rendering">rules
    for updating the text track rendering</a>. When a <a href="#text-track-cue">text track cue</a> is added to it,
    the <a href="#text-track-list-of-cues">text track list of cues</a> has its rules permanently set accordingly.</p>

   </li>

   <li>

    <p>Add the new <a href="#text-track">text track</a> to the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text
    tracks</a>.</p>

   </li>

   <li>

    <p><a href="webappapis.html#queue-a-task">Queue a task</a> to <a data-anolis-xref="concept-event-fire" href="infrastructure.html#concept-event-fire">fire</a> a <a data-anolis-xref="concept-events-trusted" href="infrastructure.html#concept-events-trusted">trusted</a> event with the name <code data-anolis-xref="event-media-addtrack"><a href="#event-media-addtrack">addtrack</a></code>, that does not bubble and is not cancelable, and
    that uses the <code><a href="#trackevent">TrackEvent</a></code> interface, with the <code data-anolis-xref="dom-TrackEvent-track"><a href="#dom-trackevent-track">track</a></code> attribute initialized to the new <a href="#text-track">text
    track</a>'s <code><a href="#texttrack">TextTrack</a></code> object, at the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-textTracks"><a href="#dom-media-texttracks">textTracks</a></code> attribute's <code><a href="#texttracklist">TextTrackList</a></code>
    object.</p>

   </li>

   <li>

    <p>Return the new <code><a href="#texttrack">TextTrack</a></code> object.</p>

   </li>

  </ol><hr><p>The <dfn data-anolis-xref="dom-TextTrack-kind" id="dom-texttrack-kind"><code>kind</code></dfn> attribute must return the
  <a href="#text-track-kind">text track kind</a> of the <a href="#text-track">text track</a> that the <code><a href="#texttrack">TextTrack</a></code> object
  represents.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrack-label" id="dom-texttrack-label"><code>label</code></dfn> attribute must return the
  <a href="#text-track-label">text track label</a> of the <a href="#text-track">text track</a> that the <code><a href="#texttrack">TextTrack</a></code>
  object represents.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrack-language" id="dom-texttrack-language"><code>language</code></dfn> attribute must return the
  <a href="#text-track-language">text track language</a> of the <a href="#text-track">text track</a> that the <code><a href="#texttrack">TextTrack</a></code>
  object represents.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrack-id" id="dom-texttrack-id"><code>id</code></dfn> attribute returns the track's
  identifier, if it has one, or the empty string otherwise. For tracks that correspond to
  <code><a href="#the-track-element">track</a></code> elements, the track's identifier is the value of the element's <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> attribute, if any. For in-band tracks, the track's identifier is
  specified by the <a href="#media-resource">media resource</a>. If the <a href="#media-resource">media resource</a> is in a format
  that supports the <cite>Media Fragments URI</cite> fragment identifier syntax, the identifier
  returned for a particular track must be the same identifier that would enable the track if used as
  the name of a track in the track dimension of such a fragment identifier. <a href="references.html#refsMEDIAFRAG">[MEDIAFRAG]</a></p>

  <p>The <dfn data-anolis-xref="dom-TextTrack-inBandMetadataTrackDispatchType" id="dom-texttrack-inbandmetadatatrackdispatchtype"><code>inBandMetadataTrackDispatchType</code></dfn>
  attribute must return the <a href="#text-track-in-band-metadata-track-dispatch-type">text track in-band metadata track dispatch type</a> of the
  <a href="#text-track">text track</a> that the <code><a href="#texttrack">TextTrack</a></code> object represents.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrack-mode" id="dom-texttrack-mode"><code>mode</code></dfn> attribute, on getting, must return
  the string corresponding to the <a href="#text-track-mode">text track mode</a> of the <a href="#text-track">text track</a> that
  the <code><a href="#texttrack">TextTrack</a></code> object represents, as defined by the following list:</p>

  <dl><dt>"<dfn data-anolis-xref="dom-TextTrack-disabled" id="dom-texttrack-disabled"><code>disabled</code></dfn>"</dt>
   <dd>The <a href="#text-track-disabled">text track disabled</a> mode.</dd>
   <dt>"<dfn data-anolis-xref="dom-TextTrack-hidden" id="dom-texttrack-hidden"><code>hidden</code></dfn>"</dt>
   <dd>The <a href="#text-track-hidden">text track hidden</a> mode.</dd>
   <dt>"<dfn data-anolis-xref="dom-TextTrack-showing" id="dom-texttrack-showing"><code>showing</code></dfn>"</dt>
   <dd>The <a href="#text-track-showing">text track showing</a> mode.</dd>
  </dl><p>On setting, if the new value isn't equal to what the attribute would currently return, the new
  value must be processed as follows:</p>

  <dl class="switch"><dt>If the new value is "<code data-anolis-xref="dom-TextTrack-disabled"><a href="#dom-texttrack-disabled">disabled</a></code>"</dt>

   <dd>

    <p>Set the <a href="#text-track-mode">text track mode</a> of the <a href="#text-track">text track</a> that the
    <code><a href="#texttrack">TextTrack</a></code> object represents to the <a href="#text-track-disabled">text track disabled</a> mode.</p>

   </dd>

   <dt>If the new value is "<code data-anolis-xref="dom-TextTrack-hidden"><a href="#dom-texttrack-hidden">hidden</a></code>"</dt>

   <dd>

    <p>Set the <a href="#text-track-mode">text track mode</a> of the <a href="#text-track">text track</a> that the
    <code><a href="#texttrack">TextTrack</a></code> object represents to the <a href="#text-track-hidden">text track hidden</a> mode.</p>

   </dd>

   <dt>If the new value is "<code data-anolis-xref="dom-TextTrack-showing"><a href="#dom-texttrack-showing">showing</a></code>"</dt>

   <dd>

    <p>Set the <a href="#text-track-mode">text track mode</a> of the <a href="#text-track">text track</a> that the
    <code><a href="#texttrack">TextTrack</a></code> object represents to the <a href="#text-track-showing">text track showing</a> mode.</p>

   </dd>

  </dl><p>If the <a href="#text-track-mode">text track mode</a> of the <a href="#text-track">text track</a> that the
  <code><a href="#texttrack">TextTrack</a></code> object represents is not the <a href="#text-track-disabled">text track disabled</a> mode, then
  the <dfn data-anolis-xref="dom-TextTrack-cues" id="dom-texttrack-cues"><code>cues</code></dfn> attribute must return a
  <a href="infrastructure.html#live">live</a> <code><a href="#texttrackcuelist">TextTrackCueList</a></code> object that represents the subset of the
  <a href="#text-track-list-of-cues">text track list of cues</a> of the <a href="#text-track">text track</a> that the
  <code><a href="#texttrack">TextTrack</a></code> object represents whose <a data-anolis-xref="text track cue end time" href="#text-track-cue-end-time">end
  times</a> occur at or after the <a href="#earliest-possible-position-when-the-script-started">earliest possible position when the script
  started</a>, in <a href="#text-track-cue-order">text track cue order</a>. Otherwise, it must return null. When an
  object is returned, the same object must be returned each time.</p>

  <p>The <dfn id="earliest-possible-position-when-the-script-started">earliest possible position when the script started</dfn> is whatever the
  <a href="#earliest-possible-position">earliest possible position</a> was the last time the <a href="webappapis.html#event-loop">event loop</a> reached step
  1.</p>

  <p>If the <a href="#text-track-mode">text track mode</a> of the <a href="#text-track">text track</a> that the
  <code><a href="#texttrack">TextTrack</a></code> object represents is not the <a href="#text-track-disabled">text track disabled</a> mode, then
  the <dfn data-anolis-xref="dom-TextTrack-activeCues" id="dom-texttrack-activecues"><code>activeCues</code></dfn> attribute must return a
  <a href="infrastructure.html#live">live</a> <code><a href="#texttrackcuelist">TextTrackCueList</a></code> object that represents the subset of the
  <a href="#text-track-list-of-cues">text track list of cues</a> of the <a href="#text-track">text track</a> that the
  <code><a href="#texttrack">TextTrack</a></code> object represents whose <a href="#active-flag-was-set-when-the-script-started">active flag was set when the script
  started</a>, in <a href="#text-track-cue-order">text track cue order</a>. Otherwise, it must return null. When an
  object is returned, the same object must be returned each time.</p>

  <p>A <a href="#text-track-cue">text track cue</a>'s <dfn id="active-flag-was-set-when-the-script-started">active flag was set when the script started</dfn> if its
  <a href="#text-track-cue-active-flag">text track cue active flag</a> was set the last time the <a href="webappapis.html#event-loop">event loop</a> reached
  step 1.</p>

  <hr><p>The <dfn data-anolis-xref="dom-TextTrack-addCue" id="dom-texttrack-addcue"><code>addCue(<var data-anolis-xref="">cue</var>)</code></dfn> method
  of <code><a href="#texttrack">TextTrack</a></code> objects, when invoked, must run the following steps:</p>

  <ol><li><p>If the <a href="#text-track-list-of-cues">text track list of cues</a> does not yet have any associated <a href="#rules-for-updating-the-text-track-rendering">rules
   for updating the text track rendering</a>, then associate the <a href="#text-track-list-of-cues">text track list of
   cues</a> with the <a href="#rules-for-updating-the-text-track-rendering">rules for updating the text track rendering</a> appropriate to <var data-anolis-xref="">cue</var>.</p>

   <li><p>If <a href="#text-track-list-of-cues">text track list of cues</a>' associated <a href="#rules-for-updating-the-text-track-rendering">rules for updating the text
   track rendering</a> are not the same <a href="#rules-for-updating-the-text-track-rendering">rules for updating the text track rendering</a>
   as appropriate for <var data-anolis-xref="">cue</var>, then throw an <code><a href="infrastructure.html#invalidstateerror">InvalidStateError</a></code>
   exception and abort these steps.</p>

   <li><p>If the given <var data-anolis-xref="">cue</var> is in a <a href="#text-track-list-of-cues">text track list of cues</a>, then
   remove <var data-anolis-xref="">cue</var> from that <a href="#text-track-list-of-cues">text track list of cues</a>.</li>

   <li><p>Add <var data-anolis-xref="">cue</var> to the method's <code><a href="#texttrack">TextTrack</a></code> object's <a href="#text-track">text
   track</a>'s <a href="#text-track-list-of-cues">text track list of cues</a>.</li>

  </ol><p>The <dfn data-anolis-xref="dom-TextTrack-removeCue" id="dom-texttrack-removecue"><code>removeCue(<var data-anolis-xref="">cue</var>)</code></dfn>
  method of <code><a href="#texttrack">TextTrack</a></code> objects, when invoked, must run the following steps:</p>

  <ol><li><p>If the given <var data-anolis-xref="">cue</var> is not currently listed in the method's
   <code><a href="#texttrack">TextTrack</a></code> object's <a href="#text-track">text track</a>'s <a href="#text-track-list-of-cues">text track list of cues</a>,
   then throw a <code><a href="infrastructure.html#notfounderror">NotFoundError</a></code> exception and abort these steps.</li>

   <li><p>Remove <var data-anolis-xref="">cue</var> from the method's <code><a href="#texttrack">TextTrack</a></code> object's
   <a href="#text-track">text track</a>'s <a href="#text-track-list-of-cues">text track list of cues</a>.</li>

  </ol></div>

  <div class="example">

   <p>In this example, an <code><a href="#the-audio-element">audio</a></code> element is used to play a specific sound-effect from a
   sound file containing many sound effects. A cue is used to pause the audio, so that it ends
   exactly at the end of the clip, even if the browser is busy running some script. If the page had
   relied on script to pause the audio, then the start of the next clip might be heard if the
   browser was not able to run the script at the exact time specified.</p>

   <pre>var sfx = new Audio('sfx.wav');
var sounds = sfx.addTextTrack('metadata');

// add sounds we care about
function addFX(start, end, name) {
  var cue = new VTTCue(start, end, '');
  cue.id = name;
  cue.pauseOnExit = true;
  sounds.addCue(cue);
}
addFX(12.783, 13.612, 'dog bark');
addFX(13.612, 15.091, 'kitten mew'))

function playSound(id) {
  sfx.currentTime = sounds.getCueById(id).startTime;
  sfx.play();
}

// play a bark as soon as we can
sfx.oncanplaythrough = function () {
  playSound('dog bark');
}
// meow when the user tries to leave
window.onbeforeunload = function () {
  playSound('kitten mew');
  return 'Are you sure you want to leave this awesome page?';
}</pre>

  </div>

  <hr><pre class="idl">interface <dfn id="texttrackcuelist">TextTrackCueList</dfn> {
  readonly attribute unsigned long <a data-anolis-xref="dom-TextTrackCueList-length" href="#dom-texttrackcuelist-length">length</a>;
  getter <a href="#texttrackcue">TextTrackCue</a> (unsigned long index);
  <a href="#texttrackcue">TextTrackCue</a>? <a data-anolis-xref="dom-TextTrackCueList-getCueById" href="#dom-texttrackcuelist-getcuebyid">getCueById</a>(DOMString id);
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">cuelist</var> . <code data-anolis-xref="dom-TextTrackCueList-length"><a href="#dom-texttrackcuelist-length">length</a></code></dt>
   <dd>
    <p>Returns the number of <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> in the list.</p>
   </dd>

   <dt><var data-anolis-xref="">cuelist</var>[<var data-anolis-xref="">index</var>]</dt>
   <dd>
    <p>Returns the <a href="#text-track-cue">text track cue</a> with index <var data-anolis-xref="">index</var> in the list. The cues are sorted in <a href="#text-track-cue-order">text track cue order</a>.</p>
   </dd>

   <dt><var data-anolis-xref="">cuelist</var> . <code data-anolis-xref="dom-TextTrackCueList-getCueById"><a href="#dom-texttrackcuelist-getcuebyid">getCueById</a></code>( <var data-anolis-xref="">id</var> )</dt>
   <dd>
    <p>Returns the first <a href="#text-track-cue">text track cue</a> (in <a href="#text-track-cue-order">text track cue order</a>) with <a href="#text-track-cue-identifier">text track cue identifier</a> <var data-anolis-xref="">id</var>.</p>
    <p>Returns null if none of the cues have the given identifier or if the argument is the empty string.</p>
   </dd>

  </dl><div class="impl">

  <p>A <code><a href="#texttrackcuelist">TextTrackCueList</a></code> object represents a dynamically updating list of <a data-anolis-xref="text track cue" href="#text-track-cue">text track cues</a> in a given order.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrackCueList-length" id="dom-texttrackcuelist-length"><code>length</code></dfn> attribute must return
  the number of <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> in the list represented by the
  <code><a href="#texttrackcuelist">TextTrackCueList</a></code> object.</p>

  <p>The <a href="infrastructure.html#supported-property-indices">supported property indices</a> of a <code><a href="#texttrackcuelist">TextTrackCueList</a></code> object at any
  instant are the numbers from zero to the number of <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> in the
  list represented by the <code><a href="#texttrackcuelist">TextTrackCueList</a></code> object minus one, if any. If there are no
  <a data-anolis-xref="text track cue" href="#text-track-cue">cues</a> in the list, there are no <a href="infrastructure.html#supported-property-indices">supported property
  indices</a>.</p>

  <p>To <a href="infrastructure.html#determine-the-value-of-an-indexed-property">determine the value of an indexed property</a> for a given index <var data-anolis-xref="">index</var>, the user agent must return the <var data-anolis-xref="">index</var>th <a href="#text-track-cue">text track
  cue</a> in the list represented by the <code><a href="#texttrackcuelist">TextTrackCueList</a></code> object.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrackCueList-getCueById" id="dom-texttrackcuelist-getcuebyid"><code>getCueById(<var data-anolis-xref="">id</var>)</code></dfn> method, when called with an argument other than the empty string,
  must return the first <a href="#text-track-cue">text track cue</a> in the list represented by the
  <code><a href="#texttrackcuelist">TextTrackCueList</a></code> object whose <a href="#text-track-cue-identifier">text track cue identifier</a> is <var data-anolis-xref="">id</var>, if any, or null otherwise. If the argument is the empty string, then the method
  must return null.</p>

  </div>

  <hr><pre class="idl">interface <dfn id="texttrackcue">TextTrackCue</dfn> : <a href="infrastructure.html#eventtarget">EventTarget</a> {
  readonly attribute <a href="#texttrack">TextTrack</a>? <a data-anolis-xref="dom-TextTrackCue-track" href="#dom-texttrackcue-track">track</a>;

           attribute DOMString <a data-anolis-xref="dom-TextTrackCue-id" href="#dom-texttrackcue-id">id</a>;
           attribute double <a data-anolis-xref="dom-TextTrackCue-startTime" href="#dom-texttrackcue-starttime">startTime</a>;
           attribute double <a data-anolis-xref="dom-TextTrackCue-endTime" href="#dom-texttrackcue-endtime">endTime</a>;
           attribute boolean <a data-anolis-xref="dom-TextTrackCue-pauseOnExit" href="#dom-texttrackcue-pauseonexit">pauseOnExit</a>;

           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TextTrackCue-onenter" href="#handler-texttrackcue-onenter">onenter</a>;
           attribute <a href="webappapis.html#eventhandler">EventHandler</a> <a data-anolis-xref="handler-TextTrackCue-onexit" href="#handler-texttrackcue-onexit">onexit</a>;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">cue</var> . <a data-anolis-xref="dom-TextTrackCue-track" href="#dom-texttrackcue-track">track</a></dt>
   <dd>
    <p>Returns the <code><a href="#texttrack">TextTrack</a></code> object to which this
    <a href="#text-track-cue">text track cue</a> belongs, if any, or null
    otherwise.</p>
   </dd>

   <dt><var data-anolis-xref="">cue</var> . <a data-anolis-xref="dom-TextTrackCue-id" href="#dom-texttrackcue-id">id</a> [ = <var data-anolis-xref="">value</var> ]</dt>
   <dd>
    <p>Returns the <a href="#text-track-cue-identifier">text track cue identifier</a>.</p>
    <p>Can be set.</p>
   </dd>

   <dt><var data-anolis-xref="">cue</var> . <a data-anolis-xref="dom-TextTrackCue-startTime" href="#dom-texttrackcue-starttime">startTime</a> [ = <var data-anolis-xref="">value</var> ]</dt>
   <dd>
    <p>Returns the <a href="#text-track-cue-start-time">text track cue start time</a>, in seconds.</p>
    <p>Can be set.</p>
   </dd>

   <dt><var data-anolis-xref="">cue</var> . <a data-anolis-xref="dom-TextTrackCue-endTime" href="#dom-texttrackcue-endtime">endTime</a> [ = <var data-anolis-xref="">value</var> ]</dt>
   <dd>
    <p>Returns the <a href="#text-track-cue-end-time">text track cue end time</a>, in seconds.</p>
    <p>Can be set.</p>
   </dd>

   <dt><var data-anolis-xref="">cue</var> . <a data-anolis-xref="dom-TextTrackCue-pauseOnExit" href="#dom-texttrackcue-pauseonexit">pauseOnExit</a> [ = <var data-anolis-xref="">value</var> ]</dt>
   <dd>
    <p>Returns true if the <a href="#text-track-cue-pause-on-exit-flag">text track cue pause-on-exit flag</a> is set, false otherwise.</p>
    <p>Can be set.</p>
   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-TextTrackCue-track" id="dom-texttrackcue-track"><code>track</code></dfn> attribute, on getting, must
  return the <code><a href="#texttrack">TextTrack</a></code> object of the <a href="#text-track">text track</a> in whose <a data-anolis-xref="text
  track list of cues" href="#text-track-list-of-cues">list of cues</a> the <a href="#text-track-cue">text track cue</a> that the
  <code><a href="#texttrackcue">TextTrackCue</a></code> object represents finds itself, if any; or null otherwise.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrackCue-id" id="dom-texttrackcue-id"><code>id</code></dfn> attribute, on getting, must return
  the <a href="#text-track-cue-identifier">text track cue identifier</a> of the <a href="#text-track-cue">text track cue</a> that the
  <code><a href="#texttrackcue">TextTrackCue</a></code> object represents. On setting, the <a href="#text-track-cue-identifier">text track cue
  identifier</a> must be set to the new value.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrackCue-startTime" id="dom-texttrackcue-starttime"><code>startTime</code></dfn> attribute, on getting,
  must return the <a href="#text-track-cue-start-time">text track cue start time</a> of the <a href="#text-track-cue">text track cue</a> that the
  <code><a href="#texttrackcue">TextTrackCue</a></code> object represents, in seconds. On setting, the <a href="#text-track-cue-start-time">text track cue
  start time</a> must be set to the new value, interpreted in seconds; then, if the
  <code><a href="#texttrackcue">TextTrackCue</a></code> object's <a href="#text-track-cue">text track cue</a> is in a <a href="#text-track">text track</a>'s
  <a data-anolis-xref="text track list of cues" href="#text-track-list-of-cues">list of cues</a>, and that <a href="#text-track">text track</a> is in
  a <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>, and the <a href="#media-element">media
  element</a>'s <a href="#show-poster-flag">show poster flag</a> is not set, then run the <i><a href="#time-marches-on">time marches on</a></i>
  steps for that <a href="#media-element">media element</a>.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrackCue-endTime" id="dom-texttrackcue-endtime"><code>endTime</code></dfn> attribute, on getting,
  must return the <a href="#text-track-cue-end-time">text track cue end time</a> of the <a href="#text-track-cue">text track cue</a> that the
  <code><a href="#texttrackcue">TextTrackCue</a></code> object represents, in seconds. On setting, the <a href="#text-track-cue-end-time">text track cue end
  time</a> must be set to the new value, interpreted in seconds; then, if the
  <code><a href="#texttrackcue">TextTrackCue</a></code> object's <a href="#text-track-cue">text track cue</a> is in a <a href="#text-track">text track</a>'s
  <a data-anolis-xref="text track list of cues" href="#text-track-list-of-cues">list of cues</a>, and that <a href="#text-track">text track</a> is in
  a <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>, and the <a href="#media-element">media
  element</a>'s <a href="#show-poster-flag">show poster flag</a> is not set, then run the <i><a href="#time-marches-on">time marches on</a></i>
  steps for that <a href="#media-element">media element</a>.</p>

  <p>The <dfn data-anolis-xref="dom-TextTrackCue-pauseOnExit" id="dom-texttrackcue-pauseonexit"><code>pauseOnExit</code></dfn> attribute, on
  getting, must return true if the <a href="#text-track-cue-pause-on-exit-flag">text track cue pause-on-exit flag</a> of the <a href="#text-track-cue">text
  track cue</a> that the <code><a href="#texttrackcue">TextTrackCue</a></code> object represents is set; or false otherwise.
  On setting, the <a href="#text-track-cue-pause-on-exit-flag">text track cue pause-on-exit flag</a> must be set if the new value is
  true, and must be unset otherwise.</p>

  </div>

  <h6 id="text-tracks-describing-chapters"><span class="secno">4.7.10.12.6 </span>Text tracks describing chapters</h6>

  <p>Chapters are segments of a <a href="#media-resource">media resource</a> with a given title. Chapters can be
  nested, in the same way that sections in a document outline can have subsections.</p>

  <p>Each <a href="#text-track-cue">text track cue</a> in a <a href="#text-track">text track</a> being used for describing
  chapters has three key features: the <a href="#text-track-cue-start-time">text track cue start time</a>, giving the start time
  of the chapter, the <a href="#text-track-cue-end-time">text track cue end time</a>, giving the end time of the chapter, and
  the <a href="#text-track-cue-data">text track cue data</a> giving the chapter title.</p>

  <div class="impl">

  <p>The <dfn id="rules-for-constructing-the-chapter-tree-from-a-text-track">rules for constructing the chapter tree from a text track</dfn> are as follows. They
  produce a potentially nested list of chapters, each of which have a start time, end time, title,
  and a list of nested chapters. This algorithm discards cues that do not correctly nest within each
  other, or that are out of order.</p>

  <ol><li><p>Let <var data-anolis-xref="">list</var> be a copy of the <a data-anolis-xref="text track list of cues" href="#text-track-list-of-cues">list
   of cues</a> of the <a href="#text-track">text track</a> being processed.</li>

   <li><p>Remove from <var data-anolis-xref="">list</var> any <a href="#text-track-cue">text track cue</a> whose <a href="#text-track-cue-end-time">text
   track cue end time</a> is before its <a href="#text-track-cue-start-time">text track cue start time</a>.</li>

   <li><p>Let <var data-anolis-xref="">output</var> be an empty list of chapters, where a chapter is a record
   consisting of a start time, an end time, a title, and a (potentially empty) list of nested
   chapters. For the purpose of this algorithm, each chapter also has a parent chapter.</li>

   <li><p>Let <var data-anolis-xref="">current chapter</var> be a stand-in chapter whose start time is negative
   infinity, whose end time is positive infinity, and whose list of nested chapters is <var data-anolis-xref="">output</var>. (This is just used to make the algorithm easier to describe.)</li>

   <!-- while not empty... -->
   <li><p><i>Loop</i>: If <var data-anolis-xref="">list</var> is empty, jump to the step labeled
   <i>end</i>.</li>

   <!-- do... -->
   <li><p>Let <var data-anolis-xref="">current cue</var> be the first cue in <var data-anolis-xref="">list</var>, and then
   remove it from <var data-anolis-xref="">list</var>.</li>

   <li><p>If <var data-anolis-xref="">current cue</var>'s <a href="#text-track-cue-start-time">text track cue start time</a> is less than
   the start time of <var data-anolis-xref="">current chapter</var>, then return to the step labeled
   <i>loop</i>.</p> <!-- out of order chapter -->

   <li><p>While <var data-anolis-xref="">current cue</var>'s <a href="#text-track-cue-start-time">text track cue start time</a> is greater
   than or equal to <var data-anolis-xref="">current chapter</var>'s end time, let <var data-anolis-xref="">current
   chapter</var> be <var data-anolis-xref="">current chapter</var>'s parent chapter.</li>

   <li><p>If <var data-anolis-xref="">current cue</var>'s <a href="#text-track-cue-end-time">text track cue end time</a> is greater than
   the end time of <var data-anolis-xref="">current chapter</var>, then return to the step labeled
   <i>loop</i>.</p> <!-- misnested chapter -->

   <li>

    <p>Create a new chapter <var data-anolis-xref="">new chapter</var>, whose start time is <var data-anolis-xref="">current cue</var>'s <a href="#text-track-cue-start-time">text track cue start time</a>, whose end time is <var data-anolis-xref="">current cue</var>'s <a href="#text-track-cue-end-time">text track cue end time</a>, whose title is <var data-anolis-xref="">current cue</var>'s <a href="#text-track-cue-data">text track cue data</a> interpreted according to its
    <a href="#rules-for-rendering-the-cue-in-isolation">rules for rendering the cue in isolation</a>, and whose list of nested chapters is
    empty.</p>

    <p class="note">For WebVTT, the <a href="#rules-for-rendering-the-cue-in-isolation">rules for rendering the cue in isolation</a> are the
    <a href="infrastructure.html#rules-for-interpreting-webvtt-cue-text">rules for interpreting WebVTT cue text</a>. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>

   </li>

   <li><p>Append <var data-anolis-xref="">new chapter</var> to <var data-anolis-xref="">current chapter</var>'s list of
   nested chapters, and let <var data-anolis-xref="">current chapter</var> be <var data-anolis-xref="">new chapter</var>'s
   parent.</li>

   <li><p>Let <var data-anolis-xref="">current chapter</var> be <var data-anolis-xref="">new chapter</var>.</li>

   <li><p>Return to the step labeled <i>loop</i>.</li>
   <!-- ...end while -->

   <li><p><i>End</i>: Return <var data-anolis-xref="">output</var>.</li>

  </ol></div>

  <div class="example">

   <p>The following snippet of a <a href="infrastructure.html#webvtt-file">WebVTT file</a> shows how nested chapters can be marked
   up. The file describes three 50-minute chapters, "Astrophysics", "Computational Physics", and
   "General Relativity". The first has three subchapters, the second has four, and the third has
   two. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>

   <pre>WEBVTT

00:00:00.000 --&gt; 00:50:00.000
Astrophysics

00:00:00.000 --&gt; 00:10:00.000
Introduction to Astrophysics

00:10:00.000 --&gt; 00:45:00.000
The Solar System

00:00:00.000 --&gt; 00:10:00.000
Coursework Description

00:50:00.000 --&gt; 01:40:00.000
Computational Physics

00:50:00.000 --&gt; 00:55:00.000
Introduction to Programming

00:55:00.000 --&gt; 01:30:00.000
Data Structures

01:30:00.000 --&gt; 01:35:00.000
Answers to Last Exam

01:35:00.000 --&gt; 01:40:00.000
Coursework Description

01:40:00.000 --&gt; 02:30:00.000
General Relativity

01:40:00.000 --&gt; 02:00:00.000
Tensor Algebra

02:00:00.000 --&gt; 02:30:00.000
The General Relativistic Field Equations</pre>

  </div>


  <div class="impl">

  <h6 id="cue-events"><span class="secno">4.7.10.12.7 </span>Event definitions</h6>

  <p>The following are the <a href="webappapis.html#event-handlers">event handlers</a> that (and their corresponding <a data-anolis-xref="event handler event type" href="webappapis.html#event-handler-event-type">event handler event types</a>) must be supported, as <a href="webappapis.html#event-handler-idl-attributes">event handler IDL
  attributes</a>, by all objects implementing the <code><a href="#texttracklist">TextTrackList</a></code> interface:</p>

  <table><thead><tr><th><a data-anolis-xref="event handlers" href="webappapis.html#event-handlers">Event handler</a> <th><a href="webappapis.html#event-handler-event-type">Event handler event type</a>
   <tbody><tr><td><dfn data-anolis-xref="handler-TextTrackList-onchange" id="handler-texttracklist-onchange"><code>onchange</code></dfn> <td> <code data-anolis-xref="event-media-change"><a href="#event-media-change">change</a></code>
    <tr><td><dfn data-anolis-xref="handler-TextTrackList-onaddtrack" id="handler-texttracklist-onaddtrack"><code>onaddtrack</code></dfn> <td> <code data-anolis-xref="event-media-addtrack"><a href="#event-media-addtrack">addtrack</a></code>
    <tr><td><dfn data-anolis-xref="handler-TextTrackList-onremovetrack" id="handler-texttracklist-onremovetrack"><code>onremovetrack</code></dfn> <td> <code data-anolis-xref="event-media-removetrack"><a href="#event-media-removetrack">removetrack</a></code>
  </table><p>The following are the <a href="webappapis.html#event-handlers">event handlers</a> that (and their corresponding <a data-anolis-xref="event handler event type" href="webappapis.html#event-handler-event-type">event handler event types</a>) must be supported, as <a href="webappapis.html#event-handler-idl-attributes">event handler IDL
  attributes</a>, by all objects implementing the <code><a href="#texttrack">TextTrack</a></code> interface:</p>

  <table><thead><tr><th><a data-anolis-xref="event handlers" href="webappapis.html#event-handlers">Event handler</a> <th><a href="webappapis.html#event-handler-event-type">Event handler event type</a>
   <tbody><tr><td><dfn data-anolis-xref="handler-TextTrack-oncuechange" id="handler-texttrack-oncuechange"><code>oncuechange</code></dfn> <td> <code data-anolis-xref="event-cuechange">cuechange</code>
  </table><p>The following are the <a href="webappapis.html#event-handlers">event handlers</a> that (and their corresponding <a data-anolis-xref="event handler event type" href="webappapis.html#event-handler-event-type">event handler event types</a>) must be supported, as <a href="webappapis.html#event-handler-idl-attributes">event handler IDL
  attributes</a>, by all objects implementing the <code><a href="#texttrackcue">TextTrackCue</a></code> interface:</p>

  <table><thead><tr><th><a data-anolis-xref="event handlers" href="webappapis.html#event-handlers">Event handler</a> <th><a href="webappapis.html#event-handler-event-type">Event handler event type</a>
   <tbody><tr><td><dfn data-anolis-xref="handler-TextTrackCue-onenter" id="handler-texttrackcue-onenter"><code>onenter</code></dfn> <td> <code data-anolis-xref="event-enter">enter</code>
    <tr><td><dfn data-anolis-xref="handler-TextTrackCue-onexit" id="handler-texttrackcue-onexit"><code>onexit</code></dfn> <td> <code data-anolis-xref="event-exit">exit</code>
  </table></div>


  <h5 id="user-interface"><span class="secno">4.7.10.13 </span>User interface</h5>

  <p>The <dfn data-anolis-xref="attr-media-controls" id="attr-media-controls"><code>controls</code></dfn> attribute is a <a href="infrastructure.html#boolean-attribute">boolean
  attribute</a>. If present, it indicates that the author has not provided a scripted controller
  and would like the user agent to provide its own set of controls.</p>

  <div class="impl">

  <p>If the attribute is present, or if <a data-anolis-xref="concept-n-noscript" href="webappapis.html#concept-n-noscript">scripting is
  disabled</a> for the <a href="#media-element">media element</a>, then the user agent should <dfn id="expose-a-user-interface-to-the-user">expose a user
  interface to the user</dfn>. This user interface should include features to begin playback, pause
  playback, seek to an arbitrary position in the content (if the content supports arbitrary
  seeking), change the volume, change the display of closed captions or embedded sign-language
  tracks, select different audio tracks or turn on audio descriptions, and show the media content in
  manners more suitable to the user (e.g. full-screen video or in an independent resizable window).
  Other controls may also be made available.</p>

  <p>If the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, then the user
  agent should expose audio tracks from all the <a href="#slaved-media-elements">slaved media elements</a> (although
  avoiding duplicates if the same <a href="#media-resource">media resource</a> is being used several times). If a
  <a href="#media-resource">media resource</a>'s audio track exposed in this way has no known name, and it is the
  only audio track for a particular <a href="#media-element">media element</a>, the user agent should use the
  element's <code data-anolis-xref="attr-title"><a href="dom.html#attr-title">title</a></code> attribute, if any, as the name (or as part of the
  name) of that track.</p>

  <p>Even when the attribute is absent, however, user agents may provide controls to affect playback
  of the media resource (e.g. play, pause, seeking, and volume controls), but such features should
  not interfere with the page's normal rendering. For example, such features could be exposed in the
  <a href="#media-element">media element</a>'s context menu. The user agent may implement this simply by <a data-anolis-xref="expose a user interface to the user" href="#expose-a-user-interface-to-the-user">exposing a user interface to the user</a> as
  described above (as if the <code data-anolis-xref="attr-media-controls"><a href="#attr-media-controls">controls</a></code> attribute was
  present).</p>

  <p>If the user agent <a data-anolis-xref="expose a user interface to the user" href="#expose-a-user-interface-to-the-user">exposes a user interface to
  the user</a> by displaying controls over the <a href="#media-element">media element</a>, then the user agent
  should suppress any user interaction events while the user agent is interacting with this
  interface. (For example, if the user clicks on a video's playback control, <code data-anolis-xref="event-mousedown">mousedown</code> events and so forth would not simultaneously be fired at
  elements on the page.)</p>

  <p>Where possible (specifically, for starting, stopping, pausing, and unpausing playback, for
  seeking, for changing the rate of playback, for fast-forwarding or rewinding, for listing,
  enabling, and disabling text tracks, and for muting or changing the volume of the audio), user
  interface features exposed by the user agent must be implemented in terms of the DOM API described
  above, so that, e.g., all the same events fire.</p>

  <p>When a <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, the user agent's
  user interface for pausing and unpausing playback, for seeking, for changing the rate of playback,
  for fast-forwarding or rewinding, and for muting or changing the volume of audio of the entire
  group must be implemented in terms of the <code><a href="#mediacontroller">MediaController</a></code> API exposed on that
  <a href="#current-media-controller">current media controller</a>. When a <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media
  controller</a>, and all the <a href="#slaved-media-elements">slaved media elements</a> of that
  <code><a href="#mediacontroller">MediaController</a></code> are paused, the user agent should also unpause all the <a href="#slaved-media-elements">slaved
  media elements</a> when the user invokes a user agent interface control for beginning
  playback.</p>

  <p>The "play" function in the user agent's interface must set the <code data-anolis-xref="">playbackRate</code> attribute to the value of the <code data-anolis-xref="">defaultPlaybackRate</code> attribute before invoking the <code data-anolis-xref="">play()</code>
  method. When a <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, the
  attributes and method with those names on that <code><a href="#mediacontroller">MediaController</a></code> object must be used.
  Otherwise, the attributes and method with those names on the <a href="#media-element">media element</a> itself
  must be used. </p>

  <p>Features such as fast-forward or rewind must be implemented by only changing the <code data-anolis-xref="">playbackRate</code> attribute (and not the <code data-anolis-xref="">defaultPlaybackRate</code>
  attribute). Again, when a <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>,
  the attributes with those names on that <code><a href="#mediacontroller">MediaController</a></code> object must be used;
  otherwise, the attributes with those names on the <a href="#media-element">media element</a> itself must be used.</p>

  <p>When a <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, seeking must be
  implemented in terms of the <code data-anolis-xref="dom-MediaController-currentTime"><a href="#dom-mediacontroller-currenttime">currentTime</a></code>
  attribute on that <code><a href="#mediacontroller">MediaController</a></code> object. Otherwise, the user agent must directly
  <a data-anolis-xref="dom-media-seek" href="#dom-media-seek">seek</a> to the requested position in the <a href="#media-element">media
  element</a>'s <a href="#media-timeline">media timeline</a>. For media resources where seeking to an arbitrary
  position would be slow, user agents are encouraged to use the <i>approximate-for-speed</i> flag
  when seeking in response to the user manipulating an approximate position interface such as a seek
  bar.</p>

  <p>When a <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, user agents may
  additionally provide the user with controls that directly manipulate an individual <a href="#media-element">media
  element</a> without affecting the <code><a href="#mediacontroller">MediaController</a></code>, but such features are
  considered relatively advanced and unlikely to be useful to most users.</p>

  <p>The <a href="dom.html#activation-behavior">activation behavior</a> of a <a href="#media-element">media element</a> that is <a data-anolis-xref="expose a user interface to the user" href="#expose-a-user-interface-to-the-user">exposing a user interface to the user</a> must be
  to run the following steps:</p>

  <ol><li><p>If the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>, and that
   <a href="#current-media-controller">current media controller</a> is a <a href="#restrained-media-controller">restrained media controller</a>, then invoke
   the <code data-anolis-xref="dom-MediaController-play"><a href="#dom-mediacontroller-play">play()</a></code> method of the
   <code><a href="#mediacontroller">MediaController</a></code>.</li>

   <li><p>Otherwise, if the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>,
   and that <a href="#current-media-controller">current media controller</a> is a <a href="#paused-media-controller">paused media controller</a>, then
   invoke the <code data-anolis-xref="dom-MediaController-unpause"><a href="#dom-mediacontroller-unpause">unpause()</a></code> method of the
   <code><a href="#mediacontroller">MediaController</a></code>.</li>

   <li><p>Otherwise, if the <a href="#media-element">media element</a> has a <a href="#current-media-controller">current media controller</a>,
   then that <a href="#current-media-controller">current media controller</a> is a <a href="#playing-media-controller">playing media controller</a>;
   invoke the <code data-anolis-xref="dom-MediaController-pause"><a href="#dom-mediacontroller-pause">pause()</a></code> method of the
   <code><a href="#mediacontroller">MediaController</a></code>.</li>

   <li><p>Otherwise, the <a href="#media-element">media element</a> has no <a href="#current-media-controller">current media controller</a>; if
   the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute is true,
   then invoke the <code data-anolis-xref="dom-media-play"><a href="#dom-media-play">play()</a></code> method on the <a href="#media-element">media
   element</a>.</li>

   <li><p>Otherwise, the <a href="#media-element">media element</a> has no <a href="#current-media-controller">current media controller</a>,
   and the <a href="#media-element">media element</a>'s <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> attribute is
   false; invoke the <code data-anolis-xref="dom-media-pause"><a href="#dom-media-pause">pause()</a></code> method on the <a href="#media-element">media
   element</a>.</li>

  </ol><p>For the purposes of listing chapters in the <a href="#media-resource">media resource</a>, only <a data-anolis-xref="text
  track" href="#text-track">text tracks</a> in the <a href="#media-element">media element</a>'s <a href="#list-of-text-tracks">list of text tracks</a>
  that are <a data-anolis-xref="text track showing" href="#text-track-showing">showing</a> and whose <a href="#text-track-kind">text track kind</a> is
  <code data-anolis-xref="dom-TextTrack-kind-chapters"><a href="#dom-texttrack-kind-chapters">chapters</a></code> should be used. Such tracks must be
  interpreted according to the <a href="#rules-for-constructing-the-chapter-tree-from-a-text-track">rules for constructing the chapter tree from a text
  track</a>. When seeking in response to a user maniplating a chapter selection interface, user
  agents should not use the <i>approximate-for-speed</i> flag.</p>

  <p>The <dfn data-anolis-xref="dom-media-controls" id="dom-media-controls"><code>controls</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the content attribute of the same name.</p>

  <hr></div>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-volume"><a href="#dom-media-volume">volume</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns the current playback volume, as a number in the range 0.0 to 1.0, where 0.0 is the
    quietest and 1.0 the loudest.</p>

    <p>Can be set, to change the volume.</p>

    <p>Throws an <code><a href="infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception if the new value is not in the range 0.0 .. 1.0.</p>

   </dd>

   <dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-media-muted"><a href="#dom-media-muted">muted</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>Returns true if audio is muted, overriding the <code data-anolis-xref="dom-media-volume"><a href="#dom-media-volume">volume</a></code>
    attribute, and false if the <code data-anolis-xref="dom-media-volume"><a href="#dom-media-volume">volume</a></code> attribute is being
    honored.</p>

    <p>Can be set, to change whether the audio is muted or not.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-media-volume" id="dom-media-volume"><code>volume</code></dfn> attribute must return the playback
  volume of any audio portions of the <a href="#media-element">media element</a>, in the range 0.0 (silent) to 1.0
  (loudest). Initially, the volume should be 1.0, but user agents may remember the last set value
  across sessions, on a per-site basis or otherwise, so the volume may start at other values. On
  setting, if the new value is in the range 0.0 to 1.0 inclusive, the playback volume of any audio
  portions of the <a href="#media-element">media element</a> must be set to the new value. If the new value is
  outside the range 0.0 to 1.0 inclusive, then, on setting, an <code><a href="infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception
  must be thrown instead.</p>

  <p>The <dfn data-anolis-xref="dom-media-muted" id="dom-media-muted"><code>muted</code></dfn> attribute must return true if the
  audio output is muted and false otherwise. Initially, the audio output should not be muted
  (false), but user agents may remember the last set value across sessions, on a per-site basis or
  otherwise, so the muted state may start as muted (true). On setting, if the new value is true then
  the audio output should be muted and if the new value is false it should be unmuted.</p>

  <p>Whenever either of the values that would be returned by the <code data-anolis-xref="dom-media-volume"><a href="#dom-media-volume">volume</a></code> and <code data-anolis-xref="dom-media-muted"><a href="#dom-media-muted">muted</a></code> attributes
  change, the user agent must <a href="webappapis.html#queue-a-task">queue a task</a> to <a href="webappapis.html#fire-a-simple-event">fire a simple event</a> named
  <code data-anolis-xref="event-media-volumechange"><a href="#event-media-volumechange">volumechange</a></code> at the <a href="#media-element">media element</a>.</p>

  <p>An element's <dfn id="effective-media-volume">effective media volume</dfn> is determined as follows:</p>

  <ol><li><p>If the user has indicated that the user agent is to override the volume of the element,
   then the element's <a href="#effective-media-volume">effective media volume</a> is the volume desired by the user. Abort
   these steps.</li>

   <li><p>If the element's audio output is muted, the element's <a href="#effective-media-volume">effective media volume</a>
   is zero. Abort these steps.</li>

   <li><p>If the element has a <a href="#current-media-controller">current media controller</a> and that
   <code><a href="#mediacontroller">MediaController</a></code> object's <a href="#media-controller-mute-override">media controller mute override</a> is true, the
   element's <a href="#effective-media-volume">effective media volume</a> is zero. Abort these steps.</li>

   <li><p>Let <var data-anolis-xref="">volume</var> be the playback volume of the audio portions of the
   <a href="#media-element">media element</a>, in range 0.0 (silent) to 1.0 (loudest).</li>

   <li><p>If the element has a <a href="#current-media-controller">current media controller</a>, multiply <var data-anolis-xref="">volume</var> by that <code><a href="#mediacontroller">MediaController</a></code> object's <a href="#media-controller-volume-multiplier">media controller volume
   multiplier</a>.</li>

   <li><p>The element's <a href="#effective-media-volume">effective media volume</a> is <var data-anolis-xref="">volume</var>,
   interpreted relative to the range 0.0 to 1.0, with 0.0 being silent, and 1.0 being the loudest
   setting, values in between increasing in loudness. The range need not be linear. The loudest
   setting may be lower than the system's loudest possible setting; for example the user could have
   set a maximum volume.</li>

  </ol></div>

  <p>The <dfn data-anolis-xref="attr-media-muted" id="attr-media-muted"><code>muted</code></dfn> attribute on <a data-anolis-xref="media
  element" href="#media-element">media elements</a> is a <a href="infrastructure.html#boolean-attribute">boolean attribute</a> that controls the default state
  of the audio output of the <a href="#media-resource">media resource</a>, potentially overriding user
  preferences.</p>

  <div class="impl">

  <p>When a <a href="#media-element">media element</a> is created, if it has a <code data-anolis-xref="attr-media-muted"><a href="#attr-media-muted">muted</a></code> attribute specified, the user agent must mute the
  <a href="#media-element">media element</a>'s audio output, overriding any user preference.</p>

  <p>The <dfn data-anolis-xref="dom-media-defaultMuted" id="dom-media-defaultmuted"><code>defaultMuted</code></dfn> IDL attribute must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-media-muted"><a href="#attr-media-muted">muted</a></code> content attribute.</p>

  </div>

  <p class="note">This attribute has no dynamic effect (it only controls the default state of the
  element).</p>

  <div class="example">

   <p>This video (an advertisement) autoplays, but to avoid annoying users, it does so without
   sound, and allows the user to turn the sound on.</p>

   <pre>&lt;video src="adverts.cgi?kind=video" controls autoplay loop muted&gt;&lt;/video&gt;</pre>

  </div>




  <h5 id="time-ranges"><span class="secno">4.7.10.14 </span>Time ranges</h5>

  <p>Objects implementing the <code><a href="#timeranges">TimeRanges</a></code> interface
  represent a list of ranges (periods) of time.</p>

  <pre class="idl">interface <dfn id="timeranges">TimeRanges</dfn> {
  readonly attribute unsigned long <a data-anolis-xref="dom-TimeRanges-length" href="#dom-timeranges-length">length</a>;
  double <a data-anolis-xref="dom-TimeRanges-start" href="#dom-timeranges-start">start</a>(unsigned long index);
  double <a data-anolis-xref="dom-TimeRanges-end" href="#dom-timeranges-end">end</a>(unsigned long index);
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-TimeRanges-length"><a href="#dom-timeranges-length">length</a></code></dt>

   <dd>

    <p>Returns the number of ranges in the object.</p>

   </dd>

   <dt><var data-anolis-xref="">time</var> = <var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-TimeRanges-start"><a href="#dom-timeranges-start">start</a></code>(<var data-anolis-xref="">index</var>)</dt>

   <dd>

    <p>Returns the time for the start of the range with the given index.</p>

    <p>Throws an <code><a href="infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception if the index is out of range.</p>

   </dd>

   <dt><var data-anolis-xref="">time</var> = <var data-anolis-xref="">media</var> . <code data-anolis-xref="dom-TimeRanges-end"><a href="#dom-timeranges-end">end</a></code>(<var data-anolis-xref="">index</var>)</dt>

   <dd>

    <p>Returns the time for the end of the range with the given index.</p>

    <p>Throws an <code><a href="infrastructure.html#indexsizeerror">IndexSizeError</a></code> exception if the index is out of range.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-TimeRanges-length" id="dom-timeranges-length"><code>length</code></dfn> IDL attribute must return the
  number of ranges represented by the object.</p>

  <p>The <dfn data-anolis-xref="dom-TimeRanges-start" id="dom-timeranges-start"><code>start(<var data-anolis-xref="">index</var>)</code></dfn>
  method must return the position of the start of the <var data-anolis-xref="">index</var>th range represented
  by the object, in seconds measured from the start of the timeline that the object covers.</p>

  <p>The <dfn data-anolis-xref="dom-TimeRanges-end" id="dom-timeranges-end"><code>end(<var data-anolis-xref="">index</var>)</code></dfn> method
  must return the position of the end of the <var data-anolis-xref="">index</var>th range represented by the
  object, in seconds measured from the start of the timeline that the object covers.</p>

  <p>These methods must throw <code><a href="infrastructure.html#indexsizeerror">IndexSizeError</a></code> exceptions if called with an <var data-anolis-xref="">index</var> argument greater than or equal to the number of ranges represented by the
  object.</p>

  <p>When a <code><a href="#timeranges">TimeRanges</a></code> object is said to be a <dfn id="normalized-timeranges-object">normalized <code>TimeRanges</code>
  object</dfn>, the ranges it represents must obey the following criteria:</p>

  <ul><li>The start of a range must be greater than the end of all earlier ranges.</li>

   <li>The start of a range must be less than the end of that same range.</li>

  </ul><p>In other words, the ranges in such an object are ordered, don't overlap, aren't empty, and
  don't touch (adjacent ranges are folded into one bigger range).</p>

  <p>Ranges in a <code><a href="#timeranges">TimeRanges</a></code> object must be inclusive.</p>

  <p class="example">Thus, the end of a range would be equal to the start of a following adjacent
  (touching but not overlapping) range. Similarly, a range covering a whole timeline anchored at
  zero would have a start equal to zero and an end equal to the duration of the timeline.</p>

  <p>The timelines used by the objects returned by the <code data-anolis-xref="dom-media-buffered"><a href="#dom-media-buffered">buffered</a></code>, <code data-anolis-xref="dom-media-seekable"><a href="#dom-media-seekable">seekable</a></code> and
  <code data-anolis-xref="dom-media-played"><a href="#dom-media-played">played</a></code> IDL attributes of <a data-anolis-xref="media element" href="#media-element">media
  elements</a> must be that element's <a href="#media-timeline">media timeline</a>.</p>

  </div>


  <h5 id="event-definitions"><span class="secno">4.7.10.15 </span>Event definitions</h5>

  <pre class="idl">[Constructor(DOMString type, optional <a href="#trackeventinit">TrackEventInit</a> eventInitDict)]
interface <dfn id="trackevent">TrackEvent</dfn> : <a href="infrastructure.html#event">Event</a> {
  readonly attribute (<a href="#videotrack">VideoTrack</a> or <a href="#audiotrack">AudioTrack</a> or <a href="#texttrack">TextTrack</a>) <a data-anolis-xref="dom-TrackEvent-track" href="#dom-trackevent-track">track</a>;
};

dictionary <dfn id="trackeventinit">TrackEventInit</dfn> : <a href="infrastructure.html#eventinit">EventInit</a> {
  (<a href="#videotrack">VideoTrack</a> or <a href="#audiotrack">AudioTrack</a> or <a href="#texttrack">TextTrack</a>) track;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">event</var> . <code data-anolis-xref="dom-TrackEvent-track"><a href="#dom-trackevent-track">track</a></code></dt>

   <dd>

    <p>Returns the track object (<code><a href="#texttrack">TextTrack</a></code>, <code><a href="#audiotrack">AudioTrack</a></code>, or
    <code><a href="#videotrack">VideoTrack</a></code>) to which the event relates.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-TrackEvent-track" id="dom-trackevent-track"><code>track</code></dfn> attribute must return the value
  it was initialized to. When the object is created, this attribute must be initialized to null. It
  represents the context information for the event.</p>

  </div>



  <h5 id="mediaevents"><span class="secno">4.7.10.16 </span>Event summary</h5>

  <p><i>This section is non-normative.</i></p>
  <p>The following events fire on <a data-anolis-xref="media element" href="#media-element">media elements</a> as part of the
  processing model described above:</p>

  <table><thead><tr><th>Event name
     <th>Interface
     <th>Fired when...
     <th>Preconditions

   <tbody><tr><td><dfn data-anolis-xref="event-media-loadstart" id="event-media-loadstart"><code>loadstart</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The user agent begins looking for <a href="#media-data">media data</a>, as part of the <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection algorithm</a>.

     <td><code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> equals <code data-anolis-xref="dom-media-NETWORK_LOADING"><a href="#dom-media-network_loading">NETWORK_LOADING</a></code>

    <tr><td><dfn data-anolis-xref="event-media-progress" id="event-media-progress"><code>progress</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The user agent is fetching <a href="#media-data">media data</a>.

     <td><code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> equals <code data-anolis-xref="dom-media-NETWORK_LOADING"><a href="#dom-media-network_loading">NETWORK_LOADING</a></code>

    <tr><td><dfn data-anolis-xref="event-media-suspend" id="event-media-suspend"><code>suspend</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The user agent is intentionally not currently fetching <a href="#media-data">media data</a>.

     <td><code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> equals <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code>

    <tr><td><dfn data-anolis-xref="event-media-abort" id="event-media-abort"><code>abort</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The user agent stops fetching the <a href="#media-data">media data</a> before it is completely
     downloaded, but not due to an error.

     <td><code data-anolis-xref="dom-media-error"><a href="#dom-media-error">error</a></code> is an object with the code <code data-anolis-xref="dom-MediaError-MEDIA_ERR_ABORTED"><a href="#dom-mediaerror-media_err_aborted">MEDIA_ERR_ABORTED</a></code>. <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> equals either <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code> or <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code>, depending on when the download was aborted.

    <tr><td><dfn data-anolis-xref="event-media-error" id="event-media-error"><code>error</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>An error occurs while fetching the <a href="#media-data">media data</a>.

     <td><code data-anolis-xref="dom-media-error"><a href="#dom-media-error">error</a></code> is an object with the code <code data-anolis-xref="dom-MediaError-MEDIA_ERR_NETWORK"><a href="#dom-mediaerror-media_err_network">MEDIA_ERR_NETWORK</a></code> or higher. <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> equals either <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code> or <code data-anolis-xref="dom-media-NETWORK_IDLE"><a href="#dom-media-network_idle">NETWORK_IDLE</a></code>, depending on when the download was aborted.

    <tr><td><dfn data-anolis-xref="event-media-emptied" id="event-media-emptied"><code>emptied</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>A <a href="#media-element">media element</a> whose <code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code>
     was previously not in the <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code> state has
     just switched to that state (either because of a fatal error during load that's about to be
     reported, or because the <code data-anolis-xref="dom-media-load"><a href="#dom-media-load">load()</a></code> method was invoked while
     the <a data-anolis-xref="concept-media-load-algorithm" href="#concept-media-load-algorithm">resource selection algorithm</a> was already
     running).

     <td><code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> is <code data-anolis-xref="dom-media-NETWORK_EMPTY"><a href="#dom-media-network_empty">NETWORK_EMPTY</a></code>; all the IDL attributes are in their
     initial states.

    <tr><td><dfn data-anolis-xref="event-media-stalled" id="event-media-stalled"><code>stalled</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The user agent is trying to fetch <a href="#media-data">media data</a>, but data is unexpectedly not
     forthcoming.

     <td><code data-anolis-xref="dom-media-networkState"><a href="#dom-media-networkstate">networkState</a></code> is <code data-anolis-xref="dom-media-NETWORK_LOADING"><a href="#dom-media-network_loading">NETWORK_LOADING</a></code>.

   <tbody><tr><td><dfn data-anolis-xref="event-media-loadedmetadata" id="event-media-loadedmetadata"><code>loadedmetadata</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The user agent has just determined the duration and dimensions of the <a href="#media-resource">media
     resource</a> and <a href="#the-text-tracks-are-ready">the text tracks are ready</a>.

     <td><code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> is newly equal to <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> or greater for the first time.

    <tr><td><dfn data-anolis-xref="event-media-loadeddata" id="event-media-loadeddata"><code>loadeddata</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The user agent can render the <a href="#media-data">media data</a> at the <a href="#current-playback-position">current playback
     position</a> for the first time.

     <td><code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> newly increased to <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> or greater for the first time.

    <tr><td><dfn data-anolis-xref="event-media-canplay" id="event-media-canplay"><code>canplay</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The user agent can resume playback of the <a href="#media-data">media data</a>, but estimates that if
     playback were to be started now, the <a href="#media-resource">media resource</a> could not be rendered at the
     current playback rate up to its end without having to stop for further buffering of content.

     <td><code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> newly increased to <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> or greater.

    <tr><td><dfn data-anolis-xref="event-media-canplaythrough" id="event-media-canplaythrough"><code>canplaythrough</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The user agent estimates that if playback were to be started now, the <a href="#media-resource">media
     resource</a> could be rendered at the current playback rate all the way to its end without
     having to stop for further buffering.

     <td><code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> is newly equal to <code data-anolis-xref="dom-media-HAVE_ENOUGH_DATA"><a href="#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a></code>.

    <tr><td><dfn data-anolis-xref="event-media-playing" id="event-media-playing"><code>playing</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>Playback is ready to start after having been paused or delayed due to lack of <a href="#media-data">media
     data</a>.

     <td><code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> is newly equal to or greater than
     <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> and <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> is false, or <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> is newly false and <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> is equal to or greater than <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code>. Even if this event fires, the
     element might still not be <a href="#potentially-playing">potentially playing</a>, e.g. if the element is
     <a href="#blocked-on-its-media-controller">blocked on its media controller</a> (e.g. because the <a href="#current-media-controller">current media
     controller</a> is paused, or another <a data-anolis-xref="slaved media elements" href="#slaved-media-elements">slaved media
     element</a> is stalled somehow, or because the <a href="#media-resource">media resource</a> has no data
     corresponding to the <a href="#media-controller-position">media controller position</a>), or the element is <a href="#paused-for-user-interaction">paused
     for user interaction</a> or <a href="#paused-for-in-band-content">paused for in-band content</a>.

    <tr><td><dfn data-anolis-xref="event-media-waiting" id="event-media-waiting"><code>waiting</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>Playback has stopped because the next frame is not available, but the user agent expects
     that frame to become available in due course.

     <td><code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> is equal to or less than <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code>, and <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> is false. Either <code data-anolis-xref="dom-media-seeking"><a href="#dom-media-seeking">seeking</a></code> is true, or the <a href="#current-playback-position">current playback position</a>
     is not contained in any of the ranges in <code data-anolis-xref="dom-media-buffered"><a href="#dom-media-buffered">buffered</a></code>. It
     is possible for playback to stop for other reasons without <code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> being false, but those reasons do not fire this event
     (and when those situations resolve, a separate <code data-anolis-xref="event-media-playing"><a href="#event-media-playing">playing</a></code>
     event is not fired either): e.g. the element is newly <a href="#blocked-on-its-media-controller">blocked on its media
     controller</a>, or <a data-anolis-xref="ended playback" href="#ended-playback">playback ended</a>, or playback
     <a href="#stopped-due-to-errors">stopped due to errors</a>, or the element has <a href="#paused-for-user-interaction">paused for user interaction</a>
     or <a href="#paused-for-in-band-content">paused for in-band content</a>.

   <tbody><tr><td><dfn data-anolis-xref="event-media-seeking" id="event-media-seeking"><code>seeking</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <code data-anolis-xref="dom-media-seeking"><a href="#dom-media-seeking">seeking</a></code> IDL attribute changed to true, and the user agent has started seeking to a new position.

     <td>

    <tr><td><dfn data-anolis-xref="event-media-seeked" id="event-media-seeked"><code>seeked</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <code data-anolis-xref="dom-media-seeking"><a href="#dom-media-seeking">seeking</a></code> IDL attribute changed to false after the <a href="#current-playback-position">current playback position</a> was changed.

     <td>

    <tr><td><dfn data-anolis-xref="event-media-ended" id="event-media-ended"><code>ended</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>Playback has stopped because the end of the <a href="#media-resource">media resource</a> was reached.

     <td><code data-anolis-xref="dom-media-currentTime"><a href="#dom-media-currenttime">currentTime</a></code> equals the end of the <a href="#media-resource">media
     resource</a>; <code data-anolis-xref="dom-media-ended"><a href="#dom-media-ended">ended</a></code> is true.

   <tbody><tr><td><dfn data-anolis-xref="event-media-durationchange" id="event-media-durationchange"><code>durationchange</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <code data-anolis-xref="dom-media-duration"><a href="#dom-media-duration">duration</a></code> attribute has just been updated.

     <td>

    <tr><td><dfn data-anolis-xref="event-media-timeupdate" id="event-media-timeupdate"><code>timeupdate</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <a href="#current-playback-position">current playback position</a> changed as part of normal playback or in an especially interesting way, for example discontinuously.

     <td>

    <tr><td><dfn data-anolis-xref="event-media-play" id="event-media-play"><code>play</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The element is no longer paused. Fired after the <code data-anolis-xref="dom-media-play"><a href="#dom-media-play">play()</a></code>
     method has returned, or when the <code data-anolis-xref="attr-media-autoplay"><a href="#attr-media-autoplay">autoplay</a></code> attribute
     has caused playback to begin.

     <td><code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> is newly false.

    <tr><td><dfn data-anolis-xref="event-media-pause" id="event-media-pause"><code>pause</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The element has been paused. Fired after the <code data-anolis-xref="dom-media-pause"><a href="#dom-media-pause">pause()</a></code>
     method has returned.

     <td><code data-anolis-xref="dom-media-paused"><a href="#dom-media-paused">paused</a></code> is newly true.

    <tr><td><dfn data-anolis-xref="event-media-ratechange" id="event-media-ratechange"><code>ratechange</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>Either the <code data-anolis-xref="dom-media-defaultPlaybackRate"><a href="#dom-media-defaultplaybackrate">defaultPlaybackRate</a></code> or the
     <code data-anolis-xref="dom-media-playbackRate"><a href="#dom-media-playbackrate">playbackRate</a></code> attribute has just been updated.

     <td>

   <tbody><tr><td><dfn data-anolis-xref="event-media-resize" id="event-media-resize"><code>resize</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>One or both of the <code data-anolis-xref="dom-video-videoWidth"><a href="#dom-video-videowidth">videoWidth</a></code> and <code data-anolis-xref="dom-video-videoHeight"><a href="#dom-video-videoheight">videoHeight</a></code> attributes have just been updated.

     <td><a href="#media-element">Media element</a> is a <code><a href="#the-video-element">video</a></code> element; <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> is not <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code>

    <tr><td><dfn data-anolis-xref="event-media-volumechange" id="event-media-volumechange"><code>volumechange</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>Either the <code data-anolis-xref="dom-media-volume"><a href="#dom-media-volume">volume</a></code> attribute or the <code data-anolis-xref="dom-media-muted"><a href="#dom-media-muted">muted</a></code> attribute has changed. Fired after the relevant
     attribute's setter has returned.

     <td>

  </table><p>The following events fire on <code><a href="#mediacontroller">MediaController</a></code> objects:</p>

  <table><thead><tr><th>Event name

     <th>Interface

     <th>Fired when...

   <tbody><tr><td><dfn data-anolis-xref="event-MediaController-emptied" id="event-mediacontroller-emptied"><code>emptied</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>All the <a href="#slaved-media-elements">slaved media elements</a> newly have <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> set to <code data-anolis-xref="dom-media-HAVE_NOTHING"><a href="#dom-media-have_nothing">HAVE_NOTHING</a></code> or greater, or there are no longer any
     <a href="#slaved-media-elements">slaved media elements</a>.

    <tr><td><dfn data-anolis-xref="event-MediaController-loadedmetadata" id="event-mediacontroller-loadedmetadata"><code>loadedmetadata</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>All the <a href="#slaved-media-elements">slaved media elements</a> newly have <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> set to <code data-anolis-xref="dom-media-HAVE_METADATA"><a href="#dom-media-have_metadata">HAVE_METADATA</a></code> or greater.

    <tr><td><dfn data-anolis-xref="event-MediaController-loadeddata" id="event-mediacontroller-loadeddata"><code>loadeddata</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>All the <a href="#slaved-media-elements">slaved media elements</a> newly have <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> set to <code data-anolis-xref="dom-media-HAVE_CURRENT_DATA"><a href="#dom-media-have_current_data">HAVE_CURRENT_DATA</a></code> or greater.

    <tr><td><dfn data-anolis-xref="event-MediaController-canplay" id="event-mediacontroller-canplay"><code>canplay</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>All the <a href="#slaved-media-elements">slaved media elements</a> newly have <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> set to <code data-anolis-xref="dom-media-HAVE_FUTURE_DATA"><a href="#dom-media-have_future_data">HAVE_FUTURE_DATA</a></code> or greater.

    <tr><td><dfn data-anolis-xref="event-MediaController-canplaythrough" id="event-mediacontroller-canplaythrough"><code>canplaythrough</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>All the <a href="#slaved-media-elements">slaved media elements</a> newly have <code data-anolis-xref="dom-media-readyState"><a href="#dom-media-readystate">readyState</a></code> set to <code data-anolis-xref="dom-media-HAVE_ENOUGH_DATA"><a href="#dom-media-have_enough_data">HAVE_ENOUGH_DATA</a></code> or greater.

    <tr><td><dfn data-anolis-xref="event-MediaController-playing" id="event-mediacontroller-playing"><code>playing</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <code><a href="#mediacontroller">MediaController</a></code> is no longer a <a href="#blocked-media-controller">blocked media controller</a>.

    <tr><td><dfn data-anolis-xref="event-MediaController-ended" id="event-mediacontroller-ended"><code>ended</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <code><a href="#mediacontroller">MediaController</a></code> has reached the end of all the <a href="#slaved-media-elements">slaved media
     elements</a>.

    <tr><td><dfn data-anolis-xref="event-MediaController-waiting" id="event-mediacontroller-waiting"><code>waiting</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <code><a href="#mediacontroller">MediaController</a></code> is now a <a href="#blocked-media-controller">blocked media controller</a>.

    <tr><td><dfn data-anolis-xref="event-MediaContcoller-ended" id="event-mediacontcoller-ended"><code>ended</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>All the <a href="#slaved-media-elements">slaved media elements</a> have newly <a href="#ended-playback">ended playback</a>.

   <tbody><tr><td><dfn data-anolis-xref="event-MediaController-durationchange" id="event-mediacontroller-durationchange"><code>durationchange</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <code data-anolis-xref="dom-MediaController-duration"><a href="#dom-mediacontroller-duration">duration</a></code> attribute has just been
     updated.

    <tr><td><dfn data-anolis-xref="event-MediaController-timeupdate" id="event-mediacontroller-timeupdate"><code>timeupdate</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <a href="#media-controller-position">media controller position</a> changed.

    <tr><td><dfn data-anolis-xref="event-MediaController-play" id="event-mediacontroller-play"><code>play</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <code data-anolis-xref="dom-MediaController-paused"><a href="#dom-mediacontroller-paused">paused</a></code> attribute is newly false.

    <tr><td><dfn data-anolis-xref="event-MediaController-pause" id="event-mediacontroller-pause"><code>pause</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>The <code data-anolis-xref="dom-MediaController-paused"><a href="#dom-mediacontroller-paused">paused</a></code> attribute is newly true.

    <tr><td><dfn data-anolis-xref="event-MediaController-ratechange" id="event-mediacontroller-ratechange"><code>ratechange</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>Either the <code data-anolis-xref="dom-MediaController-defaultPlaybackRate"><a href="#dom-mediacontroller-defaultplaybackrate">defaultPlaybackRate</a></code>
     attribute or the <code data-anolis-xref="dom-MediaController-playbackRate"><a href="#dom-mediacontroller-playbackrate">playbackRate</a></code> attribute
     has just been updated.

    <tr><td><dfn data-anolis-xref="event-MediaController-volumechange" id="event-mediacontroller-volumechange"><code>volumechange</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>Either the <code data-anolis-xref="dom-MediaController-volume"><a href="#dom-mediacontroller-volume">volume</a></code> attribute or the <code data-anolis-xref="dom-MediaController-muted"><a href="#dom-mediacontroller-muted">muted</a></code> attribute has just been updated.

  </table><p>The following events fire on <code><a href="#audiotracklist">AudioTrackList</a></code>, <code><a href="#videotracklist">VideoTrackList</a></code>, and
  <code><a href="#texttracklist">TextTrackList</a></code> objects:</p>

  <table><thead><tr><th>Event name

     <th>Interface

     <th>Fired when...

   <tbody><tr><td><dfn data-anolis-xref="event-media-change" id="event-media-change"><code>change</code></dfn>

     <td><code><a href="infrastructure.html#event">Event</a></code>

     <td>One or more tracks in the track list has been enabled or disabled.

    <tr><td><dfn data-anolis-xref="event-media-addtrack" id="event-media-addtrack"><code>addtrack</code></dfn>

     <td><code><a href="#trackevent">TrackEvent</a></code>

     <td>A track has been added to the track list.

    <tr><td><dfn data-anolis-xref="event-media-removetrack" id="event-media-removetrack"><code>removetrack</code></dfn>

     <td><code><a href="#trackevent">TrackEvent</a></code>

     <td>A track has been removed from the track list.

  </table><!--ADD-TOPIC:Security--><div class="impl">

  <h5 id="security-and-privacy-considerations"><span class="secno">4.7.10.17 </span>Security and privacy considerations</h5>

  <p>The main security and privacy implications of the <code><a href="#the-video-element">video</a></code> and <code><a href="#the-audio-element">audio</a></code>
  elements come from the ability to embed media cross-origin. There are two directions that threats
  can flow: from hostile content to a victim page, and from a hostile page to victim content.</p>

  <hr><p>If a victim page embeds hostile content, the threat is that the content might contain scripted
  code that attempts to interact with the <code><a href="dom.html#document">Document</a></code> that embeds the content. To avoid
  this, user agents must ensure that there is no access from the content to the embedding page. In
  the case of media content that uses DOM concepts, the embedded content must be treated as if it
  was in its own unrelated <a href="browsers.html#top-level-browsing-context">top-level browsing context</a>.</p>

  <p class="example">For instance, if an SVG animation was embedded in a <code><a href="#the-video-element">video</a></code> element,
  the user agent would not give it access to the DOM of the outer page. From the perspective of
  scripts in the SVG resource, the SVG file would appear to be in a lone top-level browsing context
  with no parent.</p>

  <hr><p>If a hostile page embeds victim content, the threat is that the embedding page could obtain
  information from the content that it would not otherwise have access to. The API does expose some
  information: the existence of the media, its type, its duration, its size, and the performance
  characteristics of its host. Such information is already potentially problematic, but in practice
  the same information can more or less be obtained using the <code><a href="#the-img-element">img</a></code> element, and so it
  has been deemed acceptable.</p>

  <p>However, significantly more sensitive information could be obtained if the user agent further
  exposes metadata within the content such as subtitles or chapter titles. Such information is
  therefore only exposed if the video resource passes a CORS <a href="infrastructure.html#resource-sharing-check">resource sharing check</a>.
  The <code data-anolis-xref="attr-media-crossorigin"><a href="#attr-media-crossorigin">crossorigin</a></code> attribute allows authors to control
  how this check is performed. <a href="references.html#refsCORS">[CORS]</a></p>

  <p class="example">Without this restriction, an attacker could trick a user running within a
  corporate network into visiting a site that attempts to load a video from a previously leaked
  location on the corporation's intranet. If such a video included confidential plans for a new
  product, then being able to read the subtitles would present a serious confidentiality breach.</p>

  </div>
<!--REMOVE-TOPIC:Security-->


  <h5 id="best-practices-for-authors-using-media-elements"><span class="secno">4.7.10.18 </span>Best practices for authors using media elements</h5>

  <p><i>This section is non-normative.</i></p>
  <p>Playing audio and video resources on small devices such as set-top boxes or mobile phones is
  often constrained by limited hardware resources in the device. For example, a device might only
  support three simultaneous videos. For this reason, it is a good practice to release resources
  held by <a data-anolis-xref="media element" href="#media-element">media elements</a> when they are done playing, either by
  being very careful about removing all references to the element and allowing it to be garbage
  collected, or, even better, by removing the element's <code data-anolis-xref="attr-media-src"><a href="#attr-media-src">src</a></code>
  attribute and any <code><a href="#the-source-element">source</a></code> element descendants, and invoking the element's <code data-anolis-xref="dom-media-load"><a href="#dom-media-load">load()</a></code> method.</p>

  <p>Similarly, when the playback rate is not exactly 1.0, hardware, software, or format limitations
  can cause video frames to be dropped and audio to be choppy or muted.</p>


  <div class="impl">

  <h5 id="best-practices-for-implementors-of-media-elements"><span class="secno">4.7.10.19 </span>Best practices for implementors of media elements</h5>

  <p><i>This section is non-normative.</i></p>
  <p>How accurately various aspects of the <a href="#media-element">media element</a> API are implemented is
  considered a quality-of-implementation issue.</p>

  <p>For example, when implementing the <code data-anolis-xref="attr-media-buffered">buffered</code> attribute,
  how precise an implementation reports the ranges that have been buffered depends on how carefully
  the user agent inspects the data. Since the API reports ranges as times, but the data is obtained
  in byte streams, a user agent receiving a variable-bit-rate stream might only be able to determine
  precise times by actually decoding all of the data. User agents aren't required to do this,
  however; they can instead return estimates (e.g. based on the average bit rate seen so far) which
  get revised as more information becomes available.</p>

  <p>As a general rule, user agents are urged to be conservative rather than optimistic. For
  example, it would be bad to report that everything had been buffered when it had not.</p>

  <p>Another quality-of-implementation issue would be playing a video backwards when the codec is
  designed only for forward playback (e.g. there aren't many key frames, and they are far apart, and
  the intervening frames only have deltas from the previous frame). User agents could do a poor job,
  e.g. only showing key frames; however, better implementations would do more work and thus do a
  better job, e.g. actually decoding parts of the video forwards, storing the complete frames, and
  then playing the frames backwards.</p>

  <p>Similarly, while implementations are allowed to drop buffered data at any time (there is no
  requirement that a user agent keep all the media data obtained for the lifetime of the media
  element), it is again a quality of implementation issue: user agents with sufficient resources to
  keep all the data around are encouraged to do so, as this allows for a better user experience. For
  example, if the user is watching a live stream, a user agent could allow the user only to view the
  live video; however, a better user agent would buffer everything and allow the user to seek
  through the earlier material, pause it, play it forwards and backwards, etc.</p>

  <p>When multiple tracks are synchronised with a <code><a href="#mediacontroller">MediaController</a></code>, it is possible for
  scripts to add and remove media elements from the <code><a href="#mediacontroller">MediaController</a></code>'s list of
  <a href="#slaved-media-elements">slaved media elements</a>, even while these tracks are playing. How smoothly the media
  plays back in such situations is another quality-of-implementation issue.</p>

  <hr><p>When a <a href="#media-element">media element</a> that is paused is <a data-anolis-xref="remove an element from a
  document" href="infrastructure.html#remove-an-element-from-a-document">removed from a document</a> and not reinserted before the next time the <a href="webappapis.html#event-loop">event
  loop</a> spins, implementations that are resource constrained are encouraged to take that
  opportunity to release all hardware resources (like video planes, networking resources, and data
  buffers) used by the <a href="#media-element">media element</a>. (User agents still have to keep track of the
  playback position and so forth, though, in case playback is later restarted.)</p>

  </div>


  <h4 id="the-map-element"><span class="secno">4.7.11 </span>The <dfn><code>map</code></dfn> element</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd><a href="dom.html#flow-content-1">Flow content</a>.</dd>
   <dd><a href="dom.html#phrasing-content-1">Phrasing content</a>.</dd>
   <dd><a href="dom.html#palpable-content-0">Palpable content</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>Where <a href="dom.html#phrasing-content-1">phrasing content</a> is expected.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd><a href="dom.html#transparent">Transparent</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
   <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-map-name"><a href="#attr-map-name">name</a></code> - Name of <a href="#image-map">image map</a> to reference from the <code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> attribute</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">Tag omission in text/html</span>:</dt>
   <dd>Neither tag is omissible</dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd>None</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">interface <dfn id="htmlmapelement">HTMLMapElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a data-anolis-xref="dom-map-name" href="#dom-map-name">name</a>;
  readonly attribute <a href="infrastructure.html#htmlcollection">HTMLCollection</a> <a data-anolis-xref="dom-map-areas" href="#dom-map-areas">areas</a>;
  readonly attribute <a href="infrastructure.html#htmlcollection">HTMLCollection</a> <a data-anolis-xref="dom-map-images" href="#dom-map-images">images</a>;
};</pre>
   </dd>
  </dl><!--TOPIC:HTML--><p>The <code><a href="#the-map-element">map</a></code> element, in conjunction with an <code><a href="#the-img-element">img</a></code> element and any
  <code><a href="#the-area-element">area</a></code> element descendants, defines an <a href="#image-map">image map</a>. The element
  <a href="dom.html#represents">represents</a> its children.</p>

  <p>The <dfn data-anolis-xref="attr-map-name" id="attr-map-name"><code>name</code></dfn> attribute gives the map a name so that
  it can be referenced. The attribute must be present and must have a non-empty value with no <a data-anolis-xref="space character" href="infrastructure.html#space-character">space characters</a>. The value of the <code data-anolis-xref="attr-map-name"><a href="#attr-map-name">name</a></code> attribute must not be a <a data-anolis-xref="compatibility
  caseless" href="infrastructure.html#compatibility-caseless">compatibility-caseless</a> match for the value of the <code data-anolis-xref="attr-map-name"><a href="#attr-map-name">name</a></code> attribute of another <code><a href="#the-map-element">map</a></code> element in the same
  document. If the <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> attribute is also specified, both attributes must
  have the same value.</p>

<!--TOPIC:DOM APIs-->
  <dl class="domintro"><dt><var data-anolis-xref="">map</var> . <code data-anolis-xref="dom-map-areas"><a href="#dom-map-areas">areas</a></code></dt>

   <dd>

    <p>Returns an <code><a href="infrastructure.html#htmlcollection">HTMLCollection</a></code> of the <code><a href="#the-area-element">area</a></code> elements in the
    <code><a href="#the-map-element">map</a></code>.</p>

   </dd>

   <dt><var data-anolis-xref="">map</var> . <code data-anolis-xref="dom-map-images"><a href="#dom-map-images">images</a></code></dt>

   <dd>

    <p>Returns an <code><a href="infrastructure.html#htmlcollection">HTMLCollection</a></code> of the <code><a href="#the-img-element">img</a></code> and <code><a href="#the-object-element">object</a></code>
    elements that use the <code><a href="#the-map-element">map</a></code>.</p>

   </dd>

  </dl><div class="impl">

  <p>The <dfn data-anolis-xref="dom-map-areas" id="dom-map-areas"><code>areas</code></dfn> attribute must return an
  <code><a href="infrastructure.html#htmlcollection">HTMLCollection</a></code> rooted at the <code><a href="#the-map-element">map</a></code> element, whose filter matches only
  <code><a href="#the-area-element">area</a></code> elements.</p>

  <p>The <dfn data-anolis-xref="dom-map-images" id="dom-map-images"><code>images</code></dfn> attribute must return an
  <code><a href="infrastructure.html#htmlcollection">HTMLCollection</a></code> rooted at the <code><a href="dom.html#document">Document</a></code> node, whose filter matches only
  <code><a href="#the-img-element">img</a></code> and <code><a href="#the-object-element">object</a></code> elements that are associated with this <code><a href="#the-map-element">map</a></code>
  element according to the <a href="#image-map">image map</a> processing model.</p>

  <p>The IDL attribute <dfn data-anolis-xref="dom-map-name" id="dom-map-name"><code>name</code></dfn> must <a href="infrastructure.html#reflect">reflect</a>
  the content attribute of the same name.</p>

  </div>
<!--TOPIC:HTML-->

  <div class="example">

   <p>Image maps can be defined in conjunction with other content on the page, to ease maintenance.
   This example is of a page with an image map at the top of the page and a corresponding set of
   text links at the bottom.</p>

   <pre>&lt;!DOCTYPE HTML&gt;
&lt;TITLE&gt;Babies™: Toys&lt;/TITLE&gt;
&lt;HEADER&gt;
 &lt;H1&gt;Toys&lt;/H1&gt;
 &lt;IMG SRC="/images/menu.gif"
      ALT="Babies™ navigation menu. Select a department to go to its page."
      USEMAP="#NAV"&gt;
&lt;/HEADER&gt;
 ...
&lt;FOOTER&gt;
 &lt;MAP NAME="NAV"&gt;
  &lt;P&gt;
   &lt;A HREF="/clothes/"&gt;Clothes&lt;/A&gt;
   &lt;AREA ALT="Clothes" COORDS="0,0,100,50" HREF="/clothes/"&gt; |
   &lt;A HREF="/toys/"&gt;Toys&lt;/A&gt;
   &lt;AREA ALT="Toys" COORDS="0,0,100,50" HREF="/toys/"&gt; |
   &lt;A HREF="/food/"&gt;Food&lt;/A&gt;
   &lt;AREA ALT="Food" COORDS="0,0,100,50" HREF="/food/"&gt; |
   &lt;A HREF="/books/"&gt;Books&lt;/A&gt;
   &lt;AREA ALT="Books" COORDS="0,0,100,50" HREF="/books/"&gt;
 &lt;/MAP&gt;
&lt;/FOOTER&gt;</pre>

  </div>



  <h4 id="the-area-element"><span class="secno">4.7.12 </span>The <dfn><code>area</code></dfn> element</h4>

  <dl class="element"><dt><a data-anolis-xref="element-dfn-categories" href="dom.html#element-dfn-categories">Categories</a>:</dt>
   <dd><a href="dom.html#flow-content-1">Flow content</a>.</dd>
   <dd><a href="dom.html#phrasing-content-1">Phrasing content</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-contexts" href="dom.html#element-dfn-contexts">Contexts in which this element can be used</a>:</dt>
   <dd>Where <a href="dom.html#phrasing-content-1">phrasing content</a> is expected, but only if there is a <code><a href="#the-map-element">map</a></code> element ancestor or a <code><a href="scripting-1.html#the-template-element">template</a></code> element ancestor.</dd>
   <dt><a data-anolis-xref="element-dfn-content-model" href="dom.html#element-dfn-content-model">Content model</a>:</dt>
   <dd>Empty.</dd>
   <dt><a data-anolis-xref="element-dfn-attributes" href="dom.html#element-dfn-attributes">Content attributes</a>:</dt>
   <dd><a href="dom.html#global-attributes">Global attributes</a></dd>
   <dd><code data-anolis-xref="attr-area-alt"><a href="#attr-area-alt">alt</a></code> - Replacement text for use when images are not available</dd>
   <dd><code data-anolis-xref="attr-area-coords"><a href="#attr-area-coords">coords</a></code> - Coordinates for the shape to be created in an <a href="#image-map">image map</a></dd>
   <dd><code data-anolis-xref="attr-hyperlink-download"><a href="links.html#attr-hyperlink-download">download</a></code> - Whether to download the resource instead of navigating to it, and its file name if so</dd>
   <dd><code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> - Address of the <a href="links.html#hyperlink">hyperlink</a></dd>
   <dd><code data-anolis-xref="attr-hyperlink-hreflang"><a href="links.html#attr-hyperlink-hreflang">hreflang</a></code> -  Language of the linked resource</dd>
<!--PING-->
   <dd><code data-anolis-xref="attr-hyperlink-rel"><a href="links.html#attr-hyperlink-rel">rel</a></code> Relationship between the document containing the hyperlink and the destination resource</dd>
   <dd><code data-anolis-xref="attr-area-shape"><a href="#attr-area-shape">shape</a></code> - The kind of shape to be created in an <a href="#image-map">image map</a></dd>
   <dd><code data-anolis-xref="attr-hyperlink-target"><a href="links.html#attr-hyperlink-target">target</a></code> - <a href="browsers.html#browsing-context">Browsing context</a> for <a href="links.html#hyperlink">hyperlink</a> <a data-anolis-xref="navigate" href="browsers.html#navigate">navigation</a></dd>
   <dd><code data-anolis-xref="attr-hyperlink-type"><a href="links.html#attr-hyperlink-type">type</a></code> - Hint for the type of the referenced resource</dd>
   <dt><span data-anolis-xref="concept-element-tag-omission">Tag omission in text/html</span>:</dt>
   <dd>No <a data-anolis-xref="syntax-end-tag" href="syntax.html#syntax-end-tag">end tag</a></dd>
   <dt>Allowed <a href="dom.html#aria-role-attribute">ARIA role attribute</a> values:</dt>
   <dd><a href="dom.html#index-aria-link"><code title="">link</code></a> role (default - <a href="dom.html#aria-usage-note"><em>do not set</em></a>).</dd>
   <dt>Allowed <a href="dom.html#state-and-property-attributes">ARIA state and property attributes</a>:</dt>
   <dd><a href="dom.html#index-aria-global">Global aria-* attributes</a></dd>
   <dd>Any <code title="">aria-*</code> attributes 
   <a href="dom.html#allowed-aria-roles,-states-and-properties">applicable to the allowed roles</a>.</dd>
   <dt><a data-anolis-xref="element-dfn-dom" href="dom.html#element-dfn-dom">DOM interface</a>:</dt><!--TOPIC:DOM APIs-->
   <dd>
<pre class="idl">interface <dfn id="htmlareaelement">HTMLAreaElement</dfn> : <a href="dom.html#htmlelement">HTMLElement</a> {
           attribute DOMString <a data-anolis-xref="dom-area-alt" href="#dom-area-alt">alt</a>;
           attribute DOMString <a data-anolis-xref="dom-area-coords" href="#dom-area-coords">coords</a>;
           attribute DOMString <a data-anolis-xref="dom-area-shape" href="#dom-area-shape">shape</a>;
           attribute DOMString <a data-anolis-xref="dom-area-target" href="#dom-area-target">target</a>;
           attribute DOMString <a data-anolis-xref="dom-area-download" href="#dom-area-download">download</a>;
<!--PING-->
           attribute DOMString <a data-anolis-xref="dom-area-rel" href="#dom-area-rel">rel</a>;
  readonly attribute <a href="infrastructure.html#domtokenlist">DOMTokenList</a> <a data-anolis-xref="dom-area-relList" href="#dom-area-rellist">relList</a>;
           attribute DOMString <a data-anolis-xref="dom-area-hreflang" href="#dom-area-hreflang">hreflang</a>;
           attribute DOMString <a data-anolis-xref="dom-area-type" href="#dom-area-type">type</a>;
};
<a href="#htmlareaelement">HTMLAreaElement</a> implements <a href="infrastructure.html#urlutils">URLUtils</a>;</pre>
   </dd>
  </dl><!--TOPIC:HTML--><p>The <code><a href="#the-area-element">area</a></code> element <a href="dom.html#represents">represents</a> either a hyperlink with some text and a
  corresponding area on an <a href="#image-map">image map</a>, or a dead area on an image map.</p>

  <p>An <code><a href="#the-area-element">area</a></code> element with a parent node must have a <code><a href="#the-map-element">map</a></code> element ancestor
  or a <code><a href="scripting-1.html#the-template-element">template</a></code> element ancestor.</p>

  <p>If the <code><a href="#the-area-element">area</a></code> element has an <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code>
  attribute, then the <code><a href="#the-area-element">area</a></code> element represents a <a href="links.html#hyperlink">hyperlink</a>. In this case,
  the <dfn data-anolis-xref="attr-area-alt" id="attr-area-alt"><code>alt</code></dfn> attribute must be present. It specifies the
  text of the hyperlink. Its value must be text that, when presented with the texts specified for
  the other hyperlinks of the <a href="#image-map">image map</a>, and with the alternative text of the image,
  but without the image itself, provides the user with the same kind of choice as the hyperlink
  would when used without its text but with its shape applied to the image. The <code data-anolis-xref="attr-area-alt"><a href="#attr-area-alt">alt</a></code> attribute may be left blank if there is another <code><a href="#the-area-element">area</a></code>
  element in the same <a href="#image-map">image map</a> that points to the same resource and has a non-blank
  <code data-anolis-xref="attr-area-alt"><a href="#attr-area-alt">alt</a></code> attribute.</p>

  <p>If the <code><a href="#the-area-element">area</a></code> element has no <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code>
  attribute, then the area represented by the element cannot be selected, and the <code data-anolis-xref="attr-area-alt"><a href="#attr-area-alt">alt</a></code> attribute must be omitted.</p>

  <p>In both cases, the <code data-anolis-xref="attr-area-shape"><a href="#attr-area-shape">shape</a></code> and <code data-anolis-xref="attr-area-coords"><a href="#attr-area-coords">coords</a></code> attributes specify the area.</p>

  <p>The <dfn data-anolis-xref="attr-area-shape" id="attr-area-shape"><code>shape</code></dfn> attribute is an <a href="infrastructure.html#enumerated-attribute">enumerated
  attribute</a>. The following table lists the keywords defined for this attribute. The states
  given in the first cell of the rows with keywords give the states to which those keywords map.
  <span class="impl">Some of the keywords are non-conforming, as noted in the last
  column.</span></p>

  <table><thead><tr><th>State
     <th>Keywords
     <th class="impl">Notes
   <tbody><tr><td rowspan="2"><a data-anolis-xref="attr-area-shape-circle" href="#attr-area-shape-circle">Circle state</a>
     <td><dfn data-anolis-xref="attr-area-shape-keyword-circle" id="attr-area-shape-keyword-circle"><code>circle</code></dfn>
     <td class="impl">
    <tr><td class="impl"><dfn data-anolis-xref="attr-area-shape-keyword-circ" id="attr-area-shape-keyword-circ"><code>circ</code></dfn>
     <td class="impl">Non-conforming
    <tr><td><a data-anolis-xref="attr-area-shape-default" href="#attr-area-shape-default">Default state</a>
     <td><dfn data-anolis-xref="attr-area-shape-keyword-default" id="attr-area-shape-keyword-default"><code>default</code></dfn>
     <td class="impl">
    <tr><td rowspan="2"><a data-anolis-xref="attr-area-shape-poly" href="#attr-area-shape-poly">Polygon state</a>
     <td><dfn data-anolis-xref="attr-area-shape-keyword-poly" id="attr-area-shape-keyword-poly"><code>poly</code></dfn>
     <td class="impl">
    <tr><td class="impl"><dfn data-anolis-xref="attr-area-shape-keyword-polygon" id="attr-area-shape-keyword-polygon"><code>polygon</code></dfn>
     <td class="impl">Non-conforming
    <tr><td rowspan="2"><a data-anolis-xref="attr-area-shape-rect" href="#attr-area-shape-rect">Rectangle state</a>
     <td><dfn data-anolis-xref="attr-area-shape-keyword-rect" id="attr-area-shape-keyword-rect"><code>rect</code></dfn>
     <td class="impl">
    <tr><td class="impl"><dfn data-anolis-xref="attr-area-shape-keyword-rectangle" id="attr-area-shape-keyword-rectangle"><code>rectangle</code></dfn>
     <td class="impl">Non-conforming
  </table><p>The attribute may be omitted. The <i>missing value default</i> is the <a data-anolis-xref="attr-area-shape-rect" href="#attr-area-shape-rect">rectangle</a> state.</p>

  <p>The <dfn data-anolis-xref="attr-area-coords" id="attr-area-coords"><code>coords</code></dfn> attribute must, if specified,
  contain a <a href="infrastructure.html#valid-list-of-integers">valid list of integers</a>. This attribute gives the coordinates for the shape
  described by the <code data-anolis-xref="attr-area-shape"><a href="#attr-area-shape">shape</a></code> attribute. <span class="impl">The
  processing for this attribute is described as part of the <a href="#image-map">image map</a> processing
  model.</span></p>

  <!-- v2: It was suggested by John S. Urban that coords should support percentages as well as
  pixels, so that one could use the same image map for images of various sizes. -->

  <p>In the <dfn data-anolis-xref="attr-area-shape-circle" id="attr-area-shape-circle">circle state</dfn>, <code><a href="#the-area-element">area</a></code> elements must
  have a <code data-anolis-xref="attr-area-coords"><a href="#attr-area-coords">coords</a></code> attribute present, with three integers, the
  last of which must be non-negative. The first integer must be the distance in CSS pixels from the
  left edge of the image to the center of the circle, the second integer must be the distance in CSS
  pixels from the top edge of the image to the center of the circle, and the third integer must be
  the radius of the circle, again in CSS pixels.</p>

  <p>In the <dfn data-anolis-xref="attr-area-shape-default" id="attr-area-shape-default">default state</dfn> state, <code><a href="#the-area-element">area</a></code>
  elements must not have a <code data-anolis-xref="attr-area-coords"><a href="#attr-area-coords">coords</a></code> attribute. (The area is the
  whole image.)</p>

  <p>In the <dfn data-anolis-xref="attr-area-shape-poly" id="attr-area-shape-poly">polygon state</dfn>, <code><a href="#the-area-element">area</a></code> elements must
  have a <code data-anolis-xref="attr-area-coords"><a href="#attr-area-coords">coords</a></code> attribute with at least six integers, and the
  number of integers must be even. Each pair of integers must represent a coordinate given as the
  distances from the left and the top of the image in CSS pixels respectively, and all the
  coordinates together must represent the points of the polygon, in order.</p>

  <p>In the <dfn data-anolis-xref="attr-area-shape-rect" id="attr-area-shape-rect">rectangle state</dfn>, <code><a href="#the-area-element">area</a></code> elements must
  have a <code data-anolis-xref="attr-area-coords"><a href="#attr-area-coords">coords</a></code> attribute with exactly four integers, the
  first of which must be less than the third, and the second of which must be less than the fourth.
  The four points must represent, respectively, the distance from the left edge of the image to the
  left side of the rectangle, the distance from the top edge to the top side, the distance from the
  left edge to the right side, and the distance from the top edge to the bottom side, all in CSS
  pixels.</p>

  <div class="impl">

  <p>When user agents allow users to <a data-anolis-xref="following hyperlinks" href="links.html#following-hyperlinks">follow hyperlinks</a> or
  <a data-anolis-xref="downloading hyperlinks" href="links.html#downloading-hyperlinks">download hyperlinks</a> created using the
  <code><a href="#the-area-element">area</a></code> element, as described in the next section, the <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code>, <code data-anolis-xref="attr-hyperlink-target"><a href="links.html#attr-hyperlink-target">target</a></code>,
  <code data-anolis-xref="attr-hyperlink-download"><a href="links.html#attr-hyperlink-download">download</a></code>, and
<!--PING-->
  attributes decide how the link is followed. The <code data-anolis-xref="attr-hyperlink-rel"><a href="links.html#attr-hyperlink-rel">rel</a></code>, <code data-anolis-xref="attr-hyperlink-hreflang"><a href="links.html#attr-hyperlink-hreflang">hreflang</a></code>, and <code data-anolis-xref="attr-hyperlink-type"><a href="links.html#attr-hyperlink-type">type</a></code>
  attributes may be used to indicate to the user the likely nature of the target resource before the
  user follows the link.</p>

  </div>

  <p>The <code data-anolis-xref="attr-hyperlink-target"><a href="links.html#attr-hyperlink-target">target</a></code>,
    <code data-anolis-xref="attr-hyperlink-download"><a href="links.html#attr-hyperlink-download">download</a></code>, 
<!--PING-->
  <code data-anolis-xref="attr-hyperlink-rel"><a href="links.html#attr-hyperlink-rel">rel</a></code>, <code data-anolis-xref="attr-hyperlink-hreflang"><a href="links.html#attr-hyperlink-hreflang">hreflang</a></code>, and <code data-anolis-xref="attr-hyperlink-type"><a href="links.html#attr-hyperlink-type">type</a></code>
  attributes must be omitted if the <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> attribute is not
  present.</p>

  <div class="impl">

  <p>The <a href="dom.html#activation-behavior">activation behavior</a> of <code><a href="#the-area-element">area</a></code> elements is to run the following
  steps:</p>

  <ol><!-- c.f. <a>'s similar section --><li><p>If the <code><a href="#the-area-element">area</a></code> element's <code><a href="dom.html#document">Document</a></code> is not <a href="browsers.html#fully-active">fully active</a>,
   then abort these steps.</li>

   <li>

    <p>If the <code><a href="#the-area-element">area</a></code> element has a <code data-anolis-xref="attr-hyperlink-download"><a href="links.html#attr-hyperlink-download">download</a></code>
    attribute and the algorithm is not <a href="browsers.html#allowed-to-show-a-popup">allowed to show a popup</a>, or the element's <code data-anolis-xref="attr-hyperlink-target"><a href="links.html#attr-hyperlink-target">target</a></code> attribute is present and applying <a href="browsers.html#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name">the rules
    for choosing a browsing context given a browsing context name</a>, using the value of the
    <code data-anolis-xref="attr-hyperlink-target"><a href="links.html#attr-hyperlink-target">target</a></code> attribute as the browsing context name, would
    result in there not being a chosen browsing context, then run these substeps:</p>

    <ol><!--CLEANUP--><li><p>If there is an <a href="webappapis.html#entry-settings-object">entry settings object</a>, throw an <code><a href="infrastructure.html#invalidaccesserror">InvalidAccessError</a></code>
     exception.</li>

     <li><p>Abort these steps without following the hyperlink.</li>

    </ol></li>

   <li><p>Otherwise, the user agent must <a data-anolis-xref="following hyperlinks" href="links.html#following-hyperlinks">follow the
   hyperlink</a> or <a data-anolis-xref="downloading hyperlinks" href="links.html#downloading-hyperlinks">download the hyperlink</a> created by
   the <code><a href="#the-area-element">area</a></code> element, if any, and as determined by the <code data-anolis-xref="attr-hyperlink-download"><a href="links.html#attr-hyperlink-download">download</a></code> attribute and any expressed user
   preference.</li>

  </ol><p>The IDL attributes <dfn data-anolis-xref="dom-area-alt" id="dom-area-alt"><code>alt</code></dfn>, <dfn data-anolis-xref="dom-area-coords" id="dom-area-coords"><code>coords</code></dfn>, <dfn data-anolis-xref="dom-area-target" id="dom-area-target"><code>target</code></dfn>, <dfn data-anolis-xref="dom-area-download" id="dom-area-download"><code>download</code></dfn>,
<!--PING-->
  <dfn data-anolis-xref="dom-area-rel" id="dom-area-rel"><code>rel</code></dfn>,
  <dfn data-anolis-xref="dom-area-hreflang" id="dom-area-hreflang"><code>hreflang</code></dfn>, and <dfn data-anolis-xref="dom-area-type" id="dom-area-type"><code>type</code></dfn>, each must <a href="infrastructure.html#reflect">reflect</a> the respective
  content attributes of the same name.</p>

  <p>The IDL attribute <dfn data-anolis-xref="dom-area-shape" id="dom-area-shape"><code>shape</code></dfn> must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-area-shape"><a href="#attr-area-shape">shape</a></code> content attribute.</p>

  <p>The IDL attribute <dfn data-anolis-xref="dom-area-rellist" id="dom-area-rellist"><code>relList</code></dfn> must
  <a href="infrastructure.html#reflect">reflect</a> the <code data-anolis-xref="attr-hyperlink-rel"><a href="links.html#attr-hyperlink-rel">rel</a></code> content attribute.</p>

  <hr><!-- concept-uu --><p>The <code><a href="#the-area-element">area</a></code> element also supports the <code><a href="infrastructure.html#urlutils">URLUtils</a></code> interface. <a href="references.html#refsURL">[URL]</a></p>

  <p>When the element is created, and whenever the element's <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> content attribute is set, changed, or removed, the user
  agent must invoke the element's <code><a href="infrastructure.html#urlutils">URLUtils</a></code> interface's <a data-anolis-xref="concept-uu-set-the-input" href="infrastructure.html#concept-uu-set-the-input">set the input</a> algorithm with the value of the <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> content attribute, if any, or the empty string otherwise,
  as the given value.</p>

  <p>The element's <code><a href="infrastructure.html#urlutils">URLUtils</a></code> interface's <a data-anolis-xref="concept-uu-get-the-base" href="infrastructure.html#concept-uu-get-the-base">get the
  base</a> algorithm must simply return <a href="infrastructure.html#the-element's-base-url">the element's base URL</a>.</p>

  <p>The element's <code><a href="infrastructure.html#urlutils">URLUtils</a></code> interface's <a data-anolis-xref="concept-uu-query-encoding" href="infrastructure.html#concept-uu-query-encoding">query
  encoding</a> is the <a href="infrastructure.html#document's-character-encoding">document's character encoding</a>.</p>

  <p>When the element's <code><a href="infrastructure.html#urlutils">URLUtils</a></code> interface invokes its <a data-anolis-xref="concept-uu-update" href="infrastructure.html#concept-uu-update">update steps</a> with a string <var data-anolis-xref="">value</var>, the user
  agent must set the element's <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> content attribute to
  the string <var data-anolis-xref="">value</var>.</p>

  </div>



  <h4 id="image-maps"><span class="secno">4.7.13 </span>Image maps</h4>

  <!-- TESTS
  http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C%21DOCTYPE%20html%3E%0A%3Cimg%20src%3D%22http%3A//hixie.ch/resources/images/smallcats%22%20usemap%3D%23a%20onclick%3Dw%28%27img%27%29%3E%0A%3Cmap%20name%3Da%3E%0A%20%3Carea%20onclick%3Dw%28%271%27%29%20coords%3D%270%25%200%25%20100%25%20100%25%27%20href%3Djavascript%3A%3E%0A%3C/map%3E
  http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C%21DOCTYPE%20html%3E%0A%3Cbody%20onfocus%3D%22w%28document.activeElement.tagName%29%22%3E%0A%3Cimg%20src%3D%22http%3A//hixie.ch/resources/images/smallcats%22%20usemap%3D%23a%20onclick%3Dw%28%27img%27%29%20onfocus%3D%22w%28document.activeElement.tagName%29%22%3E%0A%3Cimg%20src%3D%22http%3A//hixie.ch/resources/images/sample%22%20usemap%3D%23a%20onclick%3Dw%28%27img%27%29%20onfocus%3D%22w%28document.activeElement.tagName%29%22%3E%0A%3Cmap%20name%3Da%20onfocus%3D%22w%28document.activeElement.tagName%29%22%3E%0A%20%3Carea%20onclick%3Dw%28%271%27%29%20coords%3D%270%200%2050%2050%27%20href%3Djavascript%3A%20onfocus%3D%22w%28document.activeElement.tagName%29%22%3E%0A%3C/map%3E%0A%3Cscript%3E%0A%20var%20x%20%3D%20document.getElementsByTagName%28%27img%27%29%5B0%5D%3B%0A%20x.parentNode.appendChild%28x%29%3B%0A%20document.getElementsByTagName%28%27area%27%29%5B0%5D.focus%28%29%3B%0A%3C/script%3E
  http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C%21DOCTYPE%20html%3Ex%3Cmap%3E%3Carea%20shape%3Dpolyg%20coords%3D%221%2C2%203%22%3E%3C/map%3E%0A%3Cscript%3Ex%20%3D%20document.getElementsByTagName%28%27area%27%29%5B0%5D%3B%20w%28x.shape%20+%20%27%20%27%20+%20x.coords%29%3C/script%3E
  http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C%21DOCTYPE%20html%3E%0D%0A%3Cp%3E%3Cimg%20src%3D%22http%3A//hixie.ch/resources/images/astrophy/128%22%20usemap%3D%23a%3E%0D%0A%3Cmap%20name%3Da%3E%3Carea%20shape%3Dcirc%20coords%3D%2220%2C20%2C10%25%22%20href%3D%23%3E%3Carea%20shape%3Dcirc%20coords%3D%2220%2C20%2C10%22%20href%3D%23%3E%3C/map%3E%0D%0A%3Cscript%3Edocument.write%28document.getElementsByTagName%28%27area%27%29%5B0%5D.coords%29%3C/script%3E
  -->

  <div class="impl">

  <h5 id="authoring"><span class="secno">4.7.13.1 </span>Authoring</h5>

  </div>

  <p>An <dfn id="image-map">image map</dfn> allows geometric areas on an image to be associated with <a data-anolis-xref="hyperlink" href="links.html#hyperlink">hyperlinks</a>.</p>

  <p>An image, in the form of an <code><a href="#the-img-element">img</a></code> element or an <code><a href="#the-object-element">object</a></code> element
  representing an image, may be associated with an image map (in the form of a <code><a href="#the-map-element">map</a></code>
  element) by specifying a <dfn data-anolis-xref="attr-hyperlink-usemap" id="attr-hyperlink-usemap"><code>usemap</code></dfn> attribute on
  the <code><a href="#the-img-element">img</a></code> or <code><a href="#the-object-element">object</a></code> element. The <code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> attribute, if specified, must be a <a href="infrastructure.html#valid-hash-name-reference">valid
  hash-name reference</a> to a <code><a href="#the-map-element">map</a></code> element.</p>

  <div class="example">

   <p>Consider an image that looks as follows:</p>

   <p><img alt="A line with four shapes in it, equally spaced: a red hollow box, a green circle, a blue triangle, and a yellow four-pointed star." height="150" src="images/sample-usemap.png" width="600"></p>

   <p>If we wanted just the colored areas to be clickable, we could do it as follows:</p>

   <pre>&lt;p&gt;
 Please select a shape:
 &lt;img src="shapes.png" usemap="#shapes"
      alt="Four shapes are available: a red hollow box, a green circle, a blue triangle, and a yellow four-pointed star."&gt;
 &lt;map name="shapes"&gt;
  &lt;area shape=rect coords="50,50,100,100"&gt; &lt;!-- the hole in the red box --&gt;
  &lt;area shape=rect coords="25,25,125,125" href="red.html" alt="Red box."&gt;
  &lt;area shape=circle coords="200,75,50" href="green.html" alt="Green circle."&gt;
  &lt;area shape=poly coords="325,25,262,125,388,125" href="blue.html" alt="Blue triangle."&gt;
  &lt;area shape=poly coords="450,25,435,60,400,75,435,90,450,125,465,90,500,75,465,60"
        href="yellow.html" alt="Yellow star."&gt;
 &lt;/map&gt;
&lt;/p&gt;</pre>

  </div>

  <div class="impl">

  <h5 id="processing-model-0"><span class="secno">4.7.13.2 </span>Processing model</h5>

  <p>If an <code><a href="#the-img-element">img</a></code> element or an <code><a href="#the-object-element">object</a></code> element representing an image has a
  <code data-anolis-xref="attr-hyperlink-usemap"><a href="#attr-hyperlink-usemap">usemap</a></code> attribute specified, user agents must process it
  as follows:</p>

  <ol><li><p>First, <a href="infrastructure.html#rules-for-parsing-a-hash-name-reference">rules for parsing a hash-name reference</a> to a <code><a href="#the-map-element">map</a></code> element
   must be followed. This will return either an element (the <var data-anolis-xref="">map</var>) or
   null.</li>

   <li><p>If that returned null, then abort these steps. The image is not associated with an image
   map after all.</li>

   <li><p>Otherwise, the user agent must collect all the <code><a href="#the-area-element">area</a></code> elements that are
   descendants of the <var data-anolis-xref="">map</var>. Let those be the <var data-anolis-xref="">areas</var>.</li>

  </ol><p>Having obtained the list of <code><a href="#the-area-element">area</a></code> elements that form the image map (the <var data-anolis-xref="">areas</var>), interactive user agents must process the list in one of two ways.</p>

  <p>If the user agent intends to show the text that the <code><a href="#the-img-element">img</a></code> element represents, then
  it must use the following steps.</p>

  <p class="note">In user agents that do not support images, or that have images disabled,
  <code><a href="#the-object-element">object</a></code> elements cannot represent images, and thus this section never applies (the
  <a href="dom.html#fallback-content">fallback content</a> is shown instead). The following steps therefore only apply to
  <code><a href="#the-img-element">img</a></code> elements.</p>

  <ol><li><p>Remove all the <code><a href="#the-area-element">area</a></code> elements in <var data-anolis-xref="">areas</var> that have no <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> attribute.</li>

   <li><p>Remove all the <code><a href="#the-area-element">area</a></code> elements in <var data-anolis-xref="">areas</var> that have no <code data-anolis-xref="attr-area-alt"><a href="#attr-area-alt">alt</a></code> attribute, or whose <code data-anolis-xref="attr-area-alt"><a href="#attr-area-alt">alt</a></code>
   attribute's value is the empty string, <em>if</em> there is another <code><a href="#the-area-element">area</a></code> element in
   <var data-anolis-xref="">areas</var> with the same value in the <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> attribute and with a non-empty <code data-anolis-xref="attr-area-alt"><a href="#attr-area-alt">alt</a></code> attribute.</li>

   <li><p>Each remaining <code><a href="#the-area-element">area</a></code> element in <var data-anolis-xref="">areas</var> represents a
   <a href="links.html#hyperlink">hyperlink</a>. Those hyperlinks should all be made available to the user in a manner
   associated with the text of the <code><a href="#the-img-element">img</a></code>.</p>

   <p>In this context, user agents may represent <code><a href="#the-area-element">area</a></code> and <code><a href="#the-img-element">img</a></code> elements
   with no specified <code data-anolis-xref="">alt</code> attributes, or whose <code data-anolis-xref="">alt</code>
   attributes are the empty string or some other non-visible text, in a user-agent-defined fashion
   intended to indicate the lack of suitable author-provided text.</li>

  </ol><p>If the user agent intends to show the image and allow interaction with the image to select
  hyperlinks, then the image must be associated with a set of layered shapes, taken from the
  <code><a href="#the-area-element">area</a></code> elements in <var data-anolis-xref="">areas</var>, in reverse tree order (so the last
  specified <code><a href="#the-area-element">area</a></code> element in the <var data-anolis-xref="">map</var> is the bottom-most shape, and
  the first element in the <var data-anolis-xref="">map</var>, in tree order, is the top-most shape).</p>

  <p>Each <code><a href="#the-area-element">area</a></code> element in <var data-anolis-xref="">areas</var> must be processed as follows to
  obtain a shape to layer onto the image:</p>

  <ol><li><p>Find the state that the element's <code data-anolis-xref="attr-area-shape"><a href="#attr-area-shape">shape</a></code> attribute
   represents.</li>

   <li><p>Use the <a href="infrastructure.html#rules-for-parsing-a-list-of-integers">rules for parsing a list of integers</a> to parse the element's <code data-anolis-xref="attr-area-coords"><a href="#attr-area-coords">coords</a></code> attribute, if it is present, and let the result be the
   <var data-anolis-xref="">coords</var> list. If the attribute is absent, let the <var data-anolis-xref="">coords</var>
   list be the empty list.</li>

   <li>

    <p>If the number of items in the <var data-anolis-xref="">coords</var> list is less than the minimum number
    given for the <code><a href="#the-area-element">area</a></code> element's current state, as per the following table, then the
    shape is empty; abort these steps.</p>

    <table><thead><tr><th>State
       <th>Minimum number of items
     <tbody><tr><td><a data-anolis-xref="attr-area-shape-circle" href="#attr-area-shape-circle">Circle state</a>
       <td>3
      <tr><td><a data-anolis-xref="attr-area-shape-default" href="#attr-area-shape-default">Default state</a>
       <td>0
      <tr><td><a data-anolis-xref="attr-area-shape-poly" href="#attr-area-shape-poly">Polygon state</a>
       <td>6
      <tr><td><a data-anolis-xref="attr-area-shape-rect" href="#attr-area-shape-rect">Rectangle state</a>
       <td>4
    </table></li>

   <li>

    <p>Check for excess items in the <var data-anolis-xref="">coords</var> list as per the entry in the
    following list corresponding to the <code data-anolis-xref="attr-area-shape"><a href="#attr-area-shape">shape</a></code> attribute's
    state:</p>

    <dl class="switch"><dt><a data-anolis-xref="attr-area-shape-circle" href="#attr-area-shape-circle">Circle state</a></dt>
     <dd>Drop any items in the list beyond the third.</dd>
     <dt><a data-anolis-xref="attr-area-shape-default" href="#attr-area-shape-default">Default state</a></dt>
     <dd>Drop all items in the list.</dd>
     <dt><a data-anolis-xref="attr-area-shape-poly" href="#attr-area-shape-poly">Polygon state</a></dt>
     <dd>Drop the last item if there's an odd number of items.</dd>
     <dt><a data-anolis-xref="attr-area-shape-rect" href="#attr-area-shape-rect">Rectangle state</a></dt>
     <dd>Drop any items in the list beyond the fourth.</dd>
    </dl></li>

   <li><p>If the <code data-anolis-xref="attr-area-shape"><a href="#attr-area-shape">shape</a></code> attribute represents the <a data-anolis-xref="attr-area-shape-rect" href="#attr-area-shape-rect">rectangle state</a>, and the first number in the list is
   numerically less than the third number in the list, then swap those two numbers around.</li>

   <li><p>If the <code data-anolis-xref="attr-area-shape"><a href="#attr-area-shape">shape</a></code> attribute represents the <a data-anolis-xref="attr-area-shape-rect" href="#attr-area-shape-rect">rectangle state</a>, and the second number in the list is
   numerically less than the fourth number in the list, then swap those two numbers around.</li>

   <li><p>If the <code data-anolis-xref="attr-area-shape"><a href="#attr-area-shape">shape</a></code> attribute represents the <a data-anolis-xref="attr-area-shape-circle" href="#attr-area-shape-circle">circle state</a>, and the third number in the list is less than
   or equal to zero, then the shape is empty; abort these steps.</li>

   <li><p>Now, the shape represented by the element is the one described for the entry in the list
   below corresponding to the state of the <code data-anolis-xref="attr-area-shape"><a href="#attr-area-shape">shape</a></code> attribute:</p>

    <dl class="switch"><dt><a data-anolis-xref="attr-area-shape-circle" href="#attr-area-shape-circle">Circle state</a></dt>
     <dd>

      <p>Let <var data-anolis-xref="">x</var> be the first number in <var data-anolis-xref="">coords</var>, <var data-anolis-xref="">y</var> be the second number, and <var data-anolis-xref="">r</var> be the third number.</p>

      <p>The shape is a circle whose center is <var data-anolis-xref="">x</var> CSS pixels from the left edge
      of the image and <var data-anolis-xref="">y</var> CSS pixels from the top edge of the image, and whose
      radius is <var data-anolis-xref="">r</var> pixels.</p>

     </dd>

     <dt><a data-anolis-xref="attr-area-shape-default" href="#attr-area-shape-default">Default state</a></dt>
     <dd>

      <p>The shape is a rectangle that exactly covers the entire image.</p>

     </dd>

     <dt><a data-anolis-xref="attr-area-shape-poly" href="#attr-area-shape-poly">Polygon state</a></dt>
     <dd>

      <p>Let <var data-anolis-xref="">x<sub data-anolis-xref=""><var data-anolis-xref="">i</var></sub></var> be the <span data-anolis-xref="">(2<var data-anolis-xref="">i</var>)</span>th entry in <var data-anolis-xref="">coords</var>, and <var data-anolis-xref="">y<sub data-anolis-xref=""><var data-anolis-xref="">i</var></sub></var> be the <span data-anolis-xref="">(2<var data-anolis-xref="">i</var>+1)</span>th entry in <var data-anolis-xref="">coords</var> (the first entry in <var data-anolis-xref="">coords</var> being the one with index 0).</p>

      <p>Let <var data-anolis-xref="">the coordinates</var> be (<var data-anolis-xref="">x<sub data-anolis-xref=""><var data-anolis-xref="">i</var></sub></var>, <var data-anolis-xref="">y<sub data-anolis-xref=""><var data-anolis-xref="">i</var></sub></var>),
      interpreted in CSS pixels measured from the top left of the image, for all integer values of
      <var data-anolis-xref="">i</var> from 0 to <span data-anolis-xref="">(<var data-anolis-xref="">N</var>/2)-1</span>, where <var data-anolis-xref="">N</var> is the number of items in <var data-anolis-xref="">coords</var>.</p>

      <p>The shape is a polygon whose vertices are given by <var data-anolis-xref="">the coordinates</var>, and
      whose interior is established using the even-odd rule. <a href="references.html#refsGRAPHICS">[GRAPHICS]</a></p>

      <!--
        browsers implement the even-odd rule / even winding rule:
        http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C%21DOCTYPE%20html%3E%0A%3Cimg%20usemap%3D%22%23x%22%20src%3D%22/resources/images/sample%22%3E%0A%3Cmap%20name%3D%22x%22%3E%0A%20%20%3Carea%20shape%3Dpolygon%20coords%3D%220%2C0%200%2C100%20100%2C100%20100%2C2%201%2C2%202%2C1%202%2C99%2099%2C99%2099%2C0%22%20href%3Da%3E%0A%3C/map%3E%0A
       -->

     </dd>

     <dt><a data-anolis-xref="attr-area-shape-rect" href="#attr-area-shape-rect">Rectangle state</a></dt>

     <dd>

      <p>Let <var data-anolis-xref="">x<sub data-anolis-xref="">1</sub></var> be the first number in <var data-anolis-xref="">coords</var>, <var data-anolis-xref="">y<sub data-anolis-xref="">1</sub></var> be the second number, <var data-anolis-xref="">x<sub data-anolis-xref="">2</sub></var> be the third number, and <var data-anolis-xref="">y<sub data-anolis-xref="">2</sub></var> be the fourth number.</p>

      <p>The shape is a rectangle whose top-left corner is given by the coordinate (<var data-anolis-xref="">x<sub data-anolis-xref="">1</sub></var>, <var data-anolis-xref="">y<sub data-anolis-xref="">1</sub></var>) and whose
      bottom right corner is given by the coordinate (<var data-anolis-xref="">x<sub data-anolis-xref="">2</sub></var>,
      <var data-anolis-xref="">y<sub data-anolis-xref="">2</sub></var>), those coordinates being interpreted as CSS pixels
      from the top left corner of the image.</p>

     </dd>

    </dl><p>For historical reasons, the coordinates must be interpreted relative to the
    <em>displayed</em> image after any stretching caused by the CSS 'width' and 'height' properties
    (or, for non-CSS browsers, the image element's <code data-anolis-xref="">width</code> and <code data-anolis-xref="">height</code> attributes — CSS browsers map those attributes to the
    aforementioned CSS properties).</p>

    <p class="note">Browser zoom features and transforms applied using CSS or SVG do not affect the
    coordinates.</p>

   </li>

  </ol><p>Pointing device interaction with an image associated with a set of layered shapes per the above
  algorithm must result in the relevant user interaction events being first fired to the top-most
  shape covering the point that the pointing device indicated, if any, or to the image element
  itself, if there is no shape covering that point. User agents may also allow individual
  <code><a href="#the-area-element">area</a></code> elements representing <a data-anolis-xref="hyperlink" href="links.html#hyperlink">hyperlinks</a> to be selected
  and activated (e.g. using a keyboard).</p>

  <p class="note">Because a <code><a href="#the-map-element">map</a></code> element (and its <code><a href="#the-area-element">area</a></code> elements) can be
  associated with multiple <code><a href="#the-img-element">img</a></code> and <code><a href="#the-object-element">object</a></code> elements, it is possible for an
  <code><a href="#the-area-element">area</a></code> element to correspond to multiple focusable areas of the document.</p>

  <p>Image maps are <a href="infrastructure.html#live">live</a>; if the DOM is mutated, then the user agent must act as if it
  had rerun the algorithms for image maps.</p>

  </div>



  <h4 id="mathml"><span class="secno">4.7.14 </span>MathML</h4>

  <p>The <dfn id="math"><code>math</code></dfn> element from the <a href="infrastructure.html#mathml-namespace">MathML namespace</a> falls into the
  <a href="dom.html#embedded-content-2">embedded content</a>, <a href="dom.html#phrasing-content-1">phrasing content</a>, and <a href="dom.html#flow-content-1">flow content</a>
  categories for the purposes of the content models in this specification.</p>

  <div class="impl">

  <!-- apparently we get to define error handling, so: -->

  <p>User agents must handle text other than <a href="dom.html#inter-element-whitespace">inter-element whitespace</a> found in MathML
  elements whose content models do not allow straight text by pretending for the purposes of MathML
  content models, layout, and rendering that that text is actually wrapped in an <code data-anolis-xref="">mtext</code> element in the <a href="infrastructure.html#mathml-namespace">MathML namespace</a>. (Such text is not, however,
  conforming.)</p>

  <p>User agents must act as if any MathML element whose contents does not match the element's
  content model was replaced, for the purposes of MathML layout and rendering, by an <code data-anolis-xref="">merror</code> element in the <a href="infrastructure.html#mathml-namespace">MathML namespace</a> containing some appropriate
  error message.</p>

  <p>To enable authors to use MathML tools that only accept MathML in its XML form, interactive HTML
  user agents are encouraged to provide a way to export any MathML fragment as an XML
  namespace-well-formed XML fragment.</p>

  </div>

  <p>The semantics of MathML elements are defined by the MathML specification and <a href="infrastructure.html#other-applicable-specifications">other
  applicable specifications</a>. <a href="references.html#refsMATHML">[MATHML]</a></p>

  <div class="example">

   <p>Here is an example of the use of MathML in an HTML document:</p>

   <pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;The quadratic formula&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
  &lt;h1&gt;The quadratic formula&lt;/h1&gt;
  &lt;p&gt;
   &lt;math&gt;
    &lt;mi&gt;x&lt;/mi&gt;
    &lt;mo&gt;=&lt;/mo&gt;
    &lt;mfrac&gt;
     &lt;mrow&gt;
      &lt;mo form="prefix"&gt;−&lt;/mo&gt; &lt;mi&gt;b&lt;/mi&gt;
      &lt;mo&gt;±&lt;/mo&gt;
      &lt;msqrt&gt;
       &lt;msup&gt; &lt;mi&gt;b&lt;/mi&gt; &lt;mn&gt;2&lt;/mn&gt; &lt;/msup&gt;
       &lt;mo&gt;−&lt;/mo&gt;
       &lt;mn&gt;4&lt;/mn&gt; &lt;mo&gt;⁢&lt;/mo&gt; &lt;mi&gt;a&lt;/mi&gt; &lt;mo&gt;⁢&lt;/mo&gt; &lt;mi&gt;c&lt;/mi&gt;
      &lt;/msqrt&gt;
     &lt;/mrow&gt;
     &lt;mrow&gt;
      &lt;mn&gt;2&lt;/mn&gt; &lt;mo&gt;⁢&lt;/mo&gt; &lt;mi&gt;a&lt;/mi&gt;
     &lt;/mrow&gt;
    &lt;/mfrac&gt;
   &lt;/math&gt;
  &lt;/p&gt;
 &lt;/body&gt;
&lt;/html&gt;</pre>

  </div>



  <h4 id="svg"><span class="secno">4.7.15 </span>SVG</h4>

  <p>The <dfn id="svg-0"><code>svg</code></dfn> element from the <a href="infrastructure.html#svg-namespace">SVG namespace</a> falls into the
  <a href="dom.html#embedded-content-2">embedded content</a>, <a href="dom.html#phrasing-content-1">phrasing content</a>, and <a href="dom.html#flow-content-1">flow content</a>
  categories for the purposes of the content models in this specification.</p>

  <div class="impl">

  <p>To enable authors to use SVG tools that only accept SVG in its XML form, interactive HTML user
  agents are encouraged to provide a way to export any SVG fragment as an XML namespace-well-formed
  XML fragment.</p>

  </div>

  <p>When the SVG <code data-anolis-xref="">foreignObject</code> element contains elements from the <a href="infrastructure.html#html-namespace-0">HTML
  namespace</a>, such elements must all be <a href="dom.html#flow-content-1">flow content</a>. <a href="references.html#refsSVG">[SVG]</a></p>

  <p>The content model for <code data-anolis-xref="">title</code> elements in the <a href="infrastructure.html#svg-namespace">SVG namespace</a>
  inside <a href="infrastructure.html#html-documents">HTML documents</a> is <a href="dom.html#phrasing-content-1">phrasing content</a>. (This further constrains the
  requirements given in the SVG specification.)</p>

  <p>The semantics of SVG elements are defined by the SVG specification and <a href="infrastructure.html#other-applicable-specifications">other applicable
  specifications</a>. <a href="references.html#refsSVG">[SVG]</a></p>

  <p>The SVG specification includes requirements regarding the handling of elements in the DOM that
  are not in the SVG namespace, that are in SVG fragments, and that are not included in a <code data-anolis-xref="">foreignObject</code> element. <em>This</em> specification does not define any processing
  for elements in SVG fragments that are not in the HTML namespace; they are considered neither
  conforming nor non-conforming from the perspective of this specification.</p>



  <h4 id="dimension-attributes"><span class="secno">4.7.16 </span><dfn>Dimension attributes</dfn></h4>

  <p><span class="impl"><strong>Author requirements</strong>:</span> The <dfn data-anolis-xref="attr-dim-width" id="attr-dim-width"><code>width</code></dfn> and <dfn data-anolis-xref="attr-dim-height" id="attr-dim-height"><code>height</code></dfn> attributes on <code><a href="#the-img-element">img</a></code>,
  <code><a href="#the-iframe-element">iframe</a></code>, <code><a href="#the-embed-element">embed</a></code>, <code><a href="#the-object-element">object</a></code>, <code><a href="#the-video-element">video</a></code>, and, when their
  <code data-anolis-xref="attr-input-type"><a href="forms.html#attr-input-type">type</a></code> attribute is in the <a data-anolis-xref="attr-input-type-image" href="forms.html#image-button-state-(type=image)">Image Button</a> state, <code><a href="forms.html#the-input-element">input</a></code> elements may be
  specified to give the dimensions of the visual content of the element (the width and height
  respectively, relative to the nominal direction of the output medium), in CSS pixels. The
  attributes, if specified, must have values that are <a data-anolis-xref="valid non-negative integer" href="infrastructure.html#valid-non-negative-integer">valid
  non-negative integers</a>.</p>

  <p>The specified dimensions given may differ from the dimensions specified in the resource itself,
  since the resource may have a resolution that differs from the CSS pixel resolution. (On screens,
  CSS pixels have a resolution of 96ppi, but in general the CSS pixel resolution depends on the
  reading distance.) If both attributes are specified, then one of the following statements must be
  true:</p>

  <ul><li><span data-anolis-xref=""><var data-anolis-xref="">specified width</var> - 0.5 ≤
             <var data-anolis-xref="">specified height</var> * <var data-anolis-xref="">target ratio</var> ≤
             <var data-anolis-xref="">specified width</var> + 0.5</span></li>

   <li><span data-anolis-xref=""><var data-anolis-xref="">specified height</var> - 0.5 ≤
             <var data-anolis-xref="">specified width</var> / <var data-anolis-xref="">target ratio</var> ≤
             <var data-anolis-xref="">specified height</var> + 0.5</span></li>

   <li><span data-anolis-xref=""><var data-anolis-xref="">specified height</var> = <var data-anolis-xref="">specified width</var> = 0</span></li>

  </ul><p>The <var data-anolis-xref="">target ratio</var> is the ratio of the intrinsic width to the intrinsic
  height in the resource. The <var data-anolis-xref="">specified width</var> and <var data-anolis-xref="">specified
  height</var> are the values of the <code data-anolis-xref="attr-dim-width"><a href="#attr-dim-width">width</a></code> and <code data-anolis-xref="attr-dim-height"><a href="#attr-dim-height">height</a></code> attributes respectively.</p>

  <p>The two attributes must be omitted if the resource in question does not have both an intrinsic
  width and an intrinsic height.</p>

  <p>If the two attributes are both zero, it indicates that the element is not intended for the user
  (e.g. it might be a part of a service to count page views).</p>

  <p class="note">The dimension attributes are not intended to be used to stretch the image.</p>

  <div class="impl">

  <p><strong>User agent requirements</strong>: User agents are expected to use these attributes <a href="rendering.html#dimRendering">as hints for the rendering</a>.</p>

  <p>The <dfn data-anolis-xref="dom-dim-width" id="dom-dim-width"><code>width</code></dfn> and <dfn data-anolis-xref="dom-dim-height" id="dom-dim-height"><code>height</code></dfn> IDL attributes on the <code><a href="#the-iframe-element">iframe</a></code>,
  <code><a href="#the-embed-element">embed</a></code>, <code><a href="#the-object-element">object</a></code>, and <code><a href="#the-video-element">video</a></code> elements must <a href="infrastructure.html#reflect">reflect</a>
  the respective content attributes of the same name.</p>

  <p class="note">For <code><a href="#the-iframe-element">iframe</a></code>, <code><a href="#the-embed-element">embed</a></code>, and <code><a href="#the-object-element">object</a></code> the IDL
  attributes are <code>DOMString</code>; for <code><a href="#the-video-element">video</a></code> the IDL attributes are
  <code>unsigned long</code>.</p>

  <p class="note">The corresponding IDL attributes for <code data-anolis-xref="dom-img-height"><a href="#dom-img-height">img</a></code> and
  <code data-anolis-xref="dom-input-height"><a href="forms.html#dom-input-height">input</a></code> elements are defined in those respective elements'
  sections, as they are slightly more specific to those elements' other behaviors.</p>

  </div>




  