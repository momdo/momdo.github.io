<!DOCTYPE html><html data-bug-component="HTML5 spec" data-bug-product="HTML WG" lang="ja"><meta charset="utf-8"><title>2 Common infrastructure — HTML 5.1 日本語訳
    </title><script src="js/bug-assist.js"></script>
<style type="text/css">
body {line-height:1.5}
     .applies thead th > * { display: block; }
     .applies thead code { display: block; }
     .applies tbody th { white-space: nowrap; }
     .applies td { text-align: center; }
     .applies .yes { background: yellow; }

     .matrix, .matrix td { border: hidden; text-align: right; }
     .matrix { margin-left: 2em; }

     .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
     .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
     .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

     td.eg { border-width: thin; text-align: center; }

     #table-example-1 { border: solid thin; border-collapse: collapse; margin-left: 3em; }
     #table-example-1 * { font-family: "Essays1743", serif; line-height: 1.01em; }
     #table-example-1 caption { padding-bottom: 0.5em; }
     #table-example-1 thead, #table-example-1 tbody { border: none; }
     #table-example-1 th, #table-example-1 td { border: solid thin; }
     #table-example-1 th { font-weight: normal; }
     #table-example-1 td { border-style: none solid; vertical-align: top; }
     #table-example-1 th { padding: 0.5em; vertical-align: middle; text-align: center; }
     #table-example-1 tbody tr:first-child td { padding-top: 0.5em; }
     #table-example-1 tbody tr:last-child td { padding-bottom: 1.5em; }
     #table-example-1 tbody td:first-child { padding-left: 2.5em; padding-right: 0; width: 9em; }
     #table-example-1 tbody td:first-child::after { content: leader(". "); }
     #table-example-1 tbody td { padding-left: 2em; padding-right: 2em; }
     #table-example-1 tbody td:first-child + td { width: 10em; }
     #table-example-1 tbody td:first-child + td ~ td { width: 2.5em; }
     #table-example-1 tbody td:first-child + td + td + td ~ td { width: 1.25em; }

     .apple-table-examples { border: none; border-collapse: separate; border-spacing: 1.5em 0em; width: 40em; margin-left: 3em; }
     .apple-table-examples * { font-family: "Times", serif; }
     .apple-table-examples td, .apple-table-examples th { border: none; white-space: nowrap; padding-top: 0; padding-bottom: 0; }
     .apple-table-examples tbody th:first-child { border-left: none; width: 100%; }
     .apple-table-examples thead th:first-child ~ th { font-size: smaller; font-weight: bolder; border-bottom: solid 2px; text-align: center; }
     .apple-table-examples tbody th::after, .apple-table-examples tfoot th::after { content: leader(". ") }
     .apple-table-examples tbody th, .apple-table-examples tfoot th { font: inherit; text-align: left; }
     .apple-table-examples td { text-align: right; vertical-align: top; }
     .apple-table-examples.e1 tbody tr:last-child td { border-bottom: solid 1px; }
     .apple-table-examples.e1 tbody + tbody tr:last-child td { border-bottom: double 3px; }
     .apple-table-examples.e2 th[scope=row] { padding-left: 1em; }
     .apple-table-examples sup { line-height: 0; }

     .details-example img { vertical-align: top; }

     #base64-table {
       white-space: nowrap;
       font-size: 0.6em;
       column-width: 6em;
       column-count: 5;
       column-gap: 1em;
       -moz-column-width: 6em;
       -moz-column-count: 5;
       -moz-column-gap: 1em;
       -webkit-column-width: 6em;
       -webkit-column-count: 5;
       -webkit-column-gap: 1em;
     }
     #base64-table thead { display: none; }
     #base64-table * { border: none; }
     #base64-table tbody td:first-child:after { content: ':'; }
     #base64-table tbody td:last-child { text-align: right; }

     #named-character-references-table {
       white-space: nowrap;
       font-size: 0.6em;
       column-width: 30em;
       column-gap: 1em;
       -moz-column-width: 30em;
       -moz-column-gap: 1em;
       -webkit-column-width: 30em;
       -webkit-column-gap: 1em;
     }
     #named-character-references-table > table > tbody > tr > td:first-child + td,
     #named-character-references-table > table > tbody > tr > td:last-child { text-align: center; }
     #named-character-references-table > table > tbody > tr > td:last-child:hover > span { position: absolute; top: auto; left: auto; margin-left: 0.5em; line-height: 1.2; font-size: 5em; border: outset; padding: 0.25em 0.5em; background: white; width: 1.25em; height: auto; text-align: center; }
     #named-character-references-table > table > tbody > tr#entity-CounterClockwiseContourIntegral > td:first-child { font-size: 0.5em; }

     .glyph.control { color: red; }

     @font-face {
       font-family: 'Essays1743';
       src: url('fonts/Essays1743.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-weight: bold;
       src: url('fonts/Essays1743-Bold.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-style: italic;
       src: url('fonts/Essays1743-Italic.ttf');
     }
     @font-face {
       font-family: 'Essays1743';
       font-style: italic;
       font-weight: bold;
       src: url('fonts/Essays1743-BoldItalic.ttf');
     }

    </style>
<style type="text/css">
       pre { margin-left: 2em; white-space: pre-wrap; }
       h2 { margin: 3em 0 1em 0; }
       h3 { margin: 2.5em 0 1em 0; }
       h4 { margin: 2.5em 0 0.75em 0; }
       h5, h6 { margin: 2.5em 0 1em; }
       h1 + h2, h1 + h2 + h2, h1 + p, h1 + p + h2 { margin: 0.75em 0 0.75em; }
       h2 + h3, h3 + h4, h4 + h5, h5 + h6 { margin-top: 0.5em; }
       p { margin: 1em 0; }
       hr:not(.top) { display: block; background: none; border: none; padding: 0; margin: 2em 0; height: auto; }
       .element dd,  .element dl { margin-top: 0em; margin-bottom: 0.25em;}
       dt { margin-top: 0.75em; margin-bottom: 0.5em; clear: left; }
        .element dt { margin-top: 0.5em; margin-bottom: 0.5em;  }
       dt + dt { margin-top: 0; }
       dd dt { margin-top: 0.25em; margin-bottom: 0; }
       dd p { margin-top: 0; }
       dd dl + p { margin-top: 1em; }
       dd table + p { margin-top: 1em; }
       p + * > li, dd li { margin: 1em 0; }
       dt, dfn { font-weight: bold; font-style: normal; }
       i, em { font-style: italic; }
       dt dfn { font-style: italic; }
       pre, code { font-size: inherit; font-family: monospace; font-variant: normal; }
       pre strong { color: black; font: inherit; font-weight: bold; background: yellow; }
       pre em { font-weight: bolder; font-style: normal; }
       @media screen { code { color: #D93B00; } code :link, code :visited { color: inherit; } }
       var { background-color: #f9f9f9; border: 1px solid #eee; padding: 0 2px; }
       var sub { vertical-align: bottom; font-size: smaller; position: relative; top: 0.1em; }
       table { border-collapse: collapse; border-style: hidden hidden none hidden; }
       table thead, table tbody { border-bottom: solid; }
       table tbody th:first-child { border-left: solid; }
       table tbody th { text-align: left; }
       table td, table th { border-left: solid; border-right: solid; border-bottom: solid thin; vertical-align: top; padding: 0.2em; }
       blockquote { margin: 0 0 0 2em; border: 0; padding: 0; font-style: italic; }

       .bad, .bad *:not(.XXX) { color: #5F6D7A; border-color: gray; background: transparent; }
       .matrix, .matrix td { border: none; text-align: right; }
       .matrix { margin-left: 2em; }
       .dice-example { border-collapse: collapse; border-style: hidden solid solid hidden; border-width: thin; margin-left: 3em; }
       .dice-example caption { width: 30em; font-size: smaller; font-style: italic; padding: 0.75em 0; text-align: left; }
       .dice-example td, .dice-example th { border: solid thin; width: 1.35em; height: 1.05em; text-align: center; padding: 0; }

       .toc dfn, h1 dfn, h2 dfn, h3 dfn, h4 dfn, h5 dfn, h6 dfn { font: inherit; }
       img.extra, p.overview { float: right; }
       pre.idl { border: solid thin #d3d3d3; background: #FCFCFC; color: black; padding: 0.5em 1em; position: relative; }
       pre.idl :link, pre.idl :visited { color: inherit; background: transparent; }
       pre.idl::before { content: "IDL"; font: bold small sans-serif; padding: 0.5em; background: white; position: absolute; top: 0; margin: -1px 0 0 -4em; width: 1.5em; border: thin solid; border-radius: 0 0 0 0.5em }
       pre.css { border: solid thin; background: #FFFFEE; color: black; padding: 0.5em 1em; }
       pre.css:first-line { color: #AAAA50; }
       dl.domintro {padding: 0.5em 1em; border: none; background:#E9FBE9; border: 1px solid lightgray; }
       hr + dl.domintro, div.impl + dl.domintro { margin-top: 2.5em; margin-bottom: 1.5em; }
       dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
       dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
       dl.domintro dd p { margin: 0.5em 0; }
       dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This definition is non-normative. Implementation requirements are given below this definition.'; color: #606060; border:1px solid lightgray; background: white; padding: 0 0.25em;font-size:.9em;}
       dl.switch { padding-left: 2em; }
       dl.switch > dt { text-indent: -1.5em; }
       dl.switch > dt:before { content: '\21AA'; padding: 0 0.5em 0 0; display: inline-block; width: 1em; text-align: right; line-height: 0.5em; }
       dl.triple { padding: 0 0 0 1em; }
       dl.triple dt, dl.triple dd { margin: 0; display: inline }
       dl.triple dt:after { content: ':'; }
       dl.triple dd:after { content: '\A'; white-space: pre; }
       .diff-old { text-decoration: line-through; color: silver; background: transparent; }
       .diff-chg, .diff-new { text-decoration: underline; color: green; background: transparent; }
       a .diff-new { border-bottom: 1px blue solid; }

       figure.diagrams { border: double black; background: white; padding: 1em; }
       figure.diagrams img { display: block; margin: 1em auto; } 

       h2 { page-break-before: always; }
       h1, h2, h3, h4, h5, h6 { page-break-after: avoid; }
       h1 + h2, hr + h2.no-toc { page-break-before: auto; }

       p  > span:not([title=""]):not([class="XXX"]):not([class="impl"]):not([class="note"]):not([class="t2"]):not([id]):not([lang]),
       li > span:not([title=""]):not([class="XXX"]):not([class="impl"]):not([class="note"]):not([class="t2"]):not([id]):not([lang])
       { border-bottom: solid #9999CC; }

       div.head { margin: 0 0 1em; padding: 1em 0 0 0; }
       div.head p { margin: 0; }
       div.head h1 { margin: 0; }
       div.head .logo { float: right; margin: 0 1em; }
       div.head .logo img { border: none } /* remove border from top image */
       div.head dl { margin: 1em 0; }
       div.head p.copyright, div.head p.alt { font-size: x-small; font-style: oblique; margin: 0; }

       body > .toc > li { margin-top: 1em; margin-bottom: 1em; }
       body > .toc.brief > li { margin-top: 0.35em; margin-bottom: 0.35em; }
       body > .toc > li > * { margin-bottom: 0.5em; }
       body > .toc > li > * > li > * { margin-bottom: 0.25em; }
       .toc, .toc li { list-style: none; }

       .brief { margin-top: 1em; margin-bottom: 1em; line-height: 1.1; }
       .brief li { margin: 0; padding: 0; }
       .brief li p { margin: 0; padding: 0; }

       .category-list { margin-top: -0.75em; margin-bottom: 1em; line-height: 1.5; }
       .category-list::before { content: '\21D2\A0'; font-size: 1.2em; font-weight: 900; }
       .category-list li { display: inline; }
       .category-list li:not(:last-child)::after { content: ', '; }
       .category-list li > span, .category-list li > a { text-transform: lowercase; }
       .category-list li * { text-transform: none; } /* don't affect <code> nested in <a> */

       .XXX { color: #E50000; background: white; border: solid red; padding: 0.5em; margin: 1em 0; }
       .XXX > :first-child { margin-top: 0; }
       p .XXX { line-height: 3em; }
       .annotation { border: solid thin black; background: #0C479D; color: white; position: relative; margin: 8px 0 20px 0; }
       .annotation:before { position: absolute; left: 0; top: 0; width: 100%; height: 100%; margin: 6px -6px -6px 6px; background: #333333; z-index: -1; content: ''; }
       .annotation :link, .annotation :visited { color: inherit; }
       .annotation :link:hover, .annotation :visited:hover { background: transparent; }
       .annotation span { border: none ! important; }
       .note { border-left-style: solid; border-left-width: 0.25em; background: none repeat scroll 0 0 #E9FBE9; border-color: #52E052; }
       .warning { background-color: #F9F0D4; border: medium double #FF0000; margin: 1em; padding: 1em; }
       .note em, .warning em, .note i, .warning i { font-style: normal; }
       p.note, div.note { padding: 0.5em 2em; }
       span.note { padding: 0 2em; }
       .note p:first-child, .warning p:first-child { margin-top: 0; }
       .note p:last-child, .warning p:last-child { margin-bottom: 0; }
       .warning:before { font-style: normal; }
       p.note:before { content: 'Note: '; font-weight: bolder;}
       p.warning:before { content: '\26A0 Warning! '; font-weight:bolder;}
       .critical {margin:1em; border:double red; padding:1em; background-color:#F9F0D4;}

       .bookkeeping:before { display: block; content: 'Bookkeeping details'; font-weight: bolder; font-style: italic; }
       .bookkeeping { font-size: 0.8em; margin: 2em 0; }
       .bookkeeping p { margin: 0.5em 2em; display: list-item; list-style: square; }
       .bookkeeping dt { margin: 0.5em 2em 0; }
       .bookkeeping dd { margin: 0 3em 0.5em; }

       h4 { position: relative; z-index: 3; }
       h4 + .element, h4 + div + .element { margin-top: -2.5em; padding-top: 2em; }
       .element {
         background: #F4F4FA;
         color: black;
         margin: 0 0 1em 0.15em;
         padding: 0 1em 0.25em 0.75em;
         border-left: solid #9999FF 0.25em;
         position: relative;
         z-index: 1;
       }
       .element:before {
         position: absolute;
         z-index: 2;
         top: 0;
         left: -1.15em;
         height: 2em;
         width: 0.9em;
         background: #F4F4FA;
         content: ' ';
         border-style: none none solid solid;
         border-color: #9999FF;
         border-width: 0.25em;
       }

       .example { display: block; color: #222222; background: #FCFCFC; border-left-style: solid;border-color:#c0c0c0; border-left-width: 0.25em; margin-left: 1em; padding-left: 1em;padding-bottom: 0.5em;}
       div.example:before { content: 'Code Example: '; font-weight: bolder;}
       td > .example:only-child { margin: 0 0 0 0.1em; }

       ul.domTree, ul.domTree ul { padding: 0 0 0 1em; margin: 0; }
       ul.domTree li { padding: 0; margin: 0; list-style: none; position: relative; }
       ul.domTree li li { list-style: none; }
       ul.domTree li:first-child::before { position: absolute; top: 0; height: 0.6em; left: -0.75em; width: 0.5em; border-style: none none solid solid; content: ''; border-width: 0.1em; }
       ul.domTree li:not(:last-child)::after { position: absolute; top: 0; bottom: -0.6em; left: -0.75em; width: 0.5em; border-style: none none solid solid; content: ''; border-width: 0.1em; }
       ul.domTree span { font-style: italic; font-family: serif; }
       ul.domTree .t1 code { color: purple; font-weight: bold; }
       ul.domTree .t2 { font-style: normal; font-family: monospace; }
       ul.domTree .t2 .name { color: black; font-weight: bold; }
       ul.domTree .t2 .value { color: blue; font-weight: normal; }
       ul.domTree .t3 code, .domTree .t4 code, .domTree .t5 code { color: gray; }
       ul.domTree .t7 code, .domTree .t8 code { color: green; }
       ul.domTree .t10 code { color: teal; }

       body.dfnEnabled dfn { cursor: pointer; }
       .dfnPanel {
         display: inline;
         position: absolute;
         z-index: 10;
         height: auto;
         width: auto;
         padding: 0.5em 0.75em;
         font: small sans-serif, Droid Sans Fallback;
         background: #DDDDDD;
         color: black;
         border: outset 0.2em;
       }
       .dfnPanel * { margin: 0; padding: 0; font: inherit; text-indent: 0; }
       .dfnPanel :link, .dfnPanel :visited { color: black; }
       .dfnPanel p { font-weight: bolder; }
       .dfnPanel * + p { margin-top: 0.25em; }
       .dfnPanel li { list-style-position: inside; }

       #configUI { position: absolute; z-index: 20; top: 10em; right: 1em; width: 11em; font-size: small; }
       #configUI p { margin: 0.5em 0; padding: 0.3em; background: #EEEEEE; color: black; border: inset thin; }
       #configUI p label { display: block; }
       #configUI #updateUI, #configUI .loginUI { text-align: center; }
       #configUI input[type=button] { display: block; margin: auto; }

       fieldset { margin: 1em; padding: 0.5em 1em; }
       fieldset > legend + * { margin-top: 0; }
       fieldset > :last-child { margin-bottom: 0; }
       fieldset p { margin: 0.5em 0; }
       header p.subline {color:#005A9C; font: 140% sans-serif;margin: 0.75em 0;}
       #authorButton {overflow: visible; padding: 0.1em 0.3em; position: fixed; right: 2em; top: 6em; width: auto;}

       @media print {#authorButton { display:none;}}

  </style><!--<link href="switcher/W3C-ED-au.css" rel="stylesheet" type="text/css">--><link href="https://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet" type="text/css"><script>
   function getCookie(name) {
     var params = location.search.substr(1).split("&");
     for (var index = 0; index < params.length; index++) {
       if (params[index] == name)
         return "1";
       var data = params[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     var cookies = document.cookie.split("; ");
     for (var index = 0; index < cookies.length; index++) {
       var data = cookies[index].split("=");
       if (data[0] == name)
         return unescape(data[1]);
     }
     return null;
   }
  </script><!-- style switcher script by Stommepoes  --><link href="switcher/author-view.css" id="author-view" rel="alternate stylesheet" title="Author documentation only"><script src="switcher/authorstylesheet.js"></script><link href="introduction.html" rel="prev" title="1 Introduction">
  <link href="Overview.html#contents" rel="contents" title="目次">
  <link href="dom.html" rel="next" title="3 Semantics, structure, and APIs of HTML documents">
  <body class="split chapter" onload="fixBrokenLink();"><div class="head" id="head">
<header><span id="styleSwitch"></span>
   <p><a href="http://www.w3.org/"><img alt="W3C" height="48" src="http://www.w3.org/Icons/w3c_home" width="72"></a></p>

    <h1 id="big-title">HTML 5.1 日本語訳
    </h1>
    <p class="no-num no-toc subline">HTMLとXHTMLのための語彙と関連API</p>
   <p class="no-num no-toc subline">Editor's Draft 2 October 2014</p>
   </header></div>
  

  <nav class="prev_next">
   <a href="introduction.html">← 1 導入</a> – <a href="Overview.html#contents">目次</a> – <a href="dom.html">3 セマンティック、構造、HTML文書のAPI群 →</a>
  <ol class="toc"><li><a href="infrastructure.html#infrastructure"><span class="secno">2</span> 共通インフラ</a>
  <ol><li><a href="infrastructure.html#terminology"><span class="secno">2.1</span> 用語</a>
    <ol><li><a href="infrastructure.html#resources"><span class="secno">2.1.1</span> リソース</a></li><li><a href="infrastructure.html#xml"><span class="secno">2.1.2</span> XML</a></li><li><a href="infrastructure.html#dom-trees"><span class="secno">2.1.3</span> DOMツリー</a></li><li><a href="infrastructure.html#scripting-0"><span class="secno">2.1.4</span> スクリプティング</a></li><li><a href="infrastructure.html#plugins"><span class="secno">2.1.5</span> プラグイン</a></li><li><a href="infrastructure.html#encoding-terminology"><span class="secno">2.1.6</span> 文字エンコーディング</a></li></ol></li><li><a href="infrastructure.html#conformance-requirements"><span class="secno">2.2</span> 適合性要件</a>
    <ol><li><a href="infrastructure.html#conformance-classes"><span class="secno">2.2.1 </span>Conformance classes</a></li><li><a href="infrastructure.html#dependencies"><span class="secno">2.2.2 </span>Dependencies</a></li><li><a href="infrastructure.html#extensibility-0"><span class="secno">2.2.3</span> 拡張性</a></li><li><a href="infrastructure.html#interactions-with-xpath-and-xslt"><span class="secno">2.2.4 </span>Interactions with XPath and XSLT</a></li></ol></li><li><a href="infrastructure.html#case-sensitivity-and-string-comparison"><span class="secno">2.3</span> 大文字・小文字区別と文字列の比較</a></li><li><a href="infrastructure.html#common-microsyntaxes"><span class="secno">2.4</span> 共通マイクロ構文</a>
    <ol><li><a href="infrastructure.html#common-parser-idioms"><span class="secno">2.4.1 </span>Common parser idioms</a></li><li><a href="infrastructure.html#boolean-attributes"><span class="secno">2.4.2</span> 真偽属性</a></li><li><a href="infrastructure.html#keywords-and-enumerated-attributes"><span class="secno">2.4.3</span> キーワードおよび列挙属性</a></li><li><a href="infrastructure.html#numbers"><span class="secno">2.4.4</span> 数字</a>
      <ol><li><a href="infrastructure.html#signed-integers"><span class="secno">2.4.4.1</span> 符号付き整数</a></li><li><a href="infrastructure.html#non-negative-integers"><span class="secno">2.4.4.2</span> 非負整数</a></li><li><a href="infrastructure.html#floating-point-numbers"><span class="secno">2.4.4.3</span> 浮動小数点数</a></li><li><a href="infrastructure.html#percentages-and-dimensions"><span class="secno">2.4.4.4 </span>Percentages and lengths</a></li><li><a href="infrastructure.html#lists-of-integers"><span class="secno">2.4.4.5</span> 整数リスト</a></li><li><a href="infrastructure.html#lists-of-dimensions"><span class="secno">2.4.4.6 </span>Lists of dimensions</a></li></ol></li><li><a href="infrastructure.html#dates-and-times"><span class="secno">2.4.5</span> 日付および時刻</a>
      <ol><li><a href="infrastructure.html#months"><span class="secno">2.4.5.1</span> 月</a></li><li><a href="infrastructure.html#dates"><span class="secno">2.4.5.2</span> 日付</a></li><li><a href="infrastructure.html#yearless-dates"><span class="secno">2.4.5.3</span> 年なし日付</a></li><li><a href="infrastructure.html#times"><span class="secno">2.4.5.4</span> 時刻</a></li><li><a href="infrastructure.html#floating-dates-and-times"><span class="secno">2.4.5.5</span> 浮動日付および時刻</a></li><li><a href="infrastructure.html#time-zones"><span class="secno">2.4.5.6</span> タイムゾーン</a></li><li><a href="infrastructure.html#global-dates-and-times"><span class="secno">2.4.5.7</span> グローバル日付および時刻</a></li><li><a href="infrastructure.html#weeks"><span class="secno">2.4.5.8</span> 週</a></li><li><a href="infrastructure.html#durations"><span class="secno">2.4.5.9</span> 継続時間</a></li><li><a href="infrastructure.html#vaguer-moments-in-time"><span class="secno">2.4.5.10</span> 時刻における曖昧な瞬間</a></li></ol></li><li><a href="infrastructure.html#colors"><span class="secno">2.4.6</span> 色</a></li><li><a href="infrastructure.html#space-separated-tokens"><span class="secno">2.4.7</span> 空白区切りトークン</a></li><li><a href="infrastructure.html#comma-separated-tokens"><span class="secno">2.4.8</span> コンマ区切りトークン</a></li><li><a href="infrastructure.html#syntax-references"><span class="secno">2.4.9</span> 参照</a></li><li><a href="infrastructure.html#mq"><span class="secno">2.4.10</span> メディアクエリ</a></li></ol></li><li><a href="infrastructure.html#urls"><span class="secno">2.5</span> URL</a>
    <ol><li><a href="infrastructure.html#terminology-0"><span class="secno">2.5.1</span> 用語</a></li><li><a href="infrastructure.html#resolving-urls"><span class="secno">2.5.2 </span>Resolving URLs</a></li><li><a href="infrastructure.html#dynamic-changes-to-base-urls"><span class="secno">2.5.3 </span>Dynamic changes to base URLs</a></li></ol></li><li><a href="infrastructure.html#fetching-resources"><span class="secno">2.6 </span>Fetching resources</a>
    <ol><li><a href="infrastructure.html#terminology-1"><span class="secno">2.6.1 </span>Terminology</a></li><li><a href="infrastructure.html#processing-model"><span class="secno">2.6.2 </span>Processing model</a></li><li><a href="infrastructure.html#encrypted-http-and-related-security-concerns"><span class="secno">2.6.3 </span>Encrypted HTTP and related security concerns</a></li><li><a href="infrastructure.html#content-type-sniffing"><span class="secno">2.6.4 </span>Determining the type of a resource</a></li><li><a href="infrastructure.html#extracting-character-encodings-from-meta-elements"><span class="secno">2.6.5 </span>Extracting character encodings from <code>meta</code> elements</a></li><li><a href="infrastructure.html#cors-settings-attributes"><span class="secno">2.6.6</span> CORS設定属性</a></li><li><a href="infrastructure.html#cors-enabled-fetch"><span class="secno">2.6.7 </span>CORS-enabled fetch</a></li></ol></li><li><a href="infrastructure.html#common-dom-interfaces"><span class="secno">2.7</span> 共通DOMインターフェース</a>
    <ol><li><a href="infrastructure.html#reflecting-content-attributes-in-idl-attributes"><span class="secno">2.7.1</span> IDL属性におけるコンテンツ属性の反映</a></li><li><a href="infrastructure.html#collections"><span class="secno">2.7.2</span> コレクション</a>
      <ol><li><a href="infrastructure.html#htmlallcollection"><span class="secno">2.7.2.1</span> HTMLAllCollection</a></li><li><a href="infrastructure.html#htmlformcontrolscollection"><span class="secno">2.7.2.2 </span>HTMLFormControlsCollection</a></li><li><a href="infrastructure.html#htmloptionscollection"><span class="secno">2.7.2.3 </span>HTMLOptionsCollection</a></li></ol></li><li><a href="infrastructure.html#domstringmap"><span class="secno">2.7.3 </span>DOMStringMap</a></li><li><a href="infrastructure.html#domelementmap"><span class="secno">2.7.4 </span>DOMElementMap</a></li><li><a href="infrastructure.html#transferable-objects"><span class="secno">2.7.5</span> 譲渡可能オブジェクト</a></li><li><a href="infrastructure.html#safe-passing-of-structured-data"><span class="secno">2.7.6 </span>Safe passing of structured data</a></li><li><a href="infrastructure.html#callbacks"><span class="secno">2.7.7 </span>コールバック</a></li><li><a href="infrastructure.html#garbage-collection"><span class="secno">2.7.8 </span>Garbage collection</a></li></ol></li><li><a href="infrastructure.html#namespaces"><span class="secno">2.8</span> 名前空間</a></li></ol></li></ol></nav>

  <h2 id="infrastructure"><span class="secno">2</span> 共通インフラ</h2>

  <h3 id="terminology"><span class="secno">2.1</span> 用語</h3>

  <p>この仕様は、多くの場合、同じ文脈においてHTMLおよびXMLの属性とIDL属性の両方に言及する。どの属性について言及されているかが不明瞭な場合、HTMLおよびXML属性の<dfn data-anolis-xref="">コンテンツ属性</dfn>、およびIDLインターフェースに定義される<dfn data-anolis-xref="">IDL属性</dfn>として言及される。同様に、用語"プロパティー"は、JavaScriptのオブジェクトプロパティーとCSSプロパティーの両方に使用される。プロパティーが不明瞭の場合、それぞれ<dfn data-anolis-xref="">オブジェクトプロパティー</dfn>および<dfn data-anolis-xref="">CSSプロパティー</dfn>として修飾される。</p>

  <p>一般に、ある機能が<a href="syntax.html#syntax">HTML構文</a>または<a href="the-xhtml-syntax.html#the-xhtml-syntax">XHTML構文</a>の一方に当てはまると仕様が言及する場合、他方を含む。機能が2つの言語の1つのみ明確に当てはまる場合、"HTMLに対して…（これはXHTMLに適用されない）"のように、他方の形式に適用されないことが明示的に示される。</p>

  <p>この仕様は、短い静的な文書からリッチなマルチメディアを伴う長いエッセイやレポートだけでなく、本格的な対話型アプリケーションにまで至る、HTMLの任意の用法を表す用語<dfn data-anolis-xref="">文書</dfn>を使用する。この用語は、文脈に応じて<code><a href="dom.html#document">Document</a></code>オブジェクトおよびその子孫DOMツリー、<a data-anolis-xref="the
  HTML syntax" href="syntax.html#syntax">HTML構文</a>または<a data-anolis-xref="the XHTML syntax" href="the-xhtml-syntax.html#the-xhtml-syntax">XHTML構文</a>を用いてシリアル化されたバイトストリームの両方を表すために使用される。</p>

  <p>DOM構造の文脈において、用語<a data-anolis-xref="HTML documents" href="#html-documents">HTML文書</a>および<a data-anolis-xref="XML documents" href="#xml-documents">XML文書</a>は、DOM仕様で定義されるとおりに使用され、<code><a href="dom.html#document">Document</a></code>オブジェクトが自分自身を見つけることができる2つの異なるモードを表す。<a href="references.html#refsDOM">[DOM]</a>（このような用途は常に定義にハイパーリンクされる。）</p>

  <p>バイトストリームの文脈において、用語HTML文書は、<code><a href="iana.html#text/html">text/html</a></code>として分類されたリソースを指し、用語XML文書は、<a href="#xml-mime-type">XML MIMEタイプ</a>で分類されるリソースを指す。</p>

  <p>用語<dfn id="xhtml-document">XHTML文書</dfn>は、文脈に応じて、<a href="#html-namespace-0">HTML名前空間</a>内の要素ノードを含む<a data-anolis-xref="XML documents" href="#xml-documents">XML文書</a>モードでの<code><a href="dom.html#document">Document</a></code>、および<a href="#html-namespace-0">HTML名前空間</a>由来の要素を含む<a href="#xml-mime-type">XML MIMEタイプ</a>に分類されたバイトストリームの両方を示すために使用される。</p>

  <hr><p>簡潔さのために、文書がユーザーに表示される方法を参照する際、（原文でいう）<dfn data-anolis-xref="">shown</dfn>、<dfn data-anolis-xref="">displayed</dfn>、<dfn data-anolis-xref="">visible</dfn>のような用語が時に使用されるかもしれない。これらの用語は、視覚メディアを意味するものではない。同等の方法で、他のメディアに適用されると考えなければならない。</p>

  <div class="impl">

  <p>When an algorithm B says to return to another algorithm A, it implies that A called B. Upon
  returning to A, the implementation must continue from where it left off in calling B.</p>

  </div><!-- should find somewhere more appropriate to put this -->

  
  <p>用語"透明な黒"は、赤、緑、青、およびアルファチャンネルをすべて0に設定した色を指す。</p>


  <h4 id="resources"><span class="secno">2.1.1</span> リソース</h4>

  <p>仕様は、ユーザーエージェントが外部リソースのセマンティックをデコード可能な実装を持つかどうかを参照する場合に用語<dfn data-anolis-xref="">サポートされる</dfn>を使用する。フォーマットまたはタイプは、重要なリソースの機能を無視されることなく、実装がそのフォーマットやタイプの外部リソースを処理できる場合は<i>サポートされる</i>と言われる。特定のリソースが<i>サポートされる</i>かどうかは、リソースのフォーマットのどの機能が使用されるかに依存するだろう。</p>

  <p class="example">たとえば、たとえ実装の知らないうちに、画像がアニメーションデータを含む場合でも、画像のピクセルデータがデコードされレンダリングされるならば、PNG画像はサポートされるフォーマットであると見なされるだろう。</p>

  <p class="example">たとえ実装がファイルのメタデータからムービーの寸法を決定可能でも、使用される圧縮形式がサポートされていなかった場合、MPEG-4ビデオファイルはサポートされるフォーマットであるとみなされない。</p>

  <p>特にHTTP仕様において、一部の仕様が<i>representation</i>と表されるものは、この仕様で<dfn data-anolis-xref="">リソース</dfn>として表される。<a href="references.html#refsHTTP">[HTTP]</a></p>

  <p>用語<dfn id="mime-type">MIMEタイプ</dfn>は、プロトコルの文献で時折<i>インターネットメディアタイプ</i>と呼ばれるものを指すのに使用される。この仕様において、用語<i>メディアタイプ</i>は、CSS仕様により用いられるように、プレゼンテーションのために意図されるメディアの種類を指示するために使用される。<a href="references.html#refsRFC2046">[RFC2046]</a> <a href="references.html#refsMQ">[MQ]</a></p>

  <p>メディアタイプがRFC 2616の3.7節"Media Types"で定義される<code data-anolis-xref="">media-type</code>規則に一致する場合、文字列は<dfn id="valid-mime-type">妥当なMIMEタイプ</dfn>となる。具体的には、<a href="#valid-mime-type">妥当なMIMEタイプ</a>はMIMEタイプのパラメータを含んでもよい。<a href="references.html#refsHTTP">[HTTP]</a></p>

  <p>";"（U+003B）文字を含まないが、RFC 2616の3.7節"Media Types"で定義される<code data-anolis-xref="">media-type</code>規則に一致した場合、文字列は<dfn id="valid-mime-type-with-no-parameters">パラメータなしの妥当なMIMEタイプ</dfn>となる。言い換えれば、MIMEタイプのパラメータがない、タイプおよびサブタイプのみから構成される場合である。<a href="references.html#refsHTTP">[HTTP]</a></p>

  <p>用語<dfn id="html-mime-type">HTML MIMEタイプ</dfn>は、<a href="#mime-type">MIMEタイプ</a>が<code><a href="iana.html#text/html">text/html</a></code>を表すために使用される。</p>

  <p>リソースの<dfn id="critical-subresources">クリティカルサブリソース</dfn>は、リソースが正しく処理されるために使用できる状態にしておく必要があるものである。どのリソースがクリティカルかどうかとみなされるかは、リソースのフォーマットを定義する仕様によって定義されない。</p>

  <p>用語<dfn data-anolis-xref="data protocol" id="data-protocol"><code data-anolis-xref="">data:</code> URL</dfn>は、<code data-anolis-xref="">data:</code>スキームを用いた<a data-anolis-xref="URL" href="#url">URL</a>を指す。<a href="references.html#refsRFC2397">[RFC2397]</a></p>


  <h4 id="xml"><span class="secno">2.1.2</span> XML</h4>

  <p id="html-namespace">HTMLからXHTMLへの移行を容易にするため、この仕様に準拠するユーザーエージェントは、少なくともDOMとCSSのために、<code>http://www.w3.org/1999/xhtml</code>名前空間にHTMLで要素を配置するだろう。この仕様で使用される用語"<dfn id="html-elements">HTML要素</dfn>"は、その名前空間内の任意の要素を指す。したがって、HTMLとXHTMLの要素の両方を指す。</p>

  <p>他に記載される場合を除き、この仕様で定義または記載されるすべての要素は<a href="#html-namespace-0">HTML名前空間</a>（"<code>http://www.w3.org/1999/xhtml</code>"）であり、この仕様で定義または記載されるすべての属性は名前空間を持たない。</p>

  <p>用語<dfn id="element-type">要素タイプ</dfn>は、与えられたローカル名と名前空間を持つ要素の集合を参照するために使用される。たとえば、<code><a href="forms.html#the-button-element">button</a></code>要素は要素型<code><a href="forms.html#the-button-element">button</a></code>をもつ要素であり、ローカル名"<code data-anolis-xref="">button</code><a href="#html-namespace-0"></a>"および（上で定義されるように暗黙のうちに）HTML名前空間を持つことを意味する。</p>

  <p>属性名がXMLで定義された<a href="http://www.w3.org/TR/xml/#NT-Name"><code data-anolis-xref="">Name</code></a>生成物と一致しかつ、":"（U+003A）文字を含まない場合、属性名は<dfn id="xml-compatible">XML互換</dfn>であると言われる。<a href="references.html#refsXML">[XML]</a></p>

  <p>用語<dfn id="xml-mime-type">XML MIMEタイプ</dfn>は、<a data-anolis-xref="MIME type" href="#mime-type">MIMEタイプ</a><code data-anolis-xref="">text/xml</code>、<code data-anolis-xref="">application/xml</code>、subtypeが4文字"<code data-anolis-xref="">+xml</code>"で終わる任意の<a href="#mime-type">MIMEタイプ</a>を参照するために使用される。<a href="references.html#refsRFC7303">[RFC7303]</a></p>


  <h4 id="dom-trees"><span class="secno">2.1.3</span> DOMツリー</h4>

  <p><dfn id="root-element-of-a-document-object"><code>Document</code>オブジェクトのルート要素</dfn>は、もしあれば、その<code><a href="dom.html#document">Document</a></code>が持つ最初の要素の子である。もしないならば、<code><a href="dom.html#document">Document</a></code>はルート要素を持たない。</p>

  <p><code><a href="dom.html#document">Document</a></code>オブジェクトのルート要素を示さない場合、用語<dfn id="root-element">ルート要素</dfn>は、議論されるノードでの最も遠い先祖要素ノード、または先祖を持たないノード自身を意味する。ノードが文書の一部である場合、ノードの<a href="#root-element">ルート要素</a>は文書のルート要素そのものである。しかし、一般にノードが文書ツリーの一部でないならば、ルート要素は孤立したノードだろう。</p>

  <p>要素の<a href="#root-element">ルート要素</a>が<a href="#root-element-of-a-document-object"><code>Document</code>オブジェクトのルート要素</a>である場合、ノードは<dfn id="in-a-document"><code>Document</code>内</dfn>にあると言われる。ノードの<a href="#root-element">ルート要素</a>が変化してかつ現在の文書の<a href="#root-element">ルート要素</a>である場合、ノードは<dfn data-anolis-xref="insert an element into a document" id="insert-an-element-into-a-document">挿入された文書</dfn>であると言われる。同様に、文書の<a href="#root-element">ルート要素</a>から別の要素に<a href="#root-element">ルート要素</a>が変わる場合、ノードは<dfn data-anolis-xref="remove an element from a
  document" id="remove-an-element-from-a-document">削除された文書</dfn>であると言われる。</p>

  <p>ノードの<dfn id="home-subtree">ホームサブツリー</dfn>は、そのノードの<a href="#root-element">ルート要素</a>をルートとするサブツリーである。ノードが<a href="#in-a-document"><code>Document</code>内に</a>ある場合、ノードの<a href="#home-subtree">ホームサブツリー</a>は、ノードの<code><a href="dom.html#document">Document</a></code>ツリーである。</p>

  <p>（要素のような）ある<code><a href="#node">Node</a></code>の<code><a href="dom.html#document">Document</a></code>は、<code><a href="#node">Node</a></code>の<code data-anolis-xref="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code>IDL属性が返す<code><a href="dom.html#document">Document</a></code>である。ある<code><a href="#node">Node</a></code>が<a href="#in-a-document"><code>Document</code>内に</a>ある場合、その<code><a href="dom.html#document">Document</a></code>は常に<code><a href="#node">Node</a></code>の<code><a href="dom.html#document">Document</a></code>であり、したがって<code><a href="#node">Node</a></code>の<code data-anolis-xref="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code>IDL属性は常にその<code><a href="dom.html#document">Document</a></code>を返す。</p>

  <p>コンテンツ属性の<code><a href="dom.html#document">Document</a></code>は、属性の要素の<code><a href="dom.html#document">Document</a></code>である。</p>

  <p>用語<dfn id="tree-order">ツリー順</dfn>は先行順を意味し、（<code data-anolis-xref="dom-Node-parentNode"><a href="#dom-node-parentnode">parentNode</a></code>/<code data-anolis-xref="dom-Node-childNodes"><a href="#dom-node-childnodes">childNodes</a></code>の関係を通して）DOMノードの縦型走査に関係する。</p>

  <p>When it is stated that some element or attribute is <dfn data-anolis-xref="ignore" id="ignore">ignored</dfn>, or
  treated as some other value, or handled as if it was something else, this refers only to the
  processing of the node after it is in the DOM. <span class="impl">A user agent must not mutate the
  DOM in such situations.</span></p>

  <p>新しい値が前の値と異なっている場合のみ、コンテンツ属性は値を<dfn data-anolis-xref="">変更する</dfn>と言われる。既に持つ属性値を設定することは変更ではない。</p>

  <p>用語<dfn data-anolis-xref="">空</dfn>は、属性値、<code><a href="#text-0">Text</a></code>ノード、または文字列で使用された場合、テキストの長さがゼロであることを意味する（つまり、スペースや<a href="#control-characters">制御文字</a>すら含まない）。</p>


  <h4 id="scripting-0"><span class="secno">2.1.4</span> スクリプティング</h4>

  <p>構造体"<code>Foo</code>オブジェクト"は、<code>Foo</code>が実際にインターフェースである場合、時折より正確な"<code>Foo</code>インターフェースを実装するオブジェクト"の代わりに使用される。</p>

  <p>IDL属性は、その値が（著者のスクリプトなどによって）取得時に<dfn data-anolis-xref="">取得される</dfn>と言われ、新しい値が割り当てられる際に<dfn data-anolis-xref="">設定される</dfn>と言われる。</p>

  <p>If a DOM object is said to be <dfn id="live">live</dfn>, then the attributes and methods on that object
  <span class="impl">must</span> operate on the actual underlying data, not a snapshot of the
  data.</p>

  <p>イベントのコンテキストにおいて、用語<i>発火</i>や<i>送出</i>は、DOM仕様で定義されるとおりに使用される。イベントの<dfn data-anolis-xref="concept-event-fire" id="concept-event-fire">発火</dfn>は、イベントを作成し<a data-anolis-xref="concept-event-dispatch" href="#concept-event-dispatch">送出する</a>ことを意味し、イベントの<dfn data-anolis-xref="concept-event-dispatch" id="concept-event-dispatch">送出</dfn>は、ツリーを介してイベントを伝播する手順を実行することを意味する。用語<dfn data-anolis-xref="concept-events-trusted" id="concept-events-trusted">信頼済みイベント</dfn>は、<code data-anolis-xref="dom-event-isTrusted"><a href="#dom-event-istrusted">isTrusted</a></code>属性がtrueに初期化されたイベントを参照するために使用される。<a href="references.html#refsDOM">[DOM]</a></p>


  <h4 id="plugins"><span class="secno">2.1.5</span> プラグイン</h4>

  <p>用語<dfn id="plugin">プラグイン</dfn>は、<code><a href="dom.html#document">Document</a></code>オブジェクトの属するユーザーエージェントのレンダリングに関与可能な、ユーザーエージェントによって使用されるコンテンツハンドラの組に定義されるユーザーエージェントを参照するが、<code><a href="dom.html#document">Document</a></code>の<a data-anolis-xref="child browsing context" href="browsers.html#child-browsing-context">子ブラウジングコンテキスト</a>として振る舞うことも、任意の<code><a href="#node">Node</a></code>オブジェクトを<code><a href="dom.html#document">Document</a></code>のDOMに導入することもない。</p>

  <p>通常、そのようなコンテンツハンドラは、第三者によって提供される。もっともユーザーエージェントもまた、プラグインとしてビルトインコンテンツのハンドラを指定できる。</p>

  <div class="impl">

  <p>A user agent must not consider the types <code>text/plain</code> and
  <code>application/octet-stream</code> as having a registered <a href="#plugin">plugin</a>.</p><!-- because
  of the way <object> elements handles those types, if nothing else (it also doesn't make any sense
  to have a plugin registered for those types, of course) --> 

  </div>

  <p class="example">プラグインの一例は、ユーザーがPDFファイルを操作するときに<a href="browsers.html#browsing-context">ブラウジングコンテキスト</a>でインスタンスを生成されたPDFビューアであろう。これは、実装されたPDFビューアコンポーネントがユーザーエージェント自身に実装されたものと同じメーカーかどうかにかかわらず、プラグインとしてカウントされるだろう。しかし、ユーザーエージェント（同じインターフェースを使用するのではない）とは別に起動するPDFビューアアプリケーションは、この定義によるプラグインではない。</p>

  <p class="note">プラグインはユーザーエージェント固有かつプラットフォーム固有であることが予測されるので、この仕様はプラグインと情報交換するためのメカニズムを定義しない。一部のユーザーエージェントは、NetscapeプラグインAPIのようなプラグイン機構をサポートすることを選ぶかもしれない。他のユーザーエージェントは、リモートコンテンツコンバータを使用するか、または特定の種類のビルトインサポートを持つかもしれない。実際に、この仕様はユーザーエージェントにプラグインのサポートを一切要求しない。<a href="references.html#refsNPAPI">[NPAPI]</a></p>

  <p><code data-anolis-xref="attr-iframe-sandbox"><a href="embedded-content.html#attr-iframe-sandbox">sandbox</a></code>属性のセマンティックを受け取る場合、プラグインは<dfn data-anolis-xref="concept-plugin-secure" id="concept-plugin-secure">保護される</dfn>だろう。</p>

  <p class="example">たとえば、保護されるプラグインは、プラグインがサンドボックス化される<code><a href="embedded-content.html#the-iframe-element">iframe</a></code>内部でインスタンス化される際、コンテンツがポップアップウィンドウを生成することから防ぐだろう。</p>

  <div class="impl">

  <p class="warning">Browsers should take extreme care when interacting with external content
  intended for <a data-anolis-xref="plugin" href="#plugin">plugins</a>. When third-party software is run with the same
  privileges as the user agent itself, vulnerabilities in the third-party software become as
  dangerous as those in the user agent.</p>

  <p>Since different users having differents sets of <a data-anolis-xref="plugin" href="#plugin">plugins</a> provides a
  fingerprinting vector that increases the chances of users being uniquely identified, user agents
  are encouraged to support the exact same set of <a data-anolis-xref="plugin" href="#plugin">plugins</a> for each
  user.
  
  <span class="fingerprint" title="fingerprinting vector"><a href="introduction.html#fingerprinting-vector"><img alt="(This is a fingerprinting vector.)" height="21" src="http://www.w3.org/TR/html5/images/fingerprint.png" width="15"></a></span>
  </p>

  </div>



  <h4 id="encoding-terminology"><span class="secno">2.1.6</span> 文字エンコーディング</h4>

  <p><dfn data-anolis-xref="encoding" id="encoding">文字エンコーディング</dfn>、または曖昧でない箇所での単に<i><a href="#encoding">エンコーディング</a></i>は、エンコーディング標準で定義されるように、バイトストリームとUnicode文字列との間での変換方法を定義する。<a href="#encoding">エンコーディング</a>は、エンコーディング仕様でエンコーディングの<i>名前</i>および<i>ラベル</i>として参照される、<dfn id="encoding-name">エンコーディング名</dfn>および1つ以上の<dfn data-anolis-xref="encoding label" id="encoding-label">エンコーディングラベル</dfn>を持つ。<a href="references.html#refsENCODING">[ENCODING]</a></p>

  <p><dfn id="ascii-compatible-character-encoding">ASCII互換文字エンコーディング</dfn>は、バイト0x09、0x0A、0x0C、0x0D、0x20-0x22、0x26、0x27、0x2C-0x3F、0x41-0x5Aおよび0x61-0x7Aが単一バイトまたは可変長<a href="#encoding">エンコーディング</a>であり、マルチバイト配列の2バイト目以降のバイトを無視する、Windows-1252においてこれらのバイトと同一のUnicode文字に変換する単一バイトシーケンスに対応する。<a href="references.html#refsENCODING">[ENCODING]</a></p>

  <p class="note">たとえエンコーディングで0x70のようなバイトにとってASCIIとしての解釈とは無関係な、より長いシーケンスの一部である可能性があるとしても、これは、Shift_JIS、HZ-GB-2312およびISO-2022の亜種などのエンコーディングを含む。これは、UTF-7、GSM03.38、およびEBCDICの亜種のような旧式のレガシーエンコーディングを除外する。</p><!--
   We'll have to change that if anyone comes up with a way to have a document that is valid as two
   different encodings at once, with different <meta charset> elements applying in each case.
  -->

  

  <p>用語<dfn id="a-utf-16-encoding">UTF-16エンコーディング</dfn>はUTF-16の任意の変種、BOMのあるなしに関わらず、UTF-16LEまたはUTF-16BEを指す。<a href="references.html#refsENCODING">[ENCODING]</a></p>

  <p>用語<dfn id="code-unit">コード単位</dfn>はWeb IDL仕様で定義されるとおり、16ビット符号なし整数、<code>DOMString</code>の最小の基本コンポーネントとして使用される。（これは、Unicodeで使用されるものより狭い定義であり、<i>コードポイント</i>と同一ではない。）<a href="references.html#refsWEBIDL">[WEBIDL]</a></p>

  <p>用語<dfn id="unicode-code-point">Unicodeコードポイント</dfn>は、可能であれば<i data-anolis-xref="">Unicodeスカラー値</i>を、そうでないならば孤立サロゲートコードポイントを意味する。適合要件が文字またはUnicodeコードポイントの用語で定義される場合、下位サロゲートに続く上位サロゲートから成る<a data-anolis-xref="code unit" href="#code-unit">コード単位</a>のペアは、サロゲートペアで表される単一のコードポイントとして扱われなければならないが、孤立したサロゲートは、サロゲートの値を持つ単一のコードポイントとしてそれぞれ扱われなければならない。<a href="references.html#refsUNICODE">[UNICODE]</a></p>

  <p>この仕様において、用語<dfn id="character">文字</dfn>は、<em>Unicode</em>文字として修飾されてい場合、用語<a href="#unicode-code-point">Unicodeコードポイント</a>と同義である。</p>

  <p>用語<dfn id="unicode-character">Unicode文字</dfn>は、<i data-anolis-xref="">Unicodeスカラー値</i>（すなわち、サロゲートコードポイントでない任意のUnicodeコードポイント）を意味するために使用される。<a href="references.html#refsUNICODE">[UNICODE]</a></p>

  <p>文字列の<dfn id="code-unit-length">コード単位長さ</dfn>は、その文字列の<a data-anolis-xref="code unit" href="#code-unit">コード単位</a>の数である。</p>

  <p class="note">この複雑さは、<a data-anolis-xref="Unicode character" href="#unicode-character">Unicode文字</a>の観点よりむしろ、16ビット（UTF-16）<a data-anolis-xref="code unit" href="#code-unit">コード単位</a>の観点でDOM APIを定義するための歴史的な決定に由来する。</p><!--FIXUP microdata +1--><!--FIXUP 2dcontext +1-->



 


  <h3 id="conformance-requirements"><span class="secno">2.2</span> 適合性要件</h3><!--FIXUP 2dcontext -1--><!--FIXUP microdata -1-->



  <p>この仕様において、すべての図、例、注は非規範的であり、非規範的と明示された節も同様である。この仕様におけるその他すべては規範的である。</p>

  <p>この文書の規範部分においてキーワード"MUST"、"MUST NOT"、"REQUIRED"、"SHOULD"、"SHOULD NOT"、"MAY"、"OPTIONAL"は、RFC 2119で示されたとおりに解釈される。この文書の規範部分でのキーワード"OPTIONALLY"は、"MAY"または"OPTIONAL"としての意味と同一に解釈される。読みやすさのために、これらの単語は本仕様において大文字のみで出現しない。<a href="references.html#refsRFC2119">[RFC2119]</a></p>

  <div class="impl">

  <p>Requirements phrased in the imperative as part of algorithms (such as "strip any leading space
  characters" or "return false and abort these steps") are to be interpreted with the meaning of the
  key word ("must", "should", "may", etc) used in introducing the algorithm.</p>

  <div class="example">

   <p>For example, were the spec to say:</p>

   <pre>To eat an orange, the user must:
1. Peel the orange.
2. Separate each slice of the orange.
3. Eat the orange slices.</pre>

   <p>...it would be equivalent to the following:</p>

   <pre>To eat an orange:
1. The user must peel the orange.
2. The user must separate each slice of the orange.
3. The user must eat the orange slices.</pre>

   <p>Here the key word is "must".</p>

   <p>The former (imperative) style is generally preferred in this specification for stylistic
   reasons.</p>

  </div>

  <p>Conformance requirements phrased as algorithms or specific steps may be implemented in any
  manner, so long as the end result is equivalent. (In particular, the algorithms defined in this
  specification are intended to be easy to follow, and not intended to be performant.)</p>

  </div>


  <div class="impl">

  <h4 id="conformance-classes"><span class="secno">2.2.1 </span>Conformance classes</h4>

  <p>This specification describes the conformance criteria for <span class="impl">user agents
  (relevant to implementors) and</span> documents<span class="impl"> (relevant to authors and
  authoring tool implementors)</span>.</p>

  <p><dfn id="conforming-documents">Conforming documents</dfn> are those that comply with all the conformance criteria for
  documents. For readability, some of these conformance requirements are phrased as conformance
  requirements on authors; such requirements are implicitly requirements on documents: by
  definition, all documents are assumed to have had an author. (In some cases, that author may
  itself be a user agent — such user agents are subject to additional rules, as explained
  below.)</p>

  <p class="example">For example, if a requirement states that "authors must not use the <code data-anolis-xref="">foobar</code> element", it would imply that documents are not allowed to contain elements
  named <code data-anolis-xref="">foobar</code>.</p>

  <p class="note impl">There is no implied relationship between document conformance requirements
  and implementation conformance requirements. User agents are not free to handle non-conformant
  documents as they please; the processing model described in this specification applies to
  implementations regardless of the conformity of the input documents.</p>

  <p>User agents fall into several (overlapping) categories with different conformance
  requirements.</p>

  <dl><dt id="interactive">Web browsers and other interactive user agents</dt>

   <dd>

    <p>Web browsers that support <a href="the-xhtml-syntax.html#the-xhtml-syntax">the XHTML syntax</a> must process elements and attributes
    from the <a href="#html-namespace-0">HTML namespace</a> found in XML documents as described in this specification,
    so that users can interact with them, unless the semantics of those elements have been
    overridden by other specifications.</p>

    <p class="example">A conforming XHTML processor would, upon finding an XHTML <code><a href="scripting-1.html#the-script-element">script</a></code>
    element in an XML document, execute the script contained in that element. However, if the
    element is found within a transformation expressed in XSLT (assuming the user agent also
    supports XSLT), then the processor would instead treat the <code><a href="scripting-1.html#the-script-element">script</a></code> element as an
    opaque element that forms part of the transform.</p>

    <p>Web browsers that support <a href="syntax.html#syntax">the HTML syntax</a> must process documents labeled with an
    <a href="#html-mime-type">HTML MIME type</a> as described in this specification, so that users can interact with
    them.</p>

    <p>User agents that support scripting must also be conforming implementations of the IDL
    fragments in this specification, as described in the Web IDL specification. <a href="references.html#refsWEBIDL">[WEBIDL]</a></p>

    <p class="note">Unless explicitly stated, specifications that override the semantics of HTML
    elements do not override the requirements on DOM objects representing those elements. For
    example, the <code><a href="scripting-1.html#the-script-element">script</a></code> element in the example above would still implement the
    <code><a href="scripting-1.html#htmlscriptelement">HTMLScriptElement</a></code> interface.</p>

   </dd>

   <dt id="non-interactive">Non-interactive presentation user agents</dt>

   <dd>

    <p>User agents that process HTML and XHTML documents purely to render non-interactive versions
    of them must comply to the same conformance criteria as Web browsers, except that they are
    exempt from requirements regarding user interaction.</p>

    <p class="note">Typical examples of non-interactive presentation user agents are printers
    (static UAs) and overhead displays (dynamic UAs). It is expected that most static
    non-interactive presentation user agents will also opt to <a href="#non-scripted">lack scripting
    support</a>.</p>

    <p class="example">A non-interactive but dynamic presentation UA would still execute scripts,
    allowing forms to be dynamically submitted, and so forth. However, since the concept of "focus"
    is irrelevant when the user cannot interact with the document, the UA would not need to support
    any of the focus-related DOM APIs.</p>

   </dd>

   <dt id="renderingUA">Visual user agents that support the suggested default rendering</dt>

   <dd>

    <p>User agents, whether interactive or not, may be designated (possibly as a user option) as
    supporting the suggested default rendering defined by this specification.</p>

    <p>This is not required. In particular, even user agents that do implement the suggested default
    rendering are encouraged to offer settings that override this default to improve the experience
    for the user, e.g. changing the color contrast, using different focus styles, or otherwise
    making the experience more accessible and usable to the user.</p>

    <p>User agents that are designated as supporting the suggested default rendering must, while so
    designated, implement the rules in <a href="rendering.html#rendering">the rendering section</a> that that
    section defines as the behavior that user agents are <em>expected</em> to implement.</p>

   </dd>

   <dt id="non-scripted">User agents with no scripting support</dt>

   <dd>

    <p>Implementations that do not support scripting (or which have their scripting features
    disabled entirely) are exempt from supporting the events and DOM interfaces mentioned in this
    specification. For the parts of this specification that are defined in terms of an events model
    or in terms of the DOM, such user agents must still act as if events and the DOM were
    supported.</p>

    <p class="note">Scripting can form an integral part of an application. Web browsers that do not
    support scripting, or that have scripting disabled, might be unable to fully convey the author's
    intent.</p>

   </dd>


   <dt>Conformance checkers</dt>

   <dd id="conformance-checkers">

    <p>Conformance checkers must verify that a document conforms to the applicable conformance
    criteria described in this specification. Automated conformance checkers are exempt from
    detecting errors that require interpretation of the author's intent (for example, while a
    document is non-conforming if the content of a <code><a href="grouping-content.html#the-blockquote-element">blockquote</a></code> element is not a quote,
    conformance checkers running without the input of human judgement do not have to check that
    <code><a href="grouping-content.html#the-blockquote-element">blockquote</a></code> elements only contain quoted material).</p>

    <p>Conformance checkers must check that the input document conforms when parsed without a
    <a href="browsers.html#browsing-context">browsing context</a> (meaning that no scripts are run, and that the parser's
    <a href="syntax.html#scripting-flag">scripting flag</a> is disabled), and should also check that the input document conforms
    when parsed with a <a href="browsers.html#browsing-context">browsing context</a> in which scripts execute, and that the scripts
    never cause non-conforming states to occur other than transiently during script execution
    itself. (This is only a "SHOULD" and not a "MUST" requirement because it has been proven to be
    impossible. <a href="references.html#refsCOMPUTABLE">[COMPUTABLE]</a>)</p>

    <p>The term "HTML validator" can be used to refer to a conformance checker that itself conforms
    to the applicable requirements of this specification.</p>

    <div class="note">

     <p>XML DTDs cannot express all the conformance requirements of this specification. Therefore, a
     validating XML processor and a DTD cannot constitute a conformance checker. Also, since neither
     of the two authoring formats defined in this specification are applications of SGML, a
     validating SGML system cannot constitute a conformance checker either.</p>

     <p>To put it another way, there are three types of conformance criteria:</p>

     <ol><li>Criteria that can be expressed in a DTD.</li>

      <li>Criteria that cannot be expressed by a DTD, but can still be checked by a machine.</li>

      <li>Criteria that can only be checked by a human.</li>

     </ol><p>A conformance checker must check for the first two. A simple DTD-based validator only checks
     for the first class of errors and is therefore not a conforming conformance checker according
     to this specification.</p>

    </div>
   </dd>


   <dt>Data mining tools</dt>

   <dd id="data-mining">

    <p>Applications and tools that process HTML and XHTML documents for reasons other than to either
    render the documents or check them for conformance should act in accordance with the semantics
    of the documents that they process.</p>

    <p class="example">A tool that generates <a data-anolis-xref="outline" href="sections.html#outline">document outlines</a> but
    increases the nesting level for each paragraph and does not increase the nesting level for each
    section would not be conforming.</p>

   </dd>


   <dt id="editors">Authoring tools and markup generators</dt>

   <dd>

    <p>Authoring tools and markup generators must generate <a href="#conforming-documents">conforming documents</a>.
    Conformance criteria that apply to authors also apply to authoring tools, where appropriate.</p>

    <p>Authoring tools are exempt from the strict requirements of using elements only for their
    specified purpose, but only to the extent that authoring tools are not yet able to determine
    author intent. However, authoring tools must not automatically misuse elements or encourage
    their users to do so.</p>

    <p class="example">For example, it is not conforming to use an <code><a href="sections.html#the-address-element">address</a></code> element for
    arbitrary contact information; that element can only be used for marking up contact information
    for the author of the document or section. However, since an authoring tool is likely unable to
    determine the difference, an authoring tool is exempt from that requirement. This does not mean,
    though, that authoring tools can use <code><a href="sections.html#the-address-element">address</a></code> elements for any block of italics text
    (for instance); it just means that the authoring tool doesn't have to verify that when the user
    uses a tool for inserting contact information for a section, that the user really is doing that
    and not inserting something else instead.</p>

    <p class="note">In terms of conformance checking, an editor has to output documents that conform
    to the same extent that a conformance checker will verify.</p>

    <p>When an authoring tool is used to edit a non-conforming document, it may preserve the
    conformance errors in sections of the document that were not edited during the editing session
    (i.e. an editing tool is allowed to round-trip erroneous content). However, an authoring tool
    must not claim that the output is conformant if errors have been so preserved.</p>

    <p>Authoring tools are expected to come in two broad varieties: tools that work from structure
    or semantic data, and tools that work on a What-You-See-Is-What-You-Get media-specific editing
    basis (WYSIWYG).</p>

    <p>The former is the preferred mechanism for tools that author HTML, since the structure in the
    source information can be used to make informed choices regarding which HTML elements and
    attributes are most appropriate.</p>

    <p>However, WYSIWYG tools are legitimate. WYSIWYG tools should use elements they know are
    appropriate, and should not use elements that they do not know to be appropriate. This might in
    certain extreme cases mean limiting the use of flow elements to just a few elements, like
    <code><a href="grouping-content.html#the-div-element">div</a></code>, <code><a href="text-level-semantics.html#the-b-element">b</a></code>, <code><a href="text-level-semantics.html#the-i-element">i</a></code>, and <code><a href="text-level-semantics.html#the-span-element">span</a></code> and making liberal use
    of the <code data-anolis-xref="attr-style"><a href="dom.html#the-style-attribute">style</a></code> attribute.</p>

    <p>All authoring tools, whether WYSIWYG or not, should make a best effort attempt at enabling
    users to create well-structured, semantically rich, media-independent content.</p>

   </dd>

  </dl><p id="hardwareLimitations">User agents may impose implementation-specific limits on otherwise
  unconstrained inputs, e.g. to prevent denial of service attacks, to guard against running out of
  memory, or to work around platform-specific limitations.
  
  <span class="fingerprint" title="fingerprinting vector"><a href="introduction.html#fingerprinting-vector"><img alt="(This is a fingerprinting vector.)" height="21" src="http://www.w3.org/TR/html5/images/fingerprint.png" width="15"></a></span>
  </p>

  <p>For compatibility with existing content and prior specifications, this specification describes
  two authoring formats: one based on XML (referred to as <a href="the-xhtml-syntax.html#the-xhtml-syntax">the XHTML syntax</a>), and one
  using a <a href="syntax.html#writing">custom format</a> inspired by SGML (referred to as <a href="syntax.html#syntax">the HTML
  syntax</a>). Implementations must support at least one of these two formats, although
  supporting both is encouraged.</p>

  <p>Some conformance requirements are phrased as requirements on elements, attributes, methods or
  objects. Such requirements fall into two categories: those describing content model restrictions,
  and those describing implementation behavior. Those in the former category are requirements on
  documents and authoring tools. Those in the second category are requirements on user agents.
  Similarly, some conformance requirements are phrased as requirements on authors; such requirements
  are to be interpreted as conformance requirements on the documents that authors produce. (In other
  words, this specification does not distinguish between conformance criteria on authors and
  conformance criteria on documents.)</p>

  </div>


  <div class="impl">

  <h4 id="dependencies"><span class="secno">2.2.2 </span>Dependencies</h4>

  <p>This specification relies on several other underlying specifications.</p>

  <dl><dt>Unicode and Encoding</dt>

   <dd>

    <p>The Unicode character set is used to represent textual data, and the Encoding standard
    defines requirements around <a data-anolis-xref="encoding" href="#encoding">character encodings</a>. <a href="references.html#refsUNICODE">[UNICODE]</a></p>

    <p class="note">This specification <a href="#encoding-terminology">introduces terminology</a>
    based on the terms defined in those specifications, as described earlier.</p>

    <p>The following terms are used as defined in the Encoding standard: <a href="references.html#refsENCODING">[ENCODING]</a></p>

    <ul class="brief"><li><dfn id="getting-an-encoding">Getting an encoding</dfn>

     </li><li>The <dfn id="encoder">encoder</dfn> and <dfn id="decoder">decoder</dfn> algorithms for various encodings, including
     the <dfn id="utf-8-encoder">UTF-8 encoder</dfn> and <dfn id="utf-8-decoder">UTF-8 decoder</dfn>

     </li><li>The generic <dfn id="decode">decode</dfn> algorithm which takes a byte stream and an encoding and
     returns a character stream

     

     </li><li>The <dfn id="utf-8-decode">UTF-8 decode</dfn> algorithm which takes a byte stream and returns a character
     stream, additionally stripping one leading UTF-8 Byte Order Mark (BOM), if any

    

    </li></ul><p class="note">The <a href="#utf-8-decoder">UTF-8 decoder</a> is distinct from the <i>UTF-8 decode
    algorithm</i>. The latter first strips a Byte Order Mark (BOM), if any, and then invokes the
    former.</p>

    <p>For readability, character encodings are sometimes referenced in this specification with a
    case that differs from the canonical case given in the Encoding standard. (For example,
    "UTF-16LE" instead of "utf-16le".)</p>

   </dd>


   <dt>XML</dt>

   <dd>

    <p>Implementations that support <a href="the-xhtml-syntax.html#the-xhtml-syntax">the XHTML syntax</a> must support some version of XML,
    as well as its corresponding namespaces specification, because that syntax uses an XML
    serialization with namespaces. <a href="references.html#refsXML">[XML]</a> <a href="references.html#refsXMLNS">[XMLNS]</a></p>

   </dd>


   <dt>URLs</dt>

   <dd>

    <p>The following terms are defined in the WHATWG URL standard: <a href="references.html#refsURL">[URL]</a></p>

    <ul class="brief"><li><dfn id="url">URL</dfn>
     </li><li><dfn id="absolute-url">Absolute URL</dfn>
     </li><li><dfn id="relative-url">Relative URL</dfn>
     </li><li><dfn data-anolis-xref="concept-url-scheme-relative" id="concept-url-scheme-relative">Relative schemes</dfn>
     </li><li>The <dfn id="url-parser">URL parser</dfn>
     </li><li><dfn id="parsed-url">Parsed URL</dfn>
     </li><li>The <dfn data-anolis-xref="concept-url-scheme" id="concept-url-scheme">scheme</dfn> component of a <a href="#parsed-url">parsed URL</a>
     </li><li>The <dfn data-anolis-xref="concept-url-scheme-data" id="concept-url-scheme-data">scheme data</dfn> component of a <a href="#parsed-url">parsed URL</a>
     </li><li>The <dfn data-anolis-xref="concept-url-username" id="concept-url-username">username</dfn> component of a <a href="#parsed-url">parsed URL</a>
     </li><li>The <dfn data-anolis-xref="concept-url-password" id="concept-url-password">password</dfn> component of a <a href="#parsed-url">parsed URL</a>
     </li><li>The <dfn data-anolis-xref="concept-url-host" id="concept-url-host">host</dfn> component of a <a href="#parsed-url">parsed URL</a>
     </li><li>The <dfn data-anolis-xref="concept-url-port" id="concept-url-port">port</dfn> component of a <a href="#parsed-url">parsed URL</a>
     </li><li>The <dfn data-anolis-xref="concept-url-path" id="concept-url-path">path</dfn> component of a <a href="#parsed-url">parsed URL</a>
     </li><li>The <dfn data-anolis-xref="concept-url-query" id="concept-url-query">query</dfn> component of a <a href="#parsed-url">parsed URL</a>
     </li><li>The <dfn data-anolis-xref="concept-url-fragment" id="concept-url-fragment">fragment</dfn> component of a <a href="#parsed-url">parsed URL</a>
     </li><li><dfn data-anolis-xref="concept-url-parse-error" id="concept-url-parse-error">Parse errors</dfn> from the <a href="#url-parser">URL parser</a>
     </li><li>The <dfn data-anolis-xref="concept-url-serializer" id="concept-url-serializer">URL serializer</dfn>
     </li><li><dfn id="default-encode-set">Default encode set</dfn>
     </li><li><dfn id="percent-encode">Percent encode</dfn>
     </li><li><dfn id="utf-8-percent-encode">UTF-8 percent encode</dfn>
     </li><li><dfn id="percent-decode">Percent decode</dfn>
     </li><li><dfn id="decoder-error">Decoder error</dfn>
     </li><li>The <dfn id="domain-label-to-ascii">domain label to ASCII</dfn> algorithm</li>
     <li>The <dfn id="domain-label-to-unicode">domain label to Unicode</dfn> algorithm</li>
     <li><dfn id="urlutils"><code>URLUtils</code></dfn> interface
     
     </li><li><dfn id="urlutilsreadonly"><code>URLUtilsReadOnly</code></dfn> interface
     
     </li><li><dfn data-anolis-xref="dom-url-href" id="dom-url-href"><code>href</code> attribute</dfn>
     </li><li><dfn data-anolis-xref="dom-url-protocol" id="dom-url-protocol"><code>protocol</code> attribute</dfn>
     </li><li>The <dfn data-anolis-xref="concept-uu-get-the-base" id="concept-uu-get-the-base">get the base</dfn> hook for <code><a href="#urlutils">URLUtils</a></code>
     </li><li>The <dfn data-anolis-xref="concept-uu-update" id="concept-uu-update">update steps</dfn> hook for <code><a href="#urlutils">URLUtils</a></code>
     </li><li>The <dfn data-anolis-xref="concept-uu-set-the-input" id="concept-uu-set-the-input">set the input</dfn> algorithm for <code><a href="#urlutils">URLUtils</a></code>
     </li><li>The <dfn data-anolis-xref="concept-uu-query-encoding" id="concept-uu-query-encoding">query encoding</dfn> of an <code><a href="#urlutils">URLUtils</a></code> object
     
     </li><li>The <dfn data-anolis-xref="concept-uu-input" id="concept-uu-input">input</dfn> of an <code><a href="#urlutils">URLUtils</a></code> object
     
     </li><li>The <dfn data-anolis-xref="concept-uu-url" id="concept-uu-url">url</dfn> of an <code><a href="#urlutils">URLUtils</a></code> object
    
    </li></ul></dd>


   <dt>Cookies</dt>

   <dd>

    <p>The following terms are defined in the Cookie specification: <a href="references.html#refsCOOKIES">[COOKIES]</a></p>

    <ul class="brief"><li><dfn id="cookie-string">cookie-string</dfn>
     </li><li><dfn id="receives-a-set-cookie-string">receives a set-cookie-string</dfn>
    </li></ul></dd>


   <dt>Fetch</dt>

   <dd>

    <p>The following terms are defined in the WHATWG Fetch specification: <a href="references.html#refsFETCH">[FETCH]</a></p>

    <ul class="brief"><li><dfn id="cross-origin-request">cross-origin request</dfn>
     </li><li><dfn id="cross-origin-request-status">cross-origin request status</dfn>
     </li><li><dfn id="custom-request-headers">custom request headers</dfn>
     </li><li><dfn id="simple-cross-origin-request">simple cross-origin request</dfn>
     </li><li><dfn id="redirect-steps">redirect steps</dfn>
     </li><li><dfn id="omit-credentials-flag">omit credentials flag</dfn>
     </li><li><dfn id="resource-sharing-check">resource sharing check</dfn>
    </li></ul><p class="note">This specification does not yet use the "fetch" algorithm from the WHATWG Fetch
    specification. It will be updated to do so in due course.</p>

   </dd><!--TOPIC:DOM APIs-->




   <dt>Web IDL</dt>

   <dd>

    <p>The IDL fragments in this specification must be interpreted as required for conforming IDL
    fragments, as described in the Web IDL specification. <a href="references.html#refsWEBIDL">[WEBIDL]</a></p>

    <p>The terms <dfn id="supported-property-indices">supported property indices</dfn>, <dfn id="determine-the-value-of-an-indexed-property">determine the value of an indexed
    property</dfn>, <dfn id="support-named-properties">support named properties</dfn>, <dfn id="supported-property-names">supported property names</dfn>,
    <dfn id="unenumerable">unenumerable</dfn>, <dfn id="determine-the-value-of-a-named-property">determine the value of a named property</dfn>, <dfn id="platform-array-objects">platform array
    objects</dfn>, and <dfn data-anolis-xref="dfn-read-only-array" id="dfn-read-only-array">read only</dfn> (when applied to arrays)
    are used as defined in the Web IDL specification. The algorithm to <dfn id="convert-a-domstring-to-a-sequence-of-unicode-characters">convert a DOMString to a
    sequence of Unicode characters</dfn> is similarly that defined in the Web IDL specification.</p>

    <p>When this specification requires a user agent to <dfn id="create-a-date-object">create a <code>Date</code> object</dfn>
    representing a particular time (which could be the special value Not-a-Number), the milliseconds
    component of that time, if any, must be truncated to an integer, and the time value of the newly
    created <code>Date</code> object must represent the resulting truncated time.</p>

    <p class="example">For instance, given the time 23045 millionths of a second after 01:00 UTC on
    January 1st 2000, i.e. the time 2000-01-01T00:00:00.023045Z, then the <code>Date</code> object
    created representing that time would represent the same time as that created representing the
    time 2000-01-01T00:00:00.023Z, 45 millionths earlier. If the given time is NaN, then the result
    is a <code>Date</code> object that represents a time value NaN (indicating that the object does
    not represent a specific instant of time).</p>

   </dd>


   <dt>JavaScript</dt>

   <dd>

    <p>Some parts of the language described by this specification only support JavaScript as the
    underlying scripting language. <a href="references.html#refsECMA262">[ECMA262]</a></p>

    <p class="note">The term "JavaScript" is used to refer to ECMA262, rather than the official term
    ECMAScript, since the term JavaScript is more widely known. Similarly, the <a href="#mime-type">MIME
    type</a> used to refer to JavaScript in this specification is <code data-anolis-xref="">text/javascript</code>, since that is the most commonly used type, <a data-anolis-xref="willful
    violation" href="introduction.html#willful-violation">despite it being an officially obsoleted type</a> according to RFC 4329. <a href="references.html#refsRFC4329">[RFC4329]</a></p>

    <p>The term <dfn id="javascript-global-environment">JavaScript global environment</dfn> refers to the <i data-anolis-xref="">global
    environment</i> concept defined in the ECMAScript specification.</p>

    <p>The ECMAScript <dfn data-anolis-xref="js-SyntaxError" id="js-syntaxerror"><code>SyntaxError</code></dfn> exception is also
    defined in the ECMAScript specification. <a href="references.html#refsECMA262">[ECMA262]</a></p>

    <p>The <dfn id="arraybuffer">ArrayBuffer</dfn> and related object types and underlying concepts from the
    ECMAScript Specification are used for several features in this specification. <a href="references.html#refsECMA262">[ECMA262]</a></p>

    <p>The following helper IDL is used for referring to <code><a href="#arraybuffer">ArrayBuffer</a></code>-related types:</p>

    <pre class="idl">typedef (<dfn id="int8array">Int8Array</dfn> or <dfn id="uint8array">Uint8Array</dfn> or <dfn id="uint8clampedarray">Uint8ClampedArray</dfn> or
         <dfn id="int16array">Int16Array</dfn> or <dfn id="uint16array">Uint16Array</dfn> or
         <dfn id="int32array">Int32Array</dfn> or <dfn id="uint32array">Uint32Array</dfn> or
         <dfn id="float32array">Float32Array</dfn> or <dfn id="float64array">Float64Array</dfn> or
         <dfn id="dataview">DataView</dfn>) <dfn id="arraybufferview">ArrayBufferView</dfn>;</pre>

    <p class="note">In particular, the <code><a href="#uint8clampedarray">Uint8ClampedArray</a></code> type is used by some <span data-anolis-xref="ImageData">2D canvas APIs</span>, and the <span><code>WebSocket</code> API</span>
    uses <code><a href="#arraybuffer">ArrayBuffer</a></code> objects for handling binary frames.</p>

   </dd>


   <dt>DOM</dt>

   <dd>

    <p>The Document Object Model (DOM) is a representation — a model — of a document and
    its content. The DOM is not just an API; the conformance criteria of HTML implementations are
    defined, in this specification, in terms of operations on the DOM. <a href="references.html#refsDOM">[DOM]</a></p>

    <p>Implementations must support DOM and the events defined in DOM Events, because this
    specification is defined in terms of the DOM, and some of the features are defined as extensions
    to the DOM interfaces. <a href="references.html#refsDOM">[DOM]</a> <a href="references.html#refsDOMEVENTS">[DOMEVENTS]</a></p>

    <p>In particular, the following features are defined in the DOM specification: <a href="references.html#refsDOM">[DOM]</a></p><!-- aka DOM Core or DOMCORE --> 

    <ul class="brief"><li><dfn id="attr"><code>Attr</code></dfn> interface</li>
     <li><dfn id="comment-0"><code>Comment</code></dfn> interface</li>
     <li><dfn id="domimplementation"><code>DOMImplementation</code></dfn> interface</li>
     <li><dfn data-anolis-xref="DOM Document" id="dom-document"><code>Document</code></dfn> interface</li>
     <li><dfn id="xmldocument"><code>XMLDocument</code></dfn> interface</li>
     <li><dfn id="documentfragment"><code>DocumentFragment</code></dfn> interface</li>
     <li><dfn id="documenttype"><code>DocumentType</code></dfn> interface</li>
     <li><dfn id="domexception"><code>DOMException</code></dfn> interface</li>
     <li><dfn id="childnode"><code>ChildNode</code></dfn> interface</li>
     <li><dfn id="element"><code>Element</code></dfn> interface</li>
     <li><dfn id="node"><code>Node</code></dfn> interface</li>
     <li><dfn id="nodelist"><code>NodeList</code></dfn> interface</li>
     <li><dfn id="processinginstruction"><code>ProcessingInstruction</code></dfn> interface</li>
     <li><dfn id="text-0"><code>Text</code></dfn> interface</li>

     <li><dfn id="htmlcollection"><code>HTMLCollection</code></dfn> interface</li>
     <li><dfn data-anolis-xref="dom-HTMLCollection-item" id="dom-htmlcollection-item"><code>item()</code></dfn> method</li>
     <li>The terms <dfn id="collections-0">collections</dfn> and <dfn id="represented-by-the-collection">represented by the collection</dfn></li>

     <li><dfn id="domtokenlist"><code>DOMTokenList</code></dfn> interface</li>
     <li><dfn id="domsettabletokenlist"><code>DOMSettableTokenList</code></dfn> interface</li>

     <li><dfn data-anolis-xref="dom-DOMImplementation-createDocument" id="dom-domimplementation-createdocument"><code>createDocument()</code></dfn> method</li>
     <li><dfn data-anolis-xref="dom-DOMImplementation-createHTMLDocument" id="dom-domimplementation-createhtmldocument"><code>createHTMLDocument()</code></dfn> method</li>
     <li><dfn data-anolis-xref="dom-Document-createElement" id="dom-document-createelement"><code>createElement()</code></dfn> method</li>
     <li><dfn data-anolis-xref="dom-Document-createElementNS" id="dom-document-createelementns"><code>createElementNS()</code></dfn> method</li>
     <li><dfn data-anolis-xref="dom-Document-getElementById" id="dom-document-getelementbyid"><code>getElementById()</code></dfn> method</li>
     <li><dfn data-anolis-xref="dom-Node-insertBefore" id="dom-node-insertbefore"><code>insertBefore()</code></dfn> method</li>

     <li><dfn data-anolis-xref="dom-Node-ownerDocument" id="dom-node-ownerdocument"><code>ownerDocument</code></dfn> attribute</li>
     <li><dfn data-anolis-xref="dom-Node-childNodes" id="dom-node-childnodes"><code>childNodes</code></dfn> attribute</li>
     <li><dfn data-anolis-xref="dom-Node-localName" id="dom-node-localname"><code>localName</code></dfn> attribute</li>
     <li><dfn data-anolis-xref="dom-Node-parentNode" id="dom-node-parentnode"><code>parentNode</code></dfn> attribute</li>
     <li><dfn data-anolis-xref="dom-Node-namespaceURI" id="dom-node-namespaceuri"><code>namespaceURI</code></dfn> attribute</li>
     <li><dfn data-anolis-xref="dom-Element-tagName" id="dom-element-tagname"><code>tagName</code></dfn> attribute</li>
     <li><dfn data-anolis-xref="dom-Element-id" id="dom-element-id"><code>id</code></dfn> attribute</li>
     <li><dfn id="textcontent"><code>textContent</code></dfn> attribute</li>

     <li>The <dfn data-anolis-xref="concept-node-insert" id="concept-node-insert">insert</dfn>, <dfn data-anolis-xref="concept-node-append" id="concept-node-append">append</dfn>, <dfn data-anolis-xref="concept-node-remove" id="concept-node-remove">remove</dfn>, <dfn data-anolis-xref="concept-node-replace" id="concept-node-replace">replace</dfn>, and <dfn data-anolis-xref="concept-node-adopt" id="concept-node-adopt">adopt</dfn> algorithms for nodes</li>
     <li>The <dfn id="nodes-are-inserted">nodes are inserted</dfn> and <dfn id="nodes-are-removed">nodes are removed</dfn> concepts</li>
     <li>An element's <dfn data-anolis-xref="concept-node-adopt-ext" id="concept-node-adopt-ext">adopting steps</dfn></li>
     <li>The <dfn id="attribute-list">attribute list</dfn> concept.</li>
     <li>The <dfn data-anolis-xref="concept-cd-data" id="concept-cd-data">data</dfn> of a text node.</li>

     <li><dfn id="event"><code>Event</code></dfn> interface</li>
     <li><dfn id="eventtarget"><code>EventTarget</code></dfn> interface</li>
     <li><dfn id="eventinit"><code>EventInit</code></dfn> dictionary type</li>
     <li><dfn data-anolis-xref="dom-Event-target" id="dom-event-target"><code>target</code></dfn> attribute</li>
     <li><dfn data-anolis-xref="dom-Event-isTrusted" id="dom-event-istrusted"><code>isTrusted</code></dfn> attribute</li>
     <li>The <dfn data-anolis-xref="concept-event-type" id="concept-event-type">type</dfn> of an event</li>
     <li>The concept of an <dfn data-anolis-xref="concept-event-listener" id="concept-event-listener">event listener</dfn> and the <a data-anolis-xref="concept-event-listener" href="#concept-event-listener">event listeners</a> associated with an <code><a href="#eventtarget">EventTarget</a></code></li>
     <li>The concept of a <dfn id="target-override">target override</dfn></li>
     <li>The concept of a regular <dfn id="event-parent">event parent</dfn> and a <dfn id="cross-boundary-event-parent">cross-boundary event parent</dfn></li><!-- see bug 18780 --> 

     <li>The <dfn data-anolis-xref="document's character encoding" id="document's-character-encoding">encoding</dfn> (herein the <i>character encoding</i>) and <dfn data-anolis-xref="concept-document-content-type" id="concept-document-content-type">content type</dfn> of a <code><a href="dom.html#document">Document</a></code></li>
     <li>The distinction between <dfn id="xml-documents">XML documents</dfn> and <dfn id="html-documents">HTML documents</dfn></li>
     <li>The terms <dfn id="quirks-mode">quirks mode</dfn>, <dfn id="limited-quirks-mode">limited-quirks mode</dfn>, and <dfn id="no-quirks-mode">no-quirks mode</dfn></li>
     <li>The algorithm to <dfn data-anolis-xref="concept-node-clone" id="concept-node-clone">clone</dfn> a <code><a href="#node">Node</a></code>, and the concept of <dfn data-anolis-xref="concept-node-clone-ext" id="concept-node-clone-ext">cloning steps</dfn> used by that algorithm</li>
     <li>The concept of <dfn id="base-url-change-steps">base URL change steps</dfn> and the definition of what happens when an element is <dfn id="affected-by-a-base-url-change">affected by a base URL change</dfn></li>
     <li>The concept of an element's <dfn data-anolis-xref="concept-id" id="concept-id">unique identifier (ID)</dfn></li>

     <li>The concept of a DOM <dfn data-anolis-xref="concept-range" id="concept-range">range</dfn>, and the terms <dfn data-anolis-xref="concept-range-start" id="concept-range-start">start</dfn>, <dfn data-anolis-xref="concept-range-end" id="concept-range-end">end</dfn>, and <dfn data-anolis-xref="concept-range-bp" id="concept-range-bp">boundary point</dfn> as applied to ranges.</li>

     <li><dfn id="mutationobserver"><code>MutationObserver</code></dfn> interface</li>
     <li>The <dfn data-anolis-xref="concept-mo-invoke" id="concept-mo-invoke">invoke <code>MutationObserver</code> objects</dfn> algorithm</li>

     <li><dfn id="promise">Promise</dfn> interface</li>
     <li>The <dfn data-anolis-xref="concept-resolver" id="concept-resolver">resolver</dfn> concept</li>
     <li>The <dfn data-anolis-xref="concept-resolver-fulfill" id="concept-resolver-fulfill">fulfill</dfn> and <dfn data-anolis-xref="concept-resolver-reject" id="concept-resolver-reject">reject</dfn> algorithms</li>

    </ul><p>The term <dfn id="throw">throw</dfn> in this specification is used as defined in the DOM specification.
    The following <code><a href="#domexception">DOMException</a></code> types are defined in the DOM specification: <a href="references.html#refsDOM">[DOM]</a></p>

    <ol class="brief"><li value="1"><dfn id="indexsizeerror"><code>IndexSizeError</code></dfn></li>
     <li value="3"><dfn id="hierarchyrequesterror"><code>HierarchyRequestError</code></dfn></li>
     <li value="4"><dfn id="wrongdocumenterror"><code>WrongDocumentError</code></dfn></li>
     <li value="5"><dfn id="invalidcharactererror"><code>InvalidCharacterError</code></dfn></li>
     <li value="7"><dfn id="nomodificationallowederror"><code>NoModificationAllowedError</code></dfn></li>
     <li value="8"><dfn id="notfounderror"><code>NotFoundError</code></dfn></li>
     <li value="9"><dfn id="notsupportederror"><code>NotSupportedError</code></dfn></li>
     <li value="11"><dfn id="invalidstateerror"><code>InvalidStateError</code></dfn></li>
     <li value="12"><dfn id="syntaxerror"><code>SyntaxError</code></dfn></li>
     <li value="13"><dfn id="invalidmodificationerror"><code>InvalidModificationError</code></dfn></li>
     <li value="14"><dfn id="namespaceerror"><code>NamespaceError</code></dfn></li>
     <li value="15"><dfn id="invalidaccesserror"><code>InvalidAccessError</code></dfn></li>
     <li value="18"><dfn id="securityerror"><code>SecurityError</code></dfn></li>
     <li value="19"><dfn id="networkerror"><code>NetworkError</code></dfn></li>
     <li value="20"><dfn id="aborterror"><code>AbortError</code></dfn></li>
     <li value="21"><dfn id="urlmismatcherror"><code>URLMismatchError</code></dfn></li>
     <li value="22"><dfn id="quotaexceedederror"><code>QuotaExceededError</code></dfn></li>
     <li value="23"><dfn id="timeouterror"><code>TimeoutError</code></dfn></li>
     <li value="24"><dfn id="invalidnodetypeerror"><code>InvalidNodeTypeError</code></dfn></li>
     <li value="25"><dfn id="datacloneerror"><code>DataCloneError</code></dfn></li>
    </ol><p class="example">For example, to <i>throw a <code><a href="#timeouterror">TimeoutError</a></code> exception</i>, a user
    agent would construct a <code><a href="#domexception">DOMException</a></code> object whose type was the string "<code data-anolis-xref="">TimeoutError</code>" (and whose code was the number 23, for legacy reasons) and
    actually throw that object as an exception.</p>

    <p>The following features are defined in the DOM Events specification: <a href="references.html#refsDOMEVENTS">[DOMEVENTS]</a></p>

    <ul class="brief"><li><dfn id="mouseevent"><code>MouseEvent</code></dfn> interface</li>
     <li><dfn id="mouseeventinit"><code>MouseEventInit</code></dfn> dictionary type</li>

     <li>The <dfn id="focusevent"><code>FocusEvent</code></dfn> interface and its <dfn data-anolis-xref="dom-FocusEvent-relatedTarget" id="dom-focusevent-relatedtarget"><code>relatedTarget</code></dfn> attribute</li>

     <li>The <dfn id="uievent"><code>UIEvent</code></dfn> interface's <dfn data-anolis-xref="dom-UIEvent-detail" id="dom-uievent-detail"><code>detail</code></dfn> attribute</li>

     <li><dfn data-anolis-xref="event-click" id="event-click"><code>click</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-dblclick" id="event-dblclick"><code>dblclick</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-mousedown" id="event-mousedown"><code>mousedown</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-mouseenter" id="event-mouseenter"><code>mouseenter</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-mouseleave" id="event-mouseleave"><code>mouseleave</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-mousemove" id="event-mousemove"><code>mousemove</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-mouseout" id="event-mouseout"><code>mouseout</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-mouseover" id="event-mouseover"><code>mouseover</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-mouseup" id="event-mouseup"><code>mouseup</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-mousewheel" id="event-mousewheel"><code>mousewheel</code></dfn> event</li>

     <li><dfn data-anolis-xref="event-keydown" id="event-keydown"><code>keydown</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-keyup" id="event-keyup"><code>keyup</code></dfn> event</li>
     <li><dfn data-anolis-xref="event-keypress" id="event-keypress"><code>keypress</code></dfn> event</li>

    </ul><p>The following features are defined in the Touch Events specification: <a href="references.html#refsTOUCH">[TOUCH]</a></p>

    <ul class="brief"><li><dfn id="touch"><code>Touch</code></dfn> interface</li>

     <li><dfn id="touch-point">Touch point</dfn> concept</li>

    </ul><p>This specification sometimes uses the term <dfn data-anolis-xref="">name</dfn> to refer to the event's
    <code data-anolis-xref="dom-event-type">type</code>; as in, "an event named <code data-anolis-xref="">click</code>"
    or "if the event name is <code data-anolis-xref="">keypress</code>". The terms "name" and "type" for
    events are synonymous.</p>

    <p>The following features are defined in the DOM Parsing and Serialization specification: <a href="references.html#refsDOMPARSING">[DOMPARSING]</a></p>

    <ul class="brief"><li><dfn data-anolis-xref="dom-innerHTML" id="dom-innerhtml"><code>innerHTML</code></dfn></li>
     <li><dfn data-anolis-xref="dom-outerHTML" id="dom-outerhtml"><code>outerHTML</code></dfn></li>
    </ul><p class="note">User agents are also encouraged to implement the features described in the
    <cite>HTML Editing APIs</cite> and <cite><code>UndoManager</code> and DOM Transaction</cite>
    specifications.
    <a href="references.html#refsEDITING">[EDITING]</a>
    <a href="references.html#refsUNDO">[UNDO]</a>
    </p>

    <p>The following parts of the Fullscreen specification are referenced from this specification,
    in part to define the rendering of <code><a href="interactive-elements.html#the-dialog-element">dialog</a></code> elements, and also to define how the
    Fullscreen API interacts with the sandboxing features in HTML: <a href="references.html#refsFULLSCREEN">[FULLSCREEN]</a></p>

    <ul class="brief"><li>The <dfn id="top-layer">top layer</dfn> concept</li>
     <li><dfn data-anolis-xref="dom-element-requestFullscreen" id="dom-element-requestfullscreen"><code>requestFullscreen()</code></dfn>
     </li><li>The <dfn id="fullscreen-enabled-flag">fullscreen enabled flag</dfn></li>
     <li>The <dfn id="fully-exit-fullscreen">fully exit fullscreen</dfn> algorithm</li>
    </ul></dd>



   <dt>File API</dt>

   <dd>

    <p>This specification uses the following features defined in the File API specification: <a href="references.html#refsFILEAPI">[FILEAPI]</a></p>

    <ul class="brief"><li><dfn id="blob"><code>Blob</code></dfn></li>
     <li><dfn id="file"><code>File</code></dfn></li>
     <li><dfn id="filelist"><code>FileList</code></dfn></li>
     <li><dfn data-anolis-xref="dom-Blob-close" id="dom-blob-close"><code>Blob.close()</code></dfn></li>
     <li><dfn data-anolis-xref="dom-Blob-type" id="dom-blob-type"><code>Blob.type</code></dfn></li>
     <li>The concept of <dfn data-anolis-xref="file-error-read" id="file-error-read">read errors</dfn></li>
    </ul></dd>


   <dt>XMLHttpRequest</dt>

   <dd>

    <p>This specification references the XMLHttpRequest specification to describe how the two
    specifications interact and to use its <code><a href="#progressevent">ProgressEvent</a></code> features. The following
    features and terms are defined in the XMLHttpRequest specification: <a href="references.html#refsXHR">[XHR]</a></p>

    <ul class="brief"><li><dfn id="xmlhttprequest"><code>XMLHttpRequest</code></dfn>
     </li><li><dfn id="progressevent"><code>ProgressEvent</code></dfn>
     </li><li><dfn data-anolis-xref="fire a progress event" id="fire-a-progress-event">Fire a progress event named <var data-anolis-xref="">e</var></dfn>

    </li></ul></dd>

   <dt>Server-Sent Events</dt>

   <dd>

    <p>This specification references <dfn id="eventsource"><code>EventSource</code></dfn> which is specified
    in the Server-Sent Events specification <a href="references.html#refsEVENTSOURCE">[EVENTSOURCE]</a></p>

   </dd><!--TOPIC:HTML-->




   <dt>Media Queries</dt>

   <dd>

    <p>Implementations must support the Media Queries language. <a href="references.html#refsMQ">[MQ]</a></p>

   </dd>


   <dt>CSS modules</dt>

   <dd>

    <p>While support for CSS as a whole is not required of implementations of this specification
    (though it is encouraged, at least for Web browsers), some features are defined in terms of
    specific CSS requirements.</p>

    <p>In particular, some features require that a string be <dfn id="parsed-as-a-css-color-value">parsed as a CSS &lt;color&gt;
    value</dfn>. When parsing a CSS value, user agents are required by the CSS specifications to
    apply some error handling rules. These apply to this specification also. <a href="references.html#refsCSSCOLOR">[CSSCOLOR]</a> <a href="references.html#refsCSS">[CSS]</a></p>

    <p class="example">For example, user agents are required to close all open constructs upon
    finding the end of a style sheet unexpectedly. Thus, when parsing the string "<code data-anolis-xref="">rgb(0,0,0</code>" (with a missing close-parenthesis) for a color value, the close
    parenthesis is implied by this error handling rule, and a value is obtained (the color 'black').
    However, the similar construct "<code data-anolis-xref="">rgb(0,0,</code>" (with both a missing parenthesis
    and a missing "blue" value) cannot be parsed, as closing the open construct does not result in a
    viable value.</p>

    <p>The term <dfn id="css-element-reference-identifier">CSS element reference identifier</dfn> is used as defined in the <cite>CSS
    Image Values and Replaced Content</cite> specification to define the API that declares
    identifiers for use with the CSS 'element()' function. <a href="references.html#refsCSSIMAGES">[CSSIMAGES]</a></p>

    <p>Similarly, the term <dfn id="provides-a-paint-source">provides a paint source</dfn> is used as defined in the <cite>CSS
    Image Values and Replaced Content</cite> specification to define the interaction of certain HTML
    elements with the CSS 'element()' function. <a href="references.html#refsCSSIMAGES">[CSSIMAGES]</a></p>

    <p>The term <dfn id="default-object-size">default object size</dfn> is also defined in the <cite>CSS Image Values and
    Replaced Content</cite> specification. <a href="references.html#refsCSSIMAGES">[CSSIMAGES]</a></p>

    <p>Implementations that support scripting must support the CSS Object Model. The following
    features and terms are defined in the CSSOM specifications: <a href="references.html#refsCSSOM">[CSSOM]</a> <a href="references.html#refsCSSOMVIEW">[CSSOMVIEW]</a>

    <ul class="brief"><li><dfn id="screen"><code>Screen</code></dfn></li>
     <li><dfn id="linkstyle"><code>LinkStyle</code></dfn></li>
     <li><dfn id="cssstyledeclaration"><code>CSSStyleDeclaration</code></dfn></li>
     <li><dfn data-anolis-xref="dom-CSSStyleDeclaration-cssText" id="dom-cssstyledeclaration-csstext"><code>cssText</code></dfn> attribute of <code><a href="#cssstyledeclaration">CSSStyleDeclaration</a></code></li>
     <li><dfn id="stylesheet"><code>StyleSheet</code></dfn></li>
     <li>The terms <dfn id="create-a-css-style-sheet">create a CSS style sheet</dfn>, <dfn id="remove-a-css-style-sheet">remove a CSS style sheet</dfn>, and <dfn id="associated-css-style-sheet">associated CSS style sheet</dfn></li>
     <li><dfn data-anolis-xref="CSS style sheet" id="css-style-sheet">CSS style sheets</dfn> and their properties:
         <dfn data-anolis-xref="concept-css-style-sheet-type" id="concept-css-style-sheet-type">type</dfn>,
         <dfn data-anolis-xref="concept-css-style-sheet-location" id="concept-css-style-sheet-location">location</dfn>,
         <dfn data-anolis-xref="concept-css-style-sheet-parent-CSS-style-sheet" id="concept-css-style-sheet-parent-css-style-sheet">parent CSS style sheet</dfn>,
         <dfn data-anolis-xref="concept-css-style-sheet-owner-node" id="concept-css-style-sheet-owner-node">owner node</dfn>,
         <dfn data-anolis-xref="concept-css-style-sheet-owner-CSS-rule" id="concept-css-style-sheet-owner-css-rule">owner CSS rule</dfn>,
         <dfn data-anolis-xref="concept-css-style-sheet-media" id="concept-css-style-sheet-media">media</dfn>,
         <dfn data-anolis-xref="concept-css-style-sheet-title" id="concept-css-style-sheet-title">title</dfn>,
         <dfn data-anolis-xref="concept-css-style-sheet-alternate-flag" id="concept-css-style-sheet-alternate-flag">alternate flag</dfn>,
         <dfn data-anolis-xref="concept-css-style-sheet-disabeld-flag" id="concept-css-style-sheet-disabeld-flag">disabled flag</dfn>,
         <dfn data-anolis-xref="concept-css-style-sheet-CSS-rules" id="concept-css-style-sheet-css-rules">CSS rules</dfn>,
         <dfn data-anolis-xref="concept-css-style-sheet-origin-clean-flag" id="concept-css-style-sheet-origin-clean-flag">origin-clean flag</dfn>
     </li>
     <li><dfn id="alternative-style-sheet-sets">Alternative style sheet sets</dfn> and the <dfn id="preferred-style-sheet-set">preferred style sheet set</dfn></li>
     <li><dfn id="serializing-a-css-value">Serializing a CSS value</dfn></li>
     <li><dfn id="scroll-an-element-into-view">Scroll an element into view</dfn></li>
     <li><dfn id="scroll-to-the-beginning-of-the-document">Scroll to the beginning of the document</dfn></li>
     <li>The <dfn data-anolis-xref="event-resize" id="event-resize"><code>resize</code></dfn> event</li>
     <li>The <dfn data-anolis-xref="event-scroll" id="event-scroll"><code>scroll</code></dfn> event</li>
    </ul><p>The term <dfn id="environment-encoding">environment encoding</dfn> is defined in the <cite>CSS Syntax</cite>
    specifications. <a href="references.html#refsCSSSYNTAX">[CSSSYNTAX]</a></p>

    <p>The term <dfn id="css-styling-attribute">CSS styling attribute</dfn> is defined in the <cite>CSS Style Attributes</cite>
    specification. <a href="references.html#refsCSSATTR">[CSSATTR]</a></p>

    <p>The <code>CanvasRenderingContext2D</code> object's use of fonts depends on the features
    described in the CSS <cite>Fonts</cite> and <cite>Font Load Events</cite> specifications, including in particular
    <dfn id="fontloader"><code>FontLoader</code></dfn>. <a href="references.html#refsCSSFONTS">[CSSFONTS]</a> <a href="references.html#refsCSSFONTLOAD">[CSSFONTLOAD]</a></p>

   </dd><!--TOPIC:Canvas-->




   <dt>SVG</dt>

   <dd>

    <p>The following interface is defined in the SVG specification: <a href="references.html#refsSVG">[SVG]</a></p>

    <ul class="brief"><li><dfn id="svgmatrix"><code>SVGMatrix</code></dfn>
    </li></ul><!-- mention that the parser supports it? --></dd>


   <dt>WebGL</dt>

   <dd>

    <p>The following interface is defined in the WebGL specification: <a href="references.html#refsWEBGL">[WEBGL]</a></p>

    <ul class="brief"><li><dfn id="webglrenderingcontext"><code>WebGLRenderingContext</code></dfn>
    </li></ul></dd><!--TOPIC:HTML--><!-- mention that the parser supports mathml? --><!--TOPIC:Video Text Tracks-->




   




   <dt>WebVTT</dt>

   <dd>

    <p>Implementations may support <dfn id="webvtt">WebVTT</dfn> as a text track format for subtitles, captions,
    chapter titles, metadata, etc, for media resources. <a href="references.html#refsWEBVTT">[WEBVTT]</a></p>

    <p>The following terms, used in this specification, are defined in the WebVTT specification:</p>

    <ul class="brief"><li><dfn id="webvtt-file">WebVTT file</dfn>
     </li><li><dfn id="webvtt-file-using-cue-text">WebVTT file using cue text</dfn>
     </li><li><dfn id="webvtt-file-using-chapter-title-text">WebVTT file using chapter title text</dfn>
     </li><li><dfn id="webvtt-file-using-only-nested-cues">WebVTT file using only nested cues</dfn>
     </li><li><dfn id="webvtt-parser">WebVTT parser</dfn>
     </li><li>The <dfn id="rules-for-updating-the-display-of-webvtt-text-tracks">rules for updating the display of WebVTT text tracks</dfn>
     </li><li>The <dfn id="rules-for-interpreting-webvtt-cue-text">rules for interpreting WebVTT cue text</dfn>
     </li><li>The WebVTT <dfn id="text-track-cue-writing-direction">text track cue writing direction</dfn>
    </li></ul></dd><!--TOPIC:WebSocket API-->




   <dt>The WebSocket protocol</dt>

   <dd>

    <p>The following terms are defined in the WebSocket protocol specification: <a href="references.html#refsWSP">[WSP]</a></p>

    <ul class="brief"><li><dfn id="establish-a-websocket-connection">establish a WebSocket connection</dfn>
     </li><li><dfn id="the-websocket-connection-is-established">the WebSocket connection is established</dfn>
     </li><li><dfn id="validate-the-server's-response">validate the server's response</dfn>
     </li><li><dfn id="extensions-in-use">extensions in use</dfn>
     </li><li><dfn id="subprotocol-in-use">subprotocol in use</dfn>
     </li><li><dfn id="headers-to-send-appropriate-cookies">headers to send appropriate cookies</dfn>
     </li><li><dfn id="cookies-set-during-the-server's-opening-handshake">cookies set during the server's opening handshake</dfn>
     </li><li><dfn id="a-websocket-message-has-been-received">a WebSocket message has been received</dfn>
     </li><li><dfn id="send-a-websocket-message">send a WebSocket Message</dfn>
     </li><li><dfn id="fail-the-websocket-connection">fail the WebSocket connection</dfn>
     </li><li><dfn id="close-the-websocket-connection">close the WebSocket connection</dfn>
     </li><li><dfn id="start-the-websocket-closing-handshake">start the WebSocket closing handshake</dfn>
     </li><li><dfn id="the-websocket-closing-handshake-is-started">the WebSocket closing handshake is started</dfn>
     </li><li><dfn id="the-websocket-connection-is-closed">the WebSocket connection is closed</dfn> (possibly <i data-anolis-xref="">cleanly</i>)
     
     </li><li><dfn id="the-websocket-connection-close-code">the WebSocket connection close code</dfn>
     </li><li><dfn id="the-websocket-connection-close-reason">the WebSocket connection close reason</dfn>

    </li></ul></dd><!--TOPIC:HTML-->




   <dt>ARIA</dt>

   <dd>

    <p>The terms <dfn id="strong-native-semantics">strong native semantics</dfn> is used as defined in the ARIA specification.
    The term <dfn id="default-implicit-aria-semantics">default implicit ARIA semantics</dfn> has the same meaning as the term <i>implicit
    WAI-ARIA semantics</i> as used in the ARIA specification. <a href="references.html#refsARIA">[ARIA]</a></p>

    <p>The <dfn data-anolis-xref="attr-aria-role" id="attr-aria-role"><code>role</code></dfn> and <code data-anolis-xref="">aria-*</code>
    attributes are defined in the ARIA specification. <a href="references.html#refsARIA">[ARIA]</a></p>


   </dd>


  </dl><p>This specification does not <em>require</em> support of any particular network protocol, style
  sheet language, scripting language, or any of the DOM specifications beyond those required in the
  list above. However, the language described by this specification is biased towards CSS as the
  styling language, JavaScript as the scripting language, and HTTP as the network protocol, and
  several features assume that those languages and protocols are in use.</p>

  <p>A user agent that implements the HTTP protocol must implement the Web Origin Concept
  specification and the HTTP State Management Mechanism specification (Cookies) as well. <a href="references.html#refsHTTP">[HTTP]</a> <a href="references.html#refsORIGIN">[ORIGIN]</a> <a href="references.html#refsCOOKIES">[COOKIES]</a></p>

  <p class="note">This specification might have certain additional requirements on character
  encodings, image formats, audio formats, and video formats in the respective sections.</p>

  </div><!--FIXUP dev-html -1-->



  <h4 id="extensibility-0"><span class="secno">2.2.3</span> 拡張性</h4><!--FIXUP dev-html +1-->


  <p>ユーザーエージェントがこの仕様を拡張するベンダー固有のプロパティーを強く推奨しない。そうすることは、特定のユーザーエージェントのユーザーだけが当該のコンテンツにアクセスすることができ、相互運用性を減少させユーザーベースを分断するので、文書はそのような拡張を使用してはならない。</p>

  <div class="impl">

  <p>If such extensions are nonetheless needed, e.g. for experimental purposes, then vendors are
  strongly urged to use one of the following extension mechanisms:</p>

  <ul><li><p>For markup-level features that can be limited to the XML serialization and need not be
   supported in the HTML serialization, vendors should use the namespace mechanism to define custom
   namespaces in which the non-standard elements and attributes are supported.</p>

   </li><li>

    <p>For markup-level features that are intended for use with <a href="syntax.html#syntax">the HTML syntax</a>,
    extensions should be limited to new attributes of the form "<code data-anolis-xref="">x-<var data-anolis-xref="">vendor</var>-<var data-anolis-xref="">feature</var></code>", where <var data-anolis-xref="">vendor</var> is a
    short string that identifies the vendor responsible for the extension, and <var data-anolis-xref="">feature</var> is the name of the feature. New element names should not be created.
    Using attributes for such extensions exclusively allows extensions from multiple vendors to
    co-exist on the same element, which would not be possible with elements. Using the "<code data-anolis-xref="">x-<var data-anolis-xref="">vendor</var>-<var data-anolis-xref="">feature</var></code>" form allows extensions
    to be made without risk of conflicting with future additions to the specification.</p>

    <div class="example">

     <p>For instance, a browser named "FerretBrowser" could use "ferret" as a vendor prefix, while a
     browser named "Mellblom Browser" could use "mb". If both of these browsers invented extensions
     that turned elements into scratch-and-sniff areas, an author experimenting with these features
     could write:</p>

     <pre>&lt;p&gt;This smells of lemons!
&lt;span x-ferret-smellovision x-ferret-smellcode="LEM01"
      x-mb-outputsmell x-mb-smell="lemon juice"&gt;&lt;/span&gt;&lt;/p&gt;</pre>

    </div>

   </li>

  </ul><p>Attribute names beginning with the two characters "<code data-anolis-xref="">x-</code>" are reserved for
  user agent use and are guaranteed to never be formally added to the HTML language. For
  flexibility, attributes names containing underscores (the U+005F LOW LINE character) are also
  reserved for experimental purposes and are guaranteed to never be formally added to the HTML
  language.</p>

  <p class="note">Pages that use such attributes are by definition non-conforming.</p>

  <p>For DOM extensions, e.g. new methods and IDL attributes, the new members should be prefixed by
  vendor-specific strings to prevent clashes with future versions of this specification.</p>

  <p>For events, experimental event types should be prefixed with vendor-specific strings.</p>

  <div class="example">

   <p>For example, if a user agent called "Pleasold" were to add an event to indicate when
   the user is going up in an elevator, it could use the prefix "<code data-anolis-xref="">pleasold</code>" and
   thus name the event "<code data-anolis-xref="">pleasoldgoingup</code>", possibly with an event handler
   attribute named "<code data-anolis-xref="">onpleasoldgoingup</code>".</p>

  </div>

  <p>All extensions must be defined so that the use of extensions neither contradicts nor causes the
  non-conformance of functionality defined in the specification.</p><!-- thanks to QA Framework --> 

  <div class="example">

   <p>For example, while strongly discouraged from doing so, an implementation "Foo Browser" could
   add a new IDL attribute "<code data-anolis-xref="">fooTypeTime</code>" to a control's DOM interface that
   returned the time it took the user to select the current value of a control (say). On the other
   hand, defining a new control that appears in a form's <code data-anolis-xref="dom-form-elements"><a href="forms.html#dom-form-elements">elements</a></code> array would be in violation of the above requirement,
   as it would violate the definition of <code data-anolis-xref="dom-form-elements"><a href="forms.html#dom-form-elements">elements</a></code> given in
   this specification.</p>

  </div>

  <p>When adding new <a data-anolis-xref="reflect" href="#reflect">reflecting</a> IDL attributes corresponding to content
  attributes of the form "<code data-anolis-xref="">x-<var data-anolis-xref="">vendor</var>-<var data-anolis-xref="">feature</var></code>", the IDL attribute should be named "<code data-anolis-xref=""><var data-anolis-xref="">vendor</var><var data-anolis-xref="">Feature</var></code>" (i.e. the "<code data-anolis-xref="">x</code>" is
  dropped from the IDL attribute's name).</p>

  </div>

  <hr><p>この仕様にベンダー中立の拡張が必要になった場合、この仕様が状況に応じて更新されうる、または拡張仕様がこの仕様の要求を上書きされうるかのいずれかである。この仕様に活動を適用するある人が、そのような拡張仕様の要件を承認することを決定する場合、拡張仕様は<dfn data-anolis-xref="other applicable specifications" id="other-applicable-specifications">適用可能な仕様</dfn>になる。

  <p>文書に対する適合用語は、そのような適用可能な仕様によって導入される変更の性質、およびコンテンツと意図される文書の解釈に依存する。適用可能な仕様は、新しい文書コンテンツ（たとえばfoobar要素）を定義してもよく、特定のほかの適合コンテンツを禁止してもよく（たとえば&lt;TABLE&gt;の使用を禁止する）、この仕様で定義されるコンテンツに対するセマンティック、DOMの変換、または処理規則を変更してもよい。文書が、適用可能な仕様の用途に依存しない<a href="#conforming-documents">適合HTML5文書</a>であるかどうか：与えられた<a href="#conforming-documents">適合HTML5文書</a>の構文およびセマンティックが、適用可能な仕様の使用によって変更されない場合、その文書は<a href="#conforming-documents">適合HTML5文書</a>のままである。与えられた（ほかの適合）文書のセマンティックまたは処理が、適用可能な仕様の使用によって変更される場合、それは<a href="#conforming-documents">適合HTML5文書</a>ではない。このような場合、その適用可能な仕様は、適合用語を定義すべきである。</p>

  <p class="note">提案されたが必須でない慣習として、そのような仕様は、"適合HTML5+XXX文書"のような適合用語を定義するかもしれない。ここでXXXは適用可能な仕様に対する短い名前である。（例："適合HTML5+自動拡張文書"）。</p>
 
  <p class="note">上に与えられる規則の結果は、特定の文法的に正しいHTML5文書が適用可能な仕様の存在下で<a href="#conforming-documents">適合HTML5文書</a>でないかもしれない。（例：適用可能な仕様がひとまとまりの付属品のように&lt;table&gt;を定義する―たとえ要素がHTML5の構文的に正しく生じても、その仕様書に書かれてかつ&lt;table&gt;要素を含む文書は、<a href="#conforming-documents">適合HTML5文書</a>ではない。）</p><!--CONFORMANCE--><!--FORK-->


  <div class="impl">

  <hr><p>User agents must treat elements and attributes that they do not understand as semantically
  neutral; leaving them in the DOM (for DOM processors), and styling them according to CSS (for CSS
  processors), but not inferring any meaning from them.</p><!--ADD-TOPIC:Security-->


  <p>When support for a feature is disabled (e.g. as an emergency measure to mitigate a security
  problem, or to aid in development, or for performance reasons), user agents must act as if they
  had no support for the feature whatsoever, and as if the feature was not mentioned in this
  specification. For example, if a particular feature is accessed via an attribute in a Web IDL
  interface, the attribute itself would be omitted from the objects that implement that interface
  — leaving the attribute on the object but making it return null or throw an exception is
  insufficient.</p><!--REMOVE-TOPIC:Security-->


  </div>

<div class="impl">

  <h4 id="interactions-with-xpath-and-xslt"><span class="secno">2.2.4 </span>Interactions with XPath and XSLT</h4>

  <p id="xpath-1.0-processors">Implementations of XPath 1.0 that operate on <a href="#html-documents">HTML
  documents</a> parsed or created in the manners described in this specification (e.g. as part of
  the <code data-anolis-xref="">document.evaluate()</code> API) must act as if the following edit was applied
  to the XPath 1.0 specification.</p>

  <p>First, remove this paragraph:</p>

  <blockquote cite="http://www.w3.org/TR/1999/REC-xpath-19991116#node-tests">

   <p>A <a href="http://www.w3.org/TR/REC-xml-names#NT-QName">QName</a> in the node test is expanded
   into an <a href="http://www.w3.org/TR/1999/REC-xpath-19991116#dt-expanded-name">expanded-name</a>
   using the namespace declarations from the expression context. This is the same way expansion is
   done for element type names in start and end-tags except that the default namespace declared with
   <code data-anolis-xref="">xmlns</code> is not used: if the <a href="http://www.w3.org/TR/REC-xml-names#NT-QName">QName</a> does not have a prefix, then the
   namespace URI is null (this is the same way attribute names are expanded). It is an error if the
   <a href="http://www.w3.org/TR/REC-xml-names#NT-QName">QName</a> has a prefix for which there is
   no namespace declaration in the expression context.</p>

  </blockquote>

  <p>Then, insert in its place the following:</p>

  <blockquote cite="http://www.w3.org/Bugs/Public/show_bug.cgi?id=7059#c37">

   <p>A QName in the node test is expanded into an expanded-name using the namespace declarations
   from the expression context. If the QName has a prefix, then there must be a<!-- added 2009-10-27
   - http://www.w3.org/Bugs/Public/show_bug.cgi?id=8062 -->  namespace declaration for this prefix in
   the expression context, and the corresponding<!-- typo fixed 2009-10-27 -
   http://www.w3.org/Bugs/Public/show_bug.cgi?id=8063 -->  namespace URI is the one that is
   associated with this prefix. It is an error if the QName has a prefix for which there is no
   namespace declaration in the expression context.  </p>

   <p>If the QName has no prefix and the principal node type of the axis is element, then the
   default element namespace is used. Otherwise if the QName has no prefix, the namespace URI is
   null. The default element namespace is a member of the context for the XPath expression. The
   value of the default element namespace when executing an XPath expression through the DOM3 XPath
   API is determined in the following way:</p>

   <ol><li>If the context node is from an HTML DOM, the default element namespace is
    "http://www.w3.org/1999/xhtml".</li>

    <li>Otherwise, the default element namespace URI is null.</li>

   </ol><p class="note">This is equivalent to adding the default element namespace feature of XPath 2.0
   to XPath 1.0, and using the HTML namespace as the default element namespace for HTML documents.
   It is motivated by the desire to have implementations be compatible with legacy HTML content
   while still supporting the changes that this specification introduces to HTML regarding the
   namespace used for HTML elements, and by the desire to use XPath 1.0 rather than XPath 2.0.</p>

  </blockquote>

  <p class="note">This change is a <a href="introduction.html#willful-violation">willful violation</a> of the XPath 1.0 specification,
  motivated by desire to have implementations be compatible with legacy content while still
  supporting the changes that this specification introduces to HTML regarding which namespace is
  used for HTML elements. <a href="references.html#refsXPATH10">[XPATH10]</a></p><!-- note: version matters for
  this ref --> 

  <hr><p id="dom-based-xslt-1.0-processors">XSLT 1.0 processors outputting to a DOM when the output
  method is "html" (either explicitly or via the defaulting rule in XSLT 1.0) are affected as
  follows:</p>

  <p>If the transformation program outputs an element in no namespace, the processor must, prior to
  constructing the corresponding DOM element node, change the namespace of the element to the
  <a href="#html-namespace-0">HTML namespace</a>, <a data-anolis-xref="converted to ASCII lowercase" href="#converted-to-ascii-lowercase">ASCII-lowercase</a> the
  element's local name, and <a data-anolis-xref="converted to ASCII lowercase" href="#converted-to-ascii-lowercase">ASCII-lowercase</a> the
  names of any non-namespaced attributes on the element.</p>

  <p class="note">This requirement is a <a href="introduction.html#willful-violation">willful violation</a> of the XSLT 1.0
  specification, required because this specification changes the namespaces and case-sensitivity
  rules of HTML in a manner that would otherwise be incompatible with DOM-based XSLT
  transformations. (Processors that serialise the output are unaffected.) <a href="references.html#refsXSLT10">[XSLT10]</a></p><!-- note: version matters for this ref --> 

  <hr><p>This specification does not specify precisely how XSLT processing interacts with the <a href="syntax.html#html-parser">HTML
  parser</a> infrastructure (for example, whether an XSLT processor acts as if it puts any
  elements into a <a href="syntax.html#stack-of-open-elements">stack of open elements</a>). However, XSLT processors must <a href="syntax.html#stop-parsing">stop
  parsing</a> if they successfully complete, and must set the <a href="dom.html#current-document-readiness">current document
  readiness</a> first to "<code data-anolis-xref="">interactive</code>"<!-- this synchronously fires an
  event -->  and then to "<code data-anolis-xref="">complete</code>"<!-- this also synchronously fires an event
  -->  if they are aborted.</p>

  <hr><p>This specification does not specify how XSLT interacts with the <a data-anolis-xref="navigate" href="browsers.html#navigate">navigation</a> algorithm, how it fits in with the <a href="webappapis.html#event-loop">event loop</a>, nor
  how error pages are to be handled (e.g. whether XSLT errors are to replace an incremental XSLT
  output, or are rendered inline, etc).</p>

  <p class="note">There are also additional non-normative comments regarding the interaction of XSLT
  and HTML <a href="scripting-1.html#scriptTagXSLT">in the <code>script</code> element section</a>, and of
  XSLT, XPath, and HTML <a href="scripting-1.html#template-XSLT-XPath">in the <code>template</code> element
  section</a>.</p>


  </div>

  <h3 id="case-sensitivity-and-string-comparison"><span class="secno">2.3</span> 大文字・小文字区別と文字列の比較</h3>

  <p><dfn id="case-sensitive">大文字・小文字区別</dfn>において2つの文字列を比較することは、正確にコードポイントを比較することを意味する。</p>

  <p><dfn id="ascii-case-insensitive">ASCII大文字・小文字区別</dfn>において2つの文字列を比較する方法は、コードポイントごとに正確に比較することを意味し、U+0041からU+005Aまでの範囲（すなわちLATIN CAPITAL LETTER AからLATIN CAPITAL LETTER Zまで）を除いて、U+0061からU+007Aまでの範囲（すなわちLATIN SMALL LETTER AからLATIN SMALL LETTER Zまで）において一致する文字も一致するとみなされる。</p>

  <p><dfn id="compatibility-caseless">互換性大文字・小文字不区別</dfn>で2つの文字列を比較する方法は、言語固有の手直し（tailoring）なしで、2つの文字列を比較するためにUnicode<i>互換性大文字・小文字不区別一致</i>操作を使用することを意味する。<a href="references.html#refsUNICODE">[UNICODE]</a></p>

  <p>明記される場合を除き、文字列の比較は<a href="#case-sensitive">大文字・小文字区別</a>の方法で実行されなければならない。</p>


  <div class="impl">

  <p><dfn data-anolis-xref="converted to ASCII uppercase" id="converted-to-ascii-uppercase">Converting a string to ASCII uppercase</dfn> means
  replacing all characters in the range U+0061 to U+007A (i.e. LATIN SMALL LETTER A to LATIN SMALL
  LETTER Z) with the corresponding characters in the range U+0041 to U+005A (i.e. LATIN CAPITAL
  LETTER A to LATIN CAPITAL LETTER Z).</p>

  <p><dfn data-anolis-xref="converted to ASCII lowercase" id="converted-to-ascii-lowercase">Converting a string to ASCII lowercase</dfn> means
  replacing all characters in the range U+0041 to U+005A (i.e. LATIN CAPITAL LETTER A to LATIN
  CAPITAL LETTER Z) with the corresponding characters in the range U+0061 to U+007A (i.e. LATIN
  SMALL LETTER A to LATIN SMALL LETTER Z).</p>

  </div>


  <p><var data-anolis-xref="">pattern</var>が<var data-anolis-xref="">s</var>未満でかつ<var data-anolis-xref="">pattern</var>の長さに<var data-anolis-xref="">s</var>を切り捨てが、互いにマッチとしての2つの文字列のままにする場合、文字列の<var data-anolis-xref="">pattern</var>は、文字列<var data-anolis-xref="">s</var>と<dfn id="prefix-match">接頭辞一致</dfn>である。</p>



  <h3 id="common-microsyntaxes"><span class="secno">2.4</span> 共通マイクロ構文</h3>

  <p>日付や数字など、HTMLには特定のデータ型を受け入れるさまざまな箇所がある。この節では、これら形式の内容の適合基準が何か、そしてどのように解析するかを説明する。</p>

  <div class="impl">

  <p class="note">Implementors are strongly urged to carefully examine any third-party libraries
  they might consider using to implement the parsing of syntaxes described below. For example, date
  libraries are likely to implement error handling behavior that differs from what is required in
  this specification, since error-handling behavior is often not defined in specifications that
  describe date syntaxes similar to those used in this specification, and thus implementations tend
  to vary greatly in how they handle errors.</p>

  </div>


  <div class="impl">

  <h4 id="common-parser-idioms"><span class="secno">2.4.1 </span>Common parser idioms</h4>

  </div>

  <p>この仕様の用途において、<dfn data-anolis-xref="space character" id="space-character">空白文字</dfn>は、U+0020 SPACE、"tab"（U+0009）、"LF"（U+000A）、"FF"（U+000C）、"CR"（U+000D）である。</p>

  <p><dfn data-anolis-xref="White_Space" id="white_space">空白類文字</dfn>は、Unicodeの<code data-anolis-xref="">PropList.txt</code>データファイルでUnicodeプロパティー"White_Space"を持つものである。<a href="references.html#refsUNICODE">[UNICODE]</a></p>

  <p class="note">これは<code data-anolis-xref="">Unicode.txt</code>データファイルでの"Bidi_Class"プロパティーの"White_Space"値（"WS"と略される）と混同されるべきでない。</p>

  <p><dfn id="control-characters">制御文字</dfn>とは、Unicodeの<code data-anolis-xref="">UnicodeData.txt</code>データファイルでUnicodeの"White_Space"プロパティーを持つものである。<a href="references.html#refsUNICODE">[UNICODE]</a></p>

  <p><dfn id="uppercase-ascii-letters">大文字のASCII文字</dfn>は、範囲<a href="#uppercase-ascii-letters">大文字のASCII文字</a>における文字である。</p>

  <p><dfn id="lowercase-ascii-letters">小文字のASCII文字</dfn>は、範囲<a href="#lowercase-ascii-letters">小文字のASCII文字</a>における文字である。</p>

  <p><dfn id="ascii-digits">ASCII数字</dfn>は、範囲<a href="#ascii-digits">ASCII数字</a>における文字である。</p>

  <p><dfn id="alphanumeric-ascii-characters">英数字のASCII文字</dfn>は、<a href="#uppercase-ascii-letters">大文字のASCII文字</a>、<a href="#lowercase-ascii-letters">小文字のASCII文字</a>、または<a href="#ascii-digits">ASCII数字</a>のいずれかである。</p>

  <p><dfn id="ascii-hex-digits">ASCII16進数字</dfn>は、<a href="#ascii-digits">ASCII 数字</a>、U+0041 LATIN CAPITAL LETTER AからU+0046 LATIN CAPITAL LETTERまで、およびU+0061 LATIN SMALL LETTER AからU+0066 LATIN SMALL LETTER Fまでの範囲の文字である。</p>

  <p><dfn id="uppercase-ascii-hex-digits">大文字のASCII16進数字</dfn>は、範囲<a href="#ascii-digits">ASCII数字</a>およびU+0041 LATIN CAPITAL LETTER AからU+0046 LATIN CAPITAL LETTER Fまでのみの文字である。</p>

  <p><dfn id="lowercase-ascii-hex-digits">小文字のASCII16進数字</dfn>は、範囲<a href="#ascii-digits">ASCII数字</a>およびU+0061 LATIN SMALL LETTER AからU+0066 LATIN SMALL LETTER Fまでのみの文字である。</p>

  <div class="impl">

  <p>Some of the micro-parsers described below follow the pattern of having an <var data-anolis-xref="">input</var> variable that holds the string being parsed, and having a <var data-anolis-xref="">position</var> variable pointing at the next character to parse in <var data-anolis-xref="">input</var>.</p>

  <p>For parsers based on this pattern, a step that requires the user agent to <dfn id="collect-a-sequence-of-characters">collect a
  sequence of characters</dfn> means that the following algorithm must be run, with <var data-anolis-xref="">characters</var> being the set of characters that can be collected:</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> and <var data-anolis-xref="">position</var> be the same variables as
   those of the same name in the algorithm that invoked these steps.</li>

   <li><p>Let <var data-anolis-xref="">result</var> be the empty string.</li>

   <li><p>While <var data-anolis-xref="">position</var> doesn't point past the end of <var data-anolis-xref="">input</var>
   and the character at <var data-anolis-xref="">position</var> is one of the <var data-anolis-xref="">characters</var>,
   append that character to the end of <var data-anolis-xref="">result</var> and advance <var data-anolis-xref="">position</var> to the next character in <var data-anolis-xref="">input</var>.</li>

   <li><p>Return <var data-anolis-xref="">result</var>.</li>

  </ol><p>The step <dfn id="skip-whitespace">skip whitespace</dfn> means that the user agent must <a href="#collect-a-sequence-of-characters">collect a sequence of
  characters</a> that are <a data-anolis-xref="space character" href="#space-character">space characters</a>. The collected
  characters are not used.</p>

  <p>When a user agent is to <dfn id="strip-line-breaks">strip line breaks</dfn> from a string, the user agent must remove
  any "LF" (U+000A) and "CR" (U+000D) characters from that string.</p>

  <p>When a user agent is to <dfn id="strip-leading-and-trailing-whitespace">strip leading and trailing whitespace</dfn> from a string, the
  user agent must remove all <a data-anolis-xref="space character" href="#space-character">space characters</a> that are at the
  start or end of the string.</p>

  <p>When a user agent is to <dfn id="strip-and-collapse-whitespace">strip and collapse whitespace</dfn> in a string, it must replace
  any sequence of one or more consecutive <a data-anolis-xref="space character" href="#space-character">space characters</a> in
  that string with a single U+0020 SPACE character, and then <a href="#strip-leading-and-trailing-whitespace">strip leading and trailing
  whitespace</a> from that string.</p>

  <p>When a user agent has to <dfn id="strictly-split-a-string">strictly split a string</dfn> on a particular delimiter character
  <var data-anolis-xref="">delimiter</var>, it must use the following algorithm:</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p>Let <var data-anolis-xref="">tokens</var> be an ordered list of tokens, initially empty.</li>

   <li><p>While <var data-anolis-xref="">position</var> is not past the end of <var data-anolis-xref="">input</var>:</p>

    <ol><li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are not the <var data-anolis-xref="">delimiter</var> character.</li>

     <li><p>Append the string collected in the previous step to <var data-anolis-xref="">tokens</var>.</li>

     <li><p>Advance <var data-anolis-xref="">position</var> to the next character in <var data-anolis-xref="">input</var>.</li><!-- skips past the delimiter --> 

    </ol></li>

   <li><p>Return <var data-anolis-xref="">tokens</var>.</li>

  </ol><p class="note">For the special cases of splitting a string <a data-anolis-xref="split a string on
  spaces" href="#split-a-string-on-spaces">on spaces</a> and <a data-anolis-xref="split a string on commas" href="#split-a-string-on-commas">on commas</a>, this
  algorithm does not apply (those algorithms also perform <a data-anolis-xref="strip leading and trailing
  whitespace" href="#strip-leading-and-trailing-whitespace">whitespace trimming</a>).</p>

  </div>



  <h4 id="boolean-attributes"><span class="secno">2.4.2</span> 真偽属性</h4>

  <p>いくつかの属性は<dfn data-anolis-xref="boolean attribute" id="boolean-attribute">真偽属性</dfn>である。要素での真偽属性の存在は真の値を表し、属性の不在は偽の値を表す。</p>

  <p>属性が存在する場合、その値は先頭または末尾の空白なしで、空の文字列または属性の正規名に<a href="#ascii-case-insensitive">ASCII大文字・小文字不区別</a>でマッチする値でなければならない。</p>

  <p class="note">値"true"および"false"は真偽属性で許可されない。偽の値を表すため、属性は完全に省略される必要がある。</p>

  <div class="example">

   <p>checkedおよびdisabledとなるチェックボックスの例を示す。<code data-anolis-xref="attr-input-checked"><a href="forms.html#attr-input-checked">checked</a></code>および<code data-anolis-xref="attr-fe-disabled"><a href="forms.html#attr-fe-disabled">disabled</a></code>属性は真偽属性である。</p>

   <pre>&lt;label&gt;&lt;input type=checkbox checked name=cheese disabled&gt; Cheese&lt;/label&gt;</pre>

   <p>これは次に書かれるものと等価であるべきである：

   <pre>&lt;label&gt;&lt;input type=checkbox checked=checked name=cheese disabled=disabled&gt; Cheese&lt;/label&gt;</pre>

   <p>スタイルを混在させることもできる。以下は依然として等価である：</p>

   <pre>&lt;label&gt;&lt;input type='checkbox' checked name=cheese disabled=""&gt; Cheese&lt;/label&gt;</pre>

  </div>



  <h4 id="keywords-and-enumerated-attributes"><span class="secno">2.4.3</span> キーワードおよび列挙属性</h4>

  <p>一部の属性は、有限集合のキーワードのいずれかを取るように定義されている。このような属性は<dfn data-anolis-xref="enumerated attribute" id="enumerated-attribute">列挙属性</dfn>と呼ばれる。キーワードは、特定の<em>状態</em>にそれぞれ対応付けて定義される（キーワードの一部が互いに同義語となる場合、複数のキーワードは同じ状態に対応づけられる。加えて、一部のキーワードは不適合であると言うことができる。これは、歴史的な理由のためだけの仕様である）。さらに、2つのデフォルト状態を挙げることができる。1つは<i>妥当でない値のデフォルト</i>であり、もう1つは<i>欠落した値のデフォルト</i>である。</p>

  <p>列挙属性が指定される場合、属性値は、先行または後続の空白なしで、不適合でないとされる与えられたキーワードのいずれかと<a href="#ascii-case-insensitive">ASCII大文字・小文字不区別</a>で一致しなければならない。</p>

  <p>属性が指定される際に、その値が与えられたキーワードのいずれかと<a href="#ascii-case-insensitive">ASCII大文字・小文字不区別</a>で一致する場合、属性のキーワードの状態は、属性が表す状態である。属性値が与えられたキーワードのいずれにも一致しないが、属性が<i>妥当でない値のデフォルト</i>を持つ場合、その属性はその状態を表す。そうでなければ、属性値がキーワードのいずれにも一致しないが<i>欠落値のデフォルト</i>状態定義が存在する場合、<em>それ</em>は属性によって表される状態である。そうでなければ、デフォルトは存在せず、何も表さない状態を意味する妥当でない値である。</p>

  <p>属性が指定<em>されない</em>際に、<i>欠落値のデフォルト</i>定義状態がある場合、それは（欠落）属性によって表される状態である。そうでなければ、属性の不在は何も状態を表さないことを意味する。</p>

  <p class="note">空文字列は妥当なキーワードとなりうる。</p>


  <h4 id="numbers"><span class="secno">2.4.4</span> 数字</h4>

  <h5 id="signed-integers"><span class="secno">2.4.4.1</span> 符号付き整数</h5>

  <p>文字列が1つ以上の<a href="#ascii-digits">ASCII 数字</a>、任意で接頭辞"-"（U+002D）文字を持つ場合、文字列は<dfn id="valid-integer">妥当な整数</dfn>である。</p>

  <p>"-"（U+002D）接頭辞なしの<a href="#valid-integer">妥当な整数</a>は、10進数を表す。"-"（U+002D）接頭辞<em>あり</em>の<a href="#valid-integer">妥当な整数</a>は、U+002D HYPHEN-MINUSに続く10進数を表し、ゼロから減算される。</p>

  <div class="impl">

  <p>The <dfn id="rules-for-parsing-integers">rules for parsing integers</dfn> are as given in the following algorithm. When
  invoked, the steps must be followed in the order given, aborting at the first step that returns a
  value. This algorithm will return either an integer or an error.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p>Let <var data-anolis-xref="">sign</var> have the value "positive".</li>

   <li><p><a href="#skip-whitespace">Skip whitespace</a>.</li>

   <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, return an
    error.</li>

   <li>

    <p>If the character indicated by <var data-anolis-xref="">position</var> (the first character) is a "-" (U+002D) character:</p>

    <ol><li>Let <var data-anolis-xref="">sign</var> be "negative".</li>

     <li>Advance <var data-anolis-xref="">position</var> to the next character.</li>

     <li>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, return an
     error.</li>

    </ol><p>Otherwise, if the character indicated by <var data-anolis-xref="">position</var> (the first character)
    is a "+" (U+002B) character:</p>

    <ol><li>Advance <var data-anolis-xref="">position</var> to the next character. (The "<code data-anolis-xref="">+</code>"
     is ignored, but it is not conforming.)</li>

     <li>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, return an
     error.</li>

    </ol></li>

   <li><p>If the character indicated by <var data-anolis-xref="">position</var> is not an <a data-anolis-xref="ASCII
   digits" href="#ascii-digits">ASCII digit</a>, then return an error.</li><!-- Ok. At this point we know we have a number. It might have
   trailing garbage which we'll ignore, but it's a number, and we
   won't return an error. -->

   

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>, and
   interpret the resulting sequence as a base-ten integer. Let <var data-anolis-xref="">value</var> be that
   integer.</li>

   <li><p>If <var data-anolis-xref="">sign</var> is "positive", return <var data-anolis-xref="">value</var>, otherwise return the result of subtracting
   <var data-anolis-xref="">value</var> from zero.</li>

  </ol></div>


  <h5 id="non-negative-integers"><span class="secno">2.4.4.2</span> 非負整数</h5>

  <p>1つ以上の<a href="#ascii-digits">ASCII数字</a>からなる場合、文字列は<dfn id="valid-non-negative-integer">妥当な非負整数</dfn>である。</p>

  <p><a href="#valid-non-negative-integer">妥当な非負整数</a>は、10進数である数を表す。</p>

  <div class="impl">

  <p>The <dfn id="rules-for-parsing-non-negative-integers">rules for parsing non-negative integers</dfn> are as given in the following algorithm.
  When invoked, the steps must be followed in the order given, aborting at the first step that
  returns a value. This algorithm will return either zero, a positive integer, or an error.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">value</var> be the result of parsing <var data-anolis-xref="">input</var> using the
   <a href="#rules-for-parsing-integers">rules for parsing integers</a>.</li>

   <li><p>If <var data-anolis-xref="">value</var> is an error, return an error.</li>

   <li><p>If <var data-anolis-xref="">value</var> is less than zero, return an error.</li>

   <li><p>Return <var data-anolis-xref="">value</var>.</li>

  </ol><!-- Implications: A leading + is ignored. A leading - is ignored if the value is zero. --></div>


  <h5 id="floating-point-numbers"><span class="secno">2.4.4.3</span> 浮動小数点数</h5>

  <p>次の場合、文字列は<dfn id="valid-floating-point-number">妥当な浮動小数点数</dfn>である：</p>

  <ol class="brief"><li>任意で、"-"（U+002D）文字。</li>

   <li>次のいずれかまたは両方の、与えられた順：

    <ol><li>ひと続きの1つ以上の<a href="#ascii-digits">ASCII数字</a>。</li>

     <li>

      <ol><li>1つの"."（U+002E）文字。</li>

       <li>ひと続きの1つ以上の<a href="#ascii-digits">ASCII数字</a>。</li>

      </ol></li>

    </ol></li>

   <li>任意で：

    <ol><li>"e"（U+0065）文字または"E"（U+0045）文字のいずれか。</li>

     <li>任意で、"-"（U+002D）文字または"+"（U+002B）文字。</li>

     <li>ひと続きの1つ以上の<a href="#ascii-digits">ASCII数字</a>。</li>

    </ol></li>

  </ol><p><a href="#valid-floating-point-number">妥当な浮動小数点数</a>は、10の累乗による仮数部の乗算によって得られる。ここで乗算は最初の数であり、10進数として解釈される（もしあれば、小数点および小数点の後の数を含み、文字列全体が"-"（U+002D）文字で始まるおよび数値がゼロでない場合、負数として仮数部を解釈する）。またここで、もしあれば、指数はEの後の数字である（Eと数字と数字の間に"-"（U+002D）文字がある場合、負数として解釈され、数字がゼロでない、またはその他Eと数字の間に"+"（U+002B）文字が存在する場合無視できる）。Eが存在しない場合、指数はゼロとして扱われる。</p>

  <p class="note">無限大および非数（NaN）値は<a data-anolis-xref="valid
  floating-point number" href="#valid-floating-point-number">妥当な浮動小数点数</a>ではない。</p>

  <div class="impl">

  <p>The <dfn data-anolis-xref="best representation of the number as a floating-point number" id="best-representation-of-the-number-as-a-floating-point-number">best
  representation of the number <var data-anolis-xref="">n</var> as a floating-point number</dfn> is the string
  obtained from applying the JavaScript operator ToString to <var data-anolis-xref="">n</var>. The JavaScript
  operator ToString is not uniquely determined. When there are multiple possible strings that could
  be obtained from the JavaScript operator ToString for a particular value, the user agent must
  always return the same string for that value (though it may differ from the value used by other
  user agents).</p>

  <p>The <dfn id="rules-for-parsing-floating-point-number-values">rules for parsing floating-point number values</dfn> are as given in the following
  algorithm. This algorithm must be aborted at the first step that returns something. This algorithm
  will return either a number or an error.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p>Let <var data-anolis-xref="">value</var> have the value 1.</li>

   <li><p>Let <var data-anolis-xref="">divisor</var> have the value 1.</li>

   <li><p>Let <var data-anolis-xref="">exponent</var> have the value 1.</li>

   <li><p><a href="#skip-whitespace">Skip whitespace</a>.</li>

   <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, return an
   error.</li>

   <li>

    <p>If the character indicated by <var data-anolis-xref="">position</var> is a U+002D HYPHEN-MINUS character
    (-):</p>

    <ol><li>Change <var data-anolis-xref="">value</var> and <var data-anolis-xref="">divisor</var> to −1.</li>

     <li>Advance <var data-anolis-xref="">position</var> to the next character.</li>

     <li>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, return an
     error.</li>

    </ol><p>Otherwise, if the character indicated by <var data-anolis-xref="">position</var> (the first character)
    is a "+" (U+002B) character:</p>

    <ol><li>Advance <var data-anolis-xref="">position</var> to the next character. (The "<code data-anolis-xref="">+</code>"
     is ignored, but it is not conforming.)</li>

     <li>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, return an
     error.</li>

    </ol></li>

   <li><p>If the character indicated by <var data-anolis-xref="">position</var> is a "." (U+002E), and
   that is not the last character in <var data-anolis-xref="">input</var>, and the character after the
   character indicated by <var data-anolis-xref="">position</var> is an <a data-anolis-xref="ASCII digits" href="#ascii-digits">ASCII
   digit</a>, then set <var data-anolis-xref="">value</var> to zero and jump to the step labeled
   <i>fraction</i>.</p><!-- we have to check there's a number so that ".e1" fails to parse but ".0"
   does not --> 

   </li><li><p>If the character indicated by <var data-anolis-xref="">position</var> is not an <a data-anolis-xref="ASCII
   digits" href="#ascii-digits">ASCII digit</a>, then return an error.</li>

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>, and
   interpret the resulting sequence as a base-ten integer. Multiply <var data-anolis-xref="">value</var> by
   that integer.</li>

   <li>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, jump to the
   step labeled <i>conversion</i>.</li>

   <li><p><i>Fraction</i>: If the character indicated by <var data-anolis-xref="">position</var> is a "." (U+002E), run these substeps:</p>

    <ol><li><p>Advance <var data-anolis-xref="">position</var> to the next character.</li>

     <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, or if the
     character indicated by <var data-anolis-xref="">position</var> is not an <a data-anolis-xref="ASCII digits" href="#ascii-digits">ASCII
     digit</a>, "e" (U+0065), or "E" (U+0045), then jump
     to the step labeled <i>conversion</i>.</li>

     <li><p>If the character indicated by <var data-anolis-xref="">position</var> is a "e" (U+0065) character or a "E" (U+0045) character, skip the remainder of
     these substeps.</p>

     </li><li><p><i>Fraction loop</i>: Multiply <var data-anolis-xref="">divisor</var> by ten.</li>

     <li>Add the value of the character indicated by <var data-anolis-xref="">position</var>, interpreted as a
     base-ten digit (0..9) and divided by <var data-anolis-xref="">divisor</var>, to <var data-anolis-xref="">value</var>.</li>

     <li><p>Advance <var data-anolis-xref="">position</var> to the next character.</li>

     <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, then jump
     to the step labeled <i>conversion</i>.</li>

     <li><p>If the character indicated by <var data-anolis-xref="">position</var> is an <a data-anolis-xref="ASCII
     digits" href="#ascii-digits">ASCII digit</a>, jump back to the step labeled <i>fraction loop</i> in these
     substeps.</li>

    </ol></li>

   <li><p>If the character indicated by <var data-anolis-xref="">position</var> is a "e" (U+0065) character or a "E" (U+0045) character, run these substeps:</p>

    <ol><li><p>Advance <var data-anolis-xref="">position</var> to the next character.</li>

     <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, then jump
     to the step labeled <i>conversion</i>.</li>

     <li>

      <p>If the character indicated by <var data-anolis-xref="">position</var> is a "-" (U+002D) character:</p>

      <ol><li>Change <var data-anolis-xref="">exponent</var> to −1.</li>

       <li>Advance <var data-anolis-xref="">position</var> to the next character.</li>

       <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, then
       jump to the step labeled <i>conversion</i>.</li>

      </ol><p>Otherwise, if the character indicated by <var data-anolis-xref="">position</var> is a "+" (U+002B) character:</p>

      <ol><li>Advance <var data-anolis-xref="">position</var> to the next character.</li>

       <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, then
       jump to the step labeled <i>conversion</i>.</li>

      </ol></li>

     <li><p>If the character indicated by <var data-anolis-xref="">position</var> is not an <a data-anolis-xref="ASCII
     digits" href="#ascii-digits">ASCII digit</a>, then jump to the step labeled <i>conversion</i>.</li>

     <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>, and
     interpret the resulting sequence as a base-ten integer. Multiply <var data-anolis-xref="">exponent</var>
     by that integer.</li>

     <li><p>Multiply <var data-anolis-xref="">value</var> by ten raised to the <var data-anolis-xref="">exponent</var>th
     power.</li>

    </ol></li>

   <li><p><i>Conversion</i>: Let <var data-anolis-xref="">S</var> be the set of finite IEEE 754
   double-precision floating-point values except −0, but with two special values added: 2<sup data-anolis-xref="">1024</sup> and −2<sup data-anolis-xref="">1024</sup>.</li>

   <li><p>Let <var data-anolis-xref="">rounded-value</var> be the number in <var data-anolis-xref="">S</var> that is
   closest to <var data-anolis-xref="">value</var>, selecting the number with an even significand if there are
   two equally close values. (The two special values 2<sup data-anolis-xref="">1024</sup> and −2<sup data-anolis-xref="">1024</sup> are considered to have even significands for this purpose.)</li>

   <li><p>If <var data-anolis-xref="">rounded-value</var> is 2<sup data-anolis-xref="">1024</sup> or −2<sup data-anolis-xref="">1024</sup>, return an error.</li>

   <li><p>Return <var data-anolis-xref="">rounded-value</var>.</li>

  </ol></div>


<div class="impl">
  <h5 id="percentages-and-dimensions"><span class="secno">2.4.4.4 </span>Percentages and lengths</h5>

 <p>The <dfn id="rules-for-parsing-dimension-values">rules for parsing dimension values</dfn> are as given in the following algorithm. When
  invoked, the steps must be followed in the order given, aborting at the first step that returns a
  value. This algorithm will return either a number greater than or equal to 1.0, or an error; if a
  number is returned, then it is further categorised as either a percentage or a length.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p><a href="#skip-whitespace">Skip whitespace</a>.</li>

   <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, return an
   error.</li>

   <li><p>If the character indicated by <var data-anolis-xref="">position</var> is a U+002B PLUS SIGN character
   (+), advance <var data-anolis-xref="">position</var> to the next character.</li>

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are "0" (U+0030) characters,
   and discard them.</li>

   <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, return an
   error.</li>

   <li><p>If the character indicated by <var data-anolis-xref="">position</var> is not one of "1" (U+0031) to "9" (U+0039), then return an error.</li><!-- Ok. At this point we know we have a number. It might have trailing garbage which we'll
   ignore, but it's a number, and we won't return an error. -->

   

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>, and
   interpret the resulting sequence as a base-ten integer. Let <var data-anolis-xref="">value</var> be that
   number.</li>

   <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, return <var data-anolis-xref="">value</var> as a length.</li>

   <li>

    <p>If the character indicated by <var data-anolis-xref="">position</var> is a U+002E FULL STOP character
    (.):</p>

    <ol><li><p>Advance <var data-anolis-xref="">position</var> to the next character.</li>

     <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, or if the
     character indicated by <var data-anolis-xref="">position</var> is not an <a data-anolis-xref="ASCII digits" href="#ascii-digits">ASCII
     digit</a>, then return <var data-anolis-xref="">value</var> as a length.</li>

     <li><p>Let <var data-anolis-xref="">divisor</var> have the value 1.</li>

     <li><p><i>Fraction loop</i>: Multiply <var data-anolis-xref="">divisor</var> by ten.</li>

     <li>Add the value of the character indicated by <var data-anolis-xref="">position</var>, interpreted as a
     base-ten digit (0..9) and divided by <var data-anolis-xref="">divisor</var>, to <var data-anolis-xref="">value</var>.</li>

     <li><p>Advance <var data-anolis-xref="">position</var> to the next character.</li>

     <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, then
     return <var data-anolis-xref="">value</var> as a length.</li>

     <li><p>If the character indicated by <var data-anolis-xref="">position</var> is an <a data-anolis-xref="ASCII
     digits" href="#ascii-digits">ASCII digit</a>, return to the step labeled <i>fraction loop</i> in these
     substeps.</li>

    </ol></li>

   <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, return <var data-anolis-xref="">value</var> as a length.</li>

   <li><p>If the character indicated by <var data-anolis-xref="">position</var> is a "%" (U+0025) character, return <var data-anolis-xref="">value</var> as a percentage.</li>

   <li><p>Return <var data-anolis-xref="">value</var> as a length.</li>

  </ol></div>


  <h5 id="lists-of-integers"><span class="secno">2.4.4.5</span> 整数リスト</h5>

  <p><dfn id="valid-list-of-integers">妥当な整数リスト</dfn>は、U+002C COMMA文字によって区切られる多数の<a data-anolis-xref="valid integer" href="#valid-integer">妥当な整数</a>であり、他の文字を持たない（たとえば<a data-anolis-xref="space character" href="#space-character">空白文字</a>のない）。さらに、与えられる整数の数、または許可される値の範囲には制限があるかもしれない。</p>

  <div class="impl">

  <p>The <dfn id="rules-for-parsing-a-list-of-integers">rules for parsing a list of integers</dfn> are as follows:</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p>Let <var data-anolis-xref="">numbers</var> be an initially empty list of integers. This list will be
   the result of this algorithm.</li>

   <li><p>If there is a character in the string <var data-anolis-xref="">input</var> at position <var data-anolis-xref="">position</var>, and it is either a U+0020 SPACE, U+002C COMMA, or U+003B SEMICOLON
   character, then advance <var data-anolis-xref="">position</var> to the next character in <var data-anolis-xref="">input</var>, or to beyond the end of the string if there are no more
   characters.</li>

   <li><p>If <var data-anolis-xref="">position</var> points to beyond the end of <var data-anolis-xref="">input</var>,
   return <var data-anolis-xref="">numbers</var> and abort.</li>

   <li><p>If the character in the string <var data-anolis-xref="">input</var> at position <var data-anolis-xref="">position</var> is a U+0020 SPACE, U+002C COMMA, or U+003B SEMICOLON character, then
   return to step 4.</li>

   <li><p>Let <var data-anolis-xref="">negated</var> be false.</li> <li><p>Let <var data-anolis-xref="">value</var> be
   0.</li>

   <li><p>Let <var data-anolis-xref="">started</var> be false. This variable is set to true when the parser
   sees a number or a "-" (U+002D) character.</li>

   <li><p>Let <var data-anolis-xref="">got number</var> be false. This variable is set to true when the parser
   sees a number.</li>

   <li><p>Let <var data-anolis-xref="">finished</var> be false. This variable is set to true to switch parser
   into a mode where it ignores characters until the next separator.</li>

   <li><p>Let <var data-anolis-xref="">bogus</var> be false.</li>

   <li><p><i>Parser</i>: If the character in the string <var data-anolis-xref="">input</var> at position <var data-anolis-xref="">position</var> is:</p>

    <dl class="switch"><dt>A U+002D HYPHEN-MINUS character</dt>

     <dd>

      <p>Follow these substeps:</p>

      <ol><li>If <var data-anolis-xref="">got number</var> is true, let <var data-anolis-xref="">finished</var> be true.</li>

       <li>If <var data-anolis-xref="">finished</var> is true, skip to the next step in the overall set of
       steps.</li>

       <li>If <var data-anolis-xref="">started</var> is true, let <var data-anolis-xref="">negated</var> be false.</li>

       <li>Otherwise, if <var data-anolis-xref="">started</var> is false and if <var data-anolis-xref="">bogus</var> is
       false, let <var data-anolis-xref="">negated</var> be true.</li>

       <li>Let <var data-anolis-xref="">started</var> be true.</li>

      </ol></dd>

     <dt>An <a data-anolis-xref="ASCII digits" href="#ascii-digits">ASCII digit</a></dt>

     <dd>

      <p>Follow these substeps:</p>

      <ol><li>If <var data-anolis-xref="">finished</var> is true, skip to the next step in the overall set of
       steps.</li>

       <li>Multiply <var data-anolis-xref="">value</var> by ten.</li>

       <li>Add the value of the digit, interpreted in base ten, to <var data-anolis-xref="">value</var>.</li>

       <li>Let <var data-anolis-xref="">started</var> be true.</li>

       <li>Let <var data-anolis-xref="">got number</var> be true.</li>

      </ol></dd>


     <dt>A U+0020 SPACE character</dt>
     <dt>A U+002C COMMA character</dt>
     <dt>A U+003B SEMICOLON character</dt>

     <dd>

      <p>Follow these substeps:</p>

      <ol><li>If <var data-anolis-xref="">got number</var> is false, return the <var data-anolis-xref="">numbers</var> list
       and abort. This happens if an entry in the list has no digits, as in "<code data-anolis-xref="">1,2,x,4</code>".</li>

       <li>If <var data-anolis-xref="">negated</var> is true, then negate <var data-anolis-xref="">value</var>.</li>

       <li>Append <var data-anolis-xref="">value</var> to the <var data-anolis-xref="">numbers</var> list.</li>

       <li>Jump to step 4 in the overall set of steps.</li>

      </ol></dd><!-- <dt>A U+002E FULL STOP character</dt> -->


     
     <dt>A character in the range U+0001 to U+001F,  <!-- space -->  U+0021 to U+002B,  <!-- comma -->  U+002D to U+002F,  <!-- digits -->  U+003A,  <!-- semicolon -->  U+003C to U+0040,  <!-- a-z -->  U+005B to U+0060,  <!-- A-Z -->  U+007b to U+007F
        (i.e. any other non-alphabetic ASCII character)</dt><!--
 Test: http://www.hixie.ch/tests/adhoc/html/flow/image-maps/004-demo.html
 IE6 on Wine treats the following characters like this also: U+1-U+1f, U+21-U+2b, U+2d-U+2f, U+3a,
 U+3c-U+40, U+5b-U+60, U+7b-U+82, U+84-U+89, U+8b, U+8d, U+8f-U+99, U+9b, U+9d, U+a0-U+bf, U+d7,
 U+f7, U+1f6-U+1f9, U+218-U+24f, U+2a9-U+385, U+387, U+38b, U+38d, U+3a2, U+3cf, U+3d7-U+3d9, U+3db,
 U+3dd, U+3df, U+3e1, U+3f4-U+400, U+40d, U+450, U+45d, U+482-U+48f, U+4c5-U+4c6, U+4c9-U+4ca,
 U+4cd-U+4cf, U+4ec-U+4ed, U+4f6-U+4f7, U+4fa-U+530, U+557-U+560, U+588-U+5cf, U+5eb-U+5ef,
 U+5f3-U+620, U+63b-U+640, U+64b-U+670, U+6b8-U+6b9, U+6bf, U+6cf, U+6d4, U+6d6-U+904, U+93a-U+957,
 U+962-U+984, U+98d-U+98e, U+991-U+992, U+9a9, U+9b1, U+9b3-U+9b5, U+9ba-U+9db, U+9de, U+9e2-U+9ef,
 U+9f2-U+a04, U+a0b-U+a0e, U+a11-U+a12, U+a29, U+a31, U+a34, U+a37, U+a3a-U+a58, U+a5d, U+a5f-U+a84,
 U+a8c, U+a8e, U+a92, U+aa9, U+ab1, U+ab4, U+aba-U+adf, U+ae1-U+b04, U+b0d-U+b0e, U+b11-U+b12,
 U+b29, U+b31, U+b34-U+b35, U+b3a-U+b5b, U+b5e, U+b62-U+b84, U+b8b-U+b8d, U+b91, U+b96-U+b98, U+b9b,
 U+b9d, U+ba0-U+ba2, U+ba5-U+ba7, U+bab-U+bad, U+bb6, U+bba-U+c04, U+c0d, U+c11, U+c29, U+c34,
 U+c3a-U+c5f, U+c62-U+c84, U+c8d, U+c91, U+ca9, U+cb4, U+cba-U+cdd, U+cdf, U+ce2-U+d04, U+d0d,
 U+d11, U+d29, U+d3a-U+d5f, U+d62-U+e00, U+e2f, U+e31, U+e34-U+e3f, U+e46-U+e80, U+e83, U+e85-U+e86,
 U+e89, U+e8b-U+e8c, U+e8e-U+e93, U+e98, U+ea0, U+ea4, U+ea6, U+ea8-U+ea9, U+eac, U+eaf-U+edb,
 U+ede-U+109f, U+10c6-U+10cf, U+10f7-U+10ff, U+115a-U+115e, U+11a3-U+11a7, U+11fa-U+1dff,
 U+1e9b-U+1e9f, U+1efa-U+1eff, U+1f16-U+1f17, U+1f1e-U+1f1f, U+1f46-U+1f47, U+1f4e-U+1f4f, U+1f58,
 U+1f5a, U+1f5c, U+1f5e, U+1f7e-U+1f7f, U+1fb5, U+1fbd-U+1fc1, U+1fc5, U+1fcd-U+1fcf, U+1fd4-U+1fd5,
 U+1fdc-U+1fdf, U+1fed-U+1ff1, U+1ff5, U+1ffd-U+249b, U+24ea-U+3004, U+3006-U+3040, U+3095-U+309a,
 U+309f-U+30a0, U+30fb, U+30ff-U+3104, U+312d-U+3130, U+318f-U+4dff, U+9fa6-U+abff, U+d7a4-U+d7ff,
 U+e000-U+f8ff, U+fa2e-U+faff, U+fb07-U+fb12, U+fb18-U+fb1e, U+fb37, U+fb3d, U+fb3f, U+fb42, U+fb45,
 U+fbb2-U+fbd2, U+fbe9, U+fce1, U+fd3e-U+fd4f, U+fd90-U+fd91, U+fdc8-U+fdef, U+fdfc-U+fe7f,
 U+fefd-U+ff20, U+ff3b-U+ff40, U+ff5b-U+ff65, U+ffa0, U+ffbf-U+ffc1, U+ffc8-U+ffc9, U+ffd0-U+ffd1,
 U+ffd8-U+ffd9, U+ffdd-U+ffff
 IE7 on Win2003 treats the following characters like this also instead: U+1-U+1f, U+21-U+2b,
 U+2d-U+2f, U+3a, U+3c-U+40, U+5b-U+60, U+7b-U+82, U+84-U+89, U+8b, U+8d, U+8f-U+99, U+9b, U+9d,
 U+a0-U+a9, U+ab-U+b4, U+b6-U+b9, U+bb-U+bf, U+d7, U+f7, U+220-U+221, U+234-U+24f, U+2ae-U+2af,
 U+2b9-U+2ba, U+2c2-U+2df, U+2e5-U+2ed, U+2ef-U+344, U+346-U+379, U+37b-U+385, U+387, U+38b, U+38d,
 U+3a2, U+3cf, U+3d8-U+3d9, U+3f4-U+3ff, U+482-U+48b, U+4c5-U+4c6, U+4c9-U+4ca, U+4cd-U+4cf,
 U+4f6-U+4f7, U+4fa-U+530, U+557-U+558, U+55a-U+560, U+588-U+5cf, U+5eb-U+5ef, U+5f3-U+620,
 U+63b-U+640, U+656-U+66f, U+6d4, U+6dd-U+6e0, U+6e9-U+6ec, U+6ee-U+6f9, U+6fd-U+70f, U+72d-U+72f,
 U+740-U+77f, U+7b1-U+900, U+904, U+93a-U+93c, U+94d - U+94f, U+951-U+957, U+964-U+980, U+984,
 U+98d-U+98e, U+991-U+992, U+9a9, U+9b1, U+9b3-U+9b5, U+9ba-U+9bd, U+9c5-U+9c6, U+9c9-U+9ca,
 U+9cd-U+9d6, U+9d8-U+9db, U+9de, U+9e4-U+9ef, U+9f2-U+a01, U+a03-U+a04, U+a0b-U+a0e, U+a11-U+a12,
 U+a29, U+a31, U+a34, U+a37, U+a3a-U+a3d, U+a43-U+a46, U+a49-U+a4a, U+a4d-U+a58, U+a5d, U+a5f-U+a6f,
 U+a75-U+a80, U+a84, U+a8c, U+a8e, U+a92, U+aa9, U+ab1, U+ab4, U+aba-U+abc, U+ac6, U+aca,
 U+acd-U+acf, U+ad1-U+adf, U+ae1-U+b00, U+b04, U+b0d-U+b0e, U+b11-U+b12, U+b29, U+b31, U+b34-U+b35,
 U+b3a-U+b3c, U+b44-U+b46, U+b49 - U+b4a, U+b4d-U+b55, U+b58-U+b5b, U+b5e, U+b62-U+b81, U+b84,
 U+b8b-U+b8d, U+b91, U+b96-U+b98, U+b9b, U+b9d, U+ba0 - U+ba2, U+ba5-U+ba7, U+bab-U+bad, U+bb6,
 U+bba-U+bbd, U+bc3-U+bc5, U+bc9, U+bcd-U+bd6, U+bd8-U+c00, U+c04, U+c0d, U+c11, U+c29, U+c34,
 U+c3a-U+c3d, U+c45, U+c49, U+c4d-U+c54, U+c57-U+c5f, U+c62-U+c81, U+c84, U+c8d, U+c91, U+ca9,
 U+cb4, U+cba-U+cbd, U+cc5, U+cc9, U+ccd-U+cd4, U+cd7-U+cdd, U+cdf, U+ce2-U+d01, U+d04, U+d0d,
 U+d11, U+d29, U+d3a-U+d3d, U+d44-U+d45, U+d49, U+d4d-U+d56, U+d58-U+d5f, U+d62-U+d81, U+d84,
 U+d97-U+d99, U+db2, U+dbc, U+dbe - U+dbf, U+dc7-U+dce, U+dd5, U+dd7, U+de0-U+df1, U+df4-U+e00,
 U+e3b-U+e3f, U+e4f-U+e80, U+e83, U+e85-U+e86, U+e89, U+e8b-U+e8c, U+e8e-U+e93, U+e98, U+ea0, U+ea4,
 U+ea6, U+ea8-U+ea9, U+eac, U+eba, U+ebe-U+ebf, U+ec5-U+ecc, U+ece-U+edb, U+ede-U+eff, U+f01-U+f3f,
 U+f48, U+f6b-U+f70, U+f82-U+f87, U+f8c-U+f8f, U+f98, U+fbd-U+fff, U+1022, U+1028, U+102b,
 U+1033-U+1035, U+1037, U+1039-U+104f, U+105a-U+109f, U+10c6-U+10cf, U+10f7-U+10ff, U+115a - U+115e,
 U+11a3-U+11a7, U+11fa-U+11ff, U+1207, U+1247, U+1249, U+124e-U+124f, U+1257, U+1259, U+125e-U+125f,
 U+1287, U+1289, U+128e-U+128f, U+12af, U+12b1, U+12b6-U+12b7, U+12bf, U+12c1, U+12c6-U+12c7,
 U+12cf, U+12d7, U+12ef, U+130f, U+1311, U+1316-U+1317, U+131f, U+1347, U+135b-U+139f,
 U+13f5-U+1400, U+166d-U+166e, U+1677-U+1680, U+169b - U+169f, U+16eb-U+177f, U+17c9-U+181f, U+1843,
 U+1878-U+187f, U+18aa-U+1dff, U+1e9c-U+1e9f, U+1efa-U+1eff, U+1f16-U+1f17, U+1f1e-U+1f1f,
 U+1f46-U+1f47, U+1f4e-U+1f4f, U+1f58, U+1f5a, U+1f5c, U+1f5e, U+1f7e-U+1f7f, U+1fb5, U+1fbd,
 U+1fbf-U+1fc1, U+1fc5, U+1fcd-U+1fcf, U+1fd4-U+1fd5, U+1fdc-U+1fdf, U+1fed-U+1ff1, U+1ff5,
 U+1ffd-U+207e, U+2080-U+2101, U+2103-U+2106, U+2108-U+2109, U+2114, U+2116-U+2118, U+211e-U+2123,
 U+2125, U+2127, U+2129, U+212e, U+2132, U+213a-U+215f, U+2184-U+3005, U+3008-U+3020, U+302a-U+3037,
 U+303b-U+3104, U+312d-U+3130, U+318f - U+319f, U+31b8-U+33ff, U+4db6-U+4dff, U+9fa6-U+9fff,
 U+a48d-U+abff, U+d7a4-U+d7ff, U+e000-U+f8ff, U+fa2e-U+faff, U+fb07-U+fb12, U+fb18-U+fb1c, U+fb1e,
 U+fb29, U+fb37, U+fb3d, U+fb3f, U+fb42, U+fb45, U+fbb2-U+fbd2, U+fd3e-U+fd4f, U+fd90-U+fd91,
 U+fdc8-U+fdef, U+fdfc-U+fe6f, U+fe73, U+fe75, U+fefd-U+ff20, U+ff3b-U+ff40, U+ff5b-U+ff9f,
 U+ffbf-U+ffc1, U+ffc8-U+ffc9, U+ffd0-U+ffd1, U+ffd8-U+ffd9, U+ffdd-U+ffff
-->

 

     <dd>

      <p>Follow these substeps:</p>

      <ol><li>If <var data-anolis-xref="">got number</var> is true, let <var data-anolis-xref="">finished</var> be true.</li>

       <li>If <var data-anolis-xref="">finished</var> is true, skip to the next step in the overall set of
       steps.</li>

       <li>Let <var data-anolis-xref="">negated</var> be false.</li>

      </ol></dd>


     <dt>Any other character</dt><!-- alphabetic a-z A-Z, and non-ASCII -->
     

     <dd>

      <p>Follow these substeps:</p>

      <ol><li>If <var data-anolis-xref="">finished</var> is true, skip to the next step in the overall set of
       steps.</li>

       <li>Let <var data-anolis-xref="">negated</var> be false.</li>

       <li>Let <var data-anolis-xref="">bogus</var> be true.</li>

       <li>If <var data-anolis-xref="">started</var> is true, then return the <var data-anolis-xref="">numbers</var> list,
       and abort. (The value in <var data-anolis-xref="">value</var> is not appended to the list first; it is
       dropped.)</li>

      </ol></dd>

    </dl></li>

   <li><p>Advance <var data-anolis-xref="">position</var> to the next character in <var data-anolis-xref="">input</var>,
   or to beyond the end of the string if there are no more characters.</li>

   <li><p>If <var data-anolis-xref="">position</var> points to a character (and not to beyond the end of <var data-anolis-xref="">input</var>), jump to the big <i>Parser</i> step above.</li>

   <li><p>If <var data-anolis-xref="">negated</var> is true, then negate <var data-anolis-xref="">value</var>.</li>

   <li><p>If <var data-anolis-xref="">got number</var> is true, then append <var data-anolis-xref="">value</var> to the
   <var data-anolis-xref="">numbers</var> list.</li>

   <li><p>Return the <var data-anolis-xref="">numbers</var> list and abort.</li>

  </ol></div>


  <div class="impl">

  <h5 id="lists-of-dimensions"><span class="secno">2.4.4.6 </span>Lists of dimensions</h5><!-- no definition of a type since no conforming feature uses this syntax (it's only used in
  cols="" and rows="" on <frameset> elements -->

  

  <p>The <dfn id="rules-for-parsing-a-list-of-dimensions">rules for parsing a list of dimensions</dfn> are as follows. These rules return a list
  of zero or more pairs consisting of a number and a unit, the unit being one of <i>percentage</i>,
  <i>relative</i>, and <i>absolute</i>.</p>

  <ol><li><p>Let <var data-anolis-xref="">raw input</var> be the string being parsed.</li>

   <li><p>If the last character in <var data-anolis-xref="">raw input</var> is a "," (U+002C) character,
   then remove that character from <var data-anolis-xref="">raw input</var>.</li>

   <li><p><a data-anolis-xref="split a string on commas" href="#split-a-string-on-commas">Split the string <var data-anolis-xref="">raw input</var> on
   commas</a>. Let <var data-anolis-xref="">raw tokens</var> be the resulting list of tokens.</li>

   <li><p>Let <var data-anolis-xref="">result</var> be an empty list of number/unit pairs.</li>

   <li>

    <p>For each token in <var data-anolis-xref="">raw tokens</var>, run the following substeps:</p>

    <ol><li><p>Let <var data-anolis-xref="">input</var> be the token.</li>


     <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>,
     initially pointing at the start of the string.</li>

     <li><p>Let <var data-anolis-xref="">value</var> be the number 0.</li>

     <li><p>Let <var data-anolis-xref="">unit</var> be <i>absolute</i>.</li>


     <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, set <var data-anolis-xref="">unit</var> to <i>relative</i> and jump to the last substep.</li>

     <li><p>If the character at <var data-anolis-xref="">position</var> is an <a data-anolis-xref="ASCII
     digits" href="#ascii-digits">ASCII digit</a>, <a href="#collect-a-sequence-of-characters">collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII
     digits</a>, interpret the resulting sequence as an integer in base ten, and increment <var data-anolis-xref="">value</var> by that integer.</li>

     <li>


      <p>If the character at <var data-anolis-xref="">position</var> is a "." (U+002E) character, run
      these substeps:</p>

      <ol><li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> consisting of <a data-anolis-xref="space
       character" href="#space-character">space characters</a> and <a href="#ascii-digits">ASCII digits</a>. Let <var data-anolis-xref="">s</var>
       be the resulting sequence.</li>

       <li><p>Remove all <a data-anolis-xref="space character" href="#space-character">space characters</a> in <var data-anolis-xref="">s</var>.</li>

       <li>

        <p>If <var data-anolis-xref="">s</var> is not the empty string, run these subsubsteps:</p>

        <ol><li><p>Let <var data-anolis-xref="">length</var> be the number of characters in <var data-anolis-xref="">s</var> (after the spaces were removed).</li>

         <li><p>Let <var data-anolis-xref="">fraction</var> be the result of interpreting <var data-anolis-xref="">s</var> as a base-ten integer, and then dividing that number by <span data-anolis-xref="">10<sup data-anolis-xref=""><var data-anolis-xref="">length</var></sup></span>.</li>

         <li><p>Increment <var data-anolis-xref="">value</var> by <var data-anolis-xref="">fraction</var>.</li>

        </ol></li>

      </ol></li>

     <li><p><a href="#skip-whitespace">Skip whitespace</a>.</li>

     <li>


      <p>If the character at <var data-anolis-xref="">position</var> is a "%" (U+0025) character,
      then set <var data-anolis-xref="">unit</var> to <i>percentage</i>.</p>

      <p>Otherwise, if the character at <var data-anolis-xref="">position</var> is a U+002A ASTERISK character
      (*), then set <var data-anolis-xref="">unit</var> to <i>relative</i>.</p>

     </li><!-- the remaining characters in /input/ are ignored -->

     


     <li><p>Add an entry to <var data-anolis-xref="">result</var> consisting of the number given by <var data-anolis-xref="">value</var> and the unit given by <var data-anolis-xref="">unit</var>.</li>

    </ol></li>

   <li><p>Return the list <var data-anolis-xref="">result</var>.</li>

  </ol></div>


  <h4 id="dates-and-times"><span class="secno">2.4.5</span> 日付および時刻</h4>

  <p>下記のアルゴリズムにおいて、<dfn id="number-of-days-in-month-month-of-year-year">年<var data-anolis-xref="">year</var>の月<var data-anolis-xref="">month</var>の日数</dfn>は：<var data-anolis-xref="">month</var>が1、3、5、7、8、10、12ならば<em>31</em>である。<var data-anolis-xref="">month</var>が4、6、9、11ならば<em>30</em>である。<var data-anolis-xref="">month</var>が2かつ<var data-anolis-xref="">year</var>が400で割り切れる数、または<var data-anolis-xref="">year</var>が4で割り切れるが100で割り切れないならば<em>29</em>であり、そうでなければ<em>28</em>である。これは、グレゴリオ暦の閏年を考慮に入れている。<a href="references.html#refsGREGORIAN">[GREGORIAN]</a></p>

  <p><a href="#ascii-digits">ASCII数字</a>がこの節で定義される日付および時刻の構文で使用される場合、これらは10進数で表現される。</p>

  <div class="impl">

  <p class="note">While the formats described here are intended to be subsets of the corresponding
  ISO8601 formats, this specification defines parsing rules in much more detail than ISO8601.
  Implementors are therefore encouraged to carefully examine any date parsing libraries before using
  them to implement the parsing rules described below; ISO8601 libraries might not parse dates and
  times in exactly the same manner. <a href="references.html#refsISO8601">[ISO8601]</a></p>

  </div>

  <p>この仕様が<dfn id="proleptic-gregorian-calendar">先発グレゴリオ暦</dfn>を参照する場合、これは、1年に遡って挿入された現代のグレゴリオ暦を意味する。<dfn id="proleptic-gregorian-date">先発グレゴリオ日付</dfn>として明示的に参照される<a href="#proleptic-gregorian-calendar">先発グレゴリオ暦</a>での日付は、たとえ暦が問題の時刻（または場所）で使用されていないとしても、その暦を使用して説明される。<a href="references.html#refsGREGORIAN">[GREGORIAN]</a></p>

  <p class="note">この仕様においてワイヤ形式としてのグレゴリオ暦の使用は、決定に関わる人々の文化的なバイアスに起因する恣意的な選択肢である。See also the section discussing <a href="forms.html#input-author-notes">date, time, and number formats</a> in forms <span class="impl">(for authors), <a href="forms.html#input-impl-notes">implemention notes regarding localization of form controls</a>,</span> and the <code><a href="text-level-semantics.html#the-time-element">time</a></code> element.</p>


  <h5 id="months"><span class="secno">2.4.5.1</span> 月</h5>

  <p><dfn data-anolis-xref="concept-month" id="concept-month">月</dfn>は、タイムゾーン情報および年と月を超えた日付を持たない、特定の<a href="#proleptic-gregorian-date">先発グレゴリオ暦</a>から成る。<a href="references.html#refsGREGORIAN">[GREGORIAN]</a></p>

  <p>与えられた順で以下のコンポーネントからなる場合、文字列は、年<var data-anolis-xref="">year</var>および月<var data-anolis-xref="">month</var>で表される<dfn id="valid-month-string">妥当な月文字列</dfn>である：</p>

  <ol><li>4<a href="#ascii-digits">桁</a>以上で表される<var data-anolis-xref="">year</var>。ここで<var data-anolis-xref="">year</var>&nbsp;&gt;&nbsp;0である。</li>

   <li>"-"（U+002D）文字</li>

   <li>1&nbsp;≤&nbsp;<var data-anolis-xref="">month</var>&nbsp;≤&nbsp;12の範囲で、月<var data-anolis-xref="">month</var>を表す2つの<a href="#ascii-digits">ASCII数字</a></li>

  </ol><div class="impl">

  <p>The rules to <dfn id="parse-a-month-string">parse a month string</dfn> are as follows. This will return either a year and
  month, or nothing. If at any point the algorithm says that it "fails", this means that it is
  aborted at that point and returns nothing.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p><a href="#parse-a-month-component">Parse a month component</a> to obtain <var data-anolis-xref="">year</var> and <var data-anolis-xref="">month</var>. If this returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is <em>not</em> beyond the
   end of <var data-anolis-xref="">input</var>, then fail.</li>

   <li><p>Return <var data-anolis-xref="">year</var> and <var data-anolis-xref="">month</var>.</li>

  </ol><p>The rules to <dfn id="parse-a-month-component">parse a month component</dfn>, given an <var data-anolis-xref="">input</var> string and
  a <var data-anolis-xref="">position</var>, are as follows. This will return either a year and a month, or
  nothing. If at any point the algorithm says that it "fails", this means that it is aborted at that
  point and returns nothing.</p>

  <ol><li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. If the
   collected sequence is not at least four characters long, then fail. Otherwise, interpret the
   resulting sequence as a base-ten integer. Let that number be the <var data-anolis-xref="">year</var>.</li>

   <li><p>If <var data-anolis-xref="">year</var> is not a number greater than zero, then fail.</li>

   <li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var> or if the
   character at <var data-anolis-xref="">position</var> is not a U+002D HYPHEN-MINUS character, then fail.
   Otherwise, move <var data-anolis-xref="">position</var> forwards one character.</li>

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. If the
   collected sequence is not exactly two characters long, then fail. Otherwise, interpret the
   resulting sequence as a base-ten integer. Let that number be the <var data-anolis-xref="">month</var>.</li>

   <li><p>If <var data-anolis-xref="">month</var> is not a number in the range 1&nbsp;≤&nbsp;<var data-anolis-xref="">month</var>&nbsp;≤&nbsp;12, then fail.</li>

   <li><p>Return <var data-anolis-xref="">year</var> and <var data-anolis-xref="">month</var>.</li>

  </ol></div>


  <h5 id="dates"><span class="secno">2.4.5.2</span> 日付</h5>

  <p><dfn data-anolis-xref="concept-date" id="concept-date">日付</dfn>は、年月日からなりタイムゾーン情報を持たない、特定の<a href="#proleptic-gregorian-date">先発グレゴリオ暦</a>からなる。<a href="references.html#refsGREGORIAN">[GREGORIAN]</a></p>

  <p>与えられた順で以下のコンポーネントからなる場合、文字列は年<var data-anolis-xref="">year</var>、月<var data-anolis-xref="">month</var>、日<var data-anolis-xref="">day</var>で表される<dfn id="valid-date-string">妥当な日付文字列</dfn>である：</p>

  <ol><li><var data-anolis-xref="">year</var>および<var data-anolis-xref="">month</var>で表される、<a href="#valid-month-string">妥当な月文字列</a></li>

   <li>"-"（U+002D）文字</li>

   <li>1&nbsp;≤&nbsp;<var data-anolis-xref="">day</var>&nbsp;≤&nbsp;<var data-anolis-xref="">maxday</var>の範囲での<var data-anolis-xref="">day</var>で表される2つの<a href="#ascii-digits">ASCII数字</a>。ここで<var data-anolis-xref="">maxday</var>は<a data-anolis-xref="number of days in month month of year year" href="#number-of-days-in-month-month-of-year-year">年<var data-anolis-xref="">year</var>および月<var data-anolis-xref="">month</var>での日の数</a>である。</li>

  </ol><div class="impl">

  <p>The rules to <dfn id="parse-a-date-string">parse a date string</dfn> are as follows. This will return either a date, or
  nothing. If at any point the algorithm says that it "fails", this means that it is aborted at that
  point and returns nothing.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p><a href="#parse-a-date-component">Parse a date component</a> to obtain <var data-anolis-xref="">year</var>, <var data-anolis-xref="">month</var>, and <var data-anolis-xref="">day</var>. If this returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is <em>not</em> beyond the end of <var data-anolis-xref="">input</var>, then fail.</li>

   <li><p>Let <var data-anolis-xref="">date</var> be the date with year <var data-anolis-xref="">year</var>, month <var data-anolis-xref="">month</var>, and day <var data-anolis-xref="">day</var>.</li>

   <li><p>Return <var data-anolis-xref="">date</var>.</li>

  </ol><p>The rules to <dfn id="parse-a-date-component">parse a date component</dfn>, given an <var data-anolis-xref="">input</var> string and a
  <var data-anolis-xref="">position</var>, are as follows. This will return either a year, a month, and a day,
  or nothing. If at any point the algorithm says that it "fails", this means that it is aborted at
  that point and returns nothing.</p>

  <ol><li><p><a href="#parse-a-month-component">Parse a month component</a> to obtain <var data-anolis-xref="">year</var> and <var data-anolis-xref="">month</var>. If this returns nothing, then fail.</li>

   <li><p>Let <var data-anolis-xref="">maxday</var> be the <a href="#number-of-days-in-month-month-of-year-year">number of days in month <var data-anolis-xref="">month</var> of year <var data-anolis-xref="">year</var></a>.</li>

   <li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var> or if the
   character at <var data-anolis-xref="">position</var> is not a U+002D HYPHEN-MINUS character, then fail.
   Otherwise, move <var data-anolis-xref="">position</var> forwards one character.</li>

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. If the
   collected sequence is not exactly two characters long, then fail. Otherwise, interpret the
   resulting sequence as a base-ten integer. Let that number be the <var data-anolis-xref="">day</var>.</li>

   <li><p>If <var data-anolis-xref="">day</var> is not a number in the range 1&nbsp;≤&nbsp;<var data-anolis-xref="">day</var>&nbsp;≤&nbsp;<var data-anolis-xref="">maxday</var>, then fail.</li>

   <li><p>Return <var data-anolis-xref="">year</var>, <var data-anolis-xref="">month</var>, and <var data-anolis-xref="">day</var>.</li>

  </ol></div>


  <h5 id="yearless-dates"><span class="secno">2.4.5.3</span> 年なし日付</h5>

  <p><dfn data-anolis-xref="concept-yearless-date" id="concept-yearless-date">年なし日付</dfn>はグレコリオ月とその月の日からなるが、年を伴わない。<a href="references.html#refsGREGORIAN">[GREGORIAN]</a></p>

  <p>与えられた順で以下のコンポーネントからなる場合、文字列は月<var data-anolis-xref="">month</var>および日<var data-anolis-xref="">day</var>で表される<dfn id="valid-yearless-date-string">妥当な年なし日付文字列</dfn>である：</p>

  <ol><li>任意で、2つの"-"（U+002D）文字</li>

   <li>1&nbsp;≤&nbsp;<var data-anolis-xref="">month</var>&nbsp;≤&nbsp;12の範囲で、月<var data-anolis-xref="">month</var>を表す2つの<a href="#ascii-digits">ASCII数字</a></li>

   <li>"-"（U+002D）文字</li>

   <li>1&nbsp;≤&nbsp;<var data-anolis-xref="">day</var>&nbsp;≤&nbsp;<var data-anolis-xref="">maxday</var>の範囲での<var data-anolis-xref="">day</var>で表される2つの<a href="#ascii-digits">ASCII数字</a>。ここで<var data-anolis-xref="">maxday</var>は月<var data-anolis-xref="">month</var>かつ任意の閏年（たとえば4または2000）における<a data-anolis-xref="number of days in month month of year year" href="#number-of-days-in-month-month-of-year-year">日数</a>である。</li>

  </ol><p class="note">言い換えると、2月を意味する<var data-anolis-xref="">month</var>が"<code data-anolis-xref="">02</code>"である場合、あたかもその年は閏年かのように、日は29であってもよい。</p>

  <div class="impl">

  <p>The rules to <dfn id="parse-a-yearless-date-string">parse a yearless date string</dfn> are as follows. This will return either a
  month and a day, or nothing. If at any point the algorithm says that it "fails", this means that
  it is aborted at that point and returns nothing.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p><a href="#parse-a-yearless-date-component">Parse a yearless date component</a> to obtain <var data-anolis-xref="">month</var> and <var data-anolis-xref="">day</var>. If this returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is <em>not</em> beyond the end of <var data-anolis-xref="">input</var>, then fail.</li>

   <li><p>Return <var data-anolis-xref="">month</var> and <var data-anolis-xref="">day</var>.</li>

  </ol><p>The rules to <dfn id="parse-a-yearless-date-component">parse a yearless date component</dfn>, given an <var data-anolis-xref="">input</var>
  string and a <var data-anolis-xref="">position</var>, are as follows. This will return either a month and a
  day, or nothing. If at any point the algorithm says that it "fails", this means that it is aborted
  at that point and returns nothing.</p>

  <ol><li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are "-" (U+002D) characters.
   If the collected sequence is not exactly zero or two characters long, then fail.</li>

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. If the
   collected sequence is not exactly two characters long, then fail. Otherwise, interpret the
   resulting sequence as a base-ten integer. Let that number be the <var data-anolis-xref="">month</var>.</li>

   <li><p>If <var data-anolis-xref="">month</var> is not a number in the range 1&nbsp;≤&nbsp;<var data-anolis-xref="">month</var>&nbsp;≤&nbsp;12, then fail.</li>

   <li><p>Let <var data-anolis-xref="">maxday</var> be the <a data-anolis-xref="number of days in month month of year
   year" href="#number-of-days-in-month-month-of-year-year">number of days</a> in month <var data-anolis-xref="">month</var> of any arbitrary leap year (e.g. 4
   or 2000).</li>

   <li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var> or if the
   character at <var data-anolis-xref="">position</var> is not a U+002D HYPHEN-MINUS character, then fail.
   Otherwise, move <var data-anolis-xref="">position</var> forwards one character.</li>

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. If the
   collected sequence is not exactly two characters long, then fail. Otherwise, interpret the
   resulting sequence as a base-ten integer. Let that number be the <var data-anolis-xref="">day</var>.</li>

   <li><p>If <var data-anolis-xref="">day</var> is not a number in the range 1&nbsp;≤&nbsp;<var data-anolis-xref="">day</var>&nbsp;≤&nbsp;<var data-anolis-xref="">maxday</var>, then fail.</li>

   <li><p>Return <var data-anolis-xref="">month</var> and <var data-anolis-xref="">day</var>.</li>

  </ol></div>


  <h5 id="times"><span class="secno">2.4.5.4</span> 時刻</h5>

  <p><dfn data-anolis-xref="concept-time" id="concept-time">時刻</dfn>は、時、分、秒、秒以下からなりタイムゾーン情報を持たない、特定の時刻からなる。</p>

  <p>与えられた順で以下のコンポーネントからなる場合、文字列は、時<var data-anolis-xref="">hour</var>、分<var data-anolis-xref="">minute</var>、秒<var data-anolis-xref="">second</var>で表される<dfn id="valid-time-string">妥当な時刻文字列</dfn>である：</p>

  <ol><li>0&nbsp;≤&nbsp;<var data-anolis-xref="">hour</var>&nbsp;≤&nbsp;23の範囲で、<var data-anolis-xref="">hour</var>を表す2つの<a href="#ascii-digits">ASCII数字</a></li>

   <li>":"（U+003A）文字</li>

   <li>0&nbsp;≤&nbsp;<var data-anolis-xref="">minute</var>&nbsp;≤&nbsp;59の範囲で<var data-anolis-xref="">minute</var>を表す2つの<a href="#ascii-digits">ASCII数字</a></li>

   <li>If <var data-anolis-xref="">second</var> is non-zero, or optionally if <var data-anolis-xref="">second</var> is
   zero:

    

    <ol><li>":"（U+003A）文字</li>

     <li>0&nbsp;≤&nbsp;<var data-anolis-xref="">s</var>&nbsp;≤&nbsp;59の範囲で、<var data-anolis-xref="">second</var>整数部を表す2つの<a href="#ascii-digits">ASCII数字</a></li>

     <li>If <var data-anolis-xref="">second</var> is not an integer, or optionally if <var data-anolis-xref="">second</var> is an integer:

      

      <ol><li>U+002E FULL STOP文字（.）</li>

       <li><var data-anolis-xref="">second</var>分数部で表される、1、2、また3<a href="#ascii-digits">桁</a></li>

      </ol></li>

    </ol></li>

  </ol><p class="note"><var data-anolis-xref="">second</var>コンポーネントは60または61にはなり得ない。閏秒を表すことはできない。</p>

  <div class="impl">

  <p>The rules to <dfn id="parse-a-time-string">parse a time string</dfn> are as follows. This will return either a time, or
  nothing. If at any point the algorithm says that it "fails", this means that it is aborted at that
  point and returns nothing.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p><a href="#parse-a-time-component">Parse a time component</a> to obtain <var data-anolis-xref="">hour</var>, <var data-anolis-xref="">minute</var>, and <var data-anolis-xref="">second</var>. If this returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is <em>not</em> beyond the end of <var data-anolis-xref="">input</var>, then fail.</li>

   <li><p>Let <var data-anolis-xref="">time</var> be the time with hour <var data-anolis-xref="">hour</var>, minute <var data-anolis-xref="">minute</var>, and second <var data-anolis-xref="">second</var>.</li>

   <li><p>Return <var data-anolis-xref="">time</var>.</li>

  </ol><p>The rules to <dfn id="parse-a-time-component">parse a time component</dfn>, given an <var data-anolis-xref="">input</var> string and a
  <var data-anolis-xref="">position</var>, are as follows. This will return either an hour, a minute, and a
  second, or nothing. If at any point the algorithm says that it "fails", this means that it is
  aborted at that point and returns nothing.</p>

  <ol><li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. If the
   collected sequence is not exactly two characters long, then fail. Otherwise, interpret the
   resulting sequence as a base-ten integer. Let that number be the <var data-anolis-xref="">hour</var>.</li>

   <li>If <var data-anolis-xref="">hour</var> is not a number in the range 0&nbsp;≤&nbsp;<var data-anolis-xref="">hour</var>&nbsp;≤&nbsp;23, then fail.</li>

   <li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var> or if the
   character at <var data-anolis-xref="">position</var> is not a U+003A COLON character, then fail. Otherwise,
   move <var data-anolis-xref="">position</var> forwards one character.</li>

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. If the
   collected sequence is not exactly two characters long, then fail. Otherwise, interpret the
   resulting sequence as a base-ten integer. Let that number be the <var data-anolis-xref="">minute</var>.</li>

   <li>If <var data-anolis-xref="">minute</var> is not a number in the range 0&nbsp;≤&nbsp;<var data-anolis-xref="">minute</var>&nbsp;≤&nbsp;59, then fail.</li>

   <li><p>Let <var data-anolis-xref="">second</var> be a string with the value "0".</li>

   <li>

    <p>If <var data-anolis-xref="">position</var> is not beyond the end of <var data-anolis-xref="">input</var> and the
    character at <var data-anolis-xref="">position</var> is a U+003A COLON, then run these substeps:</p>

    <ol><li><p>Advance <var data-anolis-xref="">position</var> to the next character in <var data-anolis-xref="">input</var>.</li>

     <li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var>, or at
     the last character in <var data-anolis-xref="">input</var>, or if the next <em>two</em> characters in <var data-anolis-xref="">input</var> starting at <var data-anolis-xref="">position</var> are not both <a href="#ascii-digits">ASCII
     digits</a>, then fail.</li>

     <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are either <a href="#ascii-digits">ASCII digits</a>
     or U+002E FULL STOP characters. If the collected sequence is three characters long, or if it is
     longer than three characters long and the third character is not a U+002E FULL STOP character,
     or if it has more than one U+002E FULL STOP character, then fail. Otherwise, let the collected
     string be <var data-anolis-xref="">second</var> instead of its previous value.</li>

    </ol></li>

   <li><p>Interpret <var data-anolis-xref="">second</var> as a base-ten number (possibly with a fractional
   part). Let <var data-anolis-xref="">second</var> be that number instead of the string version.</li>

   <li><p>If <var data-anolis-xref="">second</var> is not a number in the range 0&nbsp;≤&nbsp;<var data-anolis-xref="">second</var>&nbsp;&lt;&nbsp;60, then fail.</li>

   <li><p>Return <var data-anolis-xref="">hour</var>, <var data-anolis-xref="">minute</var>, and <var data-anolis-xref="">second</var>.</li>

  </ol></div><!--START FORK rename local->floating-->

  
  <h5 id="floating-dates-and-times"><span class="secno">2.4.5.5</span> 浮動日付および時刻</h5>

  <p><dfn data-anolis-xref="concept-datetime-floating" id="concept-datetime-floating">浮動日付および時刻</dfn>は、年、月、日、時、分、秒、秒以下からなる特定の<a href="#proleptic-gregorian-date">先発グレコリオ暦</a>からなるが、タイムゾーン情報を持たない。<a href="references.html#refsGREGORIAN">[GREGORIAN]</a></p>

  <p>与えられた順で以下のコンポーネントからなる場合、文字列は<dfn id="valid-floating-date-and-time-string">妥当な浮動日付および時刻文字列</dfn>である：</p>

  <ol><li>日付を表す<a href="#valid-date-string">妥当な日付文字列</a></li>

   <li>"T"（U+0054）文字またはU+0020 SPACE文字</li>

   <li>時刻を表す<a href="#valid-time-string">妥当な時刻文字列</a></li>

  </ol><p>与えられた順で以下のコンポーネントからなる場合、文字列は<dfn id="valid-normalised-floating-date-and-time-string">妥当な規格化浮動日付および時刻文字列</dfn>である：</p>

  <ol><li>日付を表す<a href="#valid-date-string">妥当な日付文字列</a></li>

   <li>"T"（U+0054）文字</li>

   <li>時刻を表す<a href="#valid-time-string">妥当な時間文字列</a>は、与えられた時刻に対して可能な限り最短の文字列として表現される（たとえば、与えられた時刻がゼロ秒分を過ぎている場合、完全に秒のコンポーネントを省略する）</li>

  </ol><div class="impl">

  <p>The rules to <dfn id="parse-a-floating-date-and-time-string">parse a floating date and time string</dfn> are as follows. This will return
  either a date and time, or nothing. If at any point the algorithm says that it "fails", this means
  that it is aborted at that point and returns nothing.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p><a href="#parse-a-date-component">Parse a date component</a> to obtain <var data-anolis-xref="">year</var>, <var data-anolis-xref="">month</var>, and <var data-anolis-xref="">day</var>. If this returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var> or if the
   character at <var data-anolis-xref="">position</var> is neither a U+0054 LATIN CAPITAL LETTER T character
   (T) nor a U+0020 SPACE character, then fail. Otherwise, move <var data-anolis-xref="">position</var>
   forwards one character.</li>

   <li><p><a href="#parse-a-time-component">Parse a time component</a> to obtain <var data-anolis-xref="">hour</var>, <var data-anolis-xref="">minute</var>, and <var data-anolis-xref="">second</var>. If this returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is <em>not</em> beyond the end of <var data-anolis-xref="">input</var>, then fail.</li>

   <li><p>Let <var data-anolis-xref="">date</var> be the date with year <var data-anolis-xref="">year</var>, month <var data-anolis-xref="">month</var>, and day <var data-anolis-xref="">day</var>.</li>

   <li><p>Let <var data-anolis-xref="">time</var> be the time with hour <var data-anolis-xref="">hour</var>, minute <var data-anolis-xref="">minute</var>, and second <var data-anolis-xref="">second</var>.</li>

   <li><p>Return <var data-anolis-xref="">date</var> and <var data-anolis-xref="">time</var>.</li>

  </ol></div>


  <h5 id="time-zones"><span class="secno">2.4.5.6</span> タイムゾーン</h5>

  <p><dfn data-anolis-xref="concept-timezone" id="concept-timezone">タイムゾーンオフセット</dfn>は符号付きの時と分の数字からなる。</p>

  <p>次のいずれかからなる場合、文字列は、タイムゾーンオフセットを表す<dfn id="valid-time-zone-offset-string">妥当なタイムゾーンオフセット文字列</dfn>である：</p>


  <ul><li><p>タイムゾーンがUTCの場合のみ許される、"Z"（U+005A）文字</li>

   <li>

    <p>または、与えられた順で以下のコンポーネント：</p>

    <ol><li>タイムゾーンオフセットがゼロでない場合、タイムゾーンオフセットの符号を表す、"+"（U+002B）文字または"-"（U+002D）文字のいずれか</li><!-- the -00:00 offset is disallowed because RFC3339 gives it a special semantic -->
     

     <li>0&nbsp;≤&nbsp;<var data-anolis-xref="">hour</var>&nbsp;≤&nbsp;23の範囲で、タイムゾーンオフセットの時コンポーネント<var data-anolis-xref="">hour</var>を表す2つの<a href="#ascii-digits">ASCII数字</a></li>

     <li>任意で、":"（U+003A）文字</li>

     <li>0&nbsp;≤&nbsp;<var data-anolis-xref="">minute</var>&nbsp;≤&nbsp;59の範囲で、タイムゾーンオフセットの分コンポーネント<var data-anolis-xref="">minute</var>を表す2つの<a href="#ascii-digits">ASCII数字</a></li>

    </ol></li>

  </ul><p class="note">この形式は、-23:59から+23:59までのタイムゾーンオフセットを許可する。しかし、特に、実際のタイムゾーンオフセットの範囲は-12:00から+14:00までであり、実際のタイムゾーンオフセットの分コンポーネントは常に00、30または45のいずれかである。とはいえ、永遠に保持される保証はない。タイムゾーンは国によって思いのままに変更され、標準に従わない。</p><!--FORK-->

  <p class="note">正式なタイムゾーンの形成以前に遡る歴史的な時代でのタイムゾーンのオフセットを使用についての詳細は、下記の<a data-anolis-xref="concept-datetime" href="#concept-datetime">グローバル日付および時刻</a>の節にある使用上の注意と例を参照のこと。</p>

  <div class="impl">

  <p>The rules to <dfn id="parse-a-time-zone-offset-string">parse a time-zone offset string</dfn> are as follows. This will return either
  a time-zone offset, or nothing. If at any point the algorithm says that it "fails", this means
  that it is aborted at that point and returns nothing.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p><a href="#parse-a-time-zone-offset-component">Parse a time-zone offset component</a> to obtain <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var> and <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var>. If this
   returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is <em>not</em> beyond the end of <var data-anolis-xref="">input</var>, then fail.</li>

   <li><p>Return the time-zone offset that is <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var>
   hours and <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var> minutes from UTC.</li>

  </ol><p>The rules to <dfn id="parse-a-time-zone-offset-component">parse a time-zone offset component</dfn>, given an <var data-anolis-xref="">input</var>
  string and a <var data-anolis-xref="">position</var>, are as follows. This will return either time-zone hours
  and time-zone minutes, or nothing. If at any point the algorithm says that it "fails", this means
  that it is aborted at that point and returns nothing.</p>

  <ol><li>

    <p>If the character at <var data-anolis-xref="">position</var> is a U+005A LATIN CAPITAL LETTER Z character
    (Z), then:</p>

    <ol><li><p>Let <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var> be 0.</li>

     <li><p>Let <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var> be 0.</li>

     <li><p>Advance <var data-anolis-xref="">position</var> to the next character in <var data-anolis-xref="">input</var>.</li>

    </ol><p>Otherwise, if the character at <var data-anolis-xref="">position</var> is either a "+" (U+002B)
    or a "-" (U+002D), then:</p>

    <ol><li><p>If the character at <var data-anolis-xref="">position</var> is a "+" (U+002B), let <var data-anolis-xref="">sign</var> be "positive". Otherwise, it's a "-" (U+002D); let <var data-anolis-xref="">sign</var> be "negative".</li>

     <li><p>Advance <var data-anolis-xref="">position</var> to the next character in <var data-anolis-xref="">input</var>.</li>

     <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. Let
     <var data-anolis-xref="">s</var> be the collected sequence.</li>

     <li>

      <p>If <var data-anolis-xref="">s</var> is exactly two characters long, then run these substeps:</p>

      <ol><li><p>Interpret <var data-anolis-xref="">s</var> as a base-ten integer. Let that number be the <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var>.</li>

       <li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var> or if
       the character at <var data-anolis-xref="">position</var> is not a U+003A COLON character, then fail.
       Otherwise, move <var data-anolis-xref="">position</var> forwards one character.</li>

       <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. If
       the collected sequence is not exactly two characters long, then fail. Otherwise, interpret
       the resulting sequence as a base-ten integer. Let that number be the <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var>.</li>

      </ol><p>If <var data-anolis-xref="">s</var> is exactly four characters long, then run these substeps:</p>

      <ol><li><p>Interpret the first two characters of <var data-anolis-xref="">s</var> as a base-ten integer. Let
       that number be the <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var>.</li>

       <li><p>Interpret the last two characters of <var data-anolis-xref="">s</var> as a base-ten integer. Let
       that number be the <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var>.</li>

      </ol><p>Otherwise, fail.</p>

     </li>

     <li>If <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var> is not a number in the range
     0&nbsp;≤&nbsp;<var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var>&nbsp;≤&nbsp;23, then
     fail.</li>

     <li>If <var data-anolis-xref="">sign</var> is "negative", then negate <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var>.</li>

     <li>If <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var> is not a number in the range
     0&nbsp;≤&nbsp;<var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var>&nbsp;≤&nbsp;59,
     then fail.</li>

     <li>If <var data-anolis-xref="">sign</var> is "negative", then negate <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var>.</li>

    </ol><p>Otherwise, fail.</p>

   </li>

   <li><p>Return <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var> and <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var>.</li>

  </ol></div>


  <h5 id="global-dates-and-times"><span class="secno">2.4.5.7</span> グローバル日付および時刻</h5>

  <p><dfn data-anolis-xref="concept-datetime" id="concept-datetime">グローバル日付および時刻</dfn>は、符号付き時分からなるタイムゾーンオフセットとともに年、月、日、時、分、秒、秒以下からなる特定<a href="#proleptic-gregorian-date">先発グレコリオ暦</a>で構成する。<a href="references.html#refsGREGORIAN">[GREGORIAN]</a></p>

  <p>与えられた順で以下のコンポーネントからなる場合、日付、時刻、タイムゾーンオフセットを表す文字列は<dfn id="valid-global-date-and-time-string">妥当なグローバル日付および時刻</dfn>である：</p>

  <ol><li>日付を表す<a href="#valid-date-string">妥当な日付文字列</a></li>

   <li>"T"（U+0054）文字またはU+0020 SPACE文字</li>

   <li>時刻を表す<a href="#valid-time-string">妥当な時刻文字列</a></li>

   <li>タイムゾーンオフセットを表す<a href="#valid-time-zone-offset-string">妥当なタイムゾーンオフセット文字列</a></li>

  </ol><p>20世紀半ばにUTCを形成する前の日付の時刻は、UTC（UT1の近似がSI秒を刻む）ではなく、UT1（0°経度での現代の地球太陽時）の見地から表現および解釈されなければならない。タイムゾーンを形成する前の時刻は、適切なローカル時刻とロンドンのグリニッジで観測された時間との間のおおよその現代的な違いのある明示的なタイムゾーンとともにUT1の時間として表現および解釈されなければならない。</p>

  <div class="example">

   <p>以下は<a data-anolis-xref="valid global date and time
   string" href="#valid-global-date-and-time-string">妥当なグローバル日付および時刻</a>として記述される例の一部である。</p>

   <dl><dt>"<code>0037-12-13 00:00Z</code>"</dt>

    <dd>ネロ（ローマ皇帝）の誕生日にロンドン時間を用いた地域での真夜中。これが実際に対応している日付のさらなる議論については下記を参照のこと。</dd>

    <dt>"<code>1979-10-14T12:00:00.001-04:00</code>"</dt>

    <dd>夏時間の間にアメリカ東海岸で使用されるタイムゾーンで、1979年10月14日の正午1ミリ秒後。</dd>

    <dt>"<code>8592-01-01T02:09+02:09</code>"</dt>

    <dd>8592年1月1日のUTCで夜中。現在の実際のタイムゾーンではない、UTCより早く時刻が2時9分であるタイムゾーンに関連づけられるが、それでもなお、許可される。</dd>

   </dl><p>数点の以下の日付に関して顕著である：</p>

   <ul><li>4桁未満の年はゼロで埋める必要がある。日付"37-12-13"は妥当な日付ではない。</li>

    <li>"<code data-anolis-xref="">T</code>"が空白に置換される場合、単一の空白文字でなければならない。文字列"<code data-anolis-xref="">2001-12-21&nbsp;&nbsp;12:00Z</code>"（コンポーネントの間に2つの空白）はうまく解釈されないだろう。</li>

    <li>グレゴリオ暦（UTC成立より前の時間における瞬間の範囲で、一義的に識別されうる）の導入より前の特定の時点を一義的に識別するためには、日付は最初にその時代に使用される暦（たとえばユリウス暦）からグレゴリオ暦に変換する必要がある。ネロの誕生日は、ユリウス暦で37年12月15日であり、<a href="#proleptic-gregorian-calendar">先発グレゴリオ暦</a>で37年12月13日である。</li><!-- This might not be true. I can't find a reference that gives
    his birthday with an explicit statement about the calendar being used. However, it seems
    unlikely that it would be given in the Gregorian calendar, so I assume sites use the Julian one.
    --> 

    <li>時刻とタイムゾーンオフセットのコンポーネントは任意ではない。</li>

    <li>西暦元年より前の日付は、HTMLのこのバージョンで日付時刻として表すことはできない。</li>

    <li>時刻は比較的最近の数十年までよく調整または測定されなかったので、古代において特定の出来事の時刻は、せいぜい近似値である。</li>

    <li>タイムゾーンオフセットは夏時間に基づいて異なる。</li>

   </ul></div>

  <p class="note">ゾーンオフセットは、完全なタイムゾーンの仕様ではない。現実の日付と時刻の値を操作する場合、できればIANAのタイムゾーンIDを使用して、タイムゾーンごとに個別のフィールドの使用を検討すること。<a href="references.html#refsTIMEZONES">[TIMEZONES]</a></p>

  <p>与えられた順で以下のコンポーネントから構成される場合、日付、時刻、タイムゾーンオフセットを表す文字列は<dfn id="valid-normalised-forced-utc-global-date-and-time-string">妥当なUTCに正規化されたグローバル日付および時刻</dfn>である：</p>

  <ol><li>UTCタイムゾーンに変換された日付を表す<a href="#valid-date-string">妥当な日付文字列</a></li>

   <li>"T"（U+0054）文字</li>

   <li>UTCタイムゾーンに変換されるおよび与えられた時刻に対して可能な限り最短として表現される時刻（たとえば、与えられた時刻が時間を過ぎたゼロ秒である場合、完全に秒のコンポーネントを省略する）を表す<a href="#valid-time-string">妥当な時刻文字列</a></li>

   <li>"Z"（U+005A）文字</li>

  </ol><div class="impl">

  <p>The rules to <dfn id="parse-a-global-date-and-time-string">parse a global date and time string</dfn> are as follows. This will return
  either a time in UTC, with associated time-zone offset information for round-tripping or display
  purposes, or nothing. If at any point the algorithm says that it "fails", this means that it is
  aborted at that point and returns nothing.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p><a href="#parse-a-date-component">Parse a date component</a> to obtain <var data-anolis-xref="">year</var>, <var data-anolis-xref="">month</var>, and <var data-anolis-xref="">day</var>. If this returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var> or if the
   character at <var data-anolis-xref="">position</var> is neither a U+0054 LATIN CAPITAL LETTER T character
   (T) nor a U+0020 SPACE character, then fail. Otherwise, move <var data-anolis-xref="">position</var>
   forwards one character.</li>

   <li><p><a href="#parse-a-time-component">Parse a time component</a> to obtain <var data-anolis-xref="">hour</var>, <var data-anolis-xref="">minute</var>, and <var data-anolis-xref="">second</var>. If this returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var>, then
   fail.</li>

   <li><p><a href="#parse-a-time-zone-offset-component">Parse a time-zone offset component</a> to obtain <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var> and <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var>. If this
   returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is <em>not</em> beyond the end of <var data-anolis-xref="">input</var>, then fail.</li>

   <li><p>Let <var data-anolis-xref="">time</var> be the moment in time at year <var data-anolis-xref="">year</var>, month
   <var data-anolis-xref="">month</var>, day <var data-anolis-xref="">day</var>, hours <var data-anolis-xref="">hour</var>, minute
   <var data-anolis-xref="">minute</var>, second <var data-anolis-xref="">second</var>, subtracting <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var> hours and <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var> minutes. That moment in time is a moment in the UTC time
   zone.</li>

   <li><p>Let <var data-anolis-xref="">timezone</var> be <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var>
   hours and <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var> minutes from UTC.</li>

   <li><p>Return <var data-anolis-xref="">time</var> and <var data-anolis-xref="">timezone</var>.</li>

  </ol></div>


  <h5 id="weeks"><span class="secno">2.4.5.8</span> 週</h5>

  <p><dfn data-anolis-xref="concept-week" id="concept-week">週</dfn>は、週番号年と週番号からなる。週番号は、月曜日から始まる7日間を示す。以下の定義に従って、このカレンダーシステムにおける週番号年は52または53の7日間を持つ。グレゴリオ暦の日付で1969年12月29日（1969-12-29）月曜日で始まる7日間は、1970週番号年で週番号1として定義される。連続した週は連番が付けられる。週番号年で1週目の前の週は、前の週番号年の最終週である。逆もまた同様である。<a href="references.html#refsGREGORIAN">[GREGORIAN]</a></p>

  <p>最初の日（1月1日）が木曜である<a href="#proleptic-gregorian-calendar">先発グレコリオ暦</a>の年<var data-anolis-xref="">year</var>、または最初の日（1月1日）が木曜である<a href="#proleptic-gregorian-calendar">先発グレコリオ暦</a>の年<var data-anolis-xref="">year</var>のいずれかに対応する場合、数字<var data-anolis-xref="">year</var>とともに週番号年は53週を持つ。ここで、<var data-anolis-xref="">year</var>は400で割り切れる数字、または4で割り切れるが100で割り切れない数字である。他のすべての週番号年は52週である。</p>

  <p>53週をもつ週番号年の<dfn id="week-number-of-the-last-day">最終日の週番号</dfn>は53であり、52週をもつ週番号年の最終日の週番号は52である。</p>

  <p class="note">特定の日の週番号年の数は、<a href="#proleptic-gregorian-calendar">先発グレゴリオ暦</a>で、その日を含む年の数と異なる場合がある。週番号年<var data-anolis-xref="">y</var>での最初の週は、グレコリオ年<var data-anolis-xref="">y</var>の最初の木曜を含む週である。</p>

  <p class="note">現代の用途に対して、ここで定義される<a data-anolis-xref="concept-week" href="#concept-week">週</a>は、ISO 8601で定義されるようなISO週に相当する。<a href="references.html#refsISO8601">[ISO8601]</a></p>

  <p>与えられた順で以下のコンポーネントからなる場合、文字列は、週番号年<var data-anolis-xref="">year</var>および週<var data-anolis-xref="">week</var>を表す<dfn id="valid-week-string">妥当な週文字列</dfn>である：</p>

  <ol><li>4<a href="#ascii-digits">桁</a>以上で表される<var data-anolis-xref="">year</var>。ここで<var data-anolis-xref="">year</var>&nbsp;&gt;&nbsp;0である。</li>

   <li>"-"（U+002D）文字</li>

   <li>"W"（U+0057）文字</li>

   <li>1&nbsp;≤&nbsp;<var data-anolis-xref="">week</var>&nbsp;≤&nbsp;<var data-anolis-xref="">maxweek</var>の範囲で、週<var data-anolis-xref="">week</var>を表す2つの<a href="#ascii-digits">ASCII数字</a>。ここで <var data-anolis-xref="">maxweek</var>は週番号年<var data-anolis-xref="">year</var>の<a href="#week-number-of-the-last-day">最終日の週番号</a>である。</li>

  </ol><div class="impl">

  <p>The rules to <dfn id="parse-a-week-string">parse a week string</dfn> are as follows. This will return either a week-year
  number and week number, or nothing. If at any point the algorithm says that it "fails", this means
  that it is aborted at that point and returns nothing.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. If the
   collected sequence is not at least four characters long, then fail. Otherwise, interpret the
   resulting sequence as a base-ten integer. Let that number be the <var data-anolis-xref="">year</var>.</li>

   <li><p>If <var data-anolis-xref="">year</var> is not a number greater than zero, then fail.</li>

   <li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var> or if the
   character at <var data-anolis-xref="">position</var> is not a U+002D HYPHEN-MINUS character, then fail.
   Otherwise, move <var data-anolis-xref="">position</var> forwards one character.</li>

   <li><p>If <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var> or if the
   character at <var data-anolis-xref="">position</var> is not a "W" (U+0057) character,
   then fail. Otherwise, move <var data-anolis-xref="">position</var> forwards one character.</li>

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. If the
   collected sequence is not exactly two characters long, then fail. Otherwise, interpret the
   resulting sequence as a base-ten integer. Let that number be the <var data-anolis-xref="">week</var>.</li>

   <li><p>Let <var data-anolis-xref="">maxweek</var> be the <a href="#week-number-of-the-last-day">week number of the last day</a> of year
   <var data-anolis-xref="">year</var>.</li>

   <li><p>If <var data-anolis-xref="">week</var> is not a number in the range 1&nbsp;≤&nbsp;<var data-anolis-xref="">week</var>&nbsp;≤&nbsp;<var data-anolis-xref="">maxweek</var>, then fail.</li>

   <li><p>If <var data-anolis-xref="">position</var> is <em>not</em> beyond the end of <var data-anolis-xref="">input</var>, then fail.</li>

   <li><p>Return the week-year number <var data-anolis-xref="">year</var> and the week number <var data-anolis-xref="">week</var>.</li>

  </ol></div>


  <h5 id="durations"><span class="secno">2.4.5.9</span> 継続時間</h5><!-- if you add support for year and month durations, then search for MONTHS throughout the spec
  (not just this section) for things that have to change -->

  

  <p><dfn data-anolis-xref="concept-duration" id="concept-duration">継続時間</dfn>は <!--MONTHS: either a number of
  months or--> 複数秒からなる。</p>

  <p class="note">月と秒は同等ではない（1か月は正確な秒数ではなく、その正確な長さは、測定された正確な1日に依存する期間である）ので、この仕様で定義される<a data-anolis-xref="concept-duration" href="#concept-duration">継続時間</a>は月を含めることはできない
  <!--MONTHS: consist of a mixture of both--> （すなわち年は12ヶ月と等価である）。特定の秒数を記述する継続時間のみが記述可能である。</p>

  <p>以下のいずれかからなる場合、文字列は、<a data-anolis-xref="concept-duration" href="#concept-duration">継続時間</a><var data-anolis-xref="">t</var>で表す<dfn id="valid-duration-string">妥当な継続時間文字列</dfn>である：</p>

  <ul><li><!-- The ISO format --><!-- NOTE: ISO durations also have a number of formats we do not
         consider conforming:

         - a "week" format (e.g. P4W). This one is actually supported
           by the parser.

         - P<date>T<time>, with or without hyphens

         - All these formats, with commas instead of periods for the
           seconds decimal

    -->

    

    

    <p>与えられた順でリテラルにU+0050 LATIN CAPITAL LETTER P文字の後に以下のサブコンポーネントが続く。 <!--the number of years, if any, multiplied by twelve,
    plus the number of months, if any, equals the number of months in <var data-x="">t</var>, if the
    duration is in months; or, if it is in seconds, -->ここで日、時、分および秒数は<var data-anolis-xref="">t</var>として同じ秒数に対応する：</p>

    <ol><!--MONTHS:
     <li><p>One or more <span>ASCII digits</span> followed by a U+0059 LATIN CAPITAL LETTER Y
     character, representing a number of years.</p></li>

     <li><p>One or more <span>ASCII digits</span> followed by a U+004D LATIN CAPITAL LETTER M
     character, representing a number of months.</p></li>
--><li><p>U+0044 LATIN CAPITAL LETTER D文字の後に続く、日数を表す1つ以上の<a href="#ascii-digits">ASCII数字</a>。</li>

     <li>

      <p>与えられた順で、U+0054 LATIN CAPITAL LETTER T文字の後に以下のサブコンポーネントが続く：</p>

      <ol><li><p>U+0048 LATIN CAPITAL LETTER H文字の後に続く、時数を表す1つ以上の<a href="#ascii-digits">ASCII数字</a>。</li>

       <li><p>U+0044 LATIN CAPITAL LETTER M文字の後に続く、分数を表す1つ以上の<a href="#ascii-digits">ASCII数字</a>。</li>

       <li>

        <p>以下のコンポーネント：</p>

        <ol><li><p>秒数を表す、1つ以上の<a href="#ascii-digits">ASCII数字</a>。</li>

         <li><p>任意で、秒以下を表す"."（U+002E）文字の後に続く1、2、または3つの<a href="#ascii-digits">ASCII数字</a>。</li>

         <li><p>U+0053 LATIN CAPITAL LETTER S文字。</li>

        </ol></li>

      </ol></li>

    </ol><p class="note">この、この仕様で定義される他の日付および時刻依存のマイクロ構文は、ISO 8601で定義される形式の1つに基づく。<a href="references.html#refsISO8601">[ISO8601]</a></p>

   </li>

   <li>

    <p>任意の順で、それぞれ異なる<a href="#duration-time-component-scale">継続時間時刻コンポーネントのスケール</a>を伴う、1つ以上の<a data-anolis-xref="duration time component" href="#duration-time-component">継続時間コンポーネント</a>。秒数<var data-anolis-xref="">t</var>と等価である秒数で表される合計。</p>

    <p><dfn id="duration-time-component">継続時間時刻コンポーネント</dfn>は以下のコンポーネントからなる文字列である：</p>

    <ol><li><p>0個以上の<a data-anolis-xref="space character" href="#space-character">空白文字</a>。</li>

     <li><p>秒数を表現するために指定された<a href="#duration-time-component-scale">継続時間時刻コンポーネントスケール</a>（下記参照）でスケールされる時刻単位数で表す、1つ以上の<a href="#ascii-digits">ASCII数字</a>。</li>

     <li><p>指定された<a href="#duration-time-component-scale">継続時間時刻コンポーネントスケール</a>が1（すなわち単位が秒）の場合、任意で、"."（U+002E）文字の後に続く秒以下を表す1、2、または3つの<a href="#ascii-digits">ASCII数字</a>。</li>

     <li><p>0個以上の<a data-anolis-xref="space character" href="#space-character">空白文字</a>。</li>

     <li>

      <p><a href="#duration-time-component">継続時間時刻コンポーネント</a>の数字部で用いられる時刻単位の<dfn id="duration-time-component-scale">継続時間時刻コンポーネントスケール</dfn>を表す、以下の文字の1つ：</p>

      <dl><dt>U+0057 LATIN CAPITAL LETTER W 文字</dt>
       <dt>U+0077 LATIN SMALL LETTER W 文字</dt>

       <dd>週スケールは604800である。</dd>

       <dt>U+0044 LATIN CAPITAL LETTER D 文字</dt>
       <dt>U+0064 LATIN SMALL LETTER D 文字</dt>

       <dd>日。スケールは86400である。</dd>

       <dt>U+0048 LATIN CAPITAL LETTER H 文字</dt>
       <dt>U+0068 LATIN SMALL LETTER H 文字</dt>

       <dd>時。スケールは3600である。</dd>

       <dt>U+004D LATIN CAPITAL LETTER M 文字</dt>
       <dt>U+006D LATIN SMALL LETTER M文字</dt>

       <dd>分。スケールは60である。</dd>

       <dt>U+0053 LATIN CAPITAL LETTER S文字</dt>
       <dt>U+0073 LATIN SMALL LETTER S文字</dt>

       <dd>秒。スケールは1である。</dd>

      </dl></li>

     <li><p>0個以上の<a data-anolis-xref="space character" href="#space-character">空白文字</a>。</li>

    </ol><p class="note">これはISO 8601での形式のいずれにも基づかない。ISO 8601継続時間形式の代わりに、より人間に読みやすくすることを意図する。</p>

   </li>

  </ul><div class="impl">

  <p>The rules to <dfn id="parse-a-duration-string">parse a duration string</dfn> are as follows. This will return either a <a data-anolis-xref="concept-duration" href="#concept-duration">duration</a> or nothing. If at any point the algorithm says that it
  "fails", this means that it is aborted at that point and returns nothing.</p>

  <ol><!--MONTHS: this algorithm actually already parses months adequately, though it would need
   tweaking if we introduced a "mo" unit for the non-ISO variant. See other "MONTHS" annotations
   below. --><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p>Let <var data-anolis-xref="">months</var>, <var data-anolis-xref="">seconds</var>, and <var data-anolis-xref="">component
   count</var> all be zero.</li>

   <li>

    <p>Let <var data-anolis-xref="">M-disambiguator</var> be <i>minutes</i>.</p><!--MONTHS: this note would change-->

    
    <p class="note">This flag's other value is <i>months</i>. It is used to disambiguate the "M"
    unit in ISO8601 durations, which use the same unit for months and minutes. Months are not
    allowed, but are parsed for future compatibility and to avoid misinterpreting ISO8601 durations
    that would be valid in other contexts.</p>

   </li>

   <li><p><a href="#skip-whitespace">Skip whitespace</a>.</li>

   <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, then
   fail.</li>

   <li><p>If the character in <var data-anolis-xref="">input</var> pointed to by <var data-anolis-xref="">position</var>
   is a U+0050 LATIN CAPITAL LETTER P character, then advance <var data-anolis-xref="">position</var> to the
   next character, set <var data-anolis-xref="">M-disambiguator</var> to <i>months</i>, and <a href="#skip-whitespace">skip
   whitespace</a>.</li>

   <li>

    <p>Run the following substeps in a loop, until a step requiring the loop to be broken or the
    entire algorithm to fail is reached:</p>

    <ol><li><p>Let <var data-anolis-xref="">units</var> be undefined. It will be assigned one of the following
     values: <i>years</i>, <i>months</i>, <i>weeks</i>, <i>days</i>, <i>hours</i>, <i>minutes</i>,
     and <i>seconds</i>.</li>

     <li><p>Let <var data-anolis-xref="">next character</var> be undefined. It is used to process characters
     from the <var data-anolis-xref="">input</var>.</li>

     <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, then break
     the loop.</li>

     <li><p>If the character in <var data-anolis-xref="">input</var> pointed to by <var data-anolis-xref="">position</var>
     is a U+0054 LATIN CAPITAL LETTER T character, then advance <var data-anolis-xref="">position</var> to the
     next character, set <var data-anolis-xref="">M-disambiguator</var> to <i>minutes</i>, <a href="#skip-whitespace">skip
     whitespace</a>, and return to the top of the loop.</li>

     <li><p>Set <var data-anolis-xref="">next character</var> to the character in <var data-anolis-xref="">input</var>
     pointed to by <var data-anolis-xref="">position</var>.</li>

     <li>

      <p>If <var data-anolis-xref="">next character</var> is a "." (U+002E) character, then let <var data-anolis-xref="">N</var> equal zero. (Do not advance <var data-anolis-xref="">position</var>. That is taken care
      of below.)</p>

      <p>Otherwise, if <var data-anolis-xref="">next character</var> is an <a data-anolis-xref="ASCII digits" href="#ascii-digits">ASCII
      digit</a>, then <a href="#collect-a-sequence-of-characters">collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII
      digits</a>, interpret the resulting sequence as a base-ten integer, and let <var data-anolis-xref="">N</var> be that number.</p>

      <p>Otherwise <var data-anolis-xref="">next character</var> is not part of a number; fail.</p>

     </li>

     <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, then
     fail.</li>

     <li><p>Set <var data-anolis-xref="">next character</var> to the character in <var data-anolis-xref="">input</var>
     pointed to by <var data-anolis-xref="">position</var>, and this time advance <var data-anolis-xref="">position</var>
     to the next character. (If <var data-anolis-xref="">next character</var> was a U+002E FULL STOP character
     (.) before, it will still be that character this time.)</li>

     <li>

      <p>If <var data-anolis-xref="">next character</var> is a "." (U+002E) character, then run these
      substeps:</p>

      <ol><li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are <a href="#ascii-digits">ASCII digits</a>. Let
       <var data-anolis-xref="">s</var> be the resulting sequence.</li>

       <li><p>If <var data-anolis-xref="">s</var> is the empty string, then fail.</li>

       <li><p>Let <var data-anolis-xref="">length</var> be the number of characters in <var data-anolis-xref="">s</var>.</li>

       <li><p>Let <var data-anolis-xref="">fraction</var> be the result of interpreting <var data-anolis-xref="">s</var>
       as a base-ten integer, and then dividing that number by <span data-anolis-xref="">10<sup data-anolis-xref=""><var data-anolis-xref="">length</var></sup></span>.</li>

       <li><p>Increment <var data-anolis-xref="">N</var> by <var data-anolis-xref="">fraction</var>.</li>

       <li><p><a href="#skip-whitespace">Skip whitespace</a>.</li>

       <li><p>If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, then
       fail.</li>

       <li><p>Set <var data-anolis-xref="">next character</var> to the character in <var data-anolis-xref="">input</var>
       pointed to by <var data-anolis-xref="">position</var>, and advance <var data-anolis-xref="">position</var> to the
       next character.</li>

       <li><p>If <var data-anolis-xref="">next character</var> is neither a U+0053 LATIN CAPITAL LETTER S
       character nor a U+0073 LATIN SMALL LETTER S character, then fail.</li>

       <li><p>Set <var data-anolis-xref="">units</var> to <i>seconds</i>.</li>

      </ol><p>Otherwise, run these substeps:</p>

      <ol><li><p>If <var data-anolis-xref="">next character</var> is a <a href="#space-character">space character</a>, then
       <a href="#skip-whitespace">skip whitespace</a>, set <var data-anolis-xref="">next character</var> to the character in <var data-anolis-xref="">input</var> pointed to by <var data-anolis-xref="">position</var>, and advance <var data-anolis-xref="">position</var> to the next character.</li>

       <li><!--MONTHS: this would probably be where we would add more
        logic to support a new unit like 'mo' -->

        

        <p>If <var data-anolis-xref="">next character</var> is a U+0059 LATIN CAPITAL LETTER Y character, or a
        U+0079 LATIN SMALL LETTER Y character, set <var data-anolis-xref="">units</var> to <i>years</i> and set
        <var data-anolis-xref="">M-disambiguator</var> to <i>months</i>.</p>

        <p>If <var data-anolis-xref="">next character</var> is a U+004D LATIN CAPITAL LETTER M character or a
        U+006D LATIN SMALL LETTER M character, and <var data-anolis-xref="">M-disambiguator</var> is
        <i>months</i>, then set <var data-anolis-xref="">units</var> to <i>months</i>.</p>

        <p>If <var data-anolis-xref="">next character</var> is a U+0057 LATIN CAPITAL LETTER W character or a
        U+0077 LATIN SMALL LETTER W character, set <var data-anolis-xref="">units</var> to <i>weeks</i> and set
        <var data-anolis-xref="">M-disambiguator</var> to <i>minutes</i>.</p>

        <p>If <var data-anolis-xref="">next character</var> is a U+0044 LATIN CAPITAL LETTER D character or a
        U+0064 LATIN SMALL LETTER D character, set <var data-anolis-xref="">units</var> to <i>days</i> and set
        <var data-anolis-xref="">M-disambiguator</var> to <i>minutes</i>.</p>

        <p>If <var data-anolis-xref="">next character</var> is a U+0048 LATIN CAPITAL LETTER H character or a
        U+0068 LATIN SMALL LETTER H character, set <var data-anolis-xref="">units</var> to <i>hours</i> and set
        <var data-anolis-xref="">M-disambiguator</var> to <i>minutes</i>.</p>

        <p>If <var data-anolis-xref="">next character</var> is a U+004D LATIN CAPITAL LETTER M character or a
        U+006D LATIN SMALL LETTER M character, and <var data-anolis-xref="">M-disambiguator</var> is
        <i>minutes</i>, then set <var data-anolis-xref="">units</var> to <i>minutes</i>.</p>

        <p>If <var data-anolis-xref="">next character</var> is a U+0053 LATIN CAPITAL LETTER S character or a
        U+0073 LATIN SMALL LETTER S character, set <var data-anolis-xref="">units</var> to <i>seconds</i> and
        set <var data-anolis-xref="">M-disambiguator</var> to <i>minutes</i>.</p>

        <p>Otherwise if <var data-anolis-xref="">next character</var> is none of the above characters, then
        fail.</p>

       </li>

      </ol></li>

     <li><p>Increment <var data-anolis-xref="">component count</var>.</li>

     <li><p>Let <var data-anolis-xref="">multiplier</var> be 1.</li>

     <li><p>If <var data-anolis-xref="">units</var> is <i>years</i>, multiply <var data-anolis-xref="">multiplier</var> by
     12 and set <var data-anolis-xref="">units</var> to <i>months</i>.</li>

     <li>

      <p>If <var data-anolis-xref="">units</var> is <i>months</i>, add the product of <var data-anolis-xref="">N</var> and
      <var data-anolis-xref="">multiplier</var> to <var data-anolis-xref="">months</var>.</p>

      <p>Otherwise, run these substeps:</p>

      <ol><li><p>If <var data-anolis-xref="">units</var> is <i>weeks</i>, multiply <var data-anolis-xref="">multiplier</var>
       by 7 and set <var data-anolis-xref="">units</var> to <i>days</i>.</li>

       <li><p>If <var data-anolis-xref="">units</var> is <i>days</i>, multiply <var data-anolis-xref="">multiplier</var>
       by 24 and set <var data-anolis-xref="">units</var> to <i>hours</i>.</li>

       <li><p>If <var data-anolis-xref="">units</var> is <i>hours</i>, multiply <var data-anolis-xref="">multiplier</var>
       by 60 and set <var data-anolis-xref="">units</var> to <i>minutes</i>.</li>

       <li><p>If <var data-anolis-xref="">units</var> is <i>minutes</i>, multiply <var data-anolis-xref="">multiplier</var> by 60 and set <var data-anolis-xref="">units</var> to <i>seconds</i>.</li>

       <li><p>Forcibly, <var data-anolis-xref="">units</var> is now <i>seconds</i>. Add the product of <var data-anolis-xref="">N</var> and <var data-anolis-xref="">multiplier</var> to <var data-anolis-xref="">seconds</var>.</li>

      </ol></li>

     <li><p><a href="#skip-whitespace">Skip whitespace</a>.</li>

    </ol></li>

   <li><p>If <var data-anolis-xref="">component count</var> is zero,
   fail.</li><!--MONTHS: if we add month support this is where you'd return them-->

   
   <li><p>If <var data-anolis-xref="">months</var> is not zero, fail.</li>

   <li><p>Return the <a data-anolis-xref="concept-duration" href="#concept-duration">duration</a> consisting of <var data-anolis-xref="">seconds</var> seconds.</li>

  </ol></div>


  <h5 id="vaguer-moments-in-time"><span class="secno">2.4.5.10</span> 時刻における曖昧な瞬間</h5>

  <p>以下のいずれかである場合、文字列は<dfn id="valid-date-string-with-optional-time">任意の時刻を持つ妥当な日付文字列</dfn>である：</p>

  <ul><li><a href="#valid-date-string">妥当な日付文字列</a></li>

   <li><a href="#valid-global-date-and-time-string">妥当なグローバル日付および時刻文字列</a></li>

  </ul><div class="impl">

  <hr><p>The rules to <dfn id="parse-a-date-or-time-string">parse a date or time string</dfn> are as follows. The algorithm will return
  either a <a data-anolis-xref="concept-date" href="#concept-date">date</a>, a <a data-anolis-xref="concept-time" href="#concept-time">time</a>, a <a data-anolis-xref="concept-datetime" href="#concept-datetime">global date and time</a>, or nothing. If at any point the algorithm
  says that it "fails", this means that it is aborted at that point and returns nothing.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p>Set <var data-anolis-xref="">start position</var> to the same position as <var data-anolis-xref="">position</var>.</li>

   <li><p>Set the <var data-anolis-xref="">date present</var> and <var data-anolis-xref="">time present</var> flags to
   true.</li>

   <li><p><a href="#parse-a-date-component">Parse a date component</a> to obtain <var data-anolis-xref="">year</var>, <var data-anolis-xref="">month</var>, and <var data-anolis-xref="">day</var>. If this fails, then set the <var data-anolis-xref="">date
   present</var> flag to false.</p>

   </li><li>

    <p>If <var data-anolis-xref="">date present</var> is true, and <var data-anolis-xref="">position</var> is not beyond
    the end of <var data-anolis-xref="">input</var>, and the character at <var data-anolis-xref="">position</var> is
    either a "T" (U+0054) character or a U+0020 SPACE character, then advance
    <var data-anolis-xref="">position</var> to the next character in <var data-anolis-xref="">input</var>.</p>

    <p>Otherwise, if <var data-anolis-xref="">date present</var> is true, and either <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var> or the character at <var data-anolis-xref="">position</var> is neither a "T" (U+0054) character nor a U+0020
    SPACE character, then set <var data-anolis-xref="">time present</var> to false.</p>

    <p>Otherwise, if <var data-anolis-xref="">date present</var> is false, set <var data-anolis-xref="">position</var>
    back to the same position as <var data-anolis-xref="">start position</var>.</p>

   </li>

   <li><p>If the <var data-anolis-xref="">time present</var> flag is true, then <a href="#parse-a-time-component">parse a time
   component</a> to obtain <var data-anolis-xref="">hour</var>, <var data-anolis-xref="">minute</var>, and <var data-anolis-xref="">second</var>. If this returns nothing, then fail.</li>

   <li><p>If the <var data-anolis-xref="">date present</var> and <var data-anolis-xref="">time present</var> flags are
   both true, but <var data-anolis-xref="">position</var> is beyond the end of <var data-anolis-xref="">input</var>, then
   fail.</li>

   <li><p>If the <var data-anolis-xref="">date present</var> and <var data-anolis-xref="">time present</var> flags are
   both true, <a href="#parse-a-time-zone-offset-component">parse a time-zone offset component</a> to obtain <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var> and <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var>. If this
   returns nothing, then fail.</p>

   </li><li><p>If <var data-anolis-xref="">position</var> is <em>not</em> beyond the end of <var data-anolis-xref="">input</var>, then fail.</li>

   <li>

    <p>If the <var data-anolis-xref="">date present</var> flag is true and the <var data-anolis-xref="">time present</var>
    flag is false, then let <var data-anolis-xref="">date</var> be the date with year <var data-anolis-xref="">year</var>,
    month <var data-anolis-xref="">month</var>, and day <var data-anolis-xref="">day</var>, and return <var data-anolis-xref="">date</var>.</p>

    <p>Otherwise, if the <var data-anolis-xref="">time present</var> flag is true and the <var data-anolis-xref="">date
    present</var> flag is false, then let <var data-anolis-xref="">time</var> be the time with hour <var data-anolis-xref="">hour</var>, minute <var data-anolis-xref="">minute</var>, and second <var data-anolis-xref="">second</var>,
    and return <var data-anolis-xref="">time</var>.</p>

    <p>Otherwise, let <var data-anolis-xref="">time</var> be the moment in time at year <var data-anolis-xref="">year</var>, month <var data-anolis-xref="">month</var>, day <var data-anolis-xref="">day</var>, hours <var data-anolis-xref="">hour</var>, minute <var data-anolis-xref="">minute</var>, second <var data-anolis-xref="">second</var>,
    subtracting <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var> hours and <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var> minutes, that moment in time being a moment
    in the UTC time zone; let <var data-anolis-xref="">timezone</var> be <var data-anolis-xref="">timezone<sub data-anolis-xref="">hours</sub></var> hours and <var data-anolis-xref="">timezone<sub data-anolis-xref="">minutes</sub></var>
    minutes from UTC; and return <var data-anolis-xref="">time</var> and <var data-anolis-xref="">timezone</var>.</p>

   </li>

  </ol></div>


  <h4 id="colors"><span class="secno">2.4.6</span> 色</h4>

  <p><dfn id="simple-color">単純色</dfn>は、sRGB色空間の中で各色のコンポーネント赤、緑、青を表す、0から255までの範囲の8ビット数字3つからなる。<a href="references.html#refsSRGB">[SRGB]</a></p>

  <p>正確に7文字長である、最初の文字が"#"（U+0023）文字であり、残りの6文字がすべて<a href="#ascii-hex-digits">ASCII16進数字</a>である、最初の2桁は赤コンポーネントを表し、中の2桁は緑コンポーネントを表し、最後の2桁は青コンポーネントを表す16進数である場合、文字列は<dfn id="valid-simple-color">妥当な単純色</dfn>である。</p>

  <p><a href="#valid-simple-color">妥当な単純色</a>でかつU+0041 LATIN CAPITAL LETTER AからU+0046 LATIN CAPITAL LETTER Fまでの範囲の文字を一切使用しない場合、文字列は<dfn id="valid-lowercase-simple-color">妥当な小文字の単純色</dfn>である。</p>

  <div class="impl">

  <p>The <dfn id="rules-for-parsing-simple-color-values">rules for parsing simple color values</dfn> are as given in the following algorithm.
  When invoked, the steps must be followed in the order given, aborting at the first step that
  returns a value. This algorithm will return either a <a href="#simple-color">simple color</a> or an error.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>If <var data-anolis-xref="">input</var> is not exactly seven characters long, then return an
   error.</li>

   <li><p>If the first character in <var data-anolis-xref="">input</var> is not a U+0023 NUMBER SIGN character
   (#), then return an error.</li>

   <li><p>If the last six characters of <var data-anolis-xref="">input</var> are not all <a href="#ascii-hex-digits">ASCII hex
   digits</a>, then return an error.</li>

   <li><p>Let <var data-anolis-xref="">result</var> be a <a href="#simple-color">simple color</a>.</p>

   </li><li><p>Interpret the second and third characters as a hexadecimal number and let the result be
   the red component of <var data-anolis-xref="">result</var>.</p>

   </li><li><p>Interpret the fourth and fifth characters as a hexadecimal number and let the result be
   the green component of <var data-anolis-xref="">result</var>.</p>

   </li><li><p>Interpret the sixth and seventh characters as a hexadecimal number and let the result be
   the blue component of <var data-anolis-xref="">result</var>.</p>

   </li><li><p>Return <var data-anolis-xref="">result</var>.</p>

  </li></ol><p>The <dfn id="rules-for-serializing-simple-color-values">rules for serializing simple color values</dfn> given a <a href="#simple-color">simple color</a> are
  as given in the following algorithm:</p>

  <ol><li><p>Let <var data-anolis-xref="">result</var> be a string consisting of a single "#" (U+0023) character.</li>

   <li><p>Convert the red, green, and blue components in turn to two-digit hexadecimal numbers using
   <a href="#lowercase-ascii-hex-digits">lowercase ASCII hex digits</a>, zero-padding if necessary, and append these numbers to
   <var data-anolis-xref="">result</var>, in the order red, green, blue.</p>

   </li><li><p>Return <var data-anolis-xref="">result</var>, which will be a <a href="#valid-lowercase-simple-color">valid lowercase simple
   color</a>.</li>

  </ol><hr><p>Some obsolete legacy attributes parse colors in a more complicated manner, using the <dfn id="rules-for-parsing-a-legacy-color-value">rules
  for parsing a legacy color value</dfn>, which are given in the following algorithm. When invoked,
  the steps must be followed in the order given, aborting at the first step that returns a value.
  This algorithm will return either a <a href="#simple-color">simple color</a> or an error.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>If <var data-anolis-xref="">input</var> is the empty string, then return an error.</li>

   <li><p><a href="#strip-leading-and-trailing-whitespace">Strip leading and trailing whitespace</a> from <var data-anolis-xref="">input</var>.</li>

   <li><p>If <var data-anolis-xref="">input</var> is an <a href="#ascii-case-insensitive">ASCII case-insensitive</a> match for the
   string "<code data-anolis-xref="">transparent</code>", then return an error.</li>

   <li>

    <p>If <var data-anolis-xref="">input</var> is an <a href="#ascii-case-insensitive">ASCII case-insensitive</a> match for one of the
    keywords listed in the <a href="http://www.w3.org/TR/css3-color/#svg-color">SVG color
    keywords</a> <!-- or <a href="http://www.w3.org/TR/css3-color/#css2-system">CSS2 System
    Colors</a> -->  section<!--s-->  of the CSS3 Color specification, then return the <a href="#simple-color">simple
    color</a> corresponding to that keyword. <a href="references.html#refsCSSCOLOR">[CSSCOLOR]</a></p>

    <p class="note"><a href="http://www.w3.org/TR/css3-color/#css2-system">CSS2 System
    Colors</a> are not recognised.</p>

   </li>

   <li>

    <p>If <var data-anolis-xref="">input</var> is four characters long, and the first character in <var data-anolis-xref="">input</var> is a "#" (U+0023) character, and the last three characters of
    <var data-anolis-xref="">input</var> are all <a href="#ascii-hex-digits">ASCII hex digits</a>, then run these substeps:</p>

    <ol><li><p>Let <var data-anolis-xref="">result</var> be a <a href="#simple-color">simple color</a>.</p>

     </li><li><p>Interpret the second character of <var data-anolis-xref="">input</var> as a hexadecimal digit; let
     the red component of <var data-anolis-xref="">result</var> be the resulting number multiplied by 17.</p>

     </li><li><p>Interpret the third character of <var data-anolis-xref="">input</var> as a hexadecimal digit; let
     the green component of <var data-anolis-xref="">result</var> be the resulting number multiplied by 17.</p>

     </li><li><p>Interpret the fourth character of <var data-anolis-xref="">input</var> as a hexadecimal digit; let
     the blue component of <var data-anolis-xref="">result</var> be the resulting number multiplied by 17.</p>

     </li><li><p>Return <var data-anolis-xref="">result</var>.</p>

    </li></ol></li>

   <li><p>Replace any characters in <var data-anolis-xref="">input</var> that have a Unicode code point greater
   than U+FFFF (i.e. any characters that are not in the basic multilingual plane) with the
   two-character string "<code data-anolis-xref="">00</code>".</li>

   <li><p>If <var data-anolis-xref="">input</var> is longer than 128 characters, truncate <var data-anolis-xref="">input</var>, leaving only the first 128 characters.</li>

   <li><p>If the first character in <var data-anolis-xref="">input</var> is a "#" (U+0023) character,
   remove it.</li>

   <li><p>Replace any character in <var data-anolis-xref="">input</var> that is not an <a data-anolis-xref="ASCII hex
   digits" href="#ascii-hex-digits">ASCII hex digit</a> with the character "0" (U+0030).</li>

   <li><p>While <var data-anolis-xref="">input</var>'s length is zero or not a multiple of three, append a
   "0" (U+0030) character to <var data-anolis-xref="">input</var>.</li>

   <li><p>Split <var data-anolis-xref="">input</var> into three strings of equal length, to obtain three
   components. Let <var data-anolis-xref="">length</var> be the length of those components (one third the
   length of <var data-anolis-xref="">input</var>).</li>

   <li><p>If <var data-anolis-xref="">length</var> is greater than 8, then remove the leading <span data-anolis-xref=""><var data-anolis-xref="">length</var>-8</span> characters in each component, and let <var data-anolis-xref="">length</var> be 8.</li>

   <li><p>While <var data-anolis-xref="">length</var> is greater than two and the first character in each
   component is a "0" (U+0030) character, remove that character and reduce <var data-anolis-xref="">length</var> by one.</li>

   <li><p>If <var data-anolis-xref="">length</var> is <em>still</em> greater than two, truncate each component,
   leaving only the first two characters in each.</li>

   <li><p>Let <var data-anolis-xref="">result</var> be a <a href="#simple-color">simple color</a>.</p>

   </li><li><p>Interpret the first component as a hexadecimal number; let the red component of <var data-anolis-xref="">result</var> be the resulting number.</li>

   <li><p>Interpret the second component as a hexadecimal number; let the green component of <var data-anolis-xref="">result</var> be the resulting number.</li>

   <li><p>Interpret the third component as a hexadecimal number; let the blue component of <var data-anolis-xref="">result</var> be the resulting number.</li>

   <li><p>Return <var data-anolis-xref="">result</var>.</p>

  </li></ol></div>

  <hr><!--2DCANVAS--><h4 id="space-separated-tokens"><span class="secno">2.4.7</span> 空白区切りトークン</h4>


  <p><dfn id="set-of-space-separated-tokens">空白区切りトークンの組</dfn>は、1つ以上の<a data-anolis-xref="space character" href="#space-character">空白文字</a>によって区切られた0個以上の単語（トークンとして知られる）を含む文字列である。ここで、単語は1つ以上の文字を含み、<a data-anolis-xref="space
  character" href="#space-character">空白文字</a>を含まない。</p>

  <p><a href="#set-of-space-separated-tokens">空白区切りトークンの組</a>を構成する文字列は、先頭または末尾に<a data-anolis-xref="space character" href="#space-character">空白文字</a>を持ってもよい。</p>

  <p><dfn id="unordered-set-of-unique-space-separated-tokens">順序なし固有空白区切りトークンの組</dfn>は、繰り返しトークンのない<a href="#set-of-space-separated-tokens">空白区切りトークンの組</a>である。</p>

  <p><dfn id="ordered-set-of-unique-space-separated-tokens">順序あり固有空白区切りトークンの組</dfn>は、繰り返しトークンはないが、トークンの順序が意味のある<a href="#set-of-space-separated-tokens">空白区切りトークンの組</a>である。</p>


  <p><a data-anolis-xref="set of space-separated tokens" href="#set-of-space-separated-tokens">空白区切りトークンの組</a>は時折定義された許可される値の組を持つ。許可された値の組が定義される場合、トークンはすべて許可される値のリストでなければならない。その他の値は不適合である。そのような許可される値の組が用意されない場合、すべての値は適合である。</p>

  <p class="note"><a href="#set-of-space-separated-tokens">空白区切りトークンの組</a>のトークンがどのように比較されるか（たとえば、大文字小文字を区別するかどうか）は、セットごとに定義される。</p>

  <div class="impl">

  <p>When a user agent has to <dfn id="split-a-string-on-spaces">split a string on spaces</dfn>, it must use the following
  algorithm:</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p>Let <var data-anolis-xref="">tokens</var> be an ordered list of tokens, initially empty.</li>

   <li><p><a href="#skip-whitespace">Skip whitespace</a></li>


   <li><p>While <var data-anolis-xref="">position</var> is not past the end of <var data-anolis-xref="">input</var>:</p>

    <ol><li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are not <a data-anolis-xref="space
     character" href="#space-character">space characters</a>.</li>

     <li><p>Append the string collected in the previous step to <var data-anolis-xref="">tokens</var>.</li>

     <li><p><a href="#skip-whitespace">Skip whitespace</a></li>

    </ol></li>

   <li><p>Return <var data-anolis-xref="">tokens</var>.</li>

  </ol></div>


  <h4 id="comma-separated-tokens"><span class="secno">2.4.8</span> コンマ区切りトークン</h4>


  <p><dfn id="set-of-comma-separated-tokens">コンマ区切りトークンの組</dfn>は、それぞれ単一の","（U+002C）文字で区切られる0個以上のトークンを含む文字列である。ここでトークンは0個以上の任意の文字列からなり、先頭も末尾も<a data-anolis-xref="space character" href="#space-character">空白文字</a>でなく、","（U+002C）文字を含まず、任意で<a data-anolis-xref="space character" href="#space-character">空白文字</a>に囲まれるものである。</p>

  <p class="example">たとえば、文字列"<code data-anolis-xref="">&nbsp;a&nbsp;,b,,d&nbsp;d&nbsp;</code>"は4つのトークンからなる。"a"、"b"、空文字列および"d&nbsp;d"。各トークンの周りの先頭と末尾の空白はトークンの一部としてカウントされず、空文字列はトークンであるかもしれない。</p>

  <p><a data-anolis-xref="set of comma-separated tokens" href="#set-of-comma-separated-tokens">コンマ区切りトークンの組</a>は時に妥当なトークンを構成するさらなる制約を持つ。そのような制限が定義される場合、トークンはすべてその制限に収まるようにしなければならない。その他の値は不適合である。そのような制限が指定されない場合、すべての値は適合である。</p>

  <div class="impl">

  <p>When a user agent has to <dfn id="split-a-string-on-commas">split a string on commas</dfn>, it must use the following
  algorithm:</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the string being parsed.</li>

   <li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">input</var>, initially
   pointing at the start of the string.</li>

   <li><p>Let <var data-anolis-xref="">tokens</var> be an ordered list of tokens, initially empty.</li>

   <li><p><i>Token</i>: If <var data-anolis-xref="">position</var> is past the end of <var data-anolis-xref="">input</var>, jump to the last step.</li>

   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are not "," (U+002C) characters.
   Let <var data-anolis-xref="">s</var> be the resulting sequence (which might be the empty string).</li>

   <li><p><a href="#strip-leading-and-trailing-whitespace">Strip leading and trailing whitespace</a> from <var data-anolis-xref="">s</var>.</li>

   <li><p>Append <var data-anolis-xref="">s</var> to <var data-anolis-xref="">tokens</var>.</li>

   <li><p>If <var data-anolis-xref="">position</var> is not past the end of <var data-anolis-xref="">input</var>, then
   the character at <var data-anolis-xref="">position</var> is a "," (U+002C) character; advance <var data-anolis-xref="">position</var> past that character.</li>

   <li><p>Jump back to the step labeled <i>token</i>.</li>

   <li><p>Return <var data-anolis-xref="">tokens</var>.</li>

  </ol></div>




  <h4 id="syntax-references"><span class="secno">2.4.9</span> 参照</h4>


  <p>タイプ<var data-anolis-xref="">type</var>要素に対して<dfn id="valid-hash-name-reference">妥当なハッシュ名参照</dfn>は、"#"（U+0023）文字の後に文書でタイプ<var data-anolis-xref="">type</var>をもつ要素の<code data-anolis-xref="">name</code>属性値に正確に一致する文字列からなる文字列である。</p>

  <div class="impl">

  <p>The <dfn id="rules-for-parsing-a-hash-name-reference">rules for parsing a hash-name reference</dfn> to an element of type <var data-anolis-xref="">type</var> are as follows:</p>

  <ol><li><p>If the string being parsed does not contain a U+0023 NUMBER SIGN character, or if the
   first such character in the string is the last character in the string, then return null and
   abort these steps.</li>


   <li><p>Let <var data-anolis-xref="">s</var> be the string from the character immediately after the first
   U+0023 NUMBER SIGN character in the string being parsed up to the end of that string.</li>

   <li><p>Return the first element of type <var data-anolis-xref="">type</var> that has an <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> attribute whose value is a <a href="#case-sensitive">case-sensitive</a> match for <var data-anolis-xref="">s</var> or a <code data-anolis-xref="">name</code> attribute whose value is a <a href="#compatibility-caseless">compatibility
   caseless</a> match for <var data-anolis-xref="">s</var>.</li><!--
   IE is also doing case-insensitive id="" matching.
   Tests:
   http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A%3Cmap%20name%3D%22T%26eacute%3B%26%23x01F1%3B%26%23x2075%3B%22%3E%3Carea%20href%3D%22%2F%22%20shape%3Drect%20coords%3D0%2C0%2C200%2C200%3E%3C%2Fmap%3E%0A%3Cimg%20usemap%3D%22%23t%26Eacute%3BDZ5%22%20src%3Dimage%3E
   ...except that doesn't explain why this fails:
   http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C!DOCTYPE%20html%3E%0A%3Cmap%20name%3D%22T%26eacute%3B%26%23x01F1%3B%26%23x2075%3B%26%23xFB01%3B%22%3E%3Carea%20href%3D%22%2F%22%20shape%3Drect%20coords%3D0%2C0%2C200%2C200%3E%3C%2Fmap%3E%0A%3Cimg%20usemap%3D%22%23t%26Eacute%3BDZ5F%26%23x0131%3B%26%23x0307%3B%22%20src%3Dimage%3E
   maybe they just don't know about combining dot above?
   -->

   

  </ol></div>


  <h4 id="mq"><span class="secno">2.4.10</span> メディアクエリ</h4>


  <p>メディアクエリ仕様の<code data-anolis-xref="">media_query_list</code>生成物に一致する場合、文字列は<dfn id="valid-media-query">妥当なメディアクエリ</dfn>である。<a href="references.html#refsMQ">[MQ]</a></p>

  <p>空文字列、<a data-anolis-xref="space character" href="#space-character">空白文字</a>のみからなる文字列、またはメディアクエリ仕様で与えられる定義に従ったユーザー環境にマッチするメディアクエリの場合、文字列はユーザー<dfn id="matches-the-environment">環境に一致する</dfn>。<a href="references.html#refsMQ">[MQ]</a></p>



  <h3 id="urls"><span class="secno">2.5</span> URL</h3>

  <h4 id="terminology-0"><span class="secno">2.5.1</span> 用語</h4>

  <p>WHATWG URL標準でオーサリング適合性要件に準拠する場合、<a href="#url">URL</a>は<dfn id="valid-url">妥当なURL</dfn>である。<a href="references.html#refsURL">[URL]</a></p>

  <p><a href="#valid-url">妥当なURL</a>だが空文字列でない場合、文字列は<dfn id="valid-non-empty-url">妥当な空でないURL</dfn>である。</p>

  <p><a data-anolis-xref="strip leading and trailing whitespace" href="#strip-leading-and-trailing-whitespace">先頭と末尾の空白文字を取り除いた</a>あとに<a href="#valid-url">妥当なURL</a>である場合、文字列は<dfn id="valid-url-potentially-surrounded-by-spaces">潜在的にスペースで囲まれた妥当なURL</dfn>である。</p>

  <p><a data-anolis-xref="strip leading and trailing whitespace" href="#strip-leading-and-trailing-whitespace">先頭と末尾の空白文字を取り除いた</a>あとに、<a href="#valid-non-empty-url">妥当な空でないURL</a>である場合、文字列は<dfn id="valid-non-empty-url-potentially-surrounded-by-spaces">潜在的にスペースで囲まれた妥当な空でないURL</dfn>である。</p>

  <p>この仕様は、たとえ解決不可能でも、XMLツールの互換性のために必要な場合、<a href="#html-documents">HTML文書</a>の<a data-anolis-xref="syntax-doctype" href="syntax.html#syntax-doctype">DOCTYPE</a>で用いるための<code data-anolis-xref="">about:</code> URL予約としてURL <dfn id="about:legacy-compat"><code>about:legacy-compat</code></dfn>を定義する。<a href="references.html#refsABOUT">[ABOUT]</a></p>

  <p>この仕様は、たとえ解決不可能でも、<a data-anolis-xref="an iframe srcdoc document" href="embedded-content.html#an-iframe-srcdoc-document"><code>iframe</code> <code data-anolis-xref="attr-iframe-srcdoc">srcdoc</code>文書</a>の<a href="dom.html#the-document's-address">文書のアドレス</a>として用いられる<code data-anolis-xref="">about:</code> URLを予約としてURL <dfn id="about:srcdoc"><code>about:srcdoc</code></dfn>を定義する。<a href="references.html#refsABOUT">[ABOUT]</a></p>

  <p><code><a href="dom.html#document">Document</a></code>オブジェクトの<dfn id="fallback-base-url">フォールバック基底URL</dfn>は、以下のサブステップを実行して得られる<a href="#absolute-url">絶対URL</a>である：</p>

  <ol><li><p><code><a href="dom.html#document">Document</a></code>が<a href="embedded-content.html#an-iframe-srcdoc-document"><code>iframe</code> <code data-anolis-xref="attr-iframe-srcdoc">srcdoc</code>文書</a>である場合、<code><a href="dom.html#document">Document</a></code>の<a href="browsers.html#browsing-context">ブラウジングコンテキスト</a>がもつ<a href="browsers.html#browsing-context-container">ブラウジングコンテキストコンテナ</a>の<code><a href="dom.html#document">Document</a></code>に属する<a href="#document-base-url">文書基底URL</a>を返し、これらの手順を中止する。</li>

   <li><!-- http://www.hixie.ch/tests/adhoc/html/navigation/javascript-url/ --><!-- this should be tested in the case of a browsing context that was navigated to about:blank
    after having been elsewhere, as opposed to the about:blank used at the time of the browsing
    context's creation. -->

    

    

    <p><a href="dom.html#the-document's-address">文書のアドレス</a>が<code><a href="#about:blank">about:blank</a></code>であり、かつ<code><a href="dom.html#document">Document</a></code>の<a href="browsers.html#browsing-context">ブラウジングコンテキスト</a>が<a href="browsers.html#creator-browsing-context">クリエーターブラウジングコンテキスト</a>を持つ場合、<a href="browsers.html#creator-document">クリエーター<code>Document</code></a>の<a href="#document-base-url">文書基底URL</a>を返し、これらの手順を中止する。</p>

   </li><!-- http://www.hixie.ch/tests/adhoc/dom/level0/history/pushState/001/ -->

   

   <li><p><a href="dom.html#the-document's-address">文書のアドレス</a>を返す。</li>

  </ol><p><code><a href="dom.html#document">Document</a></code>オブジェクトの<dfn id="document-base-url">文書基底URL</dfn>は、以下のサブステップを実行して得られる<a href="#absolute-url">絶対URL</a>である：</p>

  <ol><li><p><code><a href="dom.html#document">Document</a></code>に<code data-anolis-xref="attr-base-href"><a href="document-metadata.html#attr-base-href">href</a></code>属性を持つ<code><a href="document-metadata.html#the-base-element">base</a></code>要素が存在しない場合、<a href="#document-base-url">文書基底URL</a>は<code><a href="dom.html#document">Document</a></code>の<a href="#fallback-base-url">フォールバック基底URL</a>であり、これらの手順を中止する。</li>

   <li><p>そうでなければ、<a href="#document-base-url">文書基底URL</a>は<a href="#tree-order">ツリー順</a>で、<code data-anolis-xref="attr-base-href"><a href="document-metadata.html#attr-base-href">href</a></code>属性を持つ<code><a href="dom.html#document">Document</a></code>で最初の<code><a href="document-metadata.html#the-base-element">base</a></code>要素の<a href="document-metadata.html#frozen-base-url">凍結基底URL</a>である。</li>

  </ol><div class="impl">

  <h4 id="resolving-urls"><span class="secno">2.5.2 </span>Resolving URLs</h4>

  <p>Resolving a URL is the process of taking a <a href="#relative-url">relative URL</a> and obtaining the
  <a href="#absolute-url">absolute URL</a> that it implies.</p>

  <p>To <dfn id="resolve-a-url">resolve a URL</dfn> to an <a href="#absolute-url">absolute URL</a> relative to either another
  <a href="#absolute-url">absolute URL</a> or an element, the user agent must use the following steps. Resolving a
  URL can result in an error, in which case the URL is not resolvable.</p>

  <ol><li><p>Let <var data-anolis-xref="">url</var> be the <a href="#url">URL</a> being resolved.</li>

   <li>

    <p>Let <var data-anolis-xref="">encoding</var> be determined as follows:</p>

    <dl class="switch"><dt>If the URL had a character encoding defined when the URL was created or defined or when
     this algorithm was invoked</dt>

     <dd>The URL character encoding is as defined.</dd>


     <dt>If the URL came from a script (e.g. as an argument to a method)</dt>

     <dd>The URL character encoding is the <a href="webappapis.html#api-url-character-encoding">API URL character encoding</a> specified by the
     script's <a href="webappapis.html#settings-object">settings object</a>.</dd>


     <dt>If the URL came from a DOM node (e.g. from an element)</dt>

     <dd>The node has a <code><a href="dom.html#document">Document</a></code>, and the URL character encoding is the
     <a href="#document's-character-encoding">document's character encoding</a>.</dd>


    </dl></li>

   <li><p>If <var data-anolis-xref="">encoding</var> is <a href="#a-utf-16-encoding">a UTF-16 encoding</a>, then change the value
   of <var data-anolis-xref="">encoding</var> to UTF-8.</li>

   <li>

    <p>If the algorithm was invoked with an <a href="#absolute-url">absolute URL</a> to use as the base URL, let
    <var data-anolis-xref="">base</var> be that <a href="#absolute-url">absolute URL</a>.</p>

    <p>Otherwise, let <var data-anolis-xref="">base</var> be <a href="#the-element's-base-url">the element's base URL</a>.</p>

   </li>

   <li><p>Apply the <a href="#url-parser">URL parser</a> to <var data-anolis-xref="">url</var>, with <var data-anolis-xref="">base</var> as the base URL, with <var data-anolis-xref="">encoding</var> as the encoding.</li>

   <li><p>If this returns failure, then abort these steps with an error.</li>

   <li><p>Let <var data-anolis-xref="">parsed URL</var> be the result of the <a href="#url-parser">URL parser</a>.</li>

   <li><p>Let <var data-anolis-xref="">serialised URL</var> be the result of apply the <a data-anolis-xref="concept-url-serializer" href="#concept-url-serializer">URL
   serializer</a> to <var data-anolis-xref="">parsed URL</var>.</li>

   <li><p>Return <var data-anolis-xref="">serialised URL</var> as the <dfn id="resulting-absolute-url">resulting absolute URL</dfn> and
   <var data-anolis-xref="">parsed URL</var> as the <dfn id="resulting-parsed-url">resulting parsed URL</dfn>.</li>

  </ol><p>Given an element, <dfn id="the-element's-base-url">the element's base URL</dfn> is the <i>base URI of the element</i>, as
  defined by the XML Base specification, with <i>the base URI of the document entity</i> being
  defined as the <a href="#document-base-url">document base URL</a> of the <code><a href="dom.html#document">Document</a></code> that owns the element.
  <a href="references.html#refsXMLBASE">[XMLBASE]</a></p>

  <p>For the purposes of the XML Base specification, user agents must act as if all
  <code><a href="dom.html#document">Document</a></code> objects represented XML documents.</p>

  <p class="note">It is possible for <code data-anolis-xref="attr-xml-base"><a href="dom.html#the-xml:base-attribute-(xml-only)">xml:base</a></code> attributes to be
  present even in HTML fragments, as such attributes can be added dynamically using script. (Such
  scripts would not be conforming, however, as <code data-anolis-xref="attr-xml-base"><a href="dom.html#the-xml:base-attribute-(xml-only)">xml:base</a></code>
  attributes are not allowed in <a href="#html-documents">HTML documents</a>.)</p>

  </div>



  <div class="impl">

  <h4 id="dynamic-changes-to-base-urls"><span class="secno">2.5.3 </span>Dynamic changes to base URLs</h4>

  <p>When an <code data-anolis-xref="attr-xml-base"><a href="dom.html#the-xml:base-attribute-(xml-only)">xml:base</a></code> attribute is set, changed, or removed, the
  attribute's element, and all descendant elements, are <a href="#affected-by-a-base-url-change">affected by a base URL
  change</a>.</p>

  <p>When a document's <a href="#document-base-url">document base URL</a> changes, all elements in that document are
  <a href="#affected-by-a-base-url-change">affected by a base URL change</a>.</p>

  <p>The following are <a href="#base-url-change-steps">base URL change steps</a>, which run when an element is
  <a href="#affected-by-a-base-url-change">affected by a base URL change</a> (as defined by the DOM specification):</p>

  <dl class="switch"><dt>If the element creates a <a href="links.html#hyperlink">hyperlink</a></dt>

   <dd>

    <p>If the <a href="#absolute-url">absolute URL</a> identified by the hyperlink is being shown to the user, or
    if any data derived from that URL is affecting the display, then the <code data-anolis-xref="attr-hyperlink-href"><a href="links.html#attr-hyperlink-href">href</a></code> attribute should be <a data-anolis-xref="resolve a
    url" href="#resolve-a-url">re-resolved</a> relative to the element and the UI updated appropriately.</p>

    <p class="example">For example, the CSS <code data-anolis-xref="selector-link"><a href="disabled-elements.html#selector-link">:link</a></code>/<code data-anolis-xref="selector-visited"><a href="disabled-elements.html#selector-visited">:visited</a></code> pseudo-classes might have been affected.</p><!--PING-->




   </dd>

   <dt>If the element is a <code><a href="text-level-semantics.html#the-q-element">q</a></code>, <code><a href="grouping-content.html#the-blockquote-element">blockquote</a></code>, <code><a href="edits.html#the-ins-element">ins</a></code>, or
   <code><a href="edits.html#the-del-element">del</a></code> element with a <code data-anolis-xref="">cite</code> attribute</dt>

   <dd>

    <p>If the <a href="#absolute-url">absolute URL</a> identified by the <code data-anolis-xref="">cite</code> attribute is
    being shown to the user, or if any data derived from that URL is affecting the display, then the
    <a href="#url">URL</a> should be <a data-anolis-xref="resolve a url" href="#resolve-a-url">re-resolved</a> relative to the
    element and the UI updated appropriately.</p>

   </dd>

   <dt>そうでなければ</dt>

   <dd>

    <p>The element is not directly affected.</p>

    <p class="example">For instance, changing the base URL doesn't affect the image displayed by
    <code><a href="embedded-content.html#the-img-element">img</a></code> elements, although subsequent accesses of the <code data-anolis-xref="dom-img-src"><a href="embedded-content.html#dom-img-src">src</a></code> IDL attribute from script will return a new <a href="#absolute-url">absolute
    URL</a> that might no longer correspond to the image being shown.</p>

   </dd>

  </dl></div>


  <div class="impl">

  <h3 id="fetching-resources"><span class="secno">2.6 </span>Fetching resources</h3>

  <h4 id="terminology-1"><span class="secno">2.6.1 </span>Terminology</h4>

  <p id="concept-http-equivalent">User agents can implement a variety of transfer protocols, but
  this specification mostly defines behavior in terms of HTTP. <a href="references.html#refsHTTP">[HTTP]</a></p>

  <p>The <dfn data-anolis-xref="concept-http-equivalent-get" id="concept-http-equivalent-get">HTTP GET method</dfn> is equivalent to the default
  retrieval action of the protocol. For example, RETR in FTP. Such actions are idempotent and safe,
  in HTTP terms.</p>

  <p>The <dfn data-anolis-xref="concept-http-equivalent-codes" id="concept-http-equivalent-codes">HTTP response codes</dfn> are equivalent to
  statuses in other protocols that have the same basic meanings. For example, a "file not found"
  error is equivalent to a 404 code, a server error is equivalent to a 5xx code, and so on.</p>

  <p>The <dfn data-anolis-xref="concept-http-equivalent-headers" id="concept-http-equivalent-headers">HTTP headers</dfn> are equivalent to fields in
  other protocols that have the same basic meaning. For example, the HTTP authentication headers are
  equivalent to the authentication aspects of the FTP protocol.</p>

  <p>A <dfn id="referrer-source">referrer source</dfn> is either a <code><a href="dom.html#document">Document</a></code> or a <a href="#url">URL</a>.</p>


  <h4 id="processing-model"><span class="secno">2.6.2 </span>Processing model</h4>

  <p>When a user agent is to <dfn id="fetch">fetch</dfn><!--FETCH-->  a resource or <a href="#url">URL</a>, optionally
  <strong>from</strong> an origin <i data-anolis-xref="">origin</i>, optionally <strong>using</strong> a
  specific <a href="#referrer-source">referrer source</a> as an <i>override referrer source</i>, and optionally with
  any of a <i>synchronous flag</i>, a <i>manual redirect flag</i>, a <i>force same-origin flag</i>,
  and a <i>block cookies flag</i>, the following steps must be run. (When a <em><a href="#url">URL</a></em> is to be
  fetched, the URL identifies a resource to be obtained.)</p><!-- if invoked with the synchronous flag, make sure to release the storage mutex first --><!-- synchronous flag is only to be used in algorithms that are themselves asynchronous! Only
  sync-XHR is allowed to make the mistake of screwing that up. :-P --><!-- the force same-origin flag is for use in places where we'll be moving to CORS one day; when
  used, the algorithm must be invoked with a URL (not something else, like a POST request) whose
  origin is the same as the /origin/, which must also be present, and the algorithm must not be
  invoked with the manual redirect flag. --><!-- "block cookies" is currently only used by XHR -->

  

  

  

  

  <ol><li><p>If there is a specific <i>override referrer source</i>, and it is a <a href="#url">URL</a>, then
   let <var data-anolis-xref="">referrer</var> be the <i>override referrer source</i>, and jump to the step
   labeled <i>clean referrer</i>.</li>

   <li>

    <p>Let <var data-anolis-xref="">document</var> be the appropriate <code><a href="dom.html#document">Document</a></code> as given by the
    following list:</p>

    <dl class="switch"><dt>If there is a specific <i>override referrer source</i></dt>

     <dd>The <i>override referrer source</i>.</dd>


     <dt>When <a data-anolis-xref="navigate" href="browsers.html#navigate">navigating</a></dt>

     <dd>The <a href="browsers.html#active-document">active document</a> of the <a href="browsers.html#source-browsing-context">source browsing context</a>.</dd>


     <dt>When fetching resources for an element</dt>

     <dd>The element's <code><a href="dom.html#document">Document</a></code>.</dd>


    </dl></li>

   <li>

    <p>While <var data-anolis-xref="">document</var> is <a href="embedded-content.html#an-iframe-srcdoc-document">an <code>iframe</code> <code data-anolis-xref="attr-iframe-srcdoc">srcdoc</code> document</a>, let <var data-anolis-xref="">document</var> be
    <var data-anolis-xref="">document</var>'s <a href="browsers.html#browsing-context">browsing context</a>'s <a href="browsers.html#browsing-context-container">browsing context
    container</a>'s <code><a href="dom.html#document">Document</a></code> instead.</p>

   </li>

   <li>

    <p>If the <a href="browsers.html#origin-0">origin</a> of <var data-anolis-xref="">Document</var> is not a scheme/host/port tuple,
    then set <var data-anolis-xref="">referrer</var> to the empty string and jump to the step labeled <i>clean
    referrer</i>.</p>

   </li>

   <li>

    <p>Let <var data-anolis-xref="">referrer</var> be <a href="dom.html#the-document's-address">the document's address</a> of <var data-anolis-xref="">document</var>.</p>

   </li>

   <li>

    <p><i>Clean referrer</i>: Apply the <a href="#url-parser">URL parser</a> to <var data-anolis-xref="">referrer</var> and let <var data-anolis-xref="">parsed referrer</var> be the <a href="#resulting-parsed-url">resulting parsed URL</a>.</p>

   </li>

   <li>

    <p>Let <var data-anolis-xref="">referrer</var> be the result of applying the <a data-anolis-xref="concept-url-serializer" href="#concept-url-serializer">URL serializer</a> to <var data-anolis-xref="">parsed referrer</var>,
    with the <i>exclude fragment flag</i> set.</p><!-- RFC2616 says "The URI MUST NOT include a
    fragment." (section 14.36) --> 

   </li>

   <li>

    <p>If <var data-anolis-xref="">referrer</var> is not the empty string, is not a <a data-anolis-xref="data
    protocol" href="#data-protocol"><code data-anolis-xref="">data:</code> URL</a>, and is not the <a href="#url">URL</a>
    "<code><a href="#about:blank">about:blank</a></code>", then generate the <i>address of the resource from which Request-URIs
    are obtained</i> as required by HTTP for the <code data-anolis-xref="http-referer">Referer</code> (sic)
    header from <var data-anolis-xref="">referrer</var>. <a href="references.html#refsHTTP">[HTTP]</a></p>

    <p>Otherwise, the <code data-anolis-xref="http-referer">Referer</code> (sic) header must be omitted,
    regardless of its value.</p>

   </li>

   <li><p>If the algorithm was not invoked with the <i>synchronous flag</i>, perform the remaining
   steps asynchronously.</li>

   <li><p>If the <code><a href="dom.html#document">Document</a></code> with which any <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> by this algorithm would be associated doesn't have an
   associated <a href="browsers.html#browsing-context">browsing context</a>, then abort these steps.</li><!--(redundant with 'at a time convenient...' below)
   <li><p>Optionally, wait until the <code>Document</code> with which any <span
   data-x="concept-task">tasks</span> <span data-x="queue a task">queued</span> by this algorithm
   would be associated is <span data-x="active document">active</span>.</p></li>
-->



   <li>

    <p>This is the <i>main step</i>.</p>

    <p>If the resource is to be obtained from an <a href="browsers.html#application-cache">application cache</a>, then use the data
    from that <a href="browsers.html#application-cache">application cache</a>, as if it had been obtained in the manner appropriate
    given its <a href="#url">URL</a>.</p>

    <p>If the resource is identified by an <a href="#absolute-url">absolute URL</a>, and the resource is to be
    obtained using an idempotent action (such as an HTTP GET <a data-anolis-xref="concept-http-equivalent-get" href="#concept-http-equivalent-get">or equivalent</a>), and it is already being downloaded
    for other reasons (e.g. another invocation of this algorithm), and this request would be
    identical to the previous one (e.g. same <code data-anolis-xref="http-accept">Accept</code> and <code data-anolis-xref="http-origin">Origin</code> headers), and the user agent is configured such that it is to
    reuse the data from the existing download instead of initiating a new one, then use the results
    of the existing download instead of starting a new one.</p>

    <p>Otherwise, if the resource is identified by an <a href="#absolute-url">absolute URL</a> with a scheme that
    does not define a mechanism to obtain the resource (e.g. it is a <code data-anolis-xref="">mailto:</code>
    URL) or that the user agent does not support, then act as if the resource was an HTTP 204 No
    Content response with no other metadata.</p>

    <p>Otherwise, if the resource is identified by the <a href="#url">URL</a>
    <dfn id="about:blank"><code>about:blank</code></dfn>, then the resource is immediately available and consists of
    the empty string, with no metadata.</p>

    <p>Otherwise, at a time convenient to the user and the user agent, download (or otherwise
    obtain) the resource, applying the semantics of the relevant specifications (e.g. performing an
    HTTP GET or POST operation, or reading the file from disk, or expanding <a data-anolis-xref="data
    protocol" href="#data-protocol"><code data-anolis-xref="">data:</code> URLs</a>, etc).</p>

    <p>For the purposes of the <code data-anolis-xref="http-referer">Referer</code> (sic) header, use the
    <i>address of the resource from which Request-URIs are obtained</i> generated in the earlier
    step.</p>

    <p>For the purposes of the <code data-anolis-xref="http-origin">Origin</code> header, if the <a data-anolis-xref="fetch" href="#fetch">fetching algorithm</a> was explicitly initiated from an <i data-anolis-xref="">origin</i>, then <i data-anolis-xref="">the origin that initiated the HTTP request</i> is <i data-anolis-xref="">origin</i>. Otherwise, this is <i data-anolis-xref="">a request from a "privacy-sensitive"
    context</i>. <a href="references.html#refsORIGIN">[ORIGIN]</a></p>

   </li>

   <li>

    <p>If the algorithm was not invoked with the <i>block cookies flag</i>, and there are cookies to
    be set, then the user agent must run the following substeps:</p>

    <ol><li><p>Wait until ownership of the <a href="webappapis.html#storage-mutex">storage mutex</a> can be taken by this instance of
     the <a data-anolis-xref="fetch" href="#fetch">fetching</a> algorithm.</li>

     <li><p>Take ownership of the <a href="webappapis.html#storage-mutex">storage mutex</a>.</li>

     <li><p>Update the cookies. <a href="references.html#refsCOOKIES">[COOKIES]</a>
     <span class="fingerprint" title="fingerprinting vector"><a href="introduction.html#fingerprinting-vector"><img alt="(This is a fingerprinting vector.)" height="21" src="http://www.w3.org/TR/html5/images/fingerprint.png" width="15"></a></span>
     </li>

     <li><p>Release the <a href="webappapis.html#storage-mutex">storage mutex</a> so that it is once again free.</li>

    </ol></li>

   <li>

    <p>If the fetched resource is an HTTP redirect <a data-anolis-xref="concept-http-equivalent-codes" href="#concept-http-equivalent-codes">or
    equivalent</a>, then:</p>

    <dl class="switch"><dt>If the <i>force same-origin flag</i> is set and the <a href="#url">URL</a> of the target of the
     redirect does not have the <a href="browsers.html#same-origin">same origin</a> as the <a href="#url">URL</a> for which the
     <a href="#fetch">fetch</a> algorithm was invoked</dt>

     <dd>

      <p>Abort these steps and return failure from this algorithm, as if the remote host could not
      be contacted.</p>

     </dd>

     <dt>If the <i>manual redirect flag</i> is set</dt>

     <dd>

      <p>Continue, using the fetched resource (the redirect) as the result of the algorithm. If the
      calling algorithm subsequently requires the user agent to <dfn id="transparently-follow-the-redirect">transparently follow the
      redirect</dfn>, then the user agent must resume this algorithm from the <i>main step</i>, but
      using the target of the redirect as the resource to fetch, rather than the original
      resource.</p>

     </dd>

     <dt>そうでなければ</dt>

     <dd>

      <p>First, apply any relevant requirements for redirects (such as showing any appropriate
      prompts). Then, redo <i>main step</i>, but using the target of the redirect as the resource to
      fetch, rather than the original resource. For HTTP requests, the new request must include the
      same headers as the original request, except for headers for which other requirements are
      specified (such as the <code data-anolis-xref="http-host">Host</code> header). <a href="references.html#refsHTTP">[HTTP]</a></p>

      <p class="note">The HTTP specification requires that 301, 302, and 307 redirects, when applied
      to methods other than the safe methods, not be followed without user confirmation. That would
      be an appropriate prompt for the purposes of the requirement in the paragraph above. <a href="references.html#refsHTTP">[HTTP]</a></p>

     </dd>

    </dl></li>

   <li>

    <p>If the algorithm was not invoked with the <i>synchronous flag</i>: When the resource is
    available, or if there is an error of some description, <a href="webappapis.html#queue-a-task">queue a task</a> that uses the
    resource as appropriate. If the resource can be processed incrementally, as, for instance, with
    a progressively interlaced JPEG or an HTML file, additional tasks may be queued to process the
    data as it is downloaded. The <a href="webappapis.html#task-source">task source</a> for these <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> is the <a href="webappapis.html#networking-task-source">networking task source</a>.</p>

    <p>Otherwise, return the resource or error information to the calling algorithm.</p>

   </li>

  </ol><p>If the user agent can determine the actual length of the resource being <a data-anolis-xref="fetch" href="#fetch">fetched</a> for an instance of this algorithm, and if that length is finite, then
  that length is the file's <dfn data-anolis-xref="concept-fetch-total" id="concept-fetch-total">size</dfn>. Otherwise, the subject of
  the algorithm (that is, the resource being fetched) has no known <a data-anolis-xref="concept-fetch-total" href="#concept-fetch-total">size</a>. (For example, the HTTP <code data-anolis-xref="http-content-length">Content-Length</code> header might provide this information.)</p>

  <p>The user agent must also keep track of the <dfn data-anolis-xref="concept-fetch-loaded" id="concept-fetch-loaded">number of bytes
  downloaded</dfn> for each instance of this algorithm. This number must exclude any out-of-band
  metadata, such as HTTP headers.</p>

  <p class="note">The <a href="browsers.html#application-cache">application cache</a> processing model introduces some <a href="browsers.html#changesToNetworkingModel">changes to the networking model</a> to handle the returning of
  cached resources.</p>

  <p class="note">The <a data-anolis-xref="navigate" href="browsers.html#navigate">navigation</a> processing model handles redirects
  itself, overriding the redirection handling that would be done by the fetching algorithm.</p>

  <p class="note">Whether the <a href="#content-type-sniffing">type sniffing rules</a> apply to the
  fetched resource depends on the algorithm that invokes the rules — they are not always
  applicable.</p><!--ADD-TOPIC:Security-->



  <h4 id="encrypted-http-and-related-security-concerns"><span class="secno">2.6.3 </span>Encrypted HTTP and related security concerns</h4>

  <p>Anything in this specification that refers to HTTP also applies to HTTP-over-TLS, as
  represented by <a data-anolis-xref="url" href="#url">URLs</a> representing the <code data-anolis-xref="">https</code> scheme.
  <a href="references.html#refsHTTP">[HTTP]</a></p>

  <p class="warning">User agents should report certificate errors to the user and must either refuse
  to download resources sent with erroneous certificates or must act as if such resources were in
  fact served with no encryption.</p>

  <p>User agents should warn the user that there is a potential problem whenever the user visits a
  page that the user has previously visited, if the page uses less secure encryption on the second
  visit.</p>

  <p>Not doing so can result in users not noticing man-in-the-middle attacks.</p>

  <div class="example">

   <p>If a user connects to a server with a self-signed certificate, the user agent could allow the
   connection but just act as if there had been no encryption. If the user agent instead allowed the
   user to override the problem and then displayed the page as if it was fully and safely encrypted,
   the user could be easily tricked into accepting man-in-the-middle connections.</p>

   <p>If a user connects to a server with full encryption, but the page then refers to an external
   resource that has an expired certificate, then the user agent will act as if the resource was
   unavailable, possibly also reporting the problem to the user. If the user agent instead allowed
   the resource to be used, then an attacker could just look for "secure" sites that used resources
   from a different host and only apply man-in-the-middle attacks to that host, for example taking
   over scripts in the page.</p>

   <p>If a user bookmarks a site that uses a CA-signed certificate, and then later revisits that
   site directly but the site has started using a self-signed certificate, the user agent could warn
   the user that a man-in-the-middle attack is likely underway, instead of simply acting as if the
   page was not encrypted.</p>

  </div><!--REMOVE-TOPIC:Security-->



  <h4 id="content-type-sniffing"><span class="secno">2.6.4 </span>Determining the type of a resource</h4>

  <p>The <dfn data-anolis-xref="Content-Type" id="content-type">Content-Type metadata</dfn> of a resource must be obtained and
  interpreted in a manner consistent with the requirements of the MIME Sniffing specification. <a href="references.html#refsMIMESNIFF">[MIMESNIFF]</a></p>

  <p>The <dfn data-anolis-xref="Content-Type sniffing" id="content-type-sniffing-0">sniffed type of a resource</dfn> must be found in a
  manner consistent with the requirements given in the MIME Sniffing specification for finding the
  <i>sniffed media type</i> of the relevant sequence of octets. <a href="references.html#refsMIMESNIFF">[MIMESNIFF]</a></p>

  <p>The <dfn data-anolis-xref="Content-Type sniffing: image" id="content-type-sniffing:-image">rules for sniffing images specifically</dfn> and
  the <dfn data-anolis-xref="Content-Type sniffing: text or binary" id="content-type-sniffing:-text-or-binary">rules for distinguishing if a resource is
  text or binary</dfn> are also defined in the MIME Sniffing specification. Both sets of rules
  return a <a href="#mime-type">MIME type</a> as their result. <a href="references.html#refsMIMESNIFF">[MIMESNIFF]</a></p>

  <p class="warning">It is imperative that the rules in the MIME Sniffing specification be followed
  exactly. When a user agent uses different heuristics for content type detection than the server
  expects, security problems can occur. For more details, see the MIME Sniffing specification. <a href="references.html#refsMIMESNIFF">[MIMESNIFF]</a></p>


  <h4 id="extracting-character-encodings-from-meta-elements"><span class="secno">2.6.5 </span>Extracting character encodings from <code><a href="document-metadata.html#the-meta-element">meta</a></code> elements</h4>

  <p>The <dfn id="algorithm-for-extracting-a-character-encoding-from-a-meta-element">algorithm for extracting a character encoding from a <code>meta</code> element</dfn>,
  given a string <var data-anolis-xref="">s</var>, is as follows. It either returns a character encoding or
  nothing.</p>

  <ol><!-- http://www.hixie.ch/tests/adhoc/html/parsing/encoding/all.html --><li><p>Let <var data-anolis-xref="">position</var> be a pointer into <var data-anolis-xref="">s</var>, initially
   pointing at the start of the string.</li>

   <li><p><i>Loop</i>: Find the first seven characters in <var data-anolis-xref="">s</var> after <var data-anolis-xref="">position</var> that are an <a href="#ascii-case-insensitive">ASCII case-insensitive</a> match for the word "<code data-anolis-xref="">charset</code>". If no such match is found, return nothing and abort these
   steps.</li>

   <li><p>Skip any <a data-anolis-xref="space character" href="#space-character">space characters</a> that immediately follow the
   word "<code data-anolis-xref="">charset</code>" (there might not be any).</li>

   <li><p>If the next character is not a "=" (U+003D), then move <var data-anolis-xref="">position</var> to point just before that next character, and jump back to the step
   labeled <i>loop</i>.</li>

   <li><p>Skip any <a data-anolis-xref="space character" href="#space-character">space characters</a> that immediately follow the
   equals sign (there might not be any).</li>

   <li>

    <p>Process the next character as follows:</p>

    <dl class="switch"><dt>If it is a """ (U+0022) character and there is a later """ (U+0022) character in <var data-anolis-xref="">s</var></dt>
     <dt>If it is a "'" (U+0027) character and there is a later "'" (U+0027) character in <var data-anolis-xref="">s</var></dt>
     <dd>Return the result of <a href="#getting-an-encoding">getting an encoding</a> from the substring that is between
     this character and the next earliest occurrence of this character.</dd>

     <dt>If it is an unmatched """ (U+0022) character</dt>
     <dt>If it is an unmatched "'" (U+0027) character</dt>
     <dt>If there is no next character</dt>
     <dd>Return nothing.</dd>

     <dt>そうでなければ</dt>
     <dd>Return the result of <a href="#getting-an-encoding">getting an encoding</a> from the substring that consists of
     this character up to but not including the first <a href="#space-character">space character</a> or ";" (U+003B) character, or the end of <var data-anolis-xref="">s</var>, whichever comes first.</dd>

    </dl></li>

  </ol><p class="note">This algorithm is distinct from those in the HTTP specification (for example, HTTP
  doesn't allow the use of single quotes and requires supporting a backslash-escape mechanism that
  is not supported by this algorithm<!-- not to mention not having any rules for error-handling,
  which is of course why we're having to define it ourselves --> While the algorithm is used in contexts that, historically, were related to HTTP, the syntax as supported by implementations diverged some time ago. <a href="references.html#refsHTTP">[HTTP]</a></p>

  </div>


  <h4 id="cors-settings-attributes"><span class="secno">2.6.6</span> CORS設定属性</h4>

  <p><dfn id="cors-settings-attribute">CORS設定属性</dfn>は、<a href="#enumerated-attribute">列挙属性</a>である。次の表は、キーワードと属性の状態を示す。1列目のキーワードは、キーワードと同じ行で2列目のセル内の状態に対応づける。</p>

  <table><thead><tr><th> キーワード
     </th><th> 状態
     </th><th> 概要
   <tbody></th></tr><tr><td><dfn data-anolis-xref="attr-crossorigin-anonymous-keyword" id="attr-crossorigin-anonymous-keyword"><code>anonymous</code></dfn>
     </td><td><dfn data-anolis-xref="attr-crossorigin-anonymous" id="attr-crossorigin-anonymous">Anonymous</dfn>
     </td><td>Cross-origin CORSは、<i><a href="#omit-credentials-flag">省略認証情報フラグ</a></i>設定を持つ要素を要求する。
    </td></tr><tr><td><dfn data-anolis-xref="attr-crossorigin-use-credentials-keyword" id="attr-crossorigin-use-credentials-keyword"><code>use-credentials</code></dfn>
     </td><td><dfn data-anolis-xref="attr-crossorigin-use-credentials" id="attr-crossorigin-use-credentials">Use Credentials</dfn>
     </td><td>Cross-origin CORSは、<i><a href="#omit-credentials-flag">省略認証情報フラグ</a></i>設定を持たない要素を要求する。
  </td></tr></table><p>空文字列も妥当なキーワードであり、<a data-anolis-xref="attr-crossorigin-anonymous" href="#attr-crossorigin-anonymous">匿名</a>状態に対応づける。属性の<i>妥当でない値のデフォルト</i>は、<a data-anolis-xref="attr-crossorigin-anonymous" href="#attr-crossorigin-anonymous">匿名</a>状態である。<a data-anolis-xref="reflect" href="#reflect">反射</a>のために、<a data-anolis-xref="attr-crossorigin-anonymous" href="#attr-crossorigin-anonymous">匿名</a>状態の正規ケースは<code data-anolis-xref="attr-crossorigin-anonymous-keyword"><a href="#attr-crossorigin-anonymous-keyword">anonymous</a></code>キーワードである。属性が省略された場合に用いられる、<i>欠落した値のデフォルト</i>は、<dfn data-anolis-xref="attr-crossorigin-none" id="attr-crossorigin-none">No CORS</dfn>状態である。</p>


  <div class="impl">
  <h4 id="cors-enabled-fetch"><span class="secno">2.6.7 </span>CORS-enabled fetch</h4>


  <p>When the user agent is required to perform a <dfn id="potentially-cors-enabled-fetch">potentially CORS-enabled fetch</dfn> of an
  <a href="#absolute-url">absolute URL</a> <var data-anolis-xref="">URL</var> with a mode <var data-anolis-xref="">mode</var> that is
  either "<a data-anolis-xref="attr-crossorigin-none" href="#attr-crossorigin-none">No CORS</a>", "<a data-anolis-xref="attr-crossorigin-anonymous" href="#attr-crossorigin-anonymous">Anonymous</a>", or "<a data-anolis-xref="attr-crossorigin-use-credentials" href="#attr-crossorigin-use-credentials">Use Credentials</a>", optionally using a
  <a href="#referrer-source">referrer source</a> <var data-anolis-xref="">referrer source</var>, with an <a href="browsers.html#origin-0">origin</a>
  <var data-anolis-xref="">origin</var>, and with a default origin behaviour <var data-anolis-xref="">default</var>
  which is either "<i>taint</i>" or "<i>fail</i>", it must run the first applicable set of steps
  from the following list. The default origin behaviour is only used if <var data-anolis-xref="">mode</var> is
  "<a data-anolis-xref="attr-crossorigin-none" href="#attr-crossorigin-none">No CORS</a>". This algorithm wraps the <a href="#fetch">fetch</a>
  algorithm above, and labels the obtained resource as either <dfn id="cors-same-origin">CORS-same-origin</dfn> or
  <dfn id="cors-cross-origin">CORS-cross-origin</dfn>, or blocks the resource entirely.</p>

  <dl class="switch"><dt>If the <var data-anolis-xref="">URL</var> has the <a href="browsers.html#same-origin">same origin</a> as <var data-anolis-xref="">origin</var></dt>
   <dt>If the <var data-anolis-xref="">URL</var> is a <a data-anolis-xref="data protocol" href="#data-protocol"><code data-anolis-xref="">data:</code> URL</a></dt>
   <dt>If the <var data-anolis-xref="">URL</var> is <code><a href="#about:blank">about:blank</a></code></dt>

   <dd>

    <p>Run these substeps:</p>

    <ol><li><p><a href="#fetch">Fetch</a><!--FETCH--> <var data-anolis-xref="">URL</var>, using <var data-anolis-xref="">referrer
     source</var> if one was specified, with the <i>manual redirect flag</i> set.</li><!--
     http-origin privacy sensitive --> 

     <li><p><i>Loop</i>: Wait for the <a href="#fetch">fetch</a> algorithm to know if the result is a
     redirect or not.</li>

     <li>

      <p>Follow the first appropriate steps from the following list:</p>

      <dl class="switch"><dt>If the result of the <a href="#fetch">fetch</a> is a redirect, and the <a href="browsers.html#origin-0">origin</a> of the
       target URL of the redirect is not the <a href="browsers.html#same-origin">same origin</a> as <var data-anolis-xref="">origin</var></dt>

       <dd>

        <p>Set <var data-anolis-xref="">URL</var> to the target URL of the redirect and return to the top of
        the <a href="#potentially-cors-enabled-fetch">potentially CORS-enabled fetch</a> algorithm (this time, one of the other
        branches below might be taken, based on the value of <var data-anolis-xref="">mode</var><!-- but if
        it's a data: URL, we'll stay here --></p>

       </dd>

       <dt>If the result of the <a href="#fetch">fetch</a> is a redirect</dt>

       <dd>


        <p class="note">The <a href="browsers.html#origin-0">origin</a> of the target URL of the redirect is the <a href="browsers.html#same-origin">same
        origin</a> as <var data-anolis-xref="">origin</var>.</p>

        <p><a href="#transparently-follow-the-redirect">Transparently follow the redirect</a> and jump to the step labeled <i>loop</i>
        above.</p>

       </dd>

       <dt>そうでなければ</dt>

       <dd>


        <p class="note">The resource is available, it is not a redirect, and its <a href="browsers.html#origin-0">origin</a>
        is the <a href="browsers.html#same-origin">same origin</a> as <var data-anolis-xref="">origin</var>.</p>

        <p>The <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> from the <a href="#fetch">fetch</a> algorithm are
        <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> normally, and for the purposes of the calling
        algorithm, the obtained resource is <a href="#cors-same-origin">CORS-same-origin</a>.</p>

       </dd>

      </dl></li>

    </ol></dd>


   <dt>If <var data-anolis-xref="">mode</var> is "<a data-anolis-xref="attr-crossorigin-none" href="#attr-crossorigin-none">No CORS</a>" and
   <var data-anolis-xref="">default</var> is <i>taint</i></dt>

   <dd>

    <p class="note">The <var data-anolis-xref="">URL</var> does not have the <a href="browsers.html#same-origin">same origin</a> as <var data-anolis-xref="">origin</var>.</p>

    <p><a href="#fetch">Fetch</a><!--FETCH--> <var data-anolis-xref="">URL</var>, using <var data-anolis-xref="">referrer
    source</var> if one was specified.</p><!-- http-origin privacy sensitive --> 

    <p>The <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> from the <a href="#fetch">fetch</a> algorithm are <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> normally, but for the purposes of the calling algorithm, the
    obtained resource is <a href="#cors-cross-origin">CORS-cross-origin</a>. The user agent may report a cross-origin
    resource access failure to the user (e.g. in a debugging console).</p>

   </dd>


   <dt>If <var data-anolis-xref="">mode</var> is "<a data-anolis-xref="attr-crossorigin-none" href="#attr-crossorigin-none">No CORS</a>"</dt>

   <dd>


    <p class="note">The <var data-anolis-xref="">URL</var> does not have the <a href="browsers.html#same-origin">same origin</a> as <var data-anolis-xref="">origin</var>, and <var data-anolis-xref="">default</var> is <i>fail</i>.</p>

    <p>Discard any data fetched as part of this algorithm, and prevent any <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> from such invocations of the <a href="#fetch">fetch</a> algorithm
    from being <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a>.

    For the purposes of the calling algorithm, the user agent must act as if there was a fatal
    network error and no resource was obtained. The user agent may report a cross-origin resource
    access failure to the user (e.g. in a debugging console).</p>

   </dd>



   <dt>If <var data-anolis-xref="">mode</var> is "<a data-anolis-xref="attr-crossorigin-anonymous" href="#attr-crossorigin-anonymous">Anonymous</a>"
   or "<a data-anolis-xref="attr-crossorigin-use-credentials" href="#attr-crossorigin-use-credentials">Use Credentials</a>"</dt>

   <dd>

    <p class="note">The <var data-anolis-xref="">URL</var> does not have the <a href="browsers.html#same-origin">same origin</a> as <var data-anolis-xref="">origin</var>.</p>

    <p>Run these steps:</p>

    <ol><li><p>Perform a <a href="#cross-origin-request">cross-origin request</a><!--FETCH-->  with the <i>request URL</i> set
     to <var data-anolis-xref="">URL</var>, with the CORS <i data-anolis-xref="">referrer source</i> set to <var data-anolis-xref="">referrer source</var> if one was specified, the <i>source origin</i> set to <var data-anolis-xref="">origin</var>, and with the <i><a href="#omit-credentials-flag">omit credentials flag</a></i> set if <var data-anolis-xref="">mode</var> is "<a data-anolis-xref="attr-crossorigin-anonymous" href="#attr-crossorigin-anonymous">Anonymous</a>" and not
     set otherwise. <a href="references.html#refsFETCH">[FETCH]</a></li>

     <li><p>Wait for the CORS <a href="#cross-origin-request-status">cross-origin request status</a> to have a value.</li>

     <li>

      <p>Jump to the appropriate step from the following list:</p>

      <dl class="switch"><dt>If the CORS <a href="#cross-origin-request-status">cross-origin request status</a> is not <i>success</i></dt>

       <dd>


        <p>Discard all fetched data and prevent any <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> from
        the <a href="#fetch">fetch</a> algorithm from being <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a>. For
        the purposes of the calling algorithm, the user agent must act as if there was a fatal
        network error and no resource was obtained. If a CORS <a href="#resource-sharing-check">resource sharing check</a>
        failed, the user agent may report a cross-origin resource access failure to the user (e.g.
        in a debugging console).</p>

       </dd>

       <dt>If the CORS <a href="#cross-origin-request-status">cross-origin request status</a> is <i>success</i></dt>

       <dd>


        <p>The <a data-anolis-xref="concept-task" href="webappapis.html#concept-task">tasks</a> from the <a href="#fetch">fetch</a> algorithm are
        <a data-anolis-xref="queue a task" href="webappapis.html#queue-a-task">queued</a> normally, and for the purposes of the calling
        algorithm, the obtained resource is <a href="#cors-same-origin">CORS-same-origin</a>.</p>

       </dd>

      </dl></li>

    </ol></dd>

  </dl></div>



  <h3 id="common-dom-interfaces"><span class="secno">2.7</span> 共通DOMインターフェース</h3>

  <h4 id="reflecting-content-attributes-in-idl-attributes"><span class="secno">2.7.1</span> IDL属性におけるコンテンツ属性の反映</h4>

  <p>一部のIDL属性は、特定のコンテンツ属性の<dfn id="reflect">反映</dfn>を定義する。これは、IDL属性がコンテンツ属性の現在値を返し、IDL属性が与えられた値にコンテンツ属性の値を変更することを意味する。</p><!-- v2 for completeness: (also search for REFLECTIDL)
  <p class="note">A list of <span>reflecting IDL attributes</span> and
  their corresponding content attributes is given in the index.</p>
-->



  <div class="impl">

  <p>In general, on getting, if the content attribute is not present, the IDL attribute must act as
  if the content attribute's value is the empty string; and on setting, if the content attribute is
  not present, it must first be added.</p>

  <p>If a reflecting IDL attribute is a <code>DOMString</code> attribute whose content attribute is
  defined to contain a <a href="#url">URL</a>, then on getting, the IDL attribute must <a data-anolis-xref="resolve a url" href="#resolve-a-url">resolve</a> the value of the content attribute relative to the element
  and return the resulting <a href="#absolute-url">absolute URL</a> if that was successful, or the empty string
  otherwise; and on setting, must set the content attribute to the specified literal value. If the
  content attribute is absent, the IDL attribute must return the default value, if the content
  attribute has one, or else the empty string.</p>

  <p>If a reflecting IDL attribute is a <code>DOMString</code> attribute whose content attribute is
  defined to contain one or more <a data-anolis-xref="URL" href="#url">URLs</a>, then on getting, the IDL attribute
  must <a data-anolis-xref="split a string on spaces" href="#split-a-string-on-spaces">split the content attribute on spaces</a> and
  return the concatenation of <a data-anolis-xref="resolve a URL" href="#resolve-a-url">resolving</a> each token URL to an
  <a href="#absolute-url">absolute URL</a> relative to the element, with a single U+0020 SPACE character between
  each URL, ignoring any tokens that did not resolve successfully. If the content attribute is
  absent, the IDL attribute must return the default value, if the content attribute has one, or else
  the empty string. On setting, the IDL attribute must set the content attribute to the specified
  literal value.</p>

  <p>If a reflecting IDL attribute is a <code>DOMString</code> attribute whose content attribute is
  an <a href="#enumerated-attribute">enumerated attribute</a>, and the IDL attribute is <dfn id="limited-to-only-known-values">limited to only known
  values</dfn>, then, on getting, the IDL attribute must return the conforming value associated with
  the state the attribute is in (in its canonical case), if any, or the empty string if the
  attribute is in a state that has no associated keyword value or if the attribute is not in a defined state
  (e.g. the attribute is missing and there is no <i>missing value default</i>); and on setting, the
  content attribute must be set to the specified new value.</p>

  <p>If a reflecting IDL attribute is a <code>DOMString</code> attribute but doesn't fall into any
  of the above categories, then the getting and setting must be done in a transparent,
  case-preserving manner.</p>

  <p>If a reflecting IDL attribute is a <code data-anolis-xref="">boolean</code> attribute, then on getting the
  IDL attribute must return true if the content attribute is set, and false if it is absent. On
  setting, the content attribute must be removed if the IDL attribute is set to false, and must be
  set to the empty string if the IDL attribute is set to true. (This corresponds to the rules for
  <a data-anolis-xref="boolean attribute" href="#boolean-attribute">boolean content attributes</a>.)</p>

  <p>If a reflecting IDL attribute has a signed integer type (<code>long</code>) then, on getting,
  the content attribute must be parsed according to the <a data-anolis-xref="rules for parsing
  integers" href="#rules-for-parsing-integers">rules for parsing signed integers</a>, and if that is successful, and the value is in
  the range of the IDL attribute's type, the resulting value must be returned. If, on the other
  hand, it fails or returns an out of range value, or if the attribute is absent, then the default
  value must be returned instead, or 0 if there is no default value. On setting, the given value
  must be converted to the shortest possible string representing the number as a <a href="#valid-integer">valid
  integer</a> and then that string must be used as the new content attribute value.</p>

  <p>If a reflecting IDL attribute has a signed integer type (<code>long</code>) that is
  <dfn id="limited-to-only-non-negative-numbers">limited to only non-negative numbers</dfn> then, on getting, the content attribute must be
  parsed according to the <a href="#rules-for-parsing-non-negative-integers">rules for parsing non-negative integers</a>, and if that is
  successful, and the value is in the range of the IDL attribute's type, the resulting value must be
  returned. If, on the other hand, it fails or returns an out of range value, or if the attribute is
  absent, the default value must be returned instead, or −1 if there is no default value. On
  setting, if the value is negative, the user agent must throw an <code><a href="#indexsizeerror">IndexSizeError</a></code>
  exception. Otherwise, the given value must be converted to the shortest possible string
  representing the number as a <a href="#valid-non-negative-integer">valid non-negative integer</a> and then that string must be
  used as the new content attribute value.</p>

  <p>If a reflecting IDL attribute has an <em>unsigned</em> integer type (<code>unsigned
  long</code>) then, on getting, the content attribute must be parsed according to the <a href="#rules-for-parsing-non-negative-integers">rules
  for parsing non-negative integers</a>, and if that is successful, and the value is in the range
  0 to 2147483647 inclusive, the resulting value must be returned. If, on the other hand, it fails
  or returns an out of range value, or if the attribute is absent, the default value must be
  returned instead, or 0 if there is no default value. On setting, first, if the new value is in the
  range 0 to 2147483647, then let <var data-anolis-xref="">n</var> be the new value, otherwise let <var data-anolis-xref="">n</var> be the default value, or 0 if there is no default value; then, <var data-anolis-xref="">n</var> must be converted to the shortest possible string representing the number as a
  <a href="#valid-non-negative-integer">valid non-negative integer</a> and that string must be used as the new content attribute
  value.</p><!-- see http://www.w3.org/Bugs/Public/show_bug.cgi?id=10352
  https://bugzilla.mozilla.org/show_bug.cgi?id=586118 and
  https://www.w3.org/Bugs/Public/show_bug.cgi?id=17705 for why the
  range is clamped to 2147483647 rather the normal unsigned long
  maximum value of 4294967295 -->
  

  <p>If a reflecting IDL attribute has an unsigned integer type (<code>unsigned long</code>) that is
  <dfn id="limited-to-only-non-negative-numbers-greater-than-zero">limited to only non-negative numbers greater than zero</dfn>, then the behavior is similar to
  the previous case, but zero is not allowed. On getting, the content attribute must first be parsed
  according to the <a href="#rules-for-parsing-non-negative-integers">rules for parsing non-negative integers</a>, and if that is successful,
  and the value is in the range 1 to 2147483647 inclusive, the resulting value must be returned. If,
  on the other hand, it fails or returns an out of range value, or if the attribute is absent, the
  default value must be returned instead, or 1 if there is no default value. On setting, if the
  value is zero, the user agent must throw an <code><a href="#indexsizeerror">IndexSizeError</a></code> exception. Otherwise,
  first, if the new value is in the range 1 to 2147483647, then let <var data-anolis-xref="">n</var> be the new
  value, otherwise let <var data-anolis-xref="">n</var> be the default value, or 1 if there is no default
  value; then, <var data-anolis-xref="">n</var> must be converted to the shortest possible string representing
  the number as a <a href="#valid-non-negative-integer">valid non-negative integer</a> and that string must be used as the new
  content attribute value.</p><!-- see previous paragraph for note about the weird range -->
  

  <p>If a reflecting IDL attribute has a floating-point number type (<code>double</code> or
  <code>unrestricted double</code>), then, on getting, the content attribute must be parsed
  according to the <a href="#rules-for-parsing-floating-point-number-values">rules for parsing floating-point number values</a>, and if that is
  successful, the resulting value must be returned. If, on the other hand, it fails, or if the
  attribute is absent, the default value must be returned instead, or 0.0 if there is no default
  value. On setting, the given value must be converted to the <a href="#best-representation-of-the-number-as-a-floating-point-number">best representation of the
  number as a floating-point number</a> and then that string must be used as the new content
  attribute value.</p>

  <p>If a reflecting IDL attribute has a floating-point number type (<code>double</code> or
  <code>unrestricted double</code>) that is <dfn id="limited-to-numbers-greater-than-zero">limited to numbers greater than zero</dfn>, then
  the behavior is similar to the previous case, but zero and negative values are not allowed. On
  getting, the content attribute must be parsed according to the <a href="#rules-for-parsing-floating-point-number-values">rules for parsing
  floating-point number values</a>, and if that is successful and the value is greater than 0.0,
  the resulting value must be returned. If, on the other hand, it fails or returns an out of range
  value, or if the attribute is absent, the default value must be returned instead, or 0.0 if there
  is no default value. On setting, if the value is less than or equal to zero, then the value must
  be ignored. Otherwise, the given value must be converted to the <a href="#best-representation-of-the-number-as-a-floating-point-number">best representation of the
  number as a floating-point number</a> and then that string must be used as the new content
  attribute value.</p>

  <p class="note">The values Infinity and Not-a-Number (NaN) values throw an exception on setting,
  as defined in the Web IDL specification. <a href="references.html#refsWEBIDL">[WEBIDL]</a></p>

  <p>If a reflecting IDL attribute has the type <code><a href="#domtokenlist">DOMTokenList</a></code> or
  <code><a href="#domsettabletokenlist">DOMSettableTokenList</a></code>, then on getting it must return a <code><a href="#domtokenlist">DOMTokenList</a></code> or
  <code><a href="#domsettabletokenlist">DOMSettableTokenList</a></code> object (as appropriate) whose associated element is the element
  in question and whose associated attribute's local name is the name of the attribute in question.
  The same <code><a href="#domtokenlist">DOMTokenList</a></code> or <code><a href="#domsettabletokenlist">DOMSettableTokenList</a></code> object must be returned
  every time for each attribute.</p>

  <p>If a reflecting IDL attribute has the type <code><a href="dom.html#htmlelement">HTMLElement</a></code>, or an interface that
  descends from <code><a href="dom.html#htmlelement">HTMLElement</a></code>, then, on getting, it must run the following algorithm
  (stopping at the first point where a value is returned):</p>

  <ol><li>If the corresponding content attribute is absent, then the IDL attribute must return
   null.</li>

   <li>Let <var data-anolis-xref="">candidate</var> be the element that the <code data-anolis-xref="dom-Document-getElementById"><a href="#dom-document-getelementbyid">document.getElementById()</a></code> method would find when
   called on the content attribute's document if it were passed as its argument the current value of
   the corresponding content attribute.</li>

   <li>If <var data-anolis-xref="">candidate</var> is null, or if it is not type-compatible with the IDL
   attribute, then the IDL attribute must return null.</li>

   <li>Otherwise, it must return <var data-anolis-xref="">candidate</var>.</li>

  </ol><p>On setting, if the given element has an <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> attribute, and has the
  same <a href="#home-subtree">home subtree</a> as the element of the attribute being set, and the given element is
  the first element in that <a href="#home-subtree">home subtree</a> whose <a data-anolis-xref="concept-ID" href="#concept-id">ID</a> is
  the value of that <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> attribute, then the content attribute must be
  set to the value of that <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> attribute. Otherwise, the content
  attribute must be set to the empty string.</p>

  </div><!--TOPIC:DOM APIs-->



  <h4 id="collections"><span class="secno">2.7.2</span> コレクション</h4>

  <p><code><a href="#htmlallcollection-0">HTMLAllCollection</a></code>、<code><a href="#htmlformcontrolscollection-0">HTMLFormControlsCollection</a></code>、<code><a href="#htmloptionscollection-0">HTMLOptionsCollection</a></code>
<!--MD-->
  インターフェースは、<code><a href="#htmlcollection">HTMLCollection</a></code>インターフェースから派生する<a href="#collections-0">コレクション</a>である。</p>


  <h5 id="htmlallcollection"><span class="secno">2.7.2.1</span> HTMLAllCollection</h5>

  <p><code><a href="#htmlallcollection-0">HTMLAllCollection</a></code>インターフェースは、レガシー<code data-anolis-xref="dom-document-all"><a href="obsolete.html#dom-document-all">document.all</a></code>属性に対して使用される。このインターフェースは、<code><a href="#htmlcollection">HTMLCollection</a></code>に似た操作をする。主な違いは、複数の一致する要素が存在する場合に<code data-anolis-xref="dom-HTMLAllCollection-namedItem"><a href="#dom-htmlallcollection-nameditem">namedItem()</a></code>が<code><a href="#htmlcollection">HTMLCollection</a></code>オブジェクトを返し、そして<code data-anolis-xref="dom-HTMLAllCollection-item"><a href="#dom-htmlallcollection-item">item()</a></code>メソッドがその<code data-anolis-xref="dom-HTMLAllCollection-namedItem"><a href="#dom-htmlallcollection-nameditem">namedItem()</a></code>メソッドと同義語として使用できることにある。</p>

  <p class="note">すべての<code><a href="#htmlallcollection-0">HTMLAllCollection</a></code>オブジェクトは、<code><a href="dom.html#document">Document</a></code>でルート化され、すべての要素とマッチするフィルタを持つ。その結果<code><a href="#htmlallcollection-0">HTMLAllCollection</a></code>オブジェクトの<a href="#represented-by-the-collection">コレクションによって表される</a>要素は、ルート<code><a href="dom.html#document">Document</a></code>のすべての子孫要素から成る。
</p>

  <pre class="idl">interface <dfn id="htmlallcollection-0">HTMLAllCollection</dfn> : <a href="#htmlcollection">HTMLCollection</a> {
  // inherits <span data-anolis-xref="dom-HTMLCollection-length">length</span> and 'getter'
  <a href="#element">Element</a>? <a data-anolis-xref="dom-HTMLAllCollection-item" href="#dom-htmlallcollection-item">item</a>(unsigned long index);
  (<a href="#htmlcollection">HTMLCollection</a> or <a href="#element">Element</a>)? <a data-anolis-xref="dom-HTMLAllCollection-item-string" href="#dom-htmlallcollection-item-string">item</a>(DOMString name);
  legacycaller getter (<a href="#htmlcollection">HTMLCollection</a> or <a href="#element">Element</a>)? <a data-anolis-xref="dom-HTMLAllCollection-namedItem" href="#dom-htmlallcollection-nameditem">namedItem</a>(DOMString name); // shadows inherited namedItem()
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLCollection-length">length</code></dt>
   <dd>
    <p>コレクションの要素数を返す。</p>
   </dd>

   <dt><var data-anolis-xref="">element</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLAllCollection-item"><a href="#dom-htmlallcollection-item">item</a></code>(<var data-anolis-xref="">index</var>)</dt>
   <dt><var data-anolis-xref="">collection</var>[<var data-anolis-xref="">index</var>]</dt>
   <dd>
    <p>コレクションからのインデックス<var data-anolis-xref="">index</var>とともにアイテムを返す。アイテムは<a href="#tree-order">ツリー順</a>にソートされる。</p>
   </dd>

   <dt><var data-anolis-xref="">element</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLAllCollection-item-string"><a href="#dom-htmlallcollection-item-string">item</a></code>(<var data-anolis-xref="">name</var>)</dt>
   <dt><var data-anolis-xref="">collection</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLAllCollection-item-string"><a href="#dom-htmlallcollection-item-string">item</a></code>(<var data-anolis-xref="">name</var>)</dt>
   <dt><var data-anolis-xref="">element</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLAllCollection-namedItem"><a href="#dom-htmlallcollection-nameditem">namedItem</a></code>(<var data-anolis-xref="">name</var>)</dt>
   <dt><var data-anolis-xref="">collection</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLAllCollection-namedItem"><a href="#dom-htmlallcollection-nameditem">namedItem</a></code>(<var data-anolis-xref="">name</var>)</dt>
   <dt><var data-anolis-xref="">element</var> = <var data-anolis-xref="">collection</var>(<var data-anolis-xref="">name</var>)</dt>
   <dt><var data-anolis-xref="">collection</var> = <var data-anolis-xref="">collection</var>(<var data-anolis-xref="">name</var>)</dt>
   <dt><var data-anolis-xref="">collection</var>[<var data-anolis-xref="">name</var>]</dt>
   <dd>
    <p>コレクションからの<a data-anolis-xref="concept-id" href="#concept-id">ID</a>または名前<var data-anolis-xref="">name</var>とともにアイテムを返す。</p>
    <p>複数のマッチするアイテムが存在する場合、それらの要素すべてを含む<code><a href="#htmlcollection">HTMLCollection</a></code>オブジェクトが返される。</p><!-- this list only includes conforming elements: -->
    
    <p>ただし<code><a href="forms.html#the-button-element">button</a></code>、<code><a href="forms.html#the-form-element">form</a></code>、<code><a href="embedded-content.html#the-iframe-element">iframe</a></code>、<code><a href="forms.html#the-input-element">input</a></code>、<code><a href="embedded-content.html#the-map-element">map</a></code>、<code><a href="document-metadata.html#the-meta-element">meta</a></code>、<code><a href="embedded-content.html#the-object-element">object</a></code>、<code><a href="forms.html#the-select-element">select</a></code>および<code><a href="forms.html#the-textarea-element">textarea</a></code>要素は、このメソッドのために名前を持つことができる。 それらの名前は<code data-anolis-xref="">name</code>属性値によって与えられる。
</p>
   </dd>

  </dl><div class="impl">

  <p>The object's <a href="#supported-property-indices">supported property indices</a> are as defined for
  <code><a href="#htmlcollection">HTMLCollection</a></code> objects.</p>

  <p>The <dfn data-anolis-xref="dom-HTMLAllCollection-item" id="dom-htmlallcollection-item"><code>item()</code></dfn> method, when invoked
  with a numeric argument, must act like the <a data-anolis-xref="dom-HTMLCollection-item" href="#dom-htmlcollection-item">item()</a>
  method inherited from <code><a href="#htmlcollection">HTMLCollection</a></code>.</p><!-- http://software.hixie.ch/utilities/js/live-dom-viewer/?saved=2837 -->

  
  <p>The following elements are <dfn id="all-named-elements">"all"-named elements</dfn>:
   <code><a href="text-level-semantics.html#the-a-element">a</a></code>,  <!-- in some browsers -->
   <code><a href="obsolete.html#the-applet-element">applet</a></code>,
   <code><a href="forms.html#the-button-element">button</a></code>,  <!-- in some browsers -->
   <code><a href="embedded-content.html#the-embed-element">embed</a></code>,
   <code><a href="forms.html#the-form-element">form</a></code>,
   <code><a href="obsolete.html#frame">frame</a></code>,
   <code><a href="obsolete.html#frameset">frameset</a></code>,
   <code><a href="embedded-content.html#the-iframe-element">iframe</a></code>,  <!-- in some browsers -->
   <code><a href="embedded-content.html#the-img-element">img</a></code>,
   <code><a href="forms.html#the-input-element">input</a></code>,
   
   <!-- keygen? -->
   <code><a href="embedded-content.html#the-map-element">map</a></code>,  <!-- in some browsers -->
   <code><a href="document-metadata.html#the-meta-element">meta</a></code>,  <!-- in some browsers -->
   <code><a href="embedded-content.html#the-object-element">object</a></code>,
   <code><a href="forms.html#the-select-element">select</a></code>, and
   <code><a href="forms.html#the-textarea-element">textarea</a></code> <!-- in some browsers -->
  </p>

  <p>The <a href="#supported-property-names">supported property names</a> consist of the non-empty values of all the <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> attributes of all the elements <a href="#represented-by-the-collection">represented by the
  collection</a>, and the non-empty values of all the <code data-anolis-xref="">name</code> attributes of
  all the <a href="#all-named-elements">"all"-named elements</a> <a href="#represented-by-the-collection">represented by the collection</a>, in
  <a href="#tree-order">tree order</a>, ignoring later duplicates, with the <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> of
  an element preceding its <code data-anolis-xref="">name</code> if it contributes both, they differ from each
  other, and neither is the duplicate of an earlier entry.</p>

  <p>The properties exposed in this way must be <a href="#unenumerable">unenumerable</a>.</p>

  <p>The <dfn data-anolis-xref="dom-HTMLAllCollection-item-string" id="dom-htmlallcollection-item-string"><code>item(<var data-anolis-xref="">name</var>)</code></dfn> and <dfn data-anolis-xref="dom-HTMLAllCollection-namedItem" id="dom-htmlallcollection-nameditem"><code>namedItem(<var data-anolis-xref="">name</var>)</code></dfn>
  methods must act according to the following algorithm:</p>

  <ol><li>If <var data-anolis-xref="">name</var> is the empty string, return null and stop the algorithm.</li>

   <li>

    <p>Let <var data-anolis-xref="">collection</var> be an <code><a href="#htmlcollection">HTMLCollection</a></code> object rooted at the
    same <code><a href="dom.html#document">Document</a></code> as the <code><a href="#htmlallcollection-0">HTMLAllCollection</a></code> object on which the method was
    invoked, whose filter matches only elements that are either:</p>

    <ul><!--CLEANUP--><!--2x--><li><a href="#all-named-elements">"all"-named elements</a> with a <code data-anolis-xref="">name</code> attribute
     equal to <var data-anolis-xref="">name</var>, or,</li>

     <li>elements with an <a data-anolis-xref="concept-id" href="#concept-id">ID</a> equal to <var data-anolis-xref="">name</var>.</li>

    </ul></li>

   <li>If, at the time the method is called, there is exactly one node in <var data-anolis-xref="">collection</var>, then return that node and stop the algorithm.</li>

   <li>Otherwise, if, at the time the method is called, <var data-anolis-xref="">collection</var> is empty,
   return null and stop the algorithm.</li>

   <li>Otherwise, return <var data-anolis-xref="">collection</var>.</li>

  </ol></div>


  <h5 id="htmlformcontrolscollection"><span class="secno">2.7.2.2 </span>HTMLFormControlsCollection</h5>

  <p><code><a href="#htmlformcontrolscollection-0">HTMLFormControlsCollection</a></code>インターフェースは、<code><a href="forms.html#the-form-element">form</a></code>と<code><a href="forms.html#the-fieldset-element">fieldset</a></code>要素で<a data-anolis-xref="category-listed" href="forms.html#category-listed">記載要素</a>の<a href="#collections-0">コレクション</a>に使用される。</p>

  <pre class="idl">interface <dfn id="htmlformcontrolscollection-0">HTMLFormControlsCollection</dfn> : <a href="#htmlcollection">HTMLCollection</a> {
  // inherits <span data-anolis-xref="dom-HTMLCollection-length">length</span> and <a data-anolis-xref="dom-HTMLCollection-item" href="#dom-htmlcollection-item">item</a>()
  legacycaller getter (<a href="#radionodelist">RadioNodeList</a> or <a href="#element">Element</a>)? <a data-anolis-xref="dom-HTMLFormControlsCollection-namedItem" href="#dom-htmlformcontrolscollection-nameditem">namedItem</a>(DOMString name); // shadows inherited namedItem()
};

interface <dfn id="radionodelist">RadioNodeList</dfn> : <a href="#nodelist">NodeList</a> {
          attribute DOMString <a data-anolis-xref="dom-RadioNodeList-value" href="#dom-radionodelist-value">value</a>;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLCollection-length">length</code></dt>
   <dd>
    <p>コレクションの要素数を返す。</p>
   </dd>

   <dt><var data-anolis-xref="">element</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLCollection-item"><a href="#dom-htmlcollection-item">item</a></code>(<var data-anolis-xref="">index</var>)</dt>
   <dt><var data-anolis-xref="">collection</var>[<var data-anolis-xref="">index</var>]</dt>
   <dd>
    <p>コレクションからのインデックス<var data-anolis-xref="">index</var>とともにアイテムを返す。アイテムは<a href="#tree-order">ツリー順</a>にソートされる。</p>
   </dd>

   <dt><var data-anolis-xref="">element</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLFormControlsCollection-namedItem"><a href="#dom-htmlformcontrolscollection-nameditem">namedItem</a></code>(<var data-anolis-xref="">name</var>)</dt>
   <dt><var data-anolis-xref="">radioNodeList</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLFormControlsCollection-namedItem"><a href="#dom-htmlformcontrolscollection-nameditem">namedItem</a></code>(<var data-anolis-xref="">name</var>)</dt>
   <dt><var data-anolis-xref="">collection</var>[<var data-anolis-xref="">name</var>]</dt>
   <dt><var data-anolis-xref="">collection</var>(<var data-anolis-xref="">name</var>)</dt>
   <dd>
    <p>コレクションからの<a data-anolis-xref="concept-id" href="#concept-id">ID</a>または<code data-anolis-xref="attr-fe-name"><a href="forms.html#attr-fe-name">name</a></code> <var data-anolis-xref="">name</var>とともにアイテムを返す。</p>
    <p>複数のマッチするアイテムが存在する場合、それらの要素すべてを含む<code><a href="#radionodelist">RadioNodeList</a></code>オブジェクトが返される。</p>
   </dd>

   <dt><var data-anolis-xref="">radioNodeList</var> . <var data-anolis-xref="">value</var> [ = <var data-anolis-xref="">value</var> ]</dt>
   <dd>
    <p>オブジェクトによって表される最初にチェックされたラジオボタンの値を返す。</p>
    <p>設定される場合、オブジェクトによって表される与えられた値を持つ最初のラジオボタンをチェックする。</p>
   </dd>

  </dl><div class="impl">

  <p>The object's <a href="#supported-property-indices">supported property indices</a> are as defined for
  <code><a href="#htmlcollection">HTMLCollection</a></code> objects.</p>

  <p>The <a href="#supported-property-names">supported property names</a> consist of the non-empty values of all the <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> and <code data-anolis-xref="attr-fe-name"><a href="forms.html#attr-fe-name">name</a></code> attributes of all the
  elements <a href="#represented-by-the-collection">represented by the collection</a>, in <a href="#tree-order">tree order</a>, ignoring later
  duplicates, with the <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> of an element preceding its <code data-anolis-xref="attr-fe-name"><a href="forms.html#attr-fe-name">name</a></code> if it contributes both, they differ from each other, and neither is the
  duplicate of an earlier entry.</p>

  <p>The properties exposed in this way must be <a href="#unenumerable">unenumerable</a>.</p>

  <p>The <dfn data-anolis-xref="dom-HTMLFormControlsCollection-namedItem" id="dom-htmlformcontrolscollection-nameditem"><code>namedItem(<var data-anolis-xref="">name</var>)</code></dfn> method must act according to the following algorithm:</p>

  <ol><li>If <var data-anolis-xref="">name</var> is the empty string, return null and stop the algorithm.</li>

   <li>If, at the time the method is called, there is exactly one node in the collection that has
   either an <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> attribute or a <code data-anolis-xref="attr-fe-name"><a href="forms.html#attr-fe-name">name</a></code>
   attribute equal to <var data-anolis-xref="">name</var>, then return that node and stop the algorithm.</li>

   <li>Otherwise, if there are no nodes in the collection that have either an <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> attribute or a <code data-anolis-xref="attr-fe-name"><a href="forms.html#attr-fe-name">name</a></code> attribute equal
   to <var data-anolis-xref="">name</var>, then return null and stop the algorithm.</li>

   <li>Otherwise, create a new <code><a href="#radionodelist">RadioNodeList</a></code> object representing a <a href="#live">live</a>
   view of the <code><a href="#htmlformcontrolscollection-0">HTMLFormControlsCollection</a></code> object, further filtered so that the only
   nodes in the <code><a href="#radionodelist">RadioNodeList</a></code> object are those that have either an <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> attribute or a <code data-anolis-xref="attr-fe-name"><a href="forms.html#attr-fe-name">name</a></code> attribute equal
   to <var data-anolis-xref="">name</var>. The nodes in the <code><a href="#radionodelist">RadioNodeList</a></code> object must be sorted in
   <a href="#tree-order">tree order</a>.</li>

   <li>Return that <code><a href="#radionodelist">RadioNodeList</a></code> object.</li>

  </ol><hr><p>Members of the <code><a href="#radionodelist">RadioNodeList</a></code> interface inherited from the <code><a href="#nodelist">NodeList</a></code>
  interface must behave as they would on a <code><a href="#nodelist">NodeList</a></code> object.</p>

  <p>The <dfn data-anolis-xref="dom-RadioNodeList-value" id="dom-radionodelist-value"><code>value</code></dfn> IDL attribute on the
  <code><a href="#radionodelist">RadioNodeList</a></code> object, on getting, must return the value returned by running the
  following steps:</p>

  <ol><li><p>Let <var data-anolis-xref="">element</var> be the first element in <a href="#tree-order">tree order</a>
   represented by the <code><a href="#radionodelist">RadioNodeList</a></code> object that is an <code><a href="forms.html#the-input-element">input</a></code> element whose
   <code data-anolis-xref="attr-input-type"><a href="forms.html#attr-input-type">type</a></code> attribute is in the <a data-anolis-xref="attr-input-type-radio" href="forms.html#radio-button-state-(type=radio)">Radio Button</a> state and whose <a data-anolis-xref="concept-fe-checked" href="forms.html#concept-fe-checked">checkedness</a> is true. Otherwise, let it be null.</li>

   <li><p>If <var data-anolis-xref="">element</var> is null, or if it is an element with no <code data-anolis-xref="attr-input-value"><a href="forms.html#attr-input-value">value</a></code> attribute, return the empty string.</li>

   <li><p>Otherwise, return the value of <var data-anolis-xref="">element</var>'s <code data-anolis-xref="attr-input-value"><a href="forms.html#attr-input-value">value</a></code> attribute.</li>

  </ol><p>On setting, the <code data-anolis-xref="dom-RadioNodeList-value"><a href="#dom-radionodelist-value">value</a></code> IDL attribute must run the
  following steps:</p>

  <ol><li><p>Let <var data-anolis-xref="">element</var> be the first element in <a href="#tree-order">tree order</a>
   represented by the <code><a href="#radionodelist">RadioNodeList</a></code> object that is an <code><a href="forms.html#the-input-element">input</a></code> element whose
   <code data-anolis-xref="attr-input-type"><a href="forms.html#attr-input-type">type</a></code> attribute is in the <a data-anolis-xref="attr-input-type-radio" href="forms.html#radio-button-state-(type=radio)">Radio Button</a> state and whose <code data-anolis-xref="attr-input-value"><a href="forms.html#attr-input-value">value</a></code> content attribute is present and equal to the new value, if
   any. Otherwise, let it be null.</li>

   <li><p>If <var data-anolis-xref="">element</var> is not null, then set its <a data-anolis-xref="concept-fe-checked" href="forms.html#concept-fe-checked">checkedness</a> to true.</p>

  </li></ol><!--
http://software.hixie.ch/utilities/js/live-dom-viewer/?%3C%21DOCTYPE%20html%3E...%0A%3Cform%20name%3D%22a%22%3E%3Cinput%20id%3D%22x%22%20name%3D%22y%22%3E%3Cinput%20name%3D%22x%22%20id%3D%22y%22%3E%3C/form%3E%0A%3Cscript%3E%0A%20%20var%20x%3B%0A%20%20w%28x%20%3D%20document.forms%5B%27a%27%5D%5B%27x%27%5D%29%3B%0A%20%20w%28x.length%29%3B%0A%20%20x%5B0%5D.parentNode.removeChild%28x%5B0%5D%29%3B%0A%20%20w%28x.length%29%3B%0A%20%20w%28x%20%3D%3D%20document.forms%5B%27a%27%5D%5B%27x%27%5D%29%3B%0A%3C/script%3E%0A
--></div>


  <h5 id="htmloptionscollection"><span class="secno">2.7.2.3 </span>HTMLOptionsCollection</h5>

  <p><code><a href="#htmloptionscollection-0">HTMLOptionsCollection</a></code>インターフェースは、<code><a href="forms.html#the-option-element">option</a></code>要素の<a href="#collections-0">コレクション</a>に使用される。常に<code><a href="forms.html#the-select-element">select</a></code>要素がルートであり、要素の子孫をコントロールする属性およびメソッドを持つ。</p>

  <pre class="idl">interface <dfn id="htmloptionscollection-0">HTMLOptionsCollection</dfn> : <a href="#htmlcollection">HTMLCollection</a> {
  // inherits <a data-anolis-xref="dom-HTMLCollection-item" href="#dom-htmlcollection-item">item</a>()
           attribute unsigned long <a data-anolis-xref="dom-HTMLOptionsCollection-length" href="#dom-htmloptionscollection-length">length</a>; // shadows inherited length
  <a data-anolis-xref="dom-HTMLOptionsCollection-namedItem" href="#dom-htmloptionscollection-nameditem">legacycaller</a> <a href="forms.html#htmloptionelement">HTMLOptionElement</a>? (DOMString name);
  <a data-anolis-xref="dom-HTMLOptionsCollection-setter" href="#dom-htmloptionscollection-setter">setter creator</a> void (unsigned long index, <a href="forms.html#htmloptionelement">HTMLOptionElement</a>? option);
  void <a data-anolis-xref="dom-HTMLOptionsCollection-add" href="#dom-htmloptionscollection-add">add</a>((<a href="forms.html#htmloptionelement">HTMLOptionElement</a> or <a href="forms.html#htmloptgroupelement">HTMLOptGroupElement</a>) element, optional (<a href="dom.html#htmlelement">HTMLElement</a> or long)? before = null);
  void <a data-anolis-xref="dom-HTMLOptionsCollection-remove" href="#dom-htmloptionscollection-remove">remove</a>(long index);
           attribute long <a data-anolis-xref="dom-HTMLOptionsCollection-selectedIndex" href="#dom-htmloptionscollection-selectedindex">selectedIndex</a>;
};</pre>

  <dl class="domintro"><dt><var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLOptionsCollection-length"><a href="#dom-htmloptionscollection-length">length</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>
   <dd>
    <p>コレクションの要素数を返す。</p>
    <p>より小さい数に設定する場合、対応するコンテナ内の<code><a href="forms.html#the-option-element">option</a></code>要素数は切り捨てられる。</p>
    <p>より大きい数に設定する場合、そのコンテナに新しい空白の<code><a href="forms.html#the-option-element">option</a></code>要素を追加する。</p>
   </dd>

   <dt><var data-anolis-xref="">element</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLCollection-item"><a href="#dom-htmlcollection-item">item</a></code>(<var data-anolis-xref="">index</var>)</dt>
   <dt><var data-anolis-xref="">collection</var>[<var data-anolis-xref="">index</var>]</dt>
   <dd>
    <p>コレクションからのインデックス<var data-anolis-xref="">index</var>とともにアイテムを返す。アイテムは<a href="#tree-order">ツリー順</a>にソートされる。</p>
   </dd>

   <dt><var data-anolis-xref="">element</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLOptionsCollection-namedItem"><a href="#dom-htmloptionscollection-nameditem">namedItem</a></code>(<var data-anolis-xref="">name</var>)</dt>
   <dt><var data-anolis-xref="">nodeList</var> = <var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLOptionsCollection-namedItem"><a href="#dom-htmloptionscollection-nameditem">namedItem</a></code>(<var data-anolis-xref="">name</var>)</dt>
   <dt><var data-anolis-xref="">collection</var>[<var data-anolis-xref="">name</var>]</dt>
   <dt><var data-anolis-xref="">collection</var>(<var data-anolis-xref="">name</var>)</dt>
   <dd>
    <p>コレクションからの<a data-anolis-xref="concept-id" href="#concept-id">ID</a>または<code data-anolis-xref="attr-option-name"><a href="obsolete.html#attr-option-name">name</a></code> <var data-anolis-xref="">name</var>とともにアイテムを返す。</p>
    <p>複数のマッチするアイテムが存在する場合、最初のものが返される。</p>
   </dd>

   <dt><var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLOptionsCollection-add"><a href="#dom-htmloptionscollection-add">add</a></code>(<var data-anolis-xref="">element</var> [, <var data-anolis-xref="">before</var> ] )</dt>
   <dd>
    <p><var data-anolis-xref="">before</var>によって与えられるノードの前の<var data-anolis-xref="">要素</var>を挿入する。</p>
    <p><var data-anolis-xref="">before</var>引数は数字でもよく、その場合<var data-anolis-xref="">element</var>はその数字をもつアイテムの前に挿入され、またはコレクションからの要素でもよい。その場合<var data-anolis-xref="">element</var>はその要素の前に挿入される。</p>
    <p><var data-anolis-xref="">before</var>が省略された、null、または範囲外の数字の場合、<var data-anolis-xref="">element</var>はリストの最後に加えられるだろう。</p>
    <p><var data-anolis-xref="">要素</var>に挿入された要素が親要素の場合、このメソッドは<code><a href="#hierarchyrequesterror">HierarchyRequestError</a></code>例外を投げるだろう。</p>
   </dd>

   <dt><var data-anolis-xref="">collection</var> . <code data-anolis-xref="dom-HTMLOptionsCollection-selectedIndex"><a href="#dom-htmloptionscollection-selectedindex">selectedIndex</a></code> [ = <var data-anolis-xref="">value</var> ]</dt>

   <dd>

    <p>もしあるならば、最初に選ばれたアイテムのインデックスを、または選択したアイテムが存在しない場合−1を返す。</p>

    <p>選択を変更する設定が可能である。</p>

   </dd>

  </dl><div class="impl">

  <p>The object's <a href="#supported-property-indices">supported property indices</a> are as defined for
  <code><a href="#htmlcollection">HTMLCollection</a></code> objects.</p>

  <p>On getting, the <dfn data-anolis-xref="dom-HTMLOptionsCollection-length" id="dom-htmloptionscollection-length"><code>length</code></dfn>
  attribute must return the number of nodes <a href="#represented-by-the-collection">represented by the collection</a>.</p>

  <p>On setting, the behavior depends on whether the new value is equal to, greater than, or less
  than the number of nodes <a href="#represented-by-the-collection">represented by the collection</a> at that time. If the number is
  the same, then setting the attribute must do nothing. If the new value is greater, then <var data-anolis-xref="">n</var> new <code><a href="forms.html#the-option-element">option</a></code> elements with no attributes and no child nodes must be
  appended to the <code><a href="forms.html#the-select-element">select</a></code> element on which the <code><a href="#htmloptionscollection-0">HTMLOptionsCollection</a></code> is
  rooted, where <var data-anolis-xref="">n</var> is the difference between the two numbers (new value minus old
  value). Mutation events must be fired as if a <code><a href="#documentfragment">DocumentFragment</a></code> containing the new
  <code><a href="forms.html#the-option-element">option</a></code> elements had been inserted. If the new value is lower, then the last <var data-anolis-xref="">n</var> nodes in the collection must be removed from their parent nodes, where <var data-anolis-xref="">n</var> is the difference between the two numbers (old value minus new value).</p>

  <p class="note">Setting <code data-anolis-xref="dom-HTMLOptionsCollection-length"><a href="#dom-htmloptionscollection-length">length</a></code> never removes
  or adds any <code><a href="forms.html#the-optgroup-element">optgroup</a></code> elements, and never adds new children to existing
  <code><a href="forms.html#the-optgroup-element">optgroup</a></code> elements (though it can remove children from them).</p>

  <p>The <a href="#supported-property-names">supported property names</a> consist of the non-empty values of all the <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> and <code data-anolis-xref="attr-option-name"><a href="obsolete.html#attr-option-name">name</a></code> attributes of all the
  elements <a href="#represented-by-the-collection">represented by the collection</a>, in <a href="#tree-order">tree order</a>, ignoring later
  duplicates, with the <code data-anolis-xref="attr-id"><a href="dom.html#the-id-attribute">id</a></code> of an element preceding its <code data-anolis-xref="attr-option-name"><a href="obsolete.html#attr-option-name">name</a></code> if it contributes both, they differ from each other, and neither is
  the duplicate of an earlier entry.</p>

  <p>The properties exposed in this way must be <a href="#unenumerable">unenumerable</a>.</p>

  <p>The <dfn data-anolis-xref="dom-HTMLOptionsCollection-namedItem" id="dom-htmloptionscollection-nameditem">legacy caller</dfn> of the
  <code><a href="#htmloptionscollection-0">HTMLOptionsCollection</a></code> interface must act like the <code data-anolis-xref="dom-HTMLCollection-namedItem">namedItem()</code> method on the ancestor
  <code><a href="#htmlcollection">HTMLCollection</a></code> interface.</p>

  <p>When the user agent is to <dfn data-anolis-xref="dom-HTMLOptionsCollection-setter" id="dom-htmloptionscollection-setter">set the value of a new
  indexed property or set the value of an existing indexed property</dfn> for a given property index
  <var data-anolis-xref="">index</var> to a new value <var data-anolis-xref="">value</var>, it must run the following
  algorithm:</p>

  <ol><li><p>If <var data-anolis-xref="">value</var> is null, invoke the steps for the <code data-anolis-xref="dom-HTMLOptionsCollection-remove"><a href="#dom-htmloptionscollection-remove">remove</a></code> method with <var data-anolis-xref="">index</var> as
   the argument, and abort these steps.</li>

   <li><p>Let <var data-anolis-xref="">length</var> be the number of nodes <a href="#represented-by-the-collection">represented by the
   collection</a>.</li>

   <li><p>Let <var data-anolis-xref="">n</var> be <var data-anolis-xref="">index</var> minus <var data-anolis-xref="">length</var>.</li>

   <li><p>If <var data-anolis-xref="">n</var> is greater than zero, then <a data-anolis-xref="concept-node-append" href="#concept-node-append">append</a> a <code><a href="#documentfragment">DocumentFragment</a></code> consisting of <span data-anolis-xref=""><var data-anolis-xref="">n</var>-1</span> new <code><a href="forms.html#the-option-element">option</a></code> elements with no attributes and
   no child nodes to the <code><a href="forms.html#the-select-element">select</a></code> element on which the <code><a href="#htmloptionscollection-0">HTMLOptionsCollection</a></code>
   is rooted.</li>

   <li><p>If <var data-anolis-xref="">n</var> is greater than or equal to zero, <a data-anolis-xref="concept-node-append" href="#concept-node-append">append</a> <var data-anolis-xref="">value</var> to the <code><a href="forms.html#the-select-element">select</a></code>
   element. Otherwise, <a data-anolis-xref="concept-node-replace" href="#concept-node-replace">replace</a> the <var data-anolis-xref="">index</var>th element in the collection by <var data-anolis-xref="">value</var>.</li>

  </ol><p>The <dfn data-anolis-xref="dom-HTMLOptionsCollection-add" id="dom-htmloptionscollection-add"><code>add(<var data-anolis-xref="">element</var>, <var data-anolis-xref="">before</var>)</code></dfn> method must act according to the following algorithm:</p>

  <ol><li><p>If <var data-anolis-xref="">element</var> is an ancestor of the <code><a href="forms.html#the-select-element">select</a></code> element on which
   the <code><a href="#htmloptionscollection-0">HTMLOptionsCollection</a></code> is rooted, then throw a <code><a href="#hierarchyrequesterror">HierarchyRequestError</a></code>
   exception and abort these steps.</li>

   <li><p>If <var data-anolis-xref="">before</var> is an element, but that element isn't a descendant of the
   <code><a href="forms.html#the-select-element">select</a></code> element on which the <code><a href="#htmloptionscollection-0">HTMLOptionsCollection</a></code> is rooted, then throw
   a <code><a href="#notfounderror">NotFoundError</a></code> exception and abort these steps.</li>

   <li><p>If <var data-anolis-xref="">element</var> and <var data-anolis-xref="">before</var> are the same element, then
   return and abort these steps.</li>

   <li><p>If <var data-anolis-xref="">before</var> is a node, then let <var data-anolis-xref="">reference</var> be that
   node. Otherwise, if <var data-anolis-xref="">before</var> is an integer, and there is a <var data-anolis-xref="">before</var>th node in the collection, let <var data-anolis-xref="">reference</var> be that node.
   Otherwise, let <var data-anolis-xref="">reference</var> be null.</li>

   <li><p>If <var data-anolis-xref="">reference</var> is not null, let <var data-anolis-xref="">parent</var> be the parent
   node of <var data-anolis-xref="">reference</var>. Otherwise, let <var data-anolis-xref="">parent</var> be the
   <code><a href="forms.html#the-select-element">select</a></code> element on which the <code><a href="#htmloptionscollection-0">HTMLOptionsCollection</a></code> is rooted.</li>

   <li><p>Act as if the DOM <code data-anolis-xref="dom-Node-insertBefore"><a href="#dom-node-insertbefore">insertBefore()</a></code> method was
   invoked on the <var data-anolis-xref="">parent</var> node, with <var data-anolis-xref="">element</var> as the first
   argument and <var data-anolis-xref="">reference</var> as the second argument.</p>

  </li></ol><p>The <dfn data-anolis-xref="dom-HTMLOptionsCollection-remove" id="dom-htmloptionscollection-remove"><code>remove(<var data-anolis-xref="">index</var>)</code></dfn> method must act according to the following algorithm:</p>

  <ol><li><p>If the number of nodes <a href="#represented-by-the-collection">represented by the collection</a> is zero, abort these
   steps.</li>

   <li><p>If <var data-anolis-xref="">index</var> is not a number greater than or equal to 0 and less than the
   number of nodes <a href="#represented-by-the-collection">represented by the collection</a>, abort these steps.</li><!-- note that Web IDL converts 'a', NaN, -0.5, 0.5, most objects, and null to 0, and numbers in
   general truncate. so what we're checking against here in a way has very little to do with what's
   going on in the JS --><!-- objects get converted by calling ToNumber which calls ToPrimitive which eventually calls valueOf:
         http://software.hixie.ch/utilities/js/live-dom-viewer/saved/2828
         http://software.hixie.ch/utilities/js/live-dom-viewer/saved/2833
    --><!-- same for select.remove(), which calls this algorithm also:
         http://software.hixie.ch/utilities/js/live-dom-viewer/saved/2826
         http://software.hixie.ch/utilities/js/live-dom-viewer/saved/2825
         http://software.hixie.ch/utilities/js/live-dom-viewer/saved/2827
     -->
   
   
   

   <li><p>Let <var data-anolis-xref="">element</var> be the <var data-anolis-xref="">index</var>th element in the
   collection.</li>

   <li><p>Remove <var data-anolis-xref="">element</var> from its parent node.</li>

  </ol><p>The <dfn data-anolis-xref="dom-HTMLOptionsCollection-selectedIndex" id="dom-htmloptionscollection-selectedindex"><code>selectedIndex</code></dfn> IDL
  attribute must act like the identically named attribute on the <code><a href="forms.html#the-select-element">select</a></code> element on
  which the <code><a href="#htmloptionscollection-0">HTMLOptionsCollection</a></code> is rooted</p><!-- see also http://ln.hixie.ch/?start=1161042744&count=1 -->

  

  </div><!--MD--><!--TOPIC:DOM APIs-->





  <h4 id="domstringmap"><span class="secno">2.7.3 </span>DOMStringMap</h4>

  <p><code><a href="#domstringmap-0">DOMStringMap</a></code>インターフェースは、名前と値のペアの組を表す。これは、プロパティーのアクセスのためにスクリプト言語のネイティヴメカニズムを使用して、ペアの組を公開する。</p>

  <div class="impl">

  <p>When a <code><a href="#domstringmap-0">DOMStringMap</a></code> object is instantiated, it is associated with three
  algorithms, one for getting the list of name-value pairs, one for setting names to certain values,
  and one for deleting names.</p>

  <pre class="idl">[OverrideBuiltins, Exposed=Window,Worker]
interface <dfn id="domstringmap-0">DOMStringMap</dfn> {
  <a data-anolis-xref="dom-DOMStringMap-namedItem" href="#dom-domstringmap-nameditem">getter</a> DOMString (DOMString name);
  <a data-anolis-xref="dom-DOMStringMap-setItem" href="#dom-domstringmap-setitem">setter</a> <a data-anolis-xref="dom-DOMStringMap-addItem" href="#dom-domstringmap-additem">creator</a> void (DOMString name, DOMString value);
  <a data-anolis-xref="dom-DOMStringMap-removeItem" href="#dom-domstringmap-removeitem">deleter</a> void (DOMString name);
};</pre>

  <p>The <a href="#supported-property-names">supported property names</a> on a <code><a href="#domstringmap-0">DOMStringMap</a></code> object at any instant
  are the names of each pair returned from the algorithm for getting the list of name-value pairs at
  that instant, in the order returned.</p>

  <p>To <dfn data-anolis-xref="dom-DOMStringMap-namedItem" id="dom-domstringmap-nameditem">determine the value of a named property</dfn> <var data-anolis-xref="">name</var> in a <code><a href="#domstringmap-0">DOMStringMap</a></code>, the user agent must return the value component
  of the name-value pair whose name component is <var data-anolis-xref="">name</var> in the list returned by
  the algorithm for getting the list of name-value pairs.</p>

  <p>To set the value of a <dfn data-anolis-xref="dom-DOMStringMap-addItem" id="dom-domstringmap-additem">new</dfn> or <dfn data-anolis-xref="dom-DOMStringMap-setItem" id="dom-domstringmap-setitem">existing</dfn> named property <var data-anolis-xref="">name</var> to value
  <var data-anolis-xref="">value</var>, the algorithm for setting names to certain values must be run, passing
  <var data-anolis-xref="">name</var> as the name and the result of converting <var data-anolis-xref="">value</var> to a
  <code>DOMString</code> as the value.</p>

  <p>To <dfn data-anolis-xref="dom-DOMStringMap-removeItem" id="dom-domstringmap-removeitem">delete an existing named property</dfn> <var data-anolis-xref="">name</var>, the algorithm for deleting names must be run, passing <var data-anolis-xref="">name</var> as the name.</p>

  <p class="note">The <code><a href="#domstringmap-0">DOMStringMap</a></code> interface definition here is only intended for
  JavaScript environments. Other language bindings will need to define how <code><a href="#domstringmap-0">DOMStringMap</a></code>
  is to be implemented for those languages.</p>

  </div>

  <div class="example">

   <p>要素の<code data-anolis-xref="dom-dataset"><a href="dom.html#dom-dataset">dataset</a></code>属性は、要素の<code data-anolis-xref="attr-data-*"><a href="dom.html#attr-data-*">data-*</a></code>属性を公開する。</p>

   <p>類似の構造とともに以下の引数および要素が与えられるとする：</p>

   <pre>&lt;img class="tower" id="tower5" data-<!---->x="12" data-y="5"
     data-ai="robotarget" data-hp="46" data-ability="flames"
     src="towers/rocket.png alt="Rocket Tower"&gt;</pre>

   <p>1つは関数<code data-anolis-xref="">splashDamage()</code>がいくつかの引数を取ることが考えられ、第1引数は処理する要素となる：</p>

   <pre>function splashDamage(node, x, y, damage) {
  if (node.classList.contains('tower') &amp;&amp; // checking the 'class' attribute
      node.dataset.x == x &amp;&amp; // reading the 'data-x' attribute
      node.dataset.y == y) { // reading the 'data-y' attribute
    var hp = parseInt(node.dataset.hp); // reading the 'data-hp' attribute
    hp = hp - damage;
    if (hp &lt; 0) {
      hp = 0;
      node.dataset.ai = 'dead'; // setting the 'data-ai' attribute
      delete node.dataset.ability; // removing the 'data-ability' attribute
    }
    node.dataset.hp = hp; // setting the 'data-hp' attribute
  }
}</pre>

  </div>


  <h4 id="domelementmap"><span class="secno">2.7.4 </span>DOMElementMap</h4>

  <p><code><a href="#domelementmap-0">DOMElementMap</a></code>インターフェースは、名前と要素のペアの組を表す。これは、プロパティーのアクセスのためにスクリプト言語のネイティヴメカニズムを使用して、ペアの組を公開する。</p>

  <div class="impl">

  <p>When a <code><a href="#domelementmap-0">DOMElementMap</a></code> object is instantiated, it is associated with three
  algorithms, one for getting the list of name-element mappings, one for mapping a name to a certain
  element, and one for deleting mappings by name.</p>

  <pre class="idl">interface <dfn id="domelementmap-0">DOMElementMap</dfn> {
  <a data-anolis-xref="dom-DOMElementMap-namedItem" href="#dom-domelementmap-nameditem">getter</a> <a href="#element">Element</a> (DOMString name);
  <a data-anolis-xref="dom-DOMElementMap-setItem" href="#dom-domelementmap-setitem">setter</a> <a data-anolis-xref="dom-DOMElementMap-addItem" href="#dom-domelementmap-additem">creator</a> void (DOMString name, <a href="#element">Element</a> value);
  <a data-anolis-xref="dom-DOMElementMap-removeItem" href="#dom-domelementmap-removeitem">deleter</a> void (DOMString name);
};</pre>

  <p>The <a href="#supported-property-names">supported property names</a> on a <code><a href="#domelementmap-0">DOMElementMap</a></code> object at any instant
  are the names for each mapping returned from the algorithm for getting the list of name-element
  mappings at that instant, in the order returned.</p>

  <p>To <dfn data-anolis-xref="dom-DOMElementMap-namedItem" id="dom-domelementmap-nameditem">determine the value of a named property</dfn> <var data-anolis-xref="">name</var> in a <code><a href="#domelementmap-0">DOMElementMap</a></code>, the user agent must return the element
  component of the name-element mapping whose name component is <var data-anolis-xref="">name</var> in the list
  returned by the algorithm for getting the list of name-element mappings.</p>

  <p>To set the value of a <dfn data-anolis-xref="dom-DOMElementMap-addItem" id="dom-domelementmap-additem">new</dfn> or <dfn data-anolis-xref="dom-DOMElementMap-setItem" id="dom-domelementmap-setitem">existing</dfn> named property <var data-anolis-xref="">name</var> to value
  <var data-anolis-xref="">value</var>, the algorithm for mapping a name to a certain element must be run,
  passing <var data-anolis-xref="">name</var> as the name <var data-anolis-xref="">value</var> as the element.</p>

  <p>To <dfn data-anolis-xref="dom-DOMElementMap-removeItem" id="dom-domelementmap-removeitem">delete an existing named property</dfn> <var data-anolis-xref="">name</var>, the algorithm for deleting mappings must be run, passing <var data-anolis-xref="">name</var> as the name component of the mapping to be deleted.</p>

  <p class="note">The <code><a href="#domelementmap-0">DOMElementMap</a></code> interface definition here is only intended for
  JavaScript environments. Other language bindings will need to define how
  <code><a href="#domelementmap-0">DOMElementMap</a></code> is to be implemented for those languages.</p>

  </div>



  <h4 id="transferable-objects"><span class="secno">2.7.5</span> 譲渡可能オブジェクト</h4>

  <p>一部のオブジェクトは、ある操作でコピーおよびクローズされることをサポートする。これはオブジェクトを<i>譲渡可能</i>と呼び、特に共有不可の所有権またはワーカーの境界を越えて高価なリソースを移転することに使用される。</p>

  <p>以下は<code><a href="#transferable">Transferable</a></code>型である：</p>

  <ul class="brief"><li><code><a href="#arraybuffer">ArrayBuffer</a></code> <a href="references.html#refsECMA262">[ECMA262]</a>
   </li><li><code><a href="scripting-1.html#canvasproxy">CanvasProxy</a></code> （この仕様で定義される）
      </li><li><code>MessagePort</code>
     </li></ul><div class="impl">

  <p>The following IDL block formalizes this:</p>

  <pre class="idl">typedef (<a href="#arraybuffer">ArrayBuffer</a> or <a href="scripting-1.html#canvasproxy">CanvasProxy</a> or <span>MessagePort</span>) <dfn id="transferable">Transferable</dfn>;</pre>

  <p>To <dfn id="transfer-a-transferable-object">transfer a <code>Transferable</code> object</dfn> to a new owner, the user agent must
  run the steps defined for the type of object in question. The steps will return a new object of
  the same type, and will permanently <dfn data-anolis-xref="concept-Transferable-neutered" id="concept-transferable-neutered">neuter</dfn> the
  original object. (This is an irreversible and non-idempotent operation; once an object has been
  transferred, it cannot be transferred, or indeed used, again.)</p>

  <p id="transferArrayBuffer">To <a data-anolis-xref="transfer a Transferable object" href="#transfer-a-transferable-object">transfer</a> an
  <code><a href="#arraybuffer">ArrayBuffer</a></code> object <var data-anolis-xref="">old</var> to a new owner <var data-anolis-xref="">owner</var>, a user agent must create a new <code><a href="#arraybuffer">ArrayBuffer</a></code> object pointing at
  the same underlying data as <var data-anolis-xref="">old</var>, thus obtaining <var data-anolis-xref="">new</var>,
  must <a data-anolis-xref="concept-Transferable-neutered" href="#concept-transferable-neutered">neuter</a> the <var data-anolis-xref="">old</var>
  object, and must finally return <var data-anolis-xref="">new</var>. <a href="references.html#refsECMA262">[ECMA262]</a></p><!-- I'm expecting this section to move to the JS spec eventually so I'm leaving it as is for now -->
  

  <p class="note">Rules for how to <a href="scripting-1.html#transferCanvasProxy">transfer a
  <code>CanvasProxy</code> object</a> and how to <a href="references.html#refsWEBMSG">transfer a
  <code>MessagePort</code> object</a> are given in the relevant sections of this specification.</p>

  </div>


  <div class="impl">

  <h4 id="safe-passing-of-structured-data"><span class="secno">2.7.6 </span>Safe passing of structured data</h4>

  <p>When a user agent is required to obtain a <dfn id="structured-clone">structured clone</dfn> of a value, optionally
  with a <i>transfer map</i>, it must run the following algorithm, which either returns a separate
  value, or throws an exception. If a <i>transfer map</i> is provided, it consists of an association
  list of <code><a href="#transferable">Transferable</a></code> objects to placeholder objects.</p>

  <ol><li><p>Let <var data-anolis-xref="">input</var> be the value being cloned.</li>

   <li><p>Let <var data-anolis-xref="">transfer map</var> be the <i>transfer map</i> passed to the algorithm,
   if any, or the empty list otherwise.</li>

   <li><p>Let <var data-anolis-xref="">memory</var> be an association list of pairs of objects, initially
   empty. This is used to handle duplicate references. In each pair of objects, one is called the
   <em><a href="embedded-content.html#the-source-element">source</a></em> object and the other the <em>destination</em> object.</li>

   <li><p>For each mapping in <var data-anolis-xref="">transfer map</var>, add a mapping from the
   <code><a href="#transferable">Transferable</a></code> object (the source object) to the placeholder object (the destination
   object) to <var data-anolis-xref="">memory</var>.</li>

   <li><p>Let <var data-anolis-xref="">output</var> be the value resulting from calling the <a href="#internal-structured-cloning-algorithm">internal
   structured cloning algorithm</a> with <var data-anolis-xref="">input</var> as the "<var data-anolis-xref="">input</var>" argument, and <var data-anolis-xref="">memory</var> as the "<var data-anolis-xref="">memory</var>" argument.</li>

   <li><p>Return <var data-anolis-xref="">output</var>.</li>

  </ol><p>The <dfn id="internal-structured-cloning-algorithm">internal structured cloning algorithm</dfn> is always called with two arguments, <var data-anolis-xref="">input</var> and <var data-anolis-xref="">memory</var>, and its behavior is as follows:</p>

  <ol><li><p>If <var data-anolis-xref="">input</var> is the source object of a pair of objects in <var data-anolis-xref="">memory</var>, then return the destination object in that pair of objects and abort these
   steps.</li>

   <li><p>If <var data-anolis-xref="">input</var> is a primitive value, then return that value and abort these
   steps.</li>

   <li><p>Let <var data-anolis-xref="">deep clone</var> be <i>none</i>.</li>

   <li>

    <p>The <var data-anolis-xref="">input</var> value is an object. Jump to the appropriate step below:</p>

    <dl class="switch"><dt>If <var data-anolis-xref="">input</var> is a <code>Boolean</code> object</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a newly constructed Boolean object with the same value
     as <var data-anolis-xref="">input</var>.</dd>

     <dt>If <var data-anolis-xref="">input</var> is a <code>Number</code> object</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a newly constructed Number object with the same value
     as <var data-anolis-xref="">input</var>.</dd>

     <dt>If <var data-anolis-xref="">input</var> is a <code>String</code> object</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a newly constructed String object with the same value
     as <var data-anolis-xref="">input</var>.</dd>

     <dt>If <var data-anolis-xref="">input</var> is a <code>Date</code> object</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a newly constructed <code>Date</code> object with the
     same value as <var data-anolis-xref="">input</var>.</dd>

     <dt>If <var data-anolis-xref="">input</var> is a <code>RegExp</code> object</dt>

     <dd>

      <p>Let <var data-anolis-xref="">output</var> be a newly constructed <code>RegExp</code> object with the
      same pattern and flags as <var data-anolis-xref="">input</var>.</p>

      <p class="note">The value of the <code data-anolis-xref="">lastIndex</code> property is not copied.</p>

     </dd>

     <dt>If <var data-anolis-xref="">input</var> is a <code><a href="#blob">Blob</a></code> object</dt>

     <dd><p>If <var data-anolis-xref="">input</var> has been disabled through the <code data-anolis-xref="dom-Blob-close"><a href="#dom-blob-close">close()</a></code> method, throw a <code><a href="#datacloneerror">DataCloneError</a></code> exception
     and abort the overall <a href="#structured-clone">structured clone</a> algorithm. Otherwise, let <var data-anolis-xref="">output</var> be a newly constructed object of the same class as <var data-anolis-xref="">input</var>, corresponding to the same underlying data.</dd>

     <dt>If <var data-anolis-xref="">input</var> is a <code><a href="#filelist">FileList</a></code> object</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a newly constructed <code><a href="#filelist">FileList</a></code> object
     containing a list of newly constructed <code><a href="#file">File</a></code> objects corresponding to the same
     underlying data as those in <var data-anolis-xref="">input</var>, maintaining their relative
     order.</dd>

     <dt>If <var data-anolis-xref="">input</var> is an <code>ImageData</code> object</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a newly constructed <code>ImageData</code> object
     whose <code data-anolis-xref="dom-imagedata-width">width</code> and <code data-anolis-xref="dom-imagedata-height">height</code> have values equal to the corresponding attributes
     on <var data-anolis-xref="">input</var>, and whose <code data-anolis-xref="dom-imagedata-data">data</code>
     attribute has the value obtained from invoking the <a href="#internal-structured-cloning-algorithm">internal structured cloning
     algorithm</a> recursively with the value of the <code data-anolis-xref="dom-imagedata-data">data</code> attribute on <var data-anolis-xref="">input</var> as the new
     "<var data-anolis-xref="">input</var>" argument and <var data-anolis-xref="">memory</var> as the new "<var data-anolis-xref="">memory</var>" argument.</dd>

     <dt>If <var data-anolis-xref="">input</var> is an <code><a href="webappapis.html#imagebitmap">ImageBitmap</a></code> object</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a newly constructed <code><a href="webappapis.html#imagebitmap">ImageBitmap</a></code> object
     whose bitmap data is a copy of <var data-anolis-xref="">input</var>'s bitmap data.</dd>

     <dt>If <var data-anolis-xref="">input</var> is an <code><a href="#arraybuffer">ArrayBuffer</a></code> object</dt>

     <dd><p>If <var data-anolis-xref="">input</var> has been <a data-anolis-xref="concept-Transferable-neutered" href="#concept-transferable-neutered">neutered</a>, throw a <code><a href="#datacloneerror">DataCloneError</a></code>
     exception and abort the overall <a href="#structured-clone">structured clone</a> algorithm. Otherwise, let <var data-anolis-xref="">output</var> be a newly constructed <code><a href="#arraybuffer">ArrayBuffer</a></code> object whose contents
     are a copy of <var data-anolis-xref="">input</var>'s contents, with the same length.</dd>

     <dt>If <var data-anolis-xref="">input</var> is an object with a [[DataView]] internal slot</dt>

     <dd>

      <p>Let <var data-anolis-xref="">output</var> be a newly constructed object of the same class as <var data-anolis-xref="">input</var>, with its [[DataView]] internal property present, its
      [[ViewedArrayBuffer]] internal property set to the value obtained from invoking the
      <a href="#internal-structured-cloning-algorithm">internal structured cloning algorithm</a> recursively with the value of the internal
      property on <var data-anolis-xref="">input</var> as the new "<var data-anolis-xref="">input</var>" argument and
      <var data-anolis-xref="">memory</var> as the new "<var data-anolis-xref="">memory</var>" argument, and with the
      [[ByteLength]] and [[ByteOffset]] internal properties set to the same value as their
      counterparts on <var data-anolis-xref="">input</var>.</p><!-- the above might not make much sense, but it'll become moot when JS takes over defining
      how to clone ArrayBufferView objects -->

      

     </dd>

     <dt>If <var data-anolis-xref="">input</var> is an <code>Array</code> object</dt>

     <dd>

      <p>Let <var data-anolis-xref="">output</var> be a newly constructed empty <code>Array</code> object
      whose <code data-anolis-xref="">length</code> is equal to the <code data-anolis-xref="">length</code> of <var data-anolis-xref="">input</var>, and set <var data-anolis-xref="">deep clone</var> to <i>own</i>.</p>

      <p class="note">This means that the length of sparse arrays is preserved.</p>

     </dd>

     <dt>If <var data-anolis-xref="">input</var> is an <code data-anolis-xref="">Object</code> object</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a newly constructed empty <code data-anolis-xref="">Object</code> object, and set <var data-anolis-xref="">deep clone</var> to <i>own</i>.</dd>

     <dt>If <var data-anolis-xref="">input</var> is a <code data-anolis-xref="">Map</code> object</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a newly constructed empty <code data-anolis-xref="">Map</code>
     object, and set <var data-anolis-xref="">deep clone</var> to <i><a href="embedded-content.html#the-map-element">map</a></i>.</dd>

     <dt>If <var data-anolis-xref="">input</var> is a <code>Set</code> object</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a newly constructed empty <code data-anolis-xref="">Set</code>
     object, and set <var data-anolis-xref="">deep clone</var> to <i>set</i>.</dd>

     <dt>If <var data-anolis-xref="">input</var> is an object that another specification defines how to clone</dt>

     <dd><p>Let <var data-anolis-xref="">output</var> be a clone of the object as defined by the other
     specification.</dd>

     <dt>If <var data-anolis-xref="">input</var> is another native object type (e.g. <code>Error</code>,
     <code>Function</code>)</dt>
     <dt>If <var data-anolis-xref="">input</var> is a host object (e.g. a DOM node)</dt>

     <dd><p>Throw a <code><a href="#datacloneerror">DataCloneError</a></code> exception and abort the overall <a href="#structured-clone">structured
     clone</a> algorithm.</dd>

    </dl><p>For the purposes of the algorithm above, an object is a particular type of object <var data-anolis-xref="">class</var> if its [[Class]] internal property is equal to <var data-anolis-xref="">class</var>.</p>

    <p class="example">For example, "<var data-anolis-xref="">input</var> is an <code data-anolis-xref="">Object</code>
    object" if <var data-anolis-xref="">input</var>'s [[Class]] internal property is equal to the string
    "<code data-anolis-xref="">Object</code>".</p>

   </li>

   <li><p>Add a mapping from <var data-anolis-xref="">input</var> (the source object) to <var data-anolis-xref="">output</var> (the destination object) to <var data-anolis-xref="">memory</var>.</li>

   <li>

    <p>If <var data-anolis-xref="">deep clone</var> is set to <i><a href="embedded-content.html#the-map-element">map</a></i>, then run these substeps. These
    substeps use the terminology and typographic conventions used in the JavaScript specification's
    definition of Maps. <a href="references.html#refsECMA262">[ECMA262]</a></p>

    <ol><li><p>Let <var data-anolis-xref="">source</var> be the List that is the value of <var data-anolis-xref="">input</var>'s [[MapData]] internal slot, if any. If there is no such slot, then
     instead throw a <code><a href="#datacloneerror">DataCloneError</a></code> exception and abort the overall <a href="#structured-clone">structured
     clone</a> algorithm. <a href="references.html#refsECMA262">[ECMA262]</a></li>

     <li><p>Let <var data-anolis-xref="">target</var> be the List that is the value of <var data-anolis-xref="">output</var>'s [[MapData]] internal slot.</li>

     <li>

      <p>For each Record {[[key]], [[value]]} <var data-anolis-xref="">entry</var> that is an element of
      <var data-anolis-xref="">source</var>, run the following substeps:</p>

      <ol><li><p>Let <var data-anolis-xref="">key</var> have the value obtained from invoking the
       <a href="#internal-structured-cloning-algorithm">internal structured cloning algorithm</a> recursively with <var data-anolis-xref="">entry</var>.[[key]] as the new "<var data-anolis-xref="">input</var>" argument and <var data-anolis-xref="">memory</var> as the new "<var data-anolis-xref="">memory</var>" argument.</li>

       <li><p>Let <var data-anolis-xref="">value</var> have the value obtained from invoking the
       <a href="#internal-structured-cloning-algorithm">internal structured cloning algorithm</a> recursively with <var data-anolis-xref="">entry</var>.[[value]] as the new "<var data-anolis-xref="">input</var>" argument and <var data-anolis-xref="">memory</var> as the new "<var data-anolis-xref="">memory</var>" argument.</li>

       <li><p>Let <var data-anolis-xref="">new entry</var> be the Record {[[key]]: <var data-anolis-xref="">key</var>,
       [[value]]: <var data-anolis-xref="">value</var>}.</li>

       <li><p>Append <var data-anolis-xref="">new entry</var> as the last element of <var data-anolis-xref="">target</var>.</li>

      </ol></li>

     <li><p>Set <var data-anolis-xref="">deep clone</var> to <i>own</i>.</li>

    </ol></li>

   <li>

    <p>If <var data-anolis-xref="">deep clone</var> is set to <i>set</i>, then run these substeps. These
    substeps use the terminology and typographic conventions used in the JavaScript specification's
    definition of Sets. <a href="references.html#refsECMA262">[ECMA262]</a></p>

    <ol><li><p>Let <var data-anolis-xref="">source</var> be the List that is the value of <var data-anolis-xref="">input</var>'s [[SetData]] internal slot, if any. If there is no such slot, then
     instead throw a <code><a href="#datacloneerror">DataCloneError</a></code> exception and abort the overall <a href="#structured-clone">structured
     clone</a> algorithm. <a href="references.html#refsECMA262">[ECMA262]</a></li>

     <li><p>Let <var data-anolis-xref="">target</var> be the List that is the value of <var data-anolis-xref="">output</var>'s [[SetData]] internal slot.</li>

     <li>

      <p>For each <var data-anolis-xref="">entry</var> that is an element of <var data-anolis-xref="">source</var> that
      is not <i>empty</i>, run the following substeps:</p>

      <ol><li><p>Let <var data-anolis-xref="">new entry</var> have the value obtained from invoking the
       <a href="#internal-structured-cloning-algorithm">internal structured cloning algorithm</a> recursively with <var data-anolis-xref="">entry</var> as the new "<var data-anolis-xref="">input</var>" argument and <var data-anolis-xref="">memory</var> as the new "<var data-anolis-xref="">memory</var>" argument.</li>

       <li><p>Append <var data-anolis-xref="">new entry</var> as the last element of <var data-anolis-xref="">target</var>.</li>

      </ol></li>

     <li><p>Set <var data-anolis-xref="">deep clone</var> to <i>own</i>.</li>

    </ol></li>

   <li>

    <p>If <var data-anolis-xref="">deep clone</var> is set to <i>own</i>, then, for each enumerable own
    property in <var data-anolis-xref="">input</var>, run the following steps:</p>

    <ol><li><p>Let <var data-anolis-xref="">name</var> be the name of the property.</li>

     <li><p>Let <var data-anolis-xref="">source value</var> be the result of calling the [[Get]] internal
     method of <var data-anolis-xref="">input</var> with the argument <var data-anolis-xref="">name</var>. If the
     [[Get]] internal method of a property involved executing script, and that script threw an
     uncaught exception, then abort the overall <a href="#structured-clone">structured clone</a> algorithm, with that
     exception being passed through to the caller.</li>

     <li><p>Let <var data-anolis-xref="">cloned value</var> be the result of invoking the <a href="#internal-structured-cloning-algorithm">internal
     structured cloning algorithm</a> recursively with <var data-anolis-xref="">source value</var> as the
     "<var data-anolis-xref="">input</var>" argument and <var data-anolis-xref="">memory</var> as the "<var data-anolis-xref="">memory</var>" argument. If this results in an exception, then abort the overall
     <a href="#structured-clone">structured clone</a> algorithm, with that exception being passed through to the
     caller.</li>

     <li><p>Add a new property to <var data-anolis-xref="">output</var> having the name <var data-anolis-xref="">name</var>, and having the value <var data-anolis-xref="">cloned value</var>.</li>

    </ol><p>The order of the properties in the <var data-anolis-xref="">input</var> and <var data-anolis-xref="">output</var>
    objects must be the same, and any properties whose [[Get]] internal method involves running
    script must be processed in that same order.</p>

    <p class="note">This does not walk the prototype chain.</p>

    <p class="note">Property descriptors, setters, getters, and analogous features are not copied in
    this process. For example, the property in the input could be marked as read-only, but in the
    output it would just have the default state (typically read-write, though that could depend on
    the scripting environment).</p>

    <p class="note">Properties of Array objects are not treated any differently than those of other
    Objects. In particular, this means that non-index properties of arrays are copied as well.</p>

   </li>

   <li><p>Return <var data-anolis-xref="">output</var>.</li>

  </ol><p class="note">This algorithm preserves cycles and preserves the identity of duplicate objects in
  graphs.</p>

  </div>


  <h4 id="callbacks"><span class="secno">2.7.7 </span>コールバック</h4>

  <p>次のコールバック関数型は、<code><a href="#file">File</a></code>オブジェクトと対話するさまざまなAPIで使用される：</p>

  <pre class="idl">callback <dfn id="filecallback">FileCallback</dfn> = void (<a href="#file">File</a> file);</pre>


  <div class="impl">

  <h4 id="garbage-collection"><span class="secno">2.7.8 </span>Garbage collection</h4>

  <p>There is an <dfn id="implied-strong-reference">implied strong reference</dfn> from any IDL attribute that returns a
  pre-existing object to that object.</p>

  <div class="example">

   <p>For example, the <code>document.location</code> attribute means that there is a strong
   reference from a <code><a href="dom.html#document">Document</a></code> object to its <code><a href="browsers.html#location">Location</a></code> object. Similarly,
   there is always a strong reference from a <code><a href="dom.html#document">Document</a></code> to any descendant nodes, and from
   any node to its owner <code><a href="dom.html#document">Document</a></code>.</p>

  </div>

  </div><!--TOPIC:HTML Syntax and Parsing-->



  <h3 id="namespaces"><span class="secno">2.8</span> 名前空間</h3>

  <p><dfn id="html-namespace-0">HTML名前空間</dfn>は<code>http://www.w3.org/1999/xhtml</code>である。</p>

  <p><dfn id="mathml-namespace">MathML名前空間</dfn>は<code>http://www.w3.org/1998/Math/MathML</code>である。</p>

  <p><dfn id="svg-namespace">SVG名前空間</dfn>は<code>http://www.w3.org/2000/svg</code>である。</p>

  <p><dfn id="xlink-namespace">XLink名前空間</dfn>は<code>http://www.w3.org/1999/xlink</code>である。</p>

  <p><dfn id="xml-namespace">XML名前空間</dfn>は<code>http://www.w3.org/XML/1998/namespace</code>である。</p>

  <p><dfn id="xmlns-namespace">XMLNS名前空間</dfn>は<code>http://www.w3.org/2000/xmlns/</code>である。</p>

  <hr><p>データマイニングツールおよび、スクリプトを実行、CSSやXPathを評価、または別の方法で任意のコンテンツにDOMの結果を公開することなく、コンテンツに対する操作を実行するユーザーエージェントは、それらのDOMノードの類似体が実際に上記の文字列を公開することなく、特定の名前空間であることを相応の主張することによって"名前空間をサポート"してもよい。</p>

  <hr><p class="note"><a href="syntax.html#syntax">HTML構文</a>において、名前空間接頭辞および名前空間宣言は、XMLと同一の効果を持たない。たとえば、HTML要素名においてコロンは特別な意味を持たない。</p><!--TOPIC:DOM APIs-->



  </body></html>