<!DOCTYPE html><html class="split" lang="ja"><script src="https://html.spec.whatwg.org/link-fixup.js" defer=""></script><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"><title>HTML Standard, Developer's Edition 日本語訳</title><meta content="#3c790a" name="theme-color"><link rel="stylesheet" href="https://resources.whatwg.org/standard-shared-with-dev.css" crossorigin=""><link rel="icon" href="https://resources.whatwg.org/logo.svg" crossorigin=""><script>
   function toggleStatus(div) {
     div.parentNode.classList.toggle('wrapped');
   }
  </script><link rel="stylesheet" href="https://html.spec.whatwg.org/dev/styles.css" crossorigin=""><body>
  <script async="" src="search.js"></script>
  
  
  
  <header id="head" class="head with-buttons"><a href="https://whatwg.org/" class="logo"><img width="100" alt="WHATWG" crossorigin="" src="https://resources.whatwg.org/logo.svg" height="100"></a><hgroup><h1><a rel="home" href="./dev" />HTML: The Living Standard</a></h1><h2 id="dev-edition-h2" class="no-num no-toc">Developer's Edition — Last Updated <span class="pubdate">19 December 2019</span></h2></hgroup>
   

   <div id="search"><input placeholder="Search. Press '/'" autocomplete="off" name="query" id="query" type="search"><ol id="results"></ol>
   </div>
  </header>

  

  

  

  
  

  
  

  

  <nav><a href="server-sent-events.html">← 9.2 Server-sent events</a> — <a href="./">目次</a> — <a href="web-messaging.html">9.4 Cross-document messaging →</a></nav><ol class="toc"><li><ol><li><a href="web-sockets.html#network"><span class="secno">9.3</span> Web sockets</a><ol><li><a href="web-sockets.html#network-intro"><span class="secno">9.3.1</span> Introduction</a><li><a href="web-sockets.html#the-websocket-interface"><span class="secno">9.3.2</span> The <code>WebSocket</code> interface</a><li><a href="web-sockets.html#ping-and-pong-frames"><span class="secno">9.3.3</span> Ping and Pong frames</a><li><a href="web-sockets.html#the-closeevent-interface"><span class="secno">9.3.4</span> The <code>CloseEvent</code> interface</a></ol></ol></ol><h3 id="network"><span class="secno">9.3</span> <dfn>Web sockets</dfn><a href="#network" class="self-link"></a></h3><div class="status"><input onclick="toggleStatus(this)" value="⋰" type="button"><p class="support"><strong>Support:</strong> websockets<span class="and_chr yes"><span>Chrome for Android</span> <span>78+</span></span><span class="chrome yes"><span>Chrome</span> <span>16+</span></span><span class="ios_saf yes"><span>iOS Safari</span> <span>6.0+</span></span><span class="firefox yes"><span>Firefox</span> <span>11+</span></span><span class="safari yes"><span>Safari</span> <span>7+</span></span><span class="samsung yes"><span>Samsung Internet</span> <span>4+</span></span><span class="and_uc yes"><span>UC Browser for Android</span> <span>12.12+</span></span><span class="edge yes"><span>Edge</span> <span>12+</span></span><span class="ie yes"><span>IE</span> <span>10+</span></span><span class="op_mini no"><span>Opera Mini</span> <span>None</span></span><span class="opera yes"><span>Opera</span> <span>12.1+</span></span><span class="kaios yes"><span>KaiOS Browser</span> <span>2.5+</span></span><p class="caniuse">Source: <a href="https://caniuse.com/#feat=websockets">caniuse.com</a></div>

  <h4 id="network-intro"><span class="secno">9.3.1</span> Introduction<a href="#network-intro" class="self-link"></a></h4>

  

  <p>To enable Web applications to maintain bidirectional communications with server-side processes, this specification introduces the <code>WebSocket</code> interface.</p>

  <p class="note">This interface does not allow for raw access to the underlying network. For example, this interface could not be used to implement an IRC client without proxying messages through a custom server.</p>


  <aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket" title="The WebSocket object provides the API for creating and managing a WebSocket connection to a server, as well as for sending and receiving data on the connection.">WebSocket</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>Yes</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>11+</span></span><span class="firefox no"><span>Firefox</span><span>No</span></span><span class="firefox no"><span>Firefox</span><span>No</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>14+</span></span><span class="firefox_android no"><span>Firefox Android</span><span>No</span></span><span class="ie yes"><span>Internet Explorer</span><span>Yes</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><h4 id="the-websocket-interface"><span class="secno">9.3.2</span> The <code>WebSocket</code> interface<a href="#the-websocket-interface" class="self-link"></a></h4>

  

  <aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/WebSocket" title="The WebSocket() constructor returns a new WebSocket object.">WebSocket/WebSocket</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge unknown"><span>Edge</span><span>?</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>7+</span></span><span class="firefox no"><span>Firefox</span><span>No</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>7+</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android unknown"><span>Opera Android</span><span>?</span></span><span class="safari unknown"><span>Safari</span><span>?</span></span><span class="safari_ios unknown"><span>Safari iOS</span><span>?</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/send" title="The WebSocket.send() method enqueues the specified data to be transmitted to the server over the WebSocket connection, increasing the value of bufferedAmount by the number of bytes needed to contain the data. If the data can't be sent (for example, because it needs to be buffered but the buffer is full), the socket is closed automatically.">WebSocket/send</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>18+</span></span><span class="firefox no"><span>Firefox</span><span>No</span></span><span class="firefox no"><span>Firefox</span><span>No</span></span><span class="firefox no"><span>Firefox</span><span>No</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/close" title="The WebSocket.close() method closes the WebSocket connection or connection attempt, if any. If the connection is already CLOSED, this method does nothing.">WebSocket/close</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>8+</span></span><span class="firefox no"><span>Firefox</span><span>No</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/url" title="The WebSocket.url read-only property returns the absolute URL of the WebSocket as resolved by the constructor.">WebSocket/url</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>Yes</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/readyState" title="The WebSocket.readyState read-only property returns the current state of the WebSocket connection.">WebSocket/readyState</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>Yes</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/bufferedAmount" title="The WebSocket.bufferedAmount read-only property returns the number of bytes of data that have been queued using calls to send() but not yet transmitted to the network. This value resets to zero once all queued data has been sent. This value does not reset to zero when the connection is closed; if you keep calling send(), this will continue to climb.">WebSocket/bufferedAmount</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>Yes</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/extensions" title="The WebSocket.extensions read-only property returns the extensions selected by the server. This is currently only the empty string or a list of extensions as negotiated by the connection.">WebSocket/extensions</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>8+</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>8+</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/protocol" title="The WebSocket.protocol read-only property returns the name of the sub-protocol the server selected; this will be one of the strings specified in the protocols parameter when creating the WebSocket object, or the empty string if no connection is established.">WebSocket/protocol</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>Yes</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/binaryType" title="The WebSocket.binaryType property returns the type of binary data being transmitted by the connection.">WebSocket/binaryType</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>Yes</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><dl class="domintro"><dt><var>socket</var> = new <code id="dom-websocket">WebSocket</code>(<var>url</var> [, <var>protocols</var> ] )<dd><p>Creates a new <code>WebSocket</code> object, immediately establishing the associated WebSocket connection.</p>

    <p><var>url</var> is a string giving the <a id="the-websocket-interface:url" href="https://triple-underscore.github.io/URL-ja.html#concept-url" data-x-internal="url">URL</a> over which the connection is established. Only "<code>ws</code>" or "<code>wss</code>" schemes are allowed; others will cause a <a id="the-websocket-interface:syntaxerror" href="https://triple-underscore.github.io/WebIDL-ja.html#syntaxerror" data-x-internal="syntaxerror">"<code>SyntaxError</code>"</a> <code id="the-websocket-interface:domexception"><a data-x-internal="domexception" href="https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException">DOMException</a></code>. URLs with <a href="https://triple-underscore.github.io/URL-ja.html#concept-url-fragment" id="the-websocket-interface:concept-url-fragment" data-x-internal="concept-url-fragment">fragments</a> will also cause such an exception.</p>

    <p><var>protocols</var> is either a string or an array of strings. If it is a string, it is equivalent to an array consisting of just that string; if it is omitted, it is equivalent to the empty array. Each string in the array is a subprotocol name. The connection will only be established if the server reports that it has selected one of these subprotocols. The subprotocol names have to match the requirements for elements that comprise the value of <code id="the-websocket-interface:http-sec-websocket-protocol"><a href="infrastructure.html#http-sec-websocket-protocol">Sec-WebSocket-Protocol</a></code> fields as defined by <cite>The WebSocket protocol</cite>. <a href="references.html#refsWSP">[WSP]</a></p>
   <dt><var>socket</var> . <code id="dom-websocket-send">send</code>( <var>data</var> )<dd><p>Transmits <var>data</var> using the WebSocket connection. <var>data</var> can be a string, a <code id="the-websocket-interface:blob"><a data-x-internal="blob" href="https://w3c.github.io/FileAPI/#dfn-Blob">Blob</a></code>, an <code id="the-websocket-interface:idl-arraybuffer"><a data-x-internal="idl-arraybuffer" href="https://triple-underscore.github.io/WebIDL-ja.html#idl-ArrayBuffer">ArrayBuffer</a></code>, or an <code id="the-websocket-interface:idl-arraybufferview"><a data-x-internal="idl-arraybufferview" href="https://triple-underscore.github.io/WebIDL-ja.html#common-ArrayBufferView">ArrayBufferView</a></code>.</p>
  <dt><var>socket</var> . <code id="dom-websocket-close">close</code>( [ <var>code</var> ] [, <var>reason</var> ] )<dd><p>Closes the WebSocket connection, optionally using <var>code</var> as the <a href="infrastructure.html#concept-websocket-close-code" id="the-websocket-interface:concept-websocket-close-code">the WebSocket connection close code</a> and <var>reason</var> as the <a href="infrastructure.html#concept-websocket-close-reason" id="the-websocket-interface:concept-websocket-close-reason">the WebSocket connection close reason</a>.</p>
   <dt><var>socket</var> . <code id="dom-websocket-url">url</code><dd><p>Returns the <span>URL that was used</span> to establish the WebSocket connection.</p>
   <dt><var>socket</var> . <code id="dom-websocket-readystate">readyState</code><dd><p>Returns the state of the <code>WebSocket</code> object's connection. It can have the values described below.</p>
   <dt><var>socket</var> . <code id="dom-websocket-bufferedamount">bufferedAmount</code><dd><p>Returns the number of bytes of application data (UTF-8 text and binary data) that have been queued using <code id="the-websocket-interface:dom-websocket-send"><a href="#dom-websocket-send">send()</a></code> but not yet been transmitted to the network.</p>

    <p>If the WebSocket connection is closed, this attribute's value will only increase with each call to the <code id="the-websocket-interface:dom-websocket-send-2"><a href="#dom-websocket-send">send()</a></code> method. (The number does not reset to zero once the connection closes.)</p>
   <dt><var>socket</var> . <code id="dom-websocket-extensions">extensions</code><dd><p>Returns the extensions selected by the server, if any.</p>
   <dt><var>socket</var> . <code id="dom-websocket-protocol">protocol</code><dd><p>Returns the subprotocol selected by the server, if any. It can be used in conjunction with the array form of the constructor's second argument to perform subprotocol negotiation.</p>
   <dt><var>socket</var> . <code id="dom-websocket-binarytype">binaryType</code> [ = <var>value</var> ]<dd><p>Returns a string that indicates how binary data from the <code>WebSocket</code> object is exposed to scripts:</p>

    <dl><dt>"<code>blob</code>"<dd><p>Binary data is returned in <code id="the-websocket-interface:blob-2"><a data-x-internal="blob" href="https://w3c.github.io/FileAPI/#dfn-Blob">Blob</a></code> form.</p>
     <dt>"<code>arraybuffer</code>"<dd><p>Binary data is returned in <code id="the-websocket-interface:idl-arraybuffer-2"><a data-x-internal="idl-arraybuffer" href="https://triple-underscore.github.io/WebIDL-ja.html#idl-ArrayBuffer">ArrayBuffer</a></code> form.</p>
     </dl>

    <p>Can be set, to change how binary data is returned. The default is "<code>blob</code>".</p>

   </dl>

  

  <p>The <code id="the-websocket-interface:dom-websocket-readystate"><a href="#dom-websocket-readystate">readyState</a></code> attribute can have the following values:</p>

  <dl><dt><dfn id="dom-websocket-connecting"><code>CONNECTING</code></dfn> (numeric value 0)<dd>The connection has not yet been established.<dt><dfn id="dom-websocket-open"><code>OPEN</code></dfn> (numeric value 1)<dd><i id="the-websocket-interface:concept-websocket-established"><a href="infrastructure.html#concept-websocket-established">The WebSocket connection is established</a></i> and communication is possible.<dt><dfn id="dom-websocket-closing"><code>CLOSING</code></dfn> (numeric value 2)<dd>The connection is going through the closing handshake, or the <code id="the-websocket-interface:dom-websocket-close"><a href="#dom-websocket-close">close()</a></code> method has been invoked.<dt><dfn id="dom-websocket-closed"><code>CLOSED</code></dfn> (numeric value 3)<dd>The connection has been closed or could not be opened.</dl>

  

  <p class="note">The <code id="the-websocket-interface:dom-websocket-close-2"><a href="#dom-websocket-close">close()</a></code> method does not discard previously sent messages before starting the WebSocket closing handshake — even if, in practice, the user agent is still busy sending those messages, the handshake will only start after the messages are sent.</p> 

  <hr>

  

  <div class="example"><p>In this simple example, the <code id="the-websocket-interface:dom-websocket-bufferedamount"><a href="#dom-websocket-bufferedamount">bufferedAmount</a></code> attribute is used to ensure that updates are sent either at the rate of one update every 50ms, if the network can handle that rate, or at whatever rate the network <em>can</em> handle, if that is too fast.</p>

   <pre><code class='js'><c- a>var</c-> socket <c- o>=</c-> <c- k>new</c-> WebSocket<c- p>(</c-><c- t>'ws://game.example.com:12010/updates'</c-><c- p>);</c->
socket<c- p>.</c->onopen <c- o>=</c-> <c- a>function</c-> <c- p>()</c-> <c- p>{</c->
  setInterval<c- p>(</c-><c- a>function</c-><c- p>()</c-> <c- p>{</c->
    <c- k>if</c-> <c- p>(</c->socket<c- p>.</c->bufferedAmount <c- o>==</c-> <c- mi>0</c-><c- p>)</c->
      socket<c- p>.</c->send<c- p>(</c->getUpdateData<c- p>());</c->
  <c- p>},</c-> <c- mi>50</c-><c- p>);</c->
<c- p>};</c-></code></pre>

   <p>The <code id="the-websocket-interface:dom-websocket-bufferedamount-2"><a href="#dom-websocket-bufferedamount">bufferedAmount</a></code> attribute can also be used to saturate the network without sending the data at a higher rate than the network can handle, though this requires more careful monitoring of the value of the attribute over time.</p>

  </div>

  <hr>

  

  <hr>

  <p>The following are the <a id="the-websocket-interface:event-handlers" href="webappapis.html#event-handlers">event handlers</a> (and their corresponding <span>event handler event types</span>) supported, as <a id="the-websocket-interface:event-handler-idl-attributes" href="webappapis.html#event-handler-idl-attributes">event handler IDL attributes</a>, by all objects implementing the <code>WebSocket</code> interface:</p>

  <aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/onopen" title="The WebSocket.onopen property is an EventHandler that is called when the WebSocket connection's readyState changes to OPEN; this indicates that the connection is ready to send and receive data. It is called with an Event.">WebSocket/onopen</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>Yes</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/onmessage" title="The WebSocket.onmessage property is an EventHandler that is called when a message is received from the server. It is called with a MessageEvent.">WebSocket/onmessage</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>Yes</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/onerror" title="The WebSocket interface's onerror event handler property is a function which gets called when an error occurs on the WebSocket.">WebSocket/onerror</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>Yes</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSocket/onclose" title="The WebSocket.onclose property is an EventHandler that is called when the WebSocket connection's readyState changes to CLOSED. It is called with a CloseEvent.">WebSocket/onclose</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>12+</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>Yes</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>Yes</span></span><span class="ie unknown"><span>Internet Explorer</span><span>?</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><table><thead><tr><th><a href="webappapis.html#event-handlers" id="the-websocket-interface:event-handlers-2">イベントハンドラー</a><th><span>イベントハンドラーイベント型</span><tbody><tr><td><dfn id="handler-websocket-onopen"><code>onopen</code></dfn><td><code id="the-websocket-interface:event-open"><a href="indices.html#event-open">open</a></code><tr><td><dfn id="handler-websocket-onmessage"><code>onmessage</code></dfn><td><code id="the-websocket-interface:event-message"><a href="indices.html#event-message">message</a></code><tr><td><dfn id="handler-websocket-onerror"><code>onerror</code></dfn><td><code id="the-websocket-interface:event-error"><a href="indices.html#event-error">error</a></code><tr><td><dfn id="handler-websocket-onclose"><code>onclose</code></dfn><td><code id="the-websocket-interface:event-close"><a href="indices.html#event-close">close</a></code></table>


  

  <div class="example"><p>Here is an example of how to define a handler for the <code id="the-websocket-interface:event-message-2"><a href="indices.html#event-message">message</a></code> event in the case of text frames:</p>

   <pre><code class='js'>mysocket<c- p>.</c->onmessage <c- o>=</c-> <c- a>function</c-> <c- p>(</c->event<c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c->event<c- p>.</c->data <c- o>==</c-> <c- t>'on'</c-><c- p>)</c-> <c- p>{</c->
    turnLampOn<c- p>();</c->
  <c- p>}</c-> <c- k>else</c-> <c- k>if</c-> <c- p>(</c->event<c- p>.</c->data <c- o>==</c-> <c- t>'off'</c-><c- p>)</c-> <c- p>{</c->
    turnLampOff<c- p>();</c->
  <c- p>}</c->
<c- p>};</c-></code></pre>

   <p>The protocol here is a trivial one, with the server just sending "on" or "off" messages.</p>

  </div>

  <hr>

  


  <h4 id="ping-and-pong-frames"><span class="secno">9.3.3</span> Ping and Pong frames<a href="#ping-and-pong-frames" class="self-link"></a></h4>

  <p><cite>The WebSocket protocol</cite> defines Ping and Pong frames that can be used for keep-alive, heart-beats, network status probing, latency instrumentation, and so forth. These are not currently exposed in the API.</p>

  

  


  <aside class="mdn before wrapped"><input onclick="toggleStatus(this)" value="⋰" type="button"><div><b>MDN</b><details><summary><a href="https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent" title="A CloseEvent is sent to clients using WebSockets when the connection is closed. This is delivered to the listener indicated by the WebSocket object's onclose attribute.">CloseEvent</a></summary><p class="mdnsupport"><span class="chrome yes"><span>Chrome</span><span>Yes</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>Yes</span></span><span class="edge yes"><span>Edge</span><span>Yes</span></span><span class="edge_mobile unknown"><span>Edge Mobile</span><span>?</span></span><span class="firefox yes"><span>Firefox</span><span>8+</span></span><span class="firefox_android yes"><span>Firefox Android</span><span>8+</span></span><span class="ie yes"><span>Internet Explorer</span><span>10+</span></span><span class="opera yes"><span>Opera</span><span>Yes</span></span><span class="opera_android yes"><span>Opera Android</span><span>Yes</span></span><span class="safari yes"><span>Safari</span><span>Yes</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>Yes</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>Yes</span></span><span class="webview_android yes"><span>WebView Android</span><span>Yes</span></span></details></div></aside><h4 id="the-closeevent-interface"><span class="secno">9.3.4</span> The <code>CloseEvent</code> interface<a href="#the-closeevent-interface" class="self-link"></a></h4>

  <p><code>WebSocket</code> objects use the <code>CloseEvent</code> interface for their <code id="the-closeevent-interface:event-close"><a href="indices.html#event-close">close</a></code> events:</p>

  

  <dl class="domintro"><dt><var>event</var> . <code id="dom-closeevent-wasclean">wasClean</code><dd><p>Returns true if the connection closed cleanly; false otherwise.</p>
   <dt><var>event</var> . <code id="dom-closeevent-code">code</code><dd><p>Returns the WebSocket connection close code provided by the server.</p>
   <dt><var>event</var> . <code id="dom-closeevent-reason">reason</code><dd><p>Returns the WebSocket connection close reason provided by the server.</p>
   </dl>

  


  <nav><a href="server-sent-events.html">← 9.2 Server-sent events</a> — <a href="./">目次</a> — <a href="web-messaging.html">9.4 Cross-document messaging →</a></nav>
