<!DOCTYPE html><html class="split" lang="ja"><script src="https://html.spec.whatwg.org/link-fixup.js" defer=""></script><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"><title>HTML Standard, Edition for Web Developers日本語訳</title><meta content="#3c790a" name="theme-color"><link rel="stylesheet" href="https://resources.whatwg.org/standard-shared-with-dev.css" crossorigin=""><link rel="icon" href="https://resources.whatwg.org/logo.svg" crossorigin=""><link rel="stylesheet" href="https://html.spec.whatwg.org/dev/styles.css" crossorigin=""><script>
   function toggleStatus(div) {
     div.parentNode.classList.toggle('wrapped');
   }
   function setLinkFragment(link) {
     link.hash = location.hash;
   }
  </script><body>
  <script async="" src="./search.js"></script>
  
  
  
  <header id="head" class="head with-buttons"><a href="https://whatwg.org/" class="logo"><img width="100" alt="WHATWG" crossorigin="" src="https://resources.whatwg.org/logo.svg" height="100"></a><hgroup><h1><a rel="home" href="./dev" />HTML: The Living Standard</a></h1><p id="dev-edition-h2">Edition for Web Developers — Last Updated <span class="pubdate">24 March 2023</span></hgroup>
   

   <div id="search"><input placeholder="Search. Press '/'" autocomplete="off" name="query" id="query" type="search"><ol id="results"></ol>
   </div>
  </header>

  

  

  

  
  

  
  

  

  <nav><a href="dnd.html">← 6.10 ドラッグアンドドロップ</a> — <a href="./">目次</a> — <a href="browsers.html">7 ウェブページの読み込み →</a></nav><ol class="toc"><li><ol><li><a href="popover.html#the-popover-attribute"><span class="secno">6.11</span> <code>popover</code>属性</a><ol><li><a href="popover.html#the-popover-target-attributes"><span class="secno">6.11.1</span> ポップオーバーターゲット属性</a><li><a href="popover.html#popover-light-dismiss"><span class="secno">6.11.2</span> ポップオーバーの簡易非表示</a><li><a href="popover.html#the-toggleevent-interface"><span class="secno">6.11.3</span> <code>ToggleEvent</code>インターフェイス</a></ol></ol></ol><h3 id="the-popover-attribute"><span class="secno">6.11</span> <code id="the-popover-attribute:attr-popover"><a href="#attr-popover">popover</a></code>属性<a href="#the-popover-attribute" class="self-link"></a></h3>

  <p>すべての<a id="the-popover-attribute:html-elements" href="infrastructure.html#html-elements">HTML要素</a>は<dfn data-dfn-for="html-global" id="attr-popover" data-dfn-type="element-attr"><code>popover</code></dfn>コンテンツ属性設定を持ってもよい。指定された場合、要素は表示されるまでレンダリングされず、表示されると、他のページ コンテンツの上にレンダリングされる。</p>

  <div class="example"><p>The <code id="the-popover-attribute:attr-popover-2"><a href="#attr-popover">popover</a></code> attribute is a global attribute that allows authors flexibility to ensure popover functionality can be applied to elements with the most relevant semantics.</p>

   <p>The following demonstrates how one might create a popover sub-navigation list of links, within the global navigation for a website.</p>

   <pre><code class='html'><c- p>&lt;</c-><c- f>ul</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>li</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>a</c-> <c- e>href</c-><c- o>=</c-><c- s>...</c-><c- p>></c->All Products<c- p>&lt;/</c-><c- f>a</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>button</c-> <c- e>popovertarget</c-><c- o>=</c-><c- s>sub-nav</c-><c- p>></c->
     <c- p>&lt;</c-><c- f>img</c-> <c- e>src</c-><c- o>=</c-><c- s>down-arrow.png</c-> <c- e>alt</c-><c- o>=</c-><c- s>"Product pages"</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>ul</c-> <c- e>popover</c-> <c- e>id</c-><c- o>=</c-><c- s>sub-nav</c-><c- p>></c->
     <c- p>&lt;</c-><c- f>li</c-><c- p>>&lt;</c-><c- f>a</c-> <c- e>href</c-><c- o>=</c-><c- s>...</c-><c- p>></c->Shirts<c- p>&lt;/</c-><c- f>a</c-><c- p>></c->
     <c- p>&lt;</c-><c- f>li</c-><c- p>>&lt;</c-><c- f>a</c-> <c- e>href</c-><c- o>=</c-><c- s>...</c-><c- p>></c->Shoes<c- p>&lt;/</c-><c- f>a</c-><c- p>></c->
     <c- p>&lt;</c-><c- f>li</c-><c- p>>&lt;</c-><c- f>a</c-> <c- e>href</c-><c- o>=</c-><c- s>...</c-><c- p>></c->Hats etc.<c- p>&lt;/</c-><c- f>a</c-><c- p>></c->
    <c- p>&lt;/</c-><c- f>ul</c-><c- p>></c->
  <c- p>&lt;/</c-><c- f>li</c-><c- p>></c->
  <c- c>&lt;!-- other list items and links here --></c->
<c- p>&lt;/</c-><c- f>ul</c-><c- p>></c-></code></pre>
  </div>

  <p>When using <code id="the-popover-attribute:attr-popover-3"><a href="#attr-popover">popover</a></code> on elements without accessibility semantics, for instance the <code id="the-popover-attribute:the-div-element"><a href="grouping-content.html#the-div-element">div</a></code> element, authors should use the appropriate ARIA attributes to ensure the popover is accessible.</p>

  <div class="example"><p>The following shows the baseline markup to create a custom menu popover, where the first menuitem will receive keyboard focus when the popover is invoked due to the use of the <code>autofocus</code> attribute. Navigating the menuitems by arrow keys, and activation behaviors would still need author scripting.</p>

   <pre><code class='html'><c- p>&lt;</c-><c- f>button</c-> <c- e>popovertarget</c-><c- o>=</c-><c- s>menu</c-> <c- e>aria-haspopup</c-><c- o>=</c-><c- s>menu</c-><c- p>></c->Actions<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
 <c- p>&lt;</c-><c- f>div</c-> <c- e>role</c-><c- o>=</c-><c- s>menu</c-> <c- e>id</c-><c- o>=</c-><c- s>menu</c-> <c- e>popover</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>button</c-> <c- e>role</c-><c- o>=</c-><c- s>menuitem</c-> <c- e>tabindex</c-><c- o>=</c-><c- s>-1</c-> <c- e>autofocus</c-><c- p>></c->Edit<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>button</c-> <c- e>role</c-><c- o>=</c-><c- s>menuitem</c-> <c- e>tabindex</c-><c- o>=</c-><c- s>-1</c-><c- p>></c->Hide<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
  <c- p>&lt;</c-><c- f>button</c-> <c- e>role</c-><c- o>=</c-><c- s>menuitem</c-> <c- e>tabindex</c-><c- o>=</c-><c- s>-1</c-><c- p>></c->Delete<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>div</c-><c- p>></c-></code></pre>

   <p>A popover can be useful for rendering a status message, confirming the action performed by the user. The following demonstrates how one could reveal a popover in an <code id="the-popover-attribute:the-output-element"><a href="form-elements.html#the-output-element">output</a></code> element.</p>

   <pre><code class='html'><c- p>&lt;</c-><c- f>button</c-> <c- e>id</c-><c- o>=</c-><c- s>submit</c-><c- p>></c->Submit<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
<c- p>&lt;</c-><c- f>p</c-><c- p>>&lt;</c-><c- f>output</c-><c- p>>&lt;</c-><c- f>span</c-> <c- e>popover</c-><c- o>=</c-><c- s>manual</c-><c- p>>&lt;/</c-><c- f>span</c-><c- p>>&lt;/</c-><c- f>output</c-><c- p>>&lt;/</c-><c- f>p</c-><c- p>></c->

<c- p>&lt;</c-><c- f>script</c-><c- p>></c->
 <c- a>const</c-> sBtn <c- o>=</c-> document<c- p>.</c->getElementById<c- p>(</c-><c- t>'submit'</c-><c- p>);</c->
 const outSpan = document.querySelector('output [popover=manual]');
 let successMessage;
 let errorMessage;

 /* define logic for determining success of action
  and determining the appropriate success or error
  messages to use */

 sBtn.addEventListener('click', ()=> {
  if ( success ) {
   outSpan.textContent = successMessage;
  }
  else {
   outSpan.textContent = errorMessage;
  }
  outSpan.showPopover();

  setTimeout(function () {
   outSpan.hidePopover();
  }, 10000);
 });
<c- p>&lt;</c-><c- f>script</c-><c- p>></c-></code></pre>
  </div>

  <p class="note">Inserting a popover element into an <code id="the-popover-attribute:the-output-element-2"><a href="form-elements.html#the-output-element">output</a></code> element will generally cause screen readers to announce the content when it becomes visible. Depending on the complexity or frequency of the content, this could be either useful or annoying to users of these assistive technologies. Keep this in mind when using the <code id="the-popover-attribute:the-output-element-3"><a href="form-elements.html#the-output-element">output</a></code> element or other ARIA live regions to ensure the best user experience.</p>

  <p><code id="the-popover-attribute:attr-popover-4"><a href="#attr-popover">popover</a></code>属性は、次のキーワードと状態を持つ<a id="the-popover-attribute:enumerated-attribute" href="common-microsyntaxes.html#enumerated-attribute">列挙属性</a>である：</p>

  <table><thead><tr><th>キーワード<th>状態<th>概要<tbody><tr><td><dfn data-dfn-for="html-global/popover" id="attr-popover-auto" data-dfn-type="attr-value"><code>auto</code></dfn><td rowspan="2"><dfn id="attr-popover-auto-state">auto</dfn><td rowspan="2">開いたときに他のポップオーバーを閉じる。<a href="#popover-light-dismiss" id="the-popover-attribute:popover-light-dismiss">簡易非表示</a>を持つ。<tr><td>空文字列<tr><td><dfn data-dfn-for="html-global/popover" id="attr-popover-manual" data-dfn-type="attr-value"><code>manual</code></dfn><td><dfn id="attr-popover-manual-state">manual</dfn><td>他のポップオーバーを閉じない。<a href="#popover-light-dismiss" id="the-popover-attribute:popover-light-dismiss-2">簡易非表示</a>を持たない。</table>

  <p><code id="the-popover-attribute:attr-popover-5"><a href="#attr-popover">popover</a></code>属性の<i id="the-popover-attribute:invalid-value-default"><a href="common-microsyntaxes.html#invalid-value-default">不正値のデフォルト</a></i>は<a href="#attr-popover-manual-state" id="the-popover-attribute:attr-popover-manual-state">manual</a>状態であり、その<i id="the-popover-attribute:missing-value-default"><a href="common-microsyntaxes.html#missing-value-default">欠損値のデフォルト</a></i>は<dfn id="attr-popover-none-state">ポップオーバーなし</dfn>状態である。</p>

  <p><dfn data-dfn-for="HTMLElement" id="dom-popover" data-dfn-type="attribute"><code>popover</code></dfn> IDL属性は、<span>既知の値に制限され</span>、<a href="#attr-popover" id="the-popover-attribute:attr-popover-6">popover</a>属性を<a id="the-popover-attribute:reflect" href="common-dom-interfaces.html#reflect">反映し</a>なければならない。</p>

  <p>すべての <a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-2">HTML要素</a>は、<dfn id="popover-visibility-state" data-export="">ポップオーバー可視状態</dfn>を持ち、最初は<a href="#popover-hidden-state" id="the-popover-attribute:popover-hidden-state">非表示</a>で、次の潜在的な値をもつ：</p>

  <ul><li><p><dfn data-dfn-for="popover visibility state" id="popover-hidden-state" data-export="">非表示</dfn><li><p><dfn data-dfn-for="popover visibility state" id="popover-showing-state" data-export="">表示</dfn></ul>

  <p><code>Document</code>は、<dfn id="auto-popover-list">自動ポップオーバーリスト</dfn>を持つ。これは、<code>Document</code>の<a id="the-popover-attribute:top-layer" href="https://triple-underscore.github.io/fullscreen-ja.html#top-layer" data-x-internal="top-layer">最上位レイヤー</a>にあるすべての要素の<a id="the-popover-attribute:list" href="https://triple-underscore.github.io/infra-ja.html#list" data-x-internal="list">リスト</a>であり、その<code id="the-popover-attribute:attr-popover-7"><a href="#attr-popover">popover</a></code>属性は、同じ順序で<a href="#attr-popover-auto-state" id="the-popover-attribute:attr-popover-auto-state">auto</a>状態にある。</p>

  <p><code>Document</code>は、<dfn id="popover-pointerdown-target">ポップオーバーポインターダウンターゲット</dfn>を持ち、これは<a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-3">HTML要素</a>またはnullであり、最初はnullである。</p>

  <p>すべての<a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-4">HTML要素</a>は、<dfn id="popover-invoker">ポップオーバー呼び出し</dfn>を持ち、これは<a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-5">HTML要素</a>またはnullであり、最初はnullに設定される。</p>

  <p>すべての<a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-6">HTML要素</a>は、<dfn id="popover-toggle-task">ポップオーバートリガータスク</dfn>を持ち、最初はnullであり、これはnullまたは以下を持つ<a id="the-popover-attribute:struct" href="https://triple-underscore.github.io/infra-ja.html#struct" data-x-internal="struct">構造体</a>のいずれかである：</p>

  <dl><dt><dfn id="popover-toggle-task-task">Task</dfn><dd><code>ToggleEvent</code>を発火するタスク。<dt><dfn id="popover-toggle-task-old-state">Old state</dfn><dd><code id="the-popover-attribute:dom-toggleevent-oldstate-2"><a href="#dom-toggleevent-oldstate-2">oldState</a></code>属性の<a href="#popover-toggle-task-task" id="the-popover-attribute:popover-toggle-task-task">タスク</a>のイベントの値を表す文字列。</dl>

  <p>The following <a href="https://triple-underscore.github.io/DOM4-ja.html#concept-element-attributes-change-ext" id="the-popover-attribute:concept-element-attributes-change-ext" data-x-internal="concept-element-attributes-change-ext">attribute change steps</a> are used for all <a id="the-popover-attribute:html-elements-7" href="infrastructure.html#html-elements">HTML elements</a>:</p>

  <ol><li><p>If <var>namespace</var> is not null, then return.<li><p>If <var>localName</var> is not <code id="the-popover-attribute:attr-popover-8"><a href="#attr-popover">popover</a></code>, then return.<li><p>If <var>oldValue</var> and <var>value</var> are in different <a href="#attr-popover" id="the-popover-attribute:attr-popover-9">states</a>, then run the <a href="#hide-popover-algorithm" id="the-popover-attribute:hide-popover-algorithm">hide popover algorithm</a> given <var>element</var>, true, true, and false.</ol>

  <dl class="domintro"><dt><code><var>element</var>.<a href="#dom-showpopover-2" id="dom-showpopover">showPopover</a>()</code><dd>ポップオーバー<var>element</var>をトップレイヤーに追加して表示する。<var>element</var>の<code id="the-popover-attribute:attr-popover-10"><a href="#attr-popover">popover</a></code>属性が<a href="#attr-popover-auto-state" id="the-popover-attribute:attr-popover-auto-state-2">auto state</a>である場合、<a href="#topmost-popover-ancestor" id="the-popover-attribute:topmost-popover-ancestor">トップレベルのポップオーバー祖先</a>アルゴリズムに従って<var>element</var>の祖先でない限り、他のすべての<a href="#attr-popover-auto-state" id="the-popover-attribute:attr-popover-auto-state-3">auto</a>ポップオーバーも閉じられる。<dt><code><var>element</var>.<a href="#dom-hidepopover-2" id="dom-hidepopover">hidePopover</a>()</code><dd>ポップオーバー<var>element</var>をトップレイヤーから削除し、<code>display:none</code>を適用して非表示にする。<dt><code><var>element</var>.<a href="#dom-togglepopover-2" id="dom-togglepopover">togglePopover</a>()</code><dd>ポップオーバー<var>element</var>が表示されていない場合、このメソッドはそのポップオーバーを表示する。そうでなければ、このメソッドによって非表示になる。</dl>

  <p>The <dfn data-dfn-for="HTMLElement" id="dom-showpopover-2" data-dfn-type="method"><code>showPopover()</code></dfn> method steps are:</p>

  <ol><li><p>Run <a href="#show-popover" id="the-popover-attribute:show-popover">show popover</a> given <a id="the-popover-attribute:this" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a> and true.</ol>

  <p>To <dfn id="show-popover">show popover</dfn>, given an <a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-8">HTML element</a> <var>element</var> and a boolean <var>throwExceptions</var>:</p>

  <ol><li><p>If the result of running <a href="#check-popover-validity" id="the-popover-attribute:check-popover-validity">check popover validity</a> given <var>element</var>, false, and <var>throwExceptions</var> is false, then return.<li><p><a id="the-popover-attribute:assert" href="https://triple-underscore.github.io/infra-ja.html#assert" data-x-internal="assert">Assert</a>: <var>element</var> is not in <var>element</var>'s <a id="the-popover-attribute:node-document" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>'s <a id="the-popover-attribute:top-layer-2" href="https://triple-underscore.github.io/fullscreen-ja.html#top-layer" data-x-internal="top-layer">top layer</a>.<li><p>If the result of <a href="https://triple-underscore.github.io/DOM4-ja.html#concept-event-fire" id="the-popover-attribute:concept-event-fire" data-x-internal="concept-event-fire">firing an event</a> named <code id="the-popover-attribute:event-beforetoggle"><a href="indices.html#event-beforetoggle">beforetoggle</a></code>, using <code>ToggleEvent</code>, with the <code id="the-popover-attribute:dom-event-cancelable"><a data-x-internal="dom-event-cancelable" href="https://triple-underscore.github.io/DOM4-ja.html#dom-event-cancelable">cancelable</a></code> attribute initialized to true, the <code id="the-popover-attribute:dom-toggleevent-oldstate-2-2"><a href="#dom-toggleevent-oldstate-2">oldState</a></code> attribute initialized to "<code>closed</code>", and the <code id="the-popover-attribute:dom-toggleevent-newstate-2"><a href="#dom-toggleevent-newstate-2">newState</a></code> attribute initialized to "<code>open</code>" at <var>element</var> is false, then return.<li><p>If the result of running <a href="#check-popover-validity" id="the-popover-attribute:check-popover-validity-2">check popover validity</a> given <var>element</var>, false, and <var>throwExceptions</var> is false, then return.</p>

    <p class="note"><a href="#check-popover-validity" id="the-popover-attribute:check-popover-validity-3">Check popover validity</a> is called again because firing the <code id="the-popover-attribute:event-beforetoggle-2"><a href="indices.html#event-beforetoggle">beforetoggle</a></code> event could have disconnected this element or changed its <code id="the-popover-attribute:attr-popover-11"><a href="#attr-popover">popover</a></code> attribute.</p>
   <li><p>Let <var>document</var> be <var>element</var>'s <a id="the-popover-attribute:node-document-2" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>.<li><p>Let <var>shouldRestoreFocus</var> be false.<li><p>If <var>element</var>'s <code id="the-popover-attribute:attr-popover-12"><a href="#attr-popover">popover</a></code> attribute is in the <a href="#attr-popover-auto-state" id="the-popover-attribute:attr-popover-auto-state-4">auto</a> state, then:</p>

    <ol><li><p>Let <var>originalType</var> be the value of <var>element</var>'s <code id="the-popover-attribute:attr-popover-13"><a href="#attr-popover">popover</a></code> attribute.<li><p>Let <var>ancestor</var> be the result of running the <a href="#topmost-popover-ancestor" id="the-popover-attribute:topmost-popover-ancestor-2">topmost popover ancestor</a> algorithm given <var>element</var>.<li><p>If <var>ancestor</var> is null, then set <var>ancestor</var> to <var>document</var>.<li><p>Run <a href="#hide-all-popovers-until" id="the-popover-attribute:hide-all-popovers-until">hide all popovers until</a> given <var>ancestor</var>, false, and true.<li><p>If <var>originalType</var> is not equal to the value of <var>element</var>'s <code id="the-popover-attribute:attr-popover-14"><a href="#attr-popover">popover</a></code> attribute, or if the result of running <a href="#check-popover-validity" id="the-popover-attribute:check-popover-validity-4">check popover validity</a> given <var>element</var>, false, and <var>throwExceptions</var> is false, then return.</p>

      <p class="note"><a href="#check-popover-validity" id="the-popover-attribute:check-popover-validity-5">Check popover validity</a> is called again because running <a href="#hide-all-popovers-until" id="the-popover-attribute:hide-all-popovers-until-2">hide all popovers until</a> above could have fired the <code id="the-popover-attribute:event-beforetoggle-3"><a href="indices.html#event-beforetoggle">beforetoggle</a></code> event, and an event handler could have disconnected this element or called <code id="the-popover-attribute:dom-showpopover-2"><a href="#dom-showpopover-2">showPopover()</a></code> on this element.</p>
     </ol>
   <li><p>If the result of running <a href="#topmost-auto-popover" id="the-popover-attribute:topmost-auto-popover">topmost auto popover</a> on <var>document</var> is null, then set <var>shouldRestoreFocus</var> to true.</p>

    <p class="note">This ensures that focus is returned to the previously-focused element only for the first popover in a stack.</p>
   <li><p>Set <var>element</var>'s <span>previously focused element</span> to null.<li><p>Let <var>originallyFocusedElement</var> be <var>document</var>'s <a id="the-popover-attribute:focused-area-of-the-document" href="interaction.html#focused-area-of-the-document">focused area of the document</a>'s <a id="the-popover-attribute:dom-anchor" href="interaction.html#dom-anchor">DOM anchor</a>.<li><p>Add <var>element</var> to <var>document</var>'s <a id="the-popover-attribute:top-layer-3" href="https://triple-underscore.github.io/fullscreen-ja.html#top-layer" data-x-internal="top-layer">top layer</a>.<li><p>Set <var>element</var>'s <a href="#popover-visibility-state" id="the-popover-attribute:popover-visibility-state">popover visibility state</a> to <a href="#popover-showing-state" id="the-popover-attribute:popover-showing-state">showing</a>.<li><p>Run the <a href="#popover-focusing-steps" id="the-popover-attribute:popover-focusing-steps">popover focusing steps</a> given <var>element</var>.<li><p>If <var>shouldRestoreFocus</var> is true and <var>element</var>'s <code id="the-popover-attribute:attr-popover-15"><a href="#attr-popover">popover</a></code> attribute is not in the <a href="#attr-popover-none-state" id="the-popover-attribute:attr-popover-none-state">no popover</a> state, then set <var>element</var>'s <span>previously focused element</span> to <var>originallyFocusedElement</var>.<li><p><a href="#queue-a-popover-toggle-event-task" id="the-popover-attribute:queue-a-popover-toggle-event-task">Queue a popover toggle event task</a> given <var>element</var>, "<code>closed</code>", and "<code>open</code>".</ol>

  <p>To <dfn id="queue-a-popover-toggle-event-task">queue a popover toggle event task</dfn> given an element <var>element</var>, a string <var>oldState</var>, and a string <var>newState</var>:<ol><li><p>If <var>element</var>'s <a href="#popover-toggle-task" id="the-popover-attribute:popover-toggle-task">popover toggle task</a> is not null, then:</p>

    <ol><li><p>Set <var>oldState</var> to <var>element</var>'s <a href="#popover-toggle-task" id="the-popover-attribute:popover-toggle-task-2">popover toggle task</a>'s <a href="#popover-toggle-task-old-state" id="the-popover-attribute:popover-toggle-task-old-state">old state</a>.<li><p>Remove <var>element</var>'s <a href="#popover-toggle-task" id="the-popover-attribute:popover-toggle-task-3">popover toggle task</a>'s <a href="#popover-toggle-task-task" id="the-popover-attribute:popover-toggle-task-task-2">task</a> from its <span>task queue</span>.<li><p>Set <var>element</var>'s <a href="#popover-toggle-task" id="the-popover-attribute:popover-toggle-task-4">popover toggle task</a> to null.</ol>
   <li><p><span>Queue an element task</span> given the <span>user interaction task source</span> and <var>element</var> to run the following steps:</p>

    <ol><li><p><a href="https://triple-underscore.github.io/DOM4-ja.html#concept-event-fire" id="the-popover-attribute:concept-event-fire-2" data-x-internal="concept-event-fire">fire an event</a> named <code id="the-popover-attribute:event-toggle"><a href="indices.html#event-toggle">toggle</a></code>, using <code>ToggleEvent</code>, with the <code id="the-popover-attribute:dom-toggleevent-oldstate-2-3"><a href="#dom-toggleevent-oldstate-2">oldState</a></code> attribute initialized to <var>oldState</var>, and the <code id="the-popover-attribute:dom-toggleevent-newstate-2-2"><a href="#dom-toggleevent-newstate-2">newState</a></code> attribute initialized to <var>newState</var> at <var>element</var>.<li><p>Set <var>element</var>'s <a href="#popover-toggle-task" id="the-popover-attribute:popover-toggle-task-5">popover toggle task</a> to null.</ol>
   <li><p>Set <var>element</var>'s <a href="#popover-toggle-task" id="the-popover-attribute:popover-toggle-task-6">popover toggle task</a> to a struct with <a href="#popover-toggle-task-task" id="the-popover-attribute:popover-toggle-task-task-3">task</a> set to the just-queued <span>task</span> and <a href="#popover-toggle-task-old-state" id="the-popover-attribute:popover-toggle-task-old-state-2">old state</a> set to <var>oldState</var>.</ol>

  <p>The <dfn data-dfn-for="HTMLElement" id="dom-hidepopover-2" data-dfn-type="method"><code>hidePopover()</code></dfn> method steps are:</p>

  <ol><li><p>Run the <a href="#hide-popover-algorithm" id="the-popover-attribute:hide-popover-algorithm-2">hide popover algorithm</a> given <a id="the-popover-attribute:this-2" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>, true, true, and true.</ol>

  <p>To <dfn id="hide-popover-algorithm">hide a popover</dfn> given an <a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-9">HTML element</a> <var>element</var>, a boolean <var>focusPreviousElement</var>, a boolean <var>fireEvents</var>, and a boolean <var>throwExceptions</var>:</p>

  <ol><li><p>If the result of running <a href="#check-popover-validity" id="the-popover-attribute:check-popover-validity-6">check popover validity</a> given <var>element</var>, true, and <var>throwExceptions</var> is false, then return.<li><p>Let <var>document</var> be <var>element</var>'s <a id="the-popover-attribute:node-document-3" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>.<li><p>If <var>element</var>'s <code id="the-popover-attribute:attr-popover-16"><a href="#attr-popover">popover</a></code> attribute is in the <a href="#attr-popover-auto-state" id="the-popover-attribute:attr-popover-auto-state-5">auto</a> state, then:</p>

    <ol><li><p>Run <a href="#hide-all-popovers-until" id="the-popover-attribute:hide-all-popovers-until-3">hide all popovers until</a> given <var>element</var>, <var>focusPreviousElement</var>, and <var>fireEvents</var>.<li><p>If the result of running <a href="#check-popover-validity" id="the-popover-attribute:check-popover-validity-7">check popover validity</a> given <var>element</var>, true, and <var>throwExceptions</var> is false, then return.</p>

      <p class="note"><a href="#check-popover-validity" id="the-popover-attribute:check-popover-validity-8">Check popover validity</a> is called again because running <a href="#hide-all-popovers-until" id="the-popover-attribute:hide-all-popovers-until-4">hide all popovers until</a> could have disconnected <var>element</var> or changed its <code id="the-popover-attribute:attr-popover-17"><a href="#attr-popover">popover</a></code> attribute.</p>
     <li><p><a id="the-popover-attribute:assert-2" href="https://triple-underscore.github.io/infra-ja.html#assert" data-x-internal="assert">Assert</a>: the last item in <var>document</var>'s <a href="#auto-popover-list" id="the-popover-attribute:auto-popover-list">auto popover list</a> is <var>element</var>.</ol>
   <li><p>Set <var>element</var>'s <a href="#popover-invoker" id="the-popover-attribute:popover-invoker">popover invoker</a> to null.<li><p>If <var>fireEvents</var> is true:</p>

    <ol><li><p><a href="https://triple-underscore.github.io/DOM4-ja.html#concept-event-fire" id="the-popover-attribute:concept-event-fire-3" data-x-internal="concept-event-fire">Fire an event</a> named <code id="the-popover-attribute:event-beforetoggle-4"><a href="indices.html#event-beforetoggle">beforetoggle</a></code>, using <code>ToggleEvent</code>, with the <code id="the-popover-attribute:dom-toggleevent-oldstate-2-4"><a href="#dom-toggleevent-oldstate-2">oldState</a></code> attribute initialized to "<code>open</code>", and the <code id="the-popover-attribute:dom-toggleevent-newstate-2-3"><a href="#dom-toggleevent-newstate-2">newState</a></code> attribute initialized to "<code>closed</code>" at <var>element</var>.<li><p>If the result of running <a href="#check-popover-validity" id="the-popover-attribute:check-popover-validity-9">check popover validity</a> given <var>element</var>, true, and <var>throwExceptions</var> is false, then return.</p>

      <p class="note"><a href="#check-popover-validity" id="the-popover-attribute:check-popover-validity-10">Check popover validity</a> is called again because firing the <code id="the-popover-attribute:event-beforetoggle-5"><a href="indices.html#event-beforetoggle">beforetoggle</a></code> event could have disconnected <var>element</var> or changed its <code id="the-popover-attribute:attr-popover-18"><a href="#attr-popover">popover</a></code> attribute.</p>
     </ol>
   <li><p><a href="https://triple-underscore.github.io/infra-ja.html#list-remove" id="the-popover-attribute:list-remove" data-x-internal="list-remove">Remove</a> <var>element</var> from the <a id="the-popover-attribute:top-layer-4" href="https://triple-underscore.github.io/fullscreen-ja.html#top-layer" data-x-internal="top-layer">top layer</a>.<li><p>Set <var>element</var>'s <a href="#popover-visibility-state" id="the-popover-attribute:popover-visibility-state-2">popover visibility state</a> to <a href="#popover-hidden-state" id="the-popover-attribute:popover-hidden-state-2">hidden</a>.<li><p>If <var>fireEvents</var> is true, then <a href="#queue-a-popover-toggle-event-task" id="the-popover-attribute:queue-a-popover-toggle-event-task-2">queue a popover toggle event task</a> given <var>element</var>, "<code>open</code>", and "<code>closed</code>".<li><p>Let <var>previouslyFocusedElement</var> be <var>element</var>'s <span>previously focused element</span>.<li><p>If <var>previouslyFocusedElement</var> is not null, then:</p>

    <ol><li><p>Set <var>element</var>'s <span>previously focused element</span> to null.<li><p>If <var>focusPreviousElement</var> is true, then run the <span>focusing steps</span> for <var>previouslyFocusedElement</var>; the viewport should not be scrolled by doing this step.</ol>
   </ol>

  <p>The <dfn data-dfn-for="HTMLElement" id="dom-togglepopover-2" data-dfn-type="method"><code>togglePopover(<var>force</var>)</code></dfn> method steps are:</p>

  <ol><li><p>If <a id="the-popover-attribute:this-3" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>'s <a href="#popover-visibility-state" id="the-popover-attribute:popover-visibility-state-3">popover visibility state</a> is <a href="#popover-showing-state" id="the-popover-attribute:popover-showing-state-2">showing</a>, and <var>force</var> is not present or false, then run the <a href="#hide-popover-algorithm" id="the-popover-attribute:hide-popover-algorithm-3">hide popover algorithm</a> given <a id="the-popover-attribute:this-4" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>, true, true, and true.<li><p>Otherwise, if <var>force</var> is not present or true, then run <a href="#show-popover" id="the-popover-attribute:show-popover-2">show popover</a> given <a id="the-popover-attribute:this-5" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a> and true.</ol>

  <p>To <dfn id="hide-all-popovers-until">hide all popovers until</dfn>, given an <a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-10">HTML element</a> or <code>Document</code> <var>endpoint</var>, a boolean <var>focusPreviousElement</var>, and a boolean <var>fireEvents</var>:</p>

  <ol><li><p>Let <var>document</var> be <var>endpoint</var>'s <a id="the-popover-attribute:node-document-4" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>.<li><p>Let <var>closeAllOpenPopovers</var> be an algorithm which performs the following steps:</p>

    <ol><li><p>Let <var>popover</var> be <var>document</var>'s <a href="#topmost-auto-popover" id="the-popover-attribute:topmost-auto-popover-2">topmost auto popover</a>.<li><p>While <var>popover</var> is not null:</p>

      <ol><li><p>Run the <a href="#hide-popover-algorithm" id="the-popover-attribute:hide-popover-algorithm-4">hide popover algorithm</a> given <var>popover</var>, <var>focusPreviousElement</var>, <var>fireEvents</var>, and false.<li><p>Set <var>popover</var> to <var>document</var>'s <a href="#topmost-auto-popover" id="the-popover-attribute:topmost-auto-popover-3">topmost auto popover</a>.</ol>
     </ol>
   <li><p>If <var>endpoint</var> is a <code>Document</code>, then run <var>closeAllOpenPopovers</var> and return.<li><p>Let <var>lastToHide</var> be null.<li><p>Let <var>foundEndpoint</var> be false.<li><p>For each <var>popover</var> in <var>document</var>'s <a href="#auto-popover-list" id="the-popover-attribute:auto-popover-list-2">auto popover list</a>:</p>

    <ol><li><p>If <var>popover</var> is <var>endpoint</var>, then set <var>foundEndpoint</var> to true.<li><p>Otherwise, if <var>foundEndpoint</var> is true, then set <var>lastToHide</var> to <var>popover</var> and <a id="the-popover-attribute:break" href="https://triple-underscore.github.io/infra-ja.html#iteration-break" data-x-internal="break">break</a>.</ol>
   <li><p>If <var>foundEndpoint</var> is false, then run <var>closeAllOpenPopovers</var> and return.<li><p>While <var>lastToHide</var> is not null and <var>lastToHide</var>'s <a href="#popover-visibility-state" id="the-popover-attribute:popover-visibility-state-4">popover visibility state</a> is <a href="#popover-showing-state" id="the-popover-attribute:popover-showing-state-3">showing</a> and <var>document</var>'s <a href="#auto-popover-list" id="the-popover-attribute:auto-popover-list-3">auto popover list</a> is not empty:</p>

    <ol><li><p>Run the <a href="#hide-popover-algorithm" id="the-popover-attribute:hide-popover-algorithm-5">hide popover algorithm</a> given <var>document</var>'s <a href="#auto-popover-list" id="the-popover-attribute:auto-popover-list-4">auto popover list</a>'s last element, <var>focusPreviousElement</var>, <var>fireEvents</var>, and false.</ol>
   </ol>

  <p class="note">The <a href="#hide-all-popovers-until" id="the-popover-attribute:hide-all-popovers-until-5">hide all popovers until algorithm</a> is used in several cases to hide all popovers that don't stay open when something happens. For example, during light-dismiss of a popover, this algorithm ensures that we close only the popovers that aren't related to the node clicked by the user.</p>

  <p>To <dfn id="hide-all-popovers" data-export="">hide all popovers</dfn>, given a <code>Document</code> <var>document</var>, run <a href="#hide-all-popovers-until" id="the-popover-attribute:hide-all-popovers-until-6">hide all popovers until</a> given <var>document</var>, false, and false.</p>

  <p>To find the <dfn id="topmost-popover-ancestor">topmost popover ancestor</dfn>, given a <code id="the-popover-attribute:node"><a data-x-internal="node" href="https://triple-underscore.github.io/DOM4-ja.html#interface-node">Node</a></code> <var>newPopover</var>, perform the following steps. They return an <a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-11">HTML element</a> or null.</p>

  <div class="note"><p>The <a href="#topmost-popover-ancestor" id="the-popover-attribute:topmost-popover-ancestor-3">topmost popover ancestor</a> algorithm will return the topmost (latest in the <a href="#auto-popover-list" id="the-popover-attribute:auto-popover-list-5">auto popover list</a>) ancestor popover for the provided popover. Popovers can be related to each other in several ways, creating a tree of popovers. There are two paths through which one popover (call it the "child" popover) can have a topmost ancestor popover (call it the "parent" popover):</p>

   <ol><li><p>The popovers are nested within each other in the node tree. In this case, the descendant popover is the "child" and its topmost ancestor popover is the "parent".<li><p>An invoking element (e.g., a <code id="the-popover-attribute:the-button-element"><a href="form-elements.html#the-button-element">button</a></code>) has a <code id="the-popover-attribute:attr-popovertarget"><a href="#attr-popovertarget">popovertarget</a></code> attribute pointing to a popover. In this case, the popover is the "child", and the popover subtree the invoking element is in is the "parent". The invoker has to be in a popover and reference an open popover.</ol>

   <p>In each of the relationships formed above, the parent popover has to be strictly earlier in the <a href="#auto-popover-list" id="the-popover-attribute:auto-popover-list-6">auto popover list</a> than the child popover, or it does not form a valid ancestral relationship. This eliminates non-showing popovers and self-pointers (e.g., a popover with an anchor attribute that points back to the same popover), and it allows for the construction of a well-formed tree from the (possibly cyclic) graph of connections. For example, if two popovers have anchors pointing to each other, the only valid relationship is that the first one to open is the "parent" and the second is the "child". Only <a href="#attr-popover-auto-state" id="the-popover-attribute:attr-popover-auto-state-6">auto</a> popovers are considered.</p>
  </div>

  <ol><li><p>Let <var>popoverPositions</var> be an empty <a id="the-popover-attribute:the-map-element" href="image-maps.html#the-map-element">map</a>.<li><p><var>index</var>を0にする。<li><p>Let <var>document</var> be <var>newPopover</var>'s <a id="the-popover-attribute:node-document-5" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>.<li><p>For each <var>popover</var> in <var>document</var>'s <a href="#auto-popover-list" id="the-popover-attribute:auto-popover-list-7">auto popover list</a>:</p>

    <ol><li><p><a href="https://triple-underscore.github.io/infra-ja.html#map-set" id="the-popover-attribute:map-set" data-x-internal="map-set">Set</a> <var>popoverPositions</var>[<var>popover</var>] to <var>index</var>.<li><p>Increment <var>index</var> by 1.</ol>
   <li><p><a href="https://triple-underscore.github.io/infra-ja.html#map-set" id="the-popover-attribute:map-set-2" data-x-internal="map-set">Set</a> <var>popoverPositions</var>[<var>newPopover</var>] to <var>index</var>.<li><p>Increment <var>index</var> by 1.<li><p>Let <var>topmostPopoverAncestor</var> be null.<li><p>Let <var>checkAncestor</var> be an algorithm which performs the following steps given <var>candidate</var>:</p>

    <ol><li><p>If <var>candidate</var> is null, then return.<li><p>Let <var>candidateAncestor</var> be the result of running <a href="#nearest-inclusive-open-popover" id="the-popover-attribute:nearest-inclusive-open-popover">nearest inclusive open popover</a> given <var>candidate</var>.<li><p>If <var>candidateAncestor</var> is null, then return.<li><p>Let <var>candidatePosition</var> be <var>popoverPositions</var>[<var>candidateAncestor</var>].<li><p>If <var>topmostPopoverAncestor</var> is null or <var>popoverPositions</var>[<var>topmostPopoverAncestor</var>] is less than <var>candidatePosition</var>, then set <var>topmostPopoverAncestor</var> to <var>candidateAncestor</var>.</ol>
   <li><p>Run <var>checkAncestor</var> given the result of running <a href="#nearest-inclusive-open-popover" id="the-popover-attribute:nearest-inclusive-open-popover-2">nearest inclusive open popover</a> given <var>newPopover</var>'s parent node within the <a id="the-popover-attribute:flat-tree" href="https://triple-underscore.github.io/css-scoping-ja.html#flat-tree" data-x-internal="flat-tree">flat tree</a>.<li><p>For each <a href="forms.html#concept-button" id="the-popover-attribute:concept-button">button</a> <var>invoker</var> that is a <a id="the-popover-attribute:descendant" href="https://triple-underscore.github.io/DOM4-ja.html#concept-tree-descendant" data-x-internal="descendant">descendant</a> of <var>newPopover</var>'s <a id="the-popover-attribute:root" href="https://triple-underscore.github.io/DOM4-ja.html#concept-tree-root" data-x-internal="root">root</a>, in <a id="the-popover-attribute:tree-order" href="https://triple-underscore.github.io/DOM4-ja.html#concept-tree-order" data-x-internal="tree-order">tree order</a>:</p>

    <ol><li><p>If <var>invoker</var>'s <a href="#popover-target-element" id="the-popover-attribute:popover-target-element">popover target element</a> is <var>newPopover</var>, then run <var>checkAncestor</var> given <var>invoker</var>.</ol>
   <li><p>return <var>topmostPopoverAncestor</var>.</ol>

  <p>To find the <dfn id="nearest-inclusive-open-popover">nearest inclusive open popover</dfn> given a <code id="the-popover-attribute:node-2"><a data-x-internal="node" href="https://triple-underscore.github.io/DOM4-ja.html#interface-node">Node</a></code> <var>node</var>, perform the following steps. They return an <a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-12">HTML element</a> or null.</p>

  <ol><li><p>Let <var>currentNode</var> be <var>node</var>.<li><p>While <var>currentNode</var> is not null:</p>

    <ol><li><p>If <var>currentNode</var>'s <code id="the-popover-attribute:attr-popover-19"><a href="#attr-popover">popover</a></code> attribute is in the <a href="#attr-popover-auto-state" id="the-popover-attribute:attr-popover-auto-state-7">auto</a> state and <var>currentNode</var>'s <a href="#popover-visibility-state" id="the-popover-attribute:popover-visibility-state-5">popover visibility state</a> is <a href="#popover-showing-state" id="the-popover-attribute:popover-showing-state-4">showing</a>, then return <var>currentNode</var>.<li><p>Set <var>currentNode</var> to <var>currentNode</var>'s parent in the <a id="the-popover-attribute:flat-tree-2" href="https://triple-underscore.github.io/css-scoping-ja.html#flat-tree" data-x-internal="flat-tree">flat tree</a>.</ol>
   <li><p>Return null.</ol>

  <p>To <dfn id="topmost-auto-popover">find the topmost auto popover</dfn> given a <code>Document</code> <var>document</var>, perform the following steps. They return an <a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-13">HTML element</a> or null.</p>

  <ol><li><p>If <var>document</var>'s <a href="#auto-popover-list" id="the-popover-attribute:auto-popover-list-8">auto popover list</a> is not empty, then return <var>document</var>'s <a href="#auto-popover-list" id="the-popover-attribute:auto-popover-list-9">auto popover list</a>'s last element.<li><p>Return null.</ol>

  <p>To perform the <dfn id="popover-focusing-steps">popover focusing steps</dfn> for an <a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-14">HTML element</a> <var>subject</var>:</p>

  <ol><li><p>Let <var>control</var> be the <span>focus delegate</span> of <var>subject</var> given "<code>other</code>" and true.<li><p>If <var>control</var> is null, then return.<li><p>Run the <span>focusing steps</span> given <var>control</var>.<li><p>Let <var>topDocument</var> be the <a id="the-popover-attribute:active-document" href="document-sequences.html#active-document">active document</a> of <var>control</var>'s <a id="the-popover-attribute:node-document-6" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>'s <a href="document-sequences.html#concept-document-bc" id="the-popover-attribute:concept-document-bc">browsing context</a>'s <a id="the-popover-attribute:top-level-browsing-context" href="document-sequences.html#top-level-browsing-context">top-level browsing context</a>.<li><p>If <var>control</var>'s <a id="the-popover-attribute:node-document-7" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>'s <a href="https://triple-underscore.github.io/DOM4-ja.html#concept-document-origin" id="the-popover-attribute:concept-document-origin" data-x-internal="concept-document-origin">origin</a> is not the <a href="browsers.html#same-origin" id="the-popover-attribute:same-origin">same</a> as the <a href="https://triple-underscore.github.io/DOM4-ja.html#concept-document-origin" id="the-popover-attribute:concept-document-origin-2" data-x-internal="concept-document-origin">origin</a> of <var>topDocument</var>, then return.<li><p><a href="https://triple-underscore.github.io/infra-ja.html#list-empty" id="the-popover-attribute:list-empty" data-x-internal="list-empty">Empty</a> <var>topDocument</var>'s <span>autofocus candidates</span>.<li><p>Set <var>topDocument</var>'s <span>autofocus processed flag</span> to true.</ol>

  <p>To <dfn id="check-popover-validity">check popover validity</dfn> for an <a href="infrastructure.html#html-elements" id="the-popover-attribute:html-elements-15">HTML element</a> <var>element</var> given a boolean <var>expectedToBeShowing</var> and a boolean <var>throwExceptions</var>, perform the following steps. They throw an exception or return a boolean.</p>

  <ol><li><p>If <var>element</var>'s <code id="the-popover-attribute:attr-popover-20"><a href="#attr-popover">popover</a></code> attribute is in the <a href="#attr-popover-none-state" id="the-popover-attribute:attr-popover-none-state-2">no popover</a> state, then:</p>

    <ol><li><p>If <var>throwExceptions</var> is true, then throw a <a id="the-popover-attribute:notsupportederror" href="https://triple-underscore.github.io/WebIDL-ja.html#notsupportederror" data-x-internal="notsupportederror">"<code>NotSupportedError</code>"</a> <code id="the-popover-attribute:domexception"><a data-x-internal="domexception" href="https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException">DOMException</a></code>.<li><p>falseを返す。</ol>
   <li><p>If one of the following conditions is true</p>

    <ul><li><p><var>element</var> is not <a id="the-popover-attribute:connected" href="https://triple-underscore.github.io/DOM4-ja.html#connected" data-x-internal="connected">connected</a><li><p><var>expectedToBeShowing</var> is true and <var>element</var>'s <a href="#popover-visibility-state" id="the-popover-attribute:popover-visibility-state-6">popover visibility state</a> is not <a href="#popover-showing-state" id="the-popover-attribute:popover-showing-state-5">showing</a><li><p><var>expectedToBeShowing</var> is false and <var>element</var>'s <a href="#popover-visibility-state" id="the-popover-attribute:popover-visibility-state-7">popover visibility state</a> is not <a href="#popover-hidden-state" id="the-popover-attribute:popover-hidden-state-3">hidden</a><li><p><var>element</var> is a <code id="the-popover-attribute:the-dialog-element"><a href="interactive-elements.html#the-dialog-element">dialog</a></code> element and has an <code id="the-popover-attribute:attr-details-open"><a href="interactive-elements.html#attr-details-open">open</a></code> attribute<li><p><var>element</var>'s <a id="the-popover-attribute:fullscreen-flag" href="https://fullscreen.spec.whatwg.org/#fullscreen-flag" data-x-internal="fullscreen-flag">fullscreen flag</a> is set</ul>

    <p>then:</p>

    <ol><li><p>If <var>throwExceptions</var> is true, then throw a <a id="the-popover-attribute:invalidstateerror" href="https://triple-underscore.github.io/WebIDL-ja.html#invalidstateerror" data-x-internal="invalidstateerror">"<code>InvalidStateError</code>"</a> <code id="the-popover-attribute:domexception-2"><a data-x-internal="domexception" href="https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException">DOMException</a></code>.<li><p>falseを返す。</ol>
   <li><p>Return true.</ol>

  <h4 id="the-popover-target-attributes"><span class="secno">6.11.1</span> ポップオーバーターゲット属性<a href="#the-popover-target-attributes" class="self-link"></a></h4>

  <p><a href="forms.html#concept-button" id="the-popover-target-attributes:concept-button">ボタン</a>には、次のコンテンツ属性を設定してもよい：</p>

  <ul><li><p><dfn data-dfn-for="html-global" id="attr-popovertarget" data-dfn-type="element-attr"><code>popovertarget</code></dfn><li><p><dfn data-dfn-for="html-global" id="attr-popovertargetaction" data-dfn-type="element-attr"><code>popovertargetaction</code></dfn></ul>

  <p>指定された場合、<code id="the-popover-target-attributes:attr-popovertarget"><a href="#attr-popovertarget">popovertarget</a></code>属性値は、<code id="the-popover-target-attributes:attr-popovertarget-2"><a href="#attr-popovertarget">popovertarget</a></code>属性をもつ<a href="forms.html#concept-button" id="the-popover-target-attributes:concept-button-2">ボタン</a>と同じ<a id="the-popover-target-attributes:tree" href="https://triple-underscore.github.io/DOM4-ja.html#concept-tree" data-x-internal="tree">ツリー</a>内の<code id="the-popover-target-attributes:attr-popover"><a href="#attr-popover">popover</a></code>属性をもつ要素の<a href="https://triple-underscore.github.io/DOM4-ja.html#concept-id" id="the-popover-target-attributes:concept-id" data-x-internal="concept-id">ID</a>でなければならない。</p>

  <p><code id="the-popover-target-attributes:attr-popovertargetaction"><a href="#attr-popovertargetaction">popovertargetaction</a></code>属性は、次のキーワードと状態を持つ<a id="the-popover-target-attributes:enumerated-attribute" href="common-microsyntaxes.html#enumerated-attribute">列挙属性</a>である：</p>

  <table><thead><tr><th>キーワード<th>状態<th>概要<tbody><tr><td><dfn data-dfn-for="html-global/popovertargetaction" id="attr-popovertargetaction-toggle" data-dfn-type="attr-value"><code>toggle</code></dfn><td><dfn id="attr-popovertargetaction-toggle-state">toggle</dfn><td>ターゲットのポップオーバー要素を表示または非表示する。<tr><td><dfn data-dfn-for="html-global/popovertargetaction" id="attr-popovertargetaction-show" data-dfn-type="attr-value"><code>show</code></dfn><td><dfn id="attr-popovertargetaction-show-state">show</dfn><td>ターゲットのポップオーバー要素を表示する。<tr><td><dfn data-dfn-for="html-global/popovertargetaction" id="attr-popovertargetaction-hide" data-dfn-type="attr-value"><code>hide</code></dfn><td><dfn id="attr-popovertargetaction-hide-state">hide</dfn><td>ターゲットのポップオーバー要素を非表示にする。</table>

  <p><code id="the-popover-target-attributes:attr-popovertargetaction-2"><a href="#attr-popovertargetaction">popovertargetaction</a></code>属性の<i id="the-popover-target-attributes:invalid-value-default"><a href="common-microsyntaxes.html#invalid-value-default">不正値のデフォルト</a></i>と<i id="the-popover-target-attributes:missing-value-default"><a href="common-microsyntaxes.html#missing-value-default">欠損値のデフォルト</a></i>の両方は、<a href="#attr-popovertargetaction-toggle-state" id="the-popover-target-attributes:attr-popovertargetaction-toggle-state">トグル</a>状態である。</p>

  <p class="note">Whenever possible ensure the popover element is placed immediately after its triggering element in the DOM. Doing so will help ensure that the popover is exposed in a logical programmatic reading order for users of assistive technology, such as screen readers.</p>

  <div class="example"><p>The following shows how the <code id="the-popover-target-attributes:attr-popovertarget-3"><a href="#attr-popovertarget">popovertarget</a></code> attribute in combination with the <code id="the-popover-target-attributes:attr-popovertargetaction-3"><a href="#attr-popovertargetaction">popovertargetaction</a></code> attribute can be used to show and close a popover:</p>

   <pre><code class='html'><c- p>&lt;</c-><c- f>button</c-> <c- e>popovertarget</c-><c- o>=</c-><c- s>"foo"</c-> <c- e>popovertargetaction</c-><c- o>=</c-><c- s>"show"</c-><c- p>></c->
  Show a popover
<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->

<c- p>&lt;</c-><c- f>article</c-> <c- e>popover</c-><c- o>=</c-><c- s>auto</c-> <c- e>id</c-><c- o>=</c-><c- s>"foo"</c-><c- p>></c->
  This is a popover article!
  <c- p>&lt;</c-><c- f>button</c-> <c- e>popovertarget</c-><c- o>=</c-><c- s>"foo"</c-> <c- e>popovertargetaction</c-><c- o>=</c-><c- s>"close"</c-><c- p>></c->Close<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>article</c-><c- p>></c-></code></pre>

   <p>If a <code id="the-popover-target-attributes:attr-popovertargetaction-4"><a href="#attr-popovertargetaction">popovertargetaction</a></code> attribute is not specified, the default action will be to toggle the associated popover. The following shows how only specifying the <code id="the-popover-target-attributes:attr-popovertarget-4"><a href="#attr-popovertarget">popovertarget</a></code> attribute on its invoking button can toggle a manual popover between its opened and closed states. A manual popover will not light dismiss:</p>

   <pre><code class='html'><c- p>&lt;</c-><c- f>input</c-> <c- e>type</c-><c- o>=</c-><c- s>"button"</c-> <c- e>popovertarget</c-><c- o>=</c-><c- s>"foo"</c-> <c- e>value</c-><c- o>=</c-><c- s>"Toggle the popover"</c-><c- p>></c->

<c- p>&lt;</c-><c- f>div</c-> <c- e>popover</c-><c- o>=</c-><c- s>manual</c-> <c- e>id</c-><c- o>=</c-><c- s>"foo"</c-><c- p>></c->
  This is a popover!
<c- p>&lt;/</c-><c- f>div</c-><c- p>></c-></code></pre>
  </div><a href="dom.html#concept-element-dom" id="the-popover-target-attributes:concept-element-dom">DOMインターフェイス</a>：<p><dfn data-dfn-for="HTMLElement" id="dom-popovertargetelement" data-dfn-type="attribute"><code>popoverTargetElement</code></dfn> IDL属性は、<code id="the-popover-target-attributes:attr-popovertarget-5"><a href="#attr-popovertarget">popovertarget</a></code>属性を<a id="the-popover-target-attributes:reflect" href="common-dom-interfaces.html#reflect">反映</a>しなければならない。</p>

  <p><dfn data-dfn-for="HTMLElement" id="dom-popovertargetaction" data-dfn-type="attribute"><code>popoverTargetAction</code></dfn> IDL属性は、<span>既知の値のみに制限される</span>、<code id="the-popover-target-attributes:attr-popovertargetaction-5"><a href="#attr-popovertargetaction">popoverTargetAction</a></code>属性を<a id="the-popover-target-attributes:reflect-2" href="common-dom-interfaces.html#reflect">反映</a>しなければならない。</p>

  <p>To run the <dfn id="popover-target-attribute-activation-behavior">popover target attribute activation behavior</dfn> given a <code id="the-popover-target-attributes:node"><a data-x-internal="node" href="https://triple-underscore.github.io/DOM4-ja.html#interface-node">Node</a></code> <var>node</var>:</p>

  <ol><li><p>Let <var>popover</var> be <var>node</var>'s <a href="#popover-target-element" id="the-popover-target-attributes:popover-target-element">popover target element</a>.<li><p>If <var>popover</var> is null, then return.<li><p>If <var>node</var>'s <code id="the-popover-target-attributes:attr-popovertargetaction-6"><a href="#attr-popovertargetaction">popovertargetaction</a></code> attribute is in the <a href="#attr-popovertargetaction-show" id="the-popover-target-attributes:attr-popovertargetaction-show">show</a> state and <var>popover</var>'s <a href="#popover-visibility-state" id="the-popover-target-attributes:popover-visibility-state">popover visibility state</a> is <a href="#popover-showing-state" id="the-popover-target-attributes:popover-showing-state">showing</a>, then return.<li><p>If <var>node</var>'s <code id="the-popover-target-attributes:attr-popovertargetaction-7"><a href="#attr-popovertargetaction">popovertargetaction</a></code> attribute is in the <a href="#attr-popovertargetaction-hide" id="the-popover-target-attributes:attr-popovertargetaction-hide">hide</a> state and <var>popover</var>'s <a href="#popover-visibility-state" id="the-popover-target-attributes:popover-visibility-state-2">popover visibility state</a> is <a href="#popover-hidden-state" id="the-popover-target-attributes:popover-hidden-state">hidden</a>, then return.<li><p>If <var>popover</var>'s <a href="#popover-visibility-state" id="the-popover-target-attributes:popover-visibility-state-3">popover visibility state</a> is <a href="#popover-showing-state" id="the-popover-target-attributes:popover-showing-state-2">showing</a>, then run the <a href="#hide-popover-algorithm" id="the-popover-target-attributes:hide-popover-algorithm">hide popover algorithm</a> given <var>popover</var>, true, true, and false.<li><p>Otherwise, if <var>popover</var>'s <a href="#popover-visibility-state" id="the-popover-target-attributes:popover-visibility-state-4">popover visibility state</a> is <a href="#popover-hidden-state" id="the-popover-target-attributes:popover-hidden-state-2">hidden</a> and the result of running <a href="#check-popover-validity" id="the-popover-target-attributes:check-popover-validity">check popover validity</a> given <var>popover</var>, false, and false is true:</p>

    <ol><li><p>Set <var>popover</var>'s <a href="#popover-invoker" id="the-popover-target-attributes:popover-invoker">popover invoker</a> to <var>node</var>.<li><p>Run <a href="#show-popover" id="the-popover-target-attributes:show-popover">show popover</a> given <var>popover</var> and false.</ol>
   </ol>

  <p>To get the <dfn id="popover-target-element">popover target element</dfn> given a <code id="the-popover-target-attributes:node-2"><a data-x-internal="node" href="https://triple-underscore.github.io/DOM4-ja.html#interface-node">Node</a></code> <var>node</var>, perform the following steps. They return an <a href="infrastructure.html#html-elements" id="the-popover-target-attributes:html-elements">HTML element</a> or null.</p>

  <ol><li><p>If <var>node</var> is not a <a href="forms.html#concept-button" id="the-popover-target-attributes:concept-button-3">button</a>, then return null.<li><p>If <var>node</var> is <a href="form-control-infrastructure.html#concept-fe-disabled" id="the-popover-target-attributes:concept-fe-disabled">disabled</a>, then return null.<li><p>If <var>node</var> has a <a id="the-popover-target-attributes:form-owner" href="form-control-infrastructure.html#form-owner">form owner</a> and <var>node</var> is a <a href="forms.html#concept-submit-button" id="the-popover-target-attributes:concept-submit-button">submit button</a>, then return null.<li><p>Let <var>popoverElement</var> be <var>node</var>'s <span><code>popovertarget</code>-associated element</span>.<li><p>If <var>popoverElement</var> is null, then return null.<li><p>If <var>popoverElement</var>'s <code id="the-popover-target-attributes:attr-popover-2"><a href="#attr-popover">popover</a></code> attribute is in the <a href="#attr-popover-none-state" id="the-popover-target-attributes:attr-popover-none-state">no popover</a> state, then return null.<li><p>Return <var>popoverElement</var>.</ol>

  <h4 id="popover-light-dismiss"><span class="secno">6.11.2</span> <dfn>ポップオーバーの簡易非表示</dfn><a href="#popover-light-dismiss" class="self-link"></a></h4>

  <p class="note">"簡易非表示"とは、<kbd>Esc</kbd>キーを押すか、<code id="popover-light-dismiss:attr-popover"><a href="#attr-popover">popover</a></code>属性が<a href="#attr-popover-auto-state" id="popover-light-dismiss:attr-popover-auto-state">auto</a>状態のポップオーバーの外側をクリックするとポップオーバーが閉じることを意味する。</p>

  <p id="canceling-popovers"><strong>ポップオーバーのキャンセル</strong>：<code>Document</code>に<a href="#topmost-auto-popover" id="popover-light-dismiss:topmost-auto-popover">最上位の自動ポップオーバー</a>が表示されている場合、ユーザー エージェントは、アクティブ化時に、<a href="#topmost-auto-popover" id="popover-light-dismiss:topmost-auto-popover-2">最上位の自動ポップオーバー</a>、trueおよびfalseが指定された<span>ユーザーインタラクションタスクソース</span>で<span>要素タスクをキューに入れ</span>、<a href="#topmost-auto-popover" id="popover-light-dismiss:topmost-auto-popover-3">最上位の自動ポップオーバー</a>が指定された<a href="#hide-popover-algorithm" id="popover-light-dismiss:hide-popover-algorithm">非表示のポップオーバーアルゴリズム</a>を実行するユーザーインターフェイスを提供してもよい。</p>

  <p>To <dfn id="light-dismiss-open-popovers">light dismiss open popovers</dfn>, given an <code id="popover-light-dismiss:event"><a data-x-internal="event" href="https://triple-underscore.github.io/DOM4-ja.html#interface-event">Event</a></code> <var>event</var>:</p>

  <ol><li><p><a id="popover-light-dismiss:assert" href="https://triple-underscore.github.io/infra-ja.html#assert" data-x-internal="assert">Assert</a>: <var>event</var>'s <code id="popover-light-dismiss:dom-event-istrusted"><a data-x-internal="dom-event-istrusted" href="https://triple-underscore.github.io/DOM4-ja.html#dom-event-istrusted">isTrusted</a></code> attribute is true.<li><p>Let <var>target</var> be <var>event</var>'s <a href="https://dom.spec.whatwg.org/#concept-event-target" id="popover-light-dismiss:concept-event-target" data-x-internal="concept-event-target">target</a>.<li><p>Let <var>topmostPopover</var> be the result of running <a href="#topmost-auto-popover" id="popover-light-dismiss:topmost-auto-popover-4">topmost auto popover</a> given <var>target</var>.<li><p>If <var>topmostPopover</var> is null, then return.<li><p>Let <var>document</var> be <var>target</var>'s <a id="popover-light-dismiss:node-document" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>.<li><p>If <var>event</var> is a <code id="popover-light-dismiss:pointerevent"><a data-x-internal="pointerevent" href="https://triple-underscore.github.io/pointerevents3-ja.html#pointerevent-interface">PointerEvent</a></code> and <var>event</var>'s <code id="popover-light-dismiss:dom-event-type"><a data-x-internal="dom-event-type" href="https://triple-underscore.github.io/DOM4-ja.html#dom-event-type">type</a></code> is <code id="popover-light-dismiss:event-pointerdown"><a data-x-internal="event-pointerdown" href="https://triple-underscore.github.io/pointerevents3-ja.html#the-pointerdown-event">pointerdown</a></code>, then: set <var>document</var>'s <a href="#popover-pointerdown-target" id="popover-light-dismiss:popover-pointerdown-target">popover pointerdown target</a> to the result of running <a href="#topmost-clicked-popover" id="popover-light-dismiss:topmost-clicked-popover">topmost clicked popover</a> given <var>target</var>.<li><p>If <var>event</var> is a <code id="popover-light-dismiss:pointerevent-2"><a data-x-internal="pointerevent" href="https://triple-underscore.github.io/pointerevents3-ja.html#pointerevent-interface">PointerEvent</a></code> and <var>event</var>'s <code id="popover-light-dismiss:dom-event-type-2"><a data-x-internal="dom-event-type" href="https://triple-underscore.github.io/DOM4-ja.html#dom-event-type">type</a></code> is <code id="popover-light-dismiss:event-pointerup"><a data-x-internal="event-pointerup" href="https://triple-underscore.github.io/pointerevents3-ja.html#the-pointerup-event">pointerup</a></code>, then:</p>

    <ol><li><p>Let <var>ancestor</var> be the result of running <a href="#topmost-clicked-popover" id="popover-light-dismiss:topmost-clicked-popover-2">topmost clicked popover</a> given <var>target</var>.<li><p>Let <var>sameTarget</var> be true if <var>ancestor</var> is <var>document</var>'s <a href="#popover-pointerdown-target" id="popover-light-dismiss:popover-pointerdown-target-2">popover pointerdown target</a>.<li><p>Set <var>document</var>'s <a href="#popover-pointerdown-target" id="popover-light-dismiss:popover-pointerdown-target-3">popover pointerdown target</a> to null.<li><p>If <var>ancestor</var> is null, then set <var>ancestor</var> to <var>document</var>.<li><p>If <var>sameTarget</var> is true, then run <a href="#hide-all-popovers-until" id="popover-light-dismiss:hide-all-popovers-until">hide all popovers until</a> given <var>ancestor</var>, false, and true.</ol>
   </ol>

  <p class="XXX"><a href="#light-dismiss-open-popovers" id="popover-light-dismiss:light-dismiss-open-popovers">Light dismiss open popovers</a> will be called by the <a href="https://github.com/w3c/pointerevents/pull/460">Pointer Events spec</a> when the user clicks or touches anywhere on the page.</p>

  <p>To find the <dfn id="topmost-clicked-popover">topmost clicked popover</dfn>, given a <code id="popover-light-dismiss:node"><a data-x-internal="node" href="https://triple-underscore.github.io/DOM4-ja.html#interface-node">Node</a></code> <var>node</var>:</p>

  <ol><li><p>Let <var>clickedPopover</var> be the result of running <a href="#nearest-inclusive-open-popover" id="popover-light-dismiss:nearest-inclusive-open-popover">nearest inclusive open popover</a> given <var>node</var>.<li><p>Let <var>invokerPopover</var> be the result of running <a href="#nearest-inclusive-target-popover-for-invoker" id="popover-light-dismiss:nearest-inclusive-target-popover-for-invoker">nearest inclusive target popover for invoker</a> given <var>node</var>.<li><p>Let <var>getStackPosition</var> be an algorithm which performs the following steps given an <a href="infrastructure.html#html-elements" id="popover-light-dismiss:html-elements">HTML element</a> <var>popover</var>:</p>

    <ol><li><p>Let <var>popoverList</var> be <var>popover</var>'s <a id="popover-light-dismiss:node-document-2" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>'s <a href="#auto-popover-list" id="popover-light-dismiss:auto-popover-list">auto popover list</a>.<li><p>If <var>popover</var> is in <var>popoverList</var>, then return the index of <var>popover</var> in <var>popoverList</var> + 1.<li><p>Return 0.</ol>
   <li><p>If the result of running <var>getStackPosition</var> given <var>clickedPopover</var> is greater than the result of running <var>getStackPosition</var> given <var>invokerPopover</var>, then return <var>clickedPopover</var>.<li><p>Return <var>invokerPopover</var>.</ol>

  <p>To find the <dfn id="nearest-inclusive-target-popover-for-invoker">nearest inclusive target popover for invoker</dfn> given a <code id="popover-light-dismiss:node-2"><a data-x-internal="node" href="https://triple-underscore.github.io/DOM4-ja.html#interface-node">Node</a></code> <var>node</var>:</p>

  <ol><li><p>Let <var>currentNode</var> be <var>node</var>.<li><p>While <var>currentNode</var> is not null:</p>

    <ol><li><p>Let <var>targetPopover</var> be <var>currentNode</var>'s <a href="#popover-target-element" id="popover-light-dismiss:popover-target-element">popover target element</a>.<li><p>If <var>targetPopover</var> is not null and <var>targetPopover</var>'s <code id="popover-light-dismiss:attr-popover-2"><a href="#attr-popover">popover</a></code> attribute is in the <a href="#attr-popover-auto-state" id="popover-light-dismiss:attr-popover-auto-state-2">auto</a> state and <var>targetPopover</var>'s <a href="#popover-visibility-state" id="popover-light-dismiss:popover-visibility-state">popover visibility state</a> is <a href="#popover-showing-state" id="popover-light-dismiss:popover-showing-state">showing</a>, then return <var>targetPopover</var>.<li><p>Set <var>currentNode</var> to <var>currentNode</var>'s ancestor in the <a id="popover-light-dismiss:flat-tree" href="https://triple-underscore.github.io/css-scoping-ja.html#flat-tree" data-x-internal="flat-tree">flat tree</a>.</ol>
   </ol>

  <h4 id="the-toggleevent-interface"><span class="secno">6.11.3</span> <code>ToggleEvent</code>インターフェイス<a href="#the-toggleevent-interface" class="self-link"></a></h4>

  

  <dl class="domintro"><dt><code><var>event</var>.<a href="#dom-toggleevent-oldstate-2" id="dom-toggleevent-oldstate">oldState</a></code><dd><p>クローズからオープンに遷移する場合は"<code>closed</code>"に設定し、オープンからクローズに遷移する場合は"<code>open</code>"に設定する。</p>
   <dt><code><var>event</var>.<a href="#dom-toggleevent-newstate-2" id="dom-toggleevent-newstate">newState</a></code><dd><p>クローズからオープンに遷移する場合は"<code>open</code>"に設定し、オープンからクローズに遷移する場合は"<code>closed</code>"に設定する。</p>
   </dl>

  <p><dfn data-dfn-for="ToggleEvent" id="dom-toggleevent-oldstate-2" data-dfn-type="attribute"><code>oldState</code></dfn>属性は、初期化された値を返さなければならない。<code id="the-toggleevent-interface:attr-popover"><a href="#attr-popover">popover</a></code>属性の<a href="#popover-visibility-state" id="the-toggleevent-interface:popover-visibility-state">ポップオーバー可視性状態</a>をもつ要素が<a href="#popover-showing-state" id="the-toggleevent-interface:popover-showing-state">表示</a>の場合は"<code>open</code>"に初期化され、そうでなければ"<code>closed</code>"に初期化される。</p>

  <p><dfn data-dfn-for="ToggleEvent" id="dom-toggleevent-newstate-2" data-dfn-type="attribute"><code>newState</code></dfn>属性は、初期化された値を返さなければならない。<code id="the-toggleevent-interface:attr-popover-2"><a href="#attr-popover">popover</a></code>属性の<a href="#popover-visibility-state" id="the-toggleevent-interface:popover-visibility-state-2">ポップオーバー可視性状態</a>をもつ要素が<a href="#popover-showing-state" id="the-toggleevent-interface:popover-showing-state-2">表示</a>の場合は"<code>closed</code>"に初期化され、そうでなければ"<code>open</code>"に初期化される。</p>


  <nav><a href="dnd.html">← 6.10 ドラッグアンドドロップ</a> — <a href="./">目次</a> — <a href="browsers.html">7 ウェブページの読み込み →</a></nav>
