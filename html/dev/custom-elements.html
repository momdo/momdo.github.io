<!DOCTYPE html><html class=split lang=ja>
<script src=/link-fixup.js defer=""></script><meta charset=utf-8><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name=viewport>
<title>HTML Standard, Developer's Edition æ—¥æœ¬èªè¨³</title><meta content=#3c790a name=theme-color><link rel=icon href=https://resources.whatwg.org/logo.svg>
<script>
   function toggleStatus(div) {
     div.parentNode.classList.toggle('wrapped');
   }
  </script>
<style>
   .status { min-height: 0.6em; font: 1em sans-serif; width: 9em; padding: 0.3em; position: absolute; z-index: 8; right: 0.3em; background: #EEE; color: black; box-shadow: 0 0 3px #999; overflow: hidden; margin: -2em 0 0 0; border-collapse: initial; border-spacing: initial; }
   .status:hover { z-index: 9; }
   .status:focus-within { z-index: 9; }
   .status.wrapped > :not(input) { display: none; }
   .status > input { position: absolute; left: 0; top: 0; width: 1em; height: 1em; border: none; background: transparent; padding: 0; margin: 0; }
   .status > p { font-size: 0.6em; margin: 0; padding: 0; }
   .status > p + p { padding-top: 0.5em; }
   .status > p > strong { margin-left: 1.5em; }
   .status > .support { display: block; }
   .status > .support > span { padding: 0.2em 0; display: block; display: table; }
   .status > .support > span.partial { color: #666666; filter: grayscale(50%); }
   .status > .support > span.no { color: #CCCCCC; filter: grayscale(100%); }
   .status > .support > span.no::before { opacity: 0.5; }
   .status > .support > span:first-of-type { padding-top: 0.5em; }
   .status > .support > span > span { padding: 0 0.5em; display: table-cell; vertical-align: top; }
   .status > .support > span > span:first-child { width: 100%; }
   .status > .support > span > span:last-child { width: 100%; white-space: pre; padding: 0; }
   .status > .support > span::before { content: ' '; display: table-cell; min-width: 1.5em; height: 1.5em; background: no-repeat center center; background-size: contain; text-align: right; font-size: 0.75em; font-weight: bold; }
   .status > .support > .and_chr::before { background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg); }
   .status > .support > .and_ff::before { background-image: url(https://resources.whatwg.org/browser-logos/firefox.png); }
   .status > .support > .and_uc::before { background-image: url(https://resources.whatwg.org/browser-logos/uc.png); } /* UC Browser for Android */
   .status > .support > .android::before { background-image: url(https://resources.whatwg.org/browser-logos/android.svg); }
   .status > .support > .bb::before { background-image: url(https://resources.whatwg.org/browser-logos/bb.jpg); } /* Blackberry Browser */
   .status > .support > .chrome::before { background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg); }
   .status > .support > .edge::before { background-image: url(https://resources.whatwg.org/browser-logos/edge.svg); }
   .status > .support > .firefox::before { background-image: url(https://resources.whatwg.org/browser-logos/firefox.png); }
   .status > .support > .ie::before { background-image: url(https://resources.whatwg.org/browser-logos/ie.png); }
   .status > .support > .ie_mob::before { background-image: url(https://resources.whatwg.org/browser-logos/ie-mobile.svg); }
   .status > .support > .ios_saf::before { background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg); }
   .status > .support > .op_mini::before { background-image: url(https://resources.whatwg.org/browser-logos/opera-mini.png); }
   .status > .support > .op_mob::before { background-image: url(https://resources.whatwg.org/browser-logos/opera.png); }
   .status > .support > .opera::before { background-image: url(https://resources.whatwg.org/browser-logos/opera.png); }
   .status > .support > .safari::before { background-image: url(https://resources.whatwg.org/browser-logos/safari.png); }
   .status > .support > .samsung::before { background-image: url(https://resources.whatwg.org/browser-logos/samsung.png); }
   .status > .caniuse { text-align: right; font-style: italic; width: 100%; }
   .status > .caniuse + p { margin-top: 0.5em; border-top: 1px solid silver; }

   @media (max-width: 767px) {
     .status { right: -9em; }
   }
  </style><link rel=stylesheet href=styles.css>
<body>
  <script async="" src=search.js></script>
  
  
  <header id=head class="head with-buttons">
   <a href=https://whatwg.org/ class=logo><img alt=WHATWG src=https://resources.whatwg.org/logo.svg width=100 height=100></a>
   
   <hgroup><h1><a rel=home href=/dev/>HTML: The Living Standard</a></h1><h2 id=dev-edition-h2 class="no-num no-toc">Developer's Edition â€” Last Updated <span class=pubdate>6 September 2017</span></h2></hgroup>
   

   <div id=search>
    <input placeholder="Search. Press '/'" autocomplete=off name=query id=query type=search>
    <ol id=results></ol>
   </div>
  </header>

  

  
  

  
  

  

  <h2 id=about-dev-edition class="no-num no-toc">ã“ã®ä»•æ§˜ã«ã¤ã„ã¦</h2>

  <p>ã“ã®ä»•æ§˜ã¯ä»–ã®ã‚‚ã®ã¨ç•°ãªã‚‹ - è¬™è™šãªã‚¦ã‚§ãƒ–é–‹ç™ºè€…ã§ã‚ã‚‹<em>ã‚ãªãŸ</em>ã¨ä¸€ç·’ã«åŠ å·¥ã•ã‚Œã¦ã„ã‚‹ã€‚</p>

  <p>ã“ã®ä»•æ§˜ã®ç„¦ç‚¹ã¯ã€èª­ã¿ã‚„ã™ã•ã¨ã‚¢ã‚¯ã‚»ã‚¹ã®å®¹æ˜“ã•ã§ã‚ã‚‹ã€‚<a href=https://momdo.github.io/html/>å®Œå…¨ãªHTMLæ¨™æº–</a>ã¨ã¯ç•°ãªã‚Šã€ã“ã®ã€Œé–‹ç™ºè€…ç‰ˆã€ã§ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ãƒ™ãƒ³ãƒ€ãƒ¼ã ã‘ãŒçŸ¥ã‚‹å¿…è¦ãŒã‚ã‚‹æƒ…å ±ãŒå‰Šé™¤ã•ã‚Œã‚‹ã€‚ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«ã«ã‚ˆã£ã¦å®Œå…¨ãªä»•æ§˜ã‹ã‚‰è‡ªå‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€å¸¸ã«æœ€æ–°ã®HTMLé–‹ç™ºã¨åŒæœŸã™ã‚‹ã€‚</p>

  <p>ãã®æ§‹æƒ³ã€å‰µå‡ºã€æœªæ¥ã«ã¤ã„ã¦èª­ã‚€ãŸã‚ã«ã¯ã€<a href=http://web.archive.org/web/20150220020906/http://archive.germanforblack.com:80/articles/html5-for-web-developers>ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ãƒ—ãƒ¬ã‚¹ãƒªãƒªãƒ¼ã‚¹</a>ã¨ã€<a href=https://blog.whatwg.org/developers-edition-comeback>å†é–‹ã«ã¤ã„ã¦ã®ãƒ–ãƒ­ã‚°è¨˜äº‹</a>ã‚’èª­ã¾ã‚ŒãŸã„ã€‚</p>

  <p>æœ€å¾Œã«ã€ã¿ã‚“ãªã®ãŸã‚ã«ã“ã®ã‚¨ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã‚’ã‚ˆã‚Šè‰¯ãã™ã‚‹ãŸã‚ã«<a href=https://github.com/whatwg/html/labels/dev%20edition>GitHubã§è²¢çŒ®ã•ã‚ŒãŸã„</a>ã€‚</p>

  

  <nav><a href=canvas.html>â† 4.12.5 canvasè¦ç´ </a> â€“ <a href=./>ç›®æ¬¡</a> â€“ <a href=semantics-other.html>4.14 å°‚ç”¨è¦ç´ ãªã—ã®ä¸€èˆ¬çš„èªå½™ â†’</a></nav><ol class=toc><li><ol><li><a href=custom-elements.html#custom-elements><span class=secno>4.13</span> ã‚«ã‚¹ã‚¿ãƒ è¦ç´ </a><ol><li><a href=custom-elements.html#custom-elements-intro><span class=secno>4.13.1</span> å°å…¥</a><ol><li><a href=custom-elements.html#custom-elements-autonomous-example><span class=secno>4.13.1.1</span> è‡ªå¾‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã®ä½œæˆ</a></li><li><a href=custom-elements.html#custom-elements-customized-builtin-example><span class=secno>4.13.1.2</span> ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ ã®ä½œæˆ</a></li><li><a href=custom-elements.html#custom-elements-autonomous-drawbacks><span class=secno>4.13.1.3</span> è‡ªå¾‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã®æ¬ ç‚¹</a></li><li><a href=custom-elements.html#custom-elements-upgrades-examples><span class=secno>4.13.1.4</span> Upgrading elements after their creation</a></li></ol></li><li><a href=custom-elements.html#custom-element-conformance><span class=secno>4.13.2</span> Requirements for custom element constructors</a></li><li><a href=custom-elements.html#custom-elements-core-concepts><span class=secno>4.13.3</span> Core concepts</a></li><li><a href=custom-elements.html#custom-elements-api><span class=secno>4.13.4</span> The <code>CustomElementRegistry</code> interface</a></li><li><a href=custom-elements.html#upgrades><span class=secno>4.13.5</span> Upgrades</a></li><li><a href=custom-elements.html#custom-element-reactions><span class=secno>4.13.6</span> Custom element reactions</a></li></ol></li></ol></li></ol><h3 id=custom-elements><span class=secno>4.13</span> ã‚«ã‚¹ã‚¿ãƒ è¦ç´ <a href=#custom-elements class=self-link></a></h3><div class=status><input onclick=toggleStatus(this) value=â‹° type=button><p class=support><strong>Support:</strong> custom-elementsv1<span class="and_chr partial"><span>Chrome for Android (limited)</span> <span>59+</span></span><span class="chrome partial"><span>Chrome (limited)</span> <span>54+</span></span><span class="ios_saf partial"><span>iOS Safari (limited)</span> <span>10.3+</span></span><span class="and_uc no"><span>UC Browser for Android</span> <span>None</span></span><span class="firefox no"><span>Firefox</span> <span>None</span></span><span class="ie no"><span>IE</span> <span>None</span></span><span class="samsung partial"><span>Samsung Internet (limited)</span> <span>5+</span></span><span class="op_mini no"><span>Opera Mini</span> <span>None</span></span><span class="safari partial"><span>Safari (limited)</span> <span>10.1+</span></span><span class="android partial"><span>Android Browser (limited)</span> <span>56+</span></span><span class="opera partial"><span>Opera (limited)</span> <span>41+</span></span><p class=caniuse>Source: <a href="https://caniuse.com/#feat=custom-elementsv1">caniuse.com</a></div>

  <h4 id=custom-elements-intro><span class=secno>4.13.1</span> å°å…¥<a href=#custom-elements-intro class=self-link></a></h4>

  

  <p><a href=#custom-element id=custom-elements-intro:custom-element>ã‚«ã‚¹ã‚¿ãƒ è¦ç´ </a>ã¯ã€è‘—è€…ã«å®Œå…¨ã«æ©Ÿèƒ½ã™ã‚‹DOMè¦ç´ ã‚’ç‹¬è‡ªã«æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã‚’æä¾›ã™ã‚‹ã€‚ã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚°ãªã©ã§äº‹å¾Œã«è¿½åŠ ã•ã‚ŒãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å›ºæœ‰ã®å‹•ä½œã¨ã¨ã‚‚ã«ã€è‘—è€…ã¯æ–‡æ›¸å†…ã§éæ¨™æº–è¦ç´ ã‚’å¸¸ã«ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ããŸãŒã€ãã®ã‚ˆã†ãªè¦ç´ ã¯æ­´å²çš„ã«ä¸é©åˆã§ã‚ã‚Šã€ã‚ã¾ã‚Šæ©Ÿèƒ½ã—ãªã‹ã£ãŸã€‚ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã‚’<a href=#element-definition id=custom-elements-intro:element-definition>å®šç¾©ã™ã‚‹</a>ã“ã¨ã§ã€è‘—è€…ã¯ãƒ‘ãƒ¼ã‚µãƒ¼ã«è¦ç´ ã‚’æ­£ã—ãæ§‹æˆã™ã‚‹æ–¹æ³•ã¨ã€ãã®ã‚¯ãƒ©ã‚¹ã®è¦ç´ ãŒå¤‰æ›´ã«ã©ã®ã‚ˆã†ã«åå¿œã™ã‚‹ã‹ã‚’é€šçŸ¥ã§ãã‚‹ã€‚</p>

  <p>ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã¯ã€ï¼ˆã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã®å®šç¾©ã®ã‚ˆã†ãªï¼‰ä½ãƒ¬ãƒ™ãƒ«ã®è‘—è€…å…¬é–‹æ‹¡å¼µãƒã‚¤ãƒ³ãƒˆã«é–¢ã—ã¦ã€ï¼ˆHTMLã®è¦ç´ ã®ã‚ˆã†ãªï¼‰æ—¢å­˜ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ æ©Ÿèƒ½ã‚’èª¬æ˜ã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€"ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’åˆç†åŒ–ã™ã‚‹"ãŸã‚ã®å¤§ããªåŠªåŠ›ã®ä¸€éƒ¨ã§ã‚ã‚‹ã€‚ä»Šæ—¥ã€HTMLã®æ—¢å­˜è¦ç´ ã®æŒ¯ã‚‹èˆã„ã‚’å®Œå…¨ã«èª¬æ˜ã™ã‚‹ã“ã¨ã‚’å¦¨ã’ã‚‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ï¼ˆæ©Ÿèƒ½çš„ãŠã‚ˆã³æ„å‘³çš„ãªè¦ç´ ï¼‰ã®æ©Ÿèƒ½ã«ã¯å¤šãã®åˆ¶é™ãŒã‚ã‚‹ãŒã€æˆ‘ã€…ã¯æ™‚é–“ã®çµŒéã¨ã¨ã‚‚ã«ã“ã®ã‚®ãƒ£ãƒƒãƒ—ã‚’ç¸®å°ã—ãŸã„ã¨æ€ã†ã€‚</p>

  <h5 id=custom-elements-autonomous-example><span class=secno>4.13.1.1</span> è‡ªå¾‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã®ä½œæˆ<a href=#custom-elements-autonomous-example class=self-link></a></h5>

  

  <p><a href=#autonomous-custom-element id=custom-elements-autonomous-example:autonomous-custom-element>è‡ªå¾‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ </a>ã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã™ã‚‹ãŸã‚ã«ã€å›½æ——ã®å°ã•ãªã‚¢ã‚¤ã‚³ãƒ³ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã‚’å®šç¾©ã—ã¦ã¿ã‚ˆã†ã€‚ç§ãŸã¡ã®ç›®æ¨™ã¯ã€æ¬¡ã®ã‚ˆã†ã«ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã§ã‚ã‚‹ï¼š</p>

  <pre>&lt;flag-icon country="nl"&gt;&lt;/flag-icon&gt;</pre>

  <p>ã“ã‚Œã‚’è¡Œã†ã«ã¯ã€ã¾ãšã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã®ã‚¯ãƒ©ã‚¹ã‚’å®£è¨€ã—ã€<code>HTMLElement</code>ã‚’æ‹¡å¼µã™ã‚‹ï¼š</p>

  <pre>class FlagIcon extends HTMLElement {
  constructor() {
    super();
    this._countryCode = null;
  }

  static get observedAttributes() { return ["country"]; }

  attributeChangedCallback(name, oldValue, newValue) {
    // name will always be "country" due to observedAttributes
    this._countryCode = newValue;
    this._updateRendering();
  }
  connectedCallback() {
    this._updateRendering();
  }

  get country() {
    return this._countryCode;
  }
  set country(v) {
    this.setAttribute("country", v);
  }

  _updateRendering() {
    // Left as an exercise for the reader. But, you'll probably want to
    // check this.ownerDocument.defaultView to see if we've been
    // inserted into a document with a browsing context, and avoid
    // doing any work if not.
  }
}</pre>

  <p>æ¬¡ã«ã€è¦ç´ ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«æ¬¡ã®ã‚¯ãƒ©ã‚¹ã‚’ä½¿ç”¨ã—ã¦å¿…è¦ãŒã‚ã‚‹ï¼š</p>

  <pre>customElements.define("flag-icon", FlagIcon);</pre>

  <p>ã“ã®æ™‚ç‚¹ã§ã€ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã¯å‹•ä½œã™ã‚‹ã€‚<code>flag-icon</code>ã‚¿ã‚°ã‚’è¦‹ã‚‹ãŸã³ã«ã€ãƒ‘ãƒ¼ã‚µãƒ¼ã¯<code>FlagIcon</code>ã‚¯ãƒ©ã‚¹ã®æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã€è¦ç´ ã®å†…éƒ¨çŠ¶æ…‹ã‚’è¨­å®šã—ã€ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’æ›´æ–°ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ï¼ˆé©åˆ‡ãªå ´åˆï¼‰ã€æ–°ã—ã„<code>country</code>å±æ€§ã«ã¤ã„ã¦ã‚³ãƒ¼ãƒ‰ã«ä¼ãˆã‚‹ã€‚</p>

  <p>DOM APIã‚’ä½¿ç”¨ã—ã¦<code>flag-icon</code>è¦ç´ ã‚’ä½œæˆã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ï¼š</p>

  <pre>const flagIcon = document.createElement("flag-icon")
flagIcon.country = "jp"
document.body.appendChild(flagIcon)</pre>

  <p>æœ€å¾Œã«ã€<a href=#custom-element-constructor id=custom-elements-autonomous-example:custom-element-constructor>ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿</a>è‡ªä½“ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ã¤ã¾ã‚Šã€ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ã¯æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã¨åŒã˜ã§ã‚ã‚‹ï¼š</p>

  <pre>const flagIcon = new FlagIcon()
flagIcon.country = "jp"
document.body.appendChild(flagIcon)</pre>

  <h5 id=custom-elements-customized-builtin-example><span class=secno>4.13.1.2</span> ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ ã®ä½œæˆ<a href=#custom-elements-customized-builtin-example class=self-link></a></h5>

  

  <p><a href=#customized-built-in-element id=custom-elements-customized-builtin-example:customized-built-in-element>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã¯ã€<a href=#autonomous-custom-element id=custom-elements-customized-builtin-example:autonomous-custom-element>è‡ªå¾‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ </a>ã¨ã¯ã‚ãšã‹ã«ç•°ãªã‚‹å®šç¾©ãŒã‚ã‚Šã€ãã—ã¦å¤§ããç•°ãªã‚‹ä½¿ã‚ã‚Œæ–¹ã‚’ã™ã‚‹ã€ç‹¬è‡ªã®ç¨®é¡ã®<a href=#custom-element id=custom-elements-customized-builtin-example:custom-element>ã‚«ã‚¹ã‚¿ãƒ è¦ç´ </a>ã§ã‚ã‚‹ã€‚ã“ã®è¦ç´ ã¯ã€æ–°ã—ã„ã‚«ã‚¹ã‚¿ãƒ æ©Ÿèƒ½ã§HTMLã®æ—¢å­˜è¦ç´ ã‚’æ‹¡å¼µã™ã‚‹ã“ã¨ã§ã€HTMLã®æ—¢å­˜è¦ç´ ç”±æ¥ã®å‹•ä½œã®å†åˆ©ç”¨ã‚’å¯èƒ½ã«ã™ã‚‹ãŸã‚ã«å­˜åœ¨ã™ã‚‹ã€‚æ®‹å¿µãªã“ã¨ã«ã€HTMLè¦ç´ ã®æ—¢å­˜ã®å‹•ä½œã®å¤šããŒ<a href=#autonomous-custom-element id=custom-elements-customized-builtin-example:autonomous-custom-element-2>è‡ªå¾‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ </a>ã‚’ç´”ç²‹ã«ä½¿ç”¨ã—ã¦è¤‡è£½ã§ããªã„ãŸã‚ã€ã“ã‚Œã¯é‡è¦ã§ã‚ã‚‹ã€‚ä»£ã‚ã‚Šã«ã€<a href=#customized-built-in-element id=custom-elements-customized-builtin-example:customized-built-in-element-2>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã¯ã€æ—¢å­˜ã®è¦ç´ ã«ã‚«ã‚¹ã‚¿ãƒ æ§‹ç¯‰å‹•ä½œã€ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ã€ãŠã‚ˆã³ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ãƒã‚§ãƒ¼ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’å¯èƒ½ã«ã—ã€æ—¢å­˜ã®è¦ç´ ã®ä¸Šã«ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã‚’æœ¬è³ªçš„ã«"æ··åœ¨"ã•ã›ã‚‹ã€‚</p>

  <p><a href=#customized-built-in-element id=custom-elements-customized-builtin-example:customized-built-in-element-3>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚„ä»–ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒè¦ç´ ã®ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ãŠã‚ˆã³å‹•ä½œã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã«è¦ç´ ã®ãƒ­ãƒ¼ã‚«ãƒ«åã¨ã—ã¦æ‰±ã†ã®ã§ã€<a href=#autonomous-custom-element id=custom-elements-customized-builtin-example:autonomous-custom-element-3>è‡ªå¾‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ </a>ã¨ã¯ç•°ãªã‚‹æ§‹æ–‡ã‚’å¿…è¦ã¨ã™ã‚‹ã€‚ã¤ã¾ã‚Šã€æ—¢å­˜ã®å‹•ä½œã®ä¸Šã«æ§‹ç¯‰ã™ã‚‹<a href=#customized-built-in-element id=custom-elements-customized-builtin-example:customized-built-in-element-4>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã®æ¦‚å¿µã¯ã€å…ƒã®ãƒ­ãƒ¼ã‚«ãƒ«åã‚’ä¿æŒã™ã‚‹æ‹¡å¼µè¦ç´ ã«æ±ºå®šçš„ã«ä¾å­˜ã™ã‚‹ã€‚</p>

  <p>ã“ã®ä¾‹ã«ãŠã„ã¦ã€<code>plastic-button</code>ã¨ã„ã†<a href=#customized-built-in-element id=custom-elements-customized-builtin-example:customized-built-in-element-5>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã‚’ä½œæˆã™ã‚‹ã€‚ã“ã‚Œã¯é€šå¸¸ã®ãƒœã‚¿ãƒ³ã®ã‚ˆã†ã«å‹•ä½œã™ã‚‹ãŒã€ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ãŸã³ã«ãƒ•ã‚¡ãƒ³ã‚·ãƒ¼ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœãŒè¿½åŠ ã•ã‚Œã‚‹ã€‚ä»Šå›ã¯<code>HTMLElement</code>ã®ä»£ã‚ã‚Šã«<code>HTMLButtonElement</code>ã‚’æ‹¡å¼µã™ã‚‹ãŒã€å‰ã¨åŒã˜ã‚ˆã†ã«ã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã‹ã‚‰å§‹ã‚ã‚‹ï¼š</p>

  <pre>class PlasticButton extends HTMLButtonElement {
  constructor() {
    super();

    this.addEventListener("click", () =&gt; {
      // Draw some fancy animation effects!
    });
  }
}</pre>

  <p>ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã‚’å®šç¾©ã™ã‚‹å ´åˆã€<code>extends</code>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚‚æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼š</p>

  <pre>customElements.define("plastic-button", PlasticButton, { extends: "button" });</pre>

  <p>ä¸€èˆ¬ã«ã€æ‹¡å¼µã•ã‚Œã¦ã„ã‚‹è¦ç´ ã®åå‰ã¯ã€åŒã˜ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’å…±æœ‰ã™ã‚‹è¦ç´ ï¼ˆ<code>HTMLQuoteElement</code>ã‚’å…±æœ‰ã™ã‚‹<code id=custom-elements-customized-builtin-example:the-q-element><a href=text-level-semantics.html#the-q-element>q</a></code>ã¨<code id=custom-elements-customized-builtin-example:the-blockquote-element><a href=grouping-content.html#the-blockquote-element>blockquote</a></code>ã®ä¸¡è€…ãªã©ï¼‰ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã€æ‹¡å¼µã™ã‚‹è¦ç´ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’å˜ã«èª¿ã¹ã‚‹ã ã‘ã§ã¯åˆ¤æ–­ã™ã‚‹ã“ã¨ãŒã§ããªã„ã€‚</p>

  <p><a href=#customized-built-in-element id=custom-elements-customized-builtin-example:customized-built-in-element-6>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€<code id=custom-elements-customized-builtin-example:the-button-element><a href=form-elements.html#the-button-element>button</a></code>è¦ç´ ã§<code id=custom-elements-customized-builtin-example:attr-is><a href=#attr-is>is</a></code>å±æ€§ã‚’ä½¿ç”¨ã™ã‚‹ï¼š</p>

  <pre>&lt;button is="plastic-button"&gt;Click Me!&lt;/button&gt;</pre>

  <p><a href=#customized-built-in-element id=custom-elements-customized-builtin-example:customized-built-in-element-7>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã‚’<a href=#autonomous-custom-element id=custom-elements-customized-builtin-example:autonomous-custom-element-4>è‡ªå¾‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ </a>ã¨ã—ã¦ä½¿ç”¨ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã†ã¾ã<em>ã„ã‹ãªã„</em>ã€‚ã¤ã¾ã‚Šã€<code>&lt;plastic-button&gt;Click me?&lt;/plastic-button&gt;</code>ã¯ç‰¹åˆ¥ãªå‹•ä½œã‚’ã—ãªã„<code>HTMLElement</code>ã‚’ä½œæˆã™ã‚‹ã ã‘ã§ã‚ã‚‹ã€‚</p>

  <p>ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§å‹æ‹¡å¼µã—ãŸè¦ç´ ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã€æ¬¡ã®<code id=custom-elements-customized-builtin-example:dom-document-createelement><a data-x-internal=dom-document-createelement href=https://triple-underscore.github.io/DOM4-ja.html#dom-document-createelement>createElement()</a></code>ã®å½¢å¼ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ï¼š</p>

  <pre>const plasticButton = document.createElement("button", { is: "plastic-button" });
plasticButton.textContent = "Click me!";</pre>

  <p>å‰ã¨åŒã˜ã‚ˆã†ã«ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚‚å‹•ä½œã™ã‚‹ï¼š</p>

  <pre>const plasticButton2 = new PlasticButton();
console.log(plasticButton2.localName);          // will output "button"
console.log(plasticButton2.getAttribute("is")); // will output "plastic-button"</pre>

  <p>ç‰¹ã«ã€<code id=custom-elements-customized-builtin-example:the-button-element-2><a href=form-elements.html#the-button-element>button</a></code>ãŒç‰¹åˆ¥ã§ã‚ã‚‹ã™ã¹ã¦ã®æ–¹æ³•ã¯ã€ãã®ã‚ˆã†ãª"ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯ãƒœã‚¿ãƒ³"ã«ã‚‚é©ç”¨ã•ã‚Œã‚‹ï¼šãƒ•ã‚©ãƒ¼ã‚«ã‚¹å‹•ä½œã€<span>ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡</span>ã«é–¢ä¸ã™ã‚‹èƒ½åŠ›ã€<code id=custom-elements-customized-builtin-example:attr-fe-disabled><a href=form-control-infrastructure.html#attr-fe-disabled>disabled</a></code>å±æ€§ãªã©ã€‚</p>

  <p id=customized-built-in-element-restrictions><a href=#customized-built-in-element id=custom-elements-customized-builtin-example:customized-built-in-element-8>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã¯ã€æœ‰ç”¨ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒæä¾›ã™ã‚‹å‹•ä½œã¾ãŸã¯APIã‚’æŒã¤æ—¢å­˜ã®HTMLè¦ç´ ã‚’æ‹¡å¼µã‚’å¯èƒ½ã«ã™ã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã‚‹ã€‚ãã®ãŸã‚ã€ã“ã®ä»•æ§˜ã§å®šç¾©ã•ã‚Œã‚‹æ—¢å­˜ã®HTMLè¦ç´ ã®ã¿ã‚’æ‹¡å¼µã™ã‚‹ã“ã¨ãŒã§ãã€<a id=custom-elements-customized-builtin-example:element-interface href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-interface data-x-internal=element-interface>è¦ç´ ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹</a>ã¨ã—ã¦<code>HTMLUnknownElement</code>ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«å®šç¾©ã•ã‚ŒãŸ<code id=custom-elements-customized-builtin-example:bgsound><a href=obsolete.html#bgsound>bgsound</a></code>ã€<code id=custom-elements-customized-builtin-example:blink><a href=obsolete.html#blink>blink</a></code>ã€<code id=custom-elements-customized-builtin-example:isindex><a href=obsolete.html#isindex>isindex</a></code>ã€<code id=custom-elements-customized-builtin-example:keygen><a href=obsolete.html#keygen>keygen</a></code>ã€<code id=custom-elements-customized-builtin-example:multicol><a href=obsolete.html#multicol>multicol</a></code>ã€<code id=custom-elements-customized-builtin-example:nextid><a href=obsolete.html#nextid>nextid</a></code>ã€ã¾ãŸã¯<code id=custom-elements-customized-builtin-example:spacer><a href=obsolete.html#spacer>spacer</a></code>ãªã©ã®ãƒ¬ã‚¬ã‚·ãƒ¼è¦ç´ ã¯æ‹¡å¼µã§ããªã„ã€‚</p>

  <p>ã“ã®è¦ä»¶ã®1ã¤ã®ç†ç”±ã¯å°†æ¥ã®äº’æ›æ€§ã§ã‚ã‚‹ã€‚ã‚‚ã—<a href=#customized-built-in-element id=custom-elements-customized-builtin-example:customized-built-in-element-9>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ãŒã€ãŸã¨ãˆã°<code>combobox</code>ã®ã‚ˆã†ãªã€ç¾åœ¨ä¸æ˜ã®è¦ç´ ã‚’æ‹¡å¼µã—ãŸã‚‚ã®ãŒå®šç¾©ã•ã‚ŒãŸãªã‚‰ã€æ´¾ç”Ÿã—ãŸ<a href=#customized-built-in-element id=custom-elements-customized-builtin-example:customized-built-in-element-10>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã®ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ãŒã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæä¾›ã®å‹•ä½œã«èˆˆå‘³ã‚’æŒãŸãªã„åŸºæœ¬è¦ç´ ã«ä¾å­˜ã™ã‚‹ã‚ˆã†ã«ãªã‚‹ãŸã‚ã€ã“ã‚Œã¯ã“ã®ä»•æ§˜ãŒå°†æ¥<code>combobox</code>è¦ç´ ã‚’å®šç¾©ã™ã‚‹ã“ã¨ã‚’å¦¨ã’ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã€‚</p>

  <h5 id=custom-elements-autonomous-drawbacks><span class=secno>4.13.1.3</span> è‡ªå¾‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã®æ¬ ç‚¹<a href=#custom-elements-autonomous-drawbacks class=self-link></a></h5>

  

  <p>ä»¥ä¸‹ã§è¦å®šã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€ãã—ã¦ä¸Šè¨˜ã§è§¦ã‚ŒãŸã‚ˆã†ã«ã€å˜ã«<code>taco-button</code>ã¨ã„ã†è¦ç´ ã‚’å®šç¾©ã—ã¦ä½¿ç”¨ã—ã¦ã‚‚ã€ãã®ã‚ˆã†ãªè¦ç´ ãŒãƒœã‚¿ãƒ³ã‚’<a href=dom.html#represents id=custom-elements-autonomous-drawbacks:represents>è¡¨ã™</a>ã“ã¨ã‚’æ„å‘³ã—ãªã„ã€‚ã¤ã¾ã‚Šã€ã‚¦ã‚§ãƒ–ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¼ã€æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã€ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æŠ€è¡“ãªã©ã®ãƒ„ãƒ¼ãƒ«ã¯ã€å®šç¾©ã•ã‚ŒãŸåå‰ã ã‘ã«åŸºã¥ã„ã¦ã€çµæœã®è¦ç´ ã‚’ãƒœã‚¿ãƒ³ã¨ã—ã¦è‡ªå‹•çš„ã«å‡¦ç†ã—ãªã„ã€‚</p>

  <p><a href=#autonomous-custom-element id=custom-elements-autonomous-drawbacks:autonomous-custom-element>è‡ªå¾‹ã‚«ã‚¹ã‚¿ãƒ è¦ç´ </a>ã‚’ä¾ç„¶ã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ä¸€æ–¹ã§ã€æ§˜ã€…ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ‰€æœ›ã®ãƒœã‚¿ãƒ³ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã‚’ä¼ãˆã‚‹ãŸã‚ãŸã‚ã«ã¯ã€è¤‡æ•°ã®æŠ€è¡“ã‚’ç”¨ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼š</p>

  <ul><li><p><code id=custom-elements-autonomous-drawbacks:attr-tabindex><a href=interaction.html#attr-tabindex>tabindex</a></code>å±æ€§ã®è¿½åŠ ã¯ã€<code>taco-button</code>ã‚’<a id=custom-elements-autonomous-drawbacks:interactive-content-2 href=dom.html#interactive-content-2>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</a>ã«ã—ã€<a href=interaction.html#focusable-area id=custom-elements-autonomous-drawbacks:focusable-area>ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å¯èƒ½</a>ã«ã™ã‚‹ã€‚ã‚‚ã—<code>taco-button</code>ã‚’è«–ç†çš„ã«ç„¡åŠ¹ã«ã™ã‚‹ãªã‚‰ã°ã€<code id=custom-elements-autonomous-drawbacks:attr-tabindex-2><a href=interaction.html#attr-tabindex>tabindex</a></code>å±æ€§ã‚’å‰Šé™¤ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã ã‚ã†ã“ã¨ã«æ³¨æ„ã™ã‚‹ã“ã¨ã€‚</li><li><p>å¤šæ§˜ãªARIAå±æ€§ã®è¿½åŠ ã¯ã€ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã‚’ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æŠ€è¡“ã«ä¼ãˆã‚‹ã®ã«å½¹ç«‹ã¤ã€‚ãŸã¨ãˆã°ã€<code id=custom-elements-autonomous-drawbacks:attr-aria-role><a href=infrastructure.html#attr-aria-role>role</a></code>å±æ€§ã‚’"<code id=custom-elements-autonomous-drawbacks:attr-aria-role-button><a data-x-internal=attr-aria-role-button href=http://momdo.github.io/wai-aria-1.1/#button>button</a></code>"ã«è¨­å®šã™ã‚‹ã¨ã€ã“ã‚Œã¯ãƒœã‚¿ãƒ³ã§ã‚ã‚‹ã¨ã„ã†ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã‚’ä¼ãˆã‚‹ãŸã‚ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æŠ€è¡“ã§é€šå¸¸ã®ãƒœã‚¿ãƒ³ã®ã‚ˆã†ãªã‚„ã‚Šå–ã‚Šã‚’ä½¿ç”¨ã—ã¦ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¨æ­£å¸¸ã«ã‚„ã‚Šã¨ã‚Šã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æŠ€è¡“ãŒå­ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ¼ãƒ‰ã‚’æ¨ªæ–­ã—ã¦é€šçŸ¥ã™ã‚‹ä»£ã‚ã‚Šã«ã€<code id=custom-elements-autonomous-drawbacks:attr-aria-label><a data-x-internal=attr-aria-label href=http://momdo.github.io/wai-aria-1.1/#aria-label>aria-label</a></code>å±æ€§ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€ãƒœã‚¿ãƒ³ã«<a href=http://momdo.github.io/wai-aria-1.1/#dfn-accessible-name id=custom-elements-autonomous-drawbacks:concept-accessible-name data-x-internal=concept-accessible-name>ã‚¢ã‚¯ã‚»ã‚·ãƒ–ãƒ«ãªåå‰</a>ã‚’ä»˜ã‘ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ãã‚Œã‹ã‚‰ãƒœã‚¿ãƒ³ãŒè«–ç†çš„ã«ç„¡åŠ¹ã«ã§ã‚ã‚‹ã¨ãã«<code id=custom-elements-autonomous-drawbacks:attr-aria-disabled><a data-x-internal=attr-aria-disabled href=http://momdo.github.io/wai-aria-1.1/#aria-disabled>aria-disabled</a></code>ã‚’"<code>true</code>"ã«è¨­å®šã™ã‚‹ã¨ã€ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£æŠ€è¡“ã«ãƒœã‚¿ãƒ³ã®ç„¡åŠ¹çŠ¶æ…‹ãŒä¼ã‚ã‚‹ã€‚</li><li><p>é€šå¸¸äºˆæƒ³ã•ã‚Œã‚‹ãƒœã‚¿ãƒ³ã®å‹•ä½œã‚’å‡¦ç†ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€ãƒœã‚¿ãƒ³ã®ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã‚’ã‚¦ã‚§ãƒ–ãƒ–ãƒ©ã‚¦ã‚¶ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¼ãˆã‚‹ã“ã¨ã‚’æ‰‹ä¼ã†ã€‚ã“ã®å ´åˆã€æœ€ã‚‚é–¢é€£æ€§ã®é«˜ã„ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã¯ã€é©åˆ‡ãª<code id=custom-elements-autonomous-drawbacks:event-keydown><a data-x-internal=event-keydown href=https://w3c.github.io/uievents/#event-type-keydown>keydown</a></code>ã‚¤ãƒ™ãƒ³ãƒˆã‚’<code id=custom-elements-autonomous-drawbacks:event-click><a data-x-internal=event-click href=https://w3c.github.io/uievents/#event-type-click>click</a></code>ã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦ãƒ—ãƒ­ã‚­ã‚·ã™ã‚‹ã‚‚ã®ã§ã‚ã‚‹ã®ã§ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã¨ã‚¯ãƒªãƒƒã‚¯ã®ä¸¡æ–¹ã§ãƒœã‚¿ãƒ³ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚</li><li><p><code>taco-button</code>è¦ç´ ã«æä¾›ã•ã‚Œã‚‹ä»»æ„ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®è¦–è¦šã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã«åŠ ãˆã¦ã€è¦–è¦šã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã¯ã¾ãŸã€ä¾‹ãˆã°ç„¡åŠ¹ã«ãªã‚‹ãªã©ã€è«–ç†çŠ¶æ…‹ã®å¤‰åŒ–ã‚’åæ˜ ã™ã‚‹ã‚ˆã†ã«æ›´æ–°ã•ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã¤ã¾ã‚Šã€<code>taco-button</code>ã®è¦å‰‡ã‚’æŒã¤ã‚¹ã‚¿ã‚¤ãƒ«ã‚·ãƒ¼ãƒˆã¯ã™ã¹ã¦ã€<code>taco-button[disabled]</code>ã®è¦å‰‡ã‚‚å¿…è¦ã¨ãªã‚‹ã€‚</li></ul>

  <p>ã“ã‚Œã‚‰ã®ç‚¹ã‚’å¿µé ­ã«ç½®ã„ã¦ã€ï¼ˆç„¡åŠ¹ã«ã™ã‚‹æ©Ÿèƒ½ã‚’å«ã‚€ï¼‰ãƒœã‚¿ãƒ³ã®ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã‚’ä¼ãˆã‚‹è²¬ä»»ã‚’è² ã£ãŸãƒ•ãƒ«æ©Ÿèƒ½ã®<code>taco-button</code>ã¯ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ï¼š</p>

  <pre>class TacoButton extends HTMLElement {
  static get observedAttributes() { return ["disabled"]; }

  constructor() {
    super();

    this.addEventListener("keydown", e =&gt; {
      if (e.keyCode === 32 || e.keyCode === 13) {
        this.dispatchEvent(new MouseEvent("click", {
          bubbles: true,
          cancelable: true
        }));
      }
    });

    this.addEventListener("click", e =&gt; {
      if (this.disabled) {
        e.preventDefault();
        e.stopPropagation();
      }
    });

    this._observer = new MutationObserver(() =&gt; {
      this.setAttribute("aria-label", this.textContent);
    });
  }

  connectedCallback() {
    this.setAttribute("role", "button");
    this.setAttribute("tabindex", "0");

    this._observer.observe(this, {
      childList: true,
      characterData: true,
      subtree: true
    });
  }

  disconnectedCallback() {
    this._observer.disconnect();
  }

  get disabled() {
    return this.hasAttribute("disabled");
  }

  set disabled(v) {
    if (v) {
      this.setAttribute("disabled", "");
    } else {
      this.removeAttribute("disabled");
    }
  }

  attributeChangedCallback() {
    // only is called for the disabled attribute due to observedAttributes
    if (this.disabled) {
      this.removeAttribute("tabindex");
      this.setAttribute("aria-disabled", "true");
    } else {
      this.setAttribute("tabindex", "0");
      this.setAttribute("aria-disabled", "false");
    }
  }
}</pre>

  <p>ã“ã®ã‚ˆã†ã«ã‹ãªã‚Šè¤‡é›‘ãªè¦ç´ å®šç¾©ãŒã‚ã£ã¦ã‚‚ã€ãã®è¦ç´ ã¯ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ã®ãŸã‚ã«ä½¿ç”¨ã™ã‚‹å–œã³ã¨ã¯ãªã‚‰ãªã„ã€‚è‡ªèº«ã®æ„å¿—ã®<code id=custom-elements-autonomous-drawbacks:attr-tabindex-3><a href=interaction.html#attr-tabindex>tabindex</a></code>ã‚„<code id=custom-elements-autonomous-drawbacks:attr-aria-*><a href=infrastructure.html#attr-aria-*>aria-*</a></code>å±æ€§ã‚’ç¶™ç¶šçš„ã«"ç™ºèŠ½"ã•ã›ã‚‹ã€‚ã“ã‚Œã¯ã€ç¾åœ¨ã®ã¨ã“ã‚ã€ï¼ˆé€šå¸¸ã¯ã‚³ãƒ³ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å‹•ä½œã‚’ä¸Šæ›¸ãã§ãã‚‹ã‚ˆã†ã«äºˆç´„ã•ã‚Œã¦ã„ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšï¼‰ã“ã‚Œã‚‰ã®å±æ€§ã‚’å¼·åˆ¶çš„ã«ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€ã‚«ã‚¹ã‚¿ãƒ è¦ç´ ã«å¯¾ã™ã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã‚„ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å‹•ä½œã‚’æŒ‡å®šã™ã‚‹æ–¹æ³•ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã§ã‚ã‚‹ã€‚</p>

  <p>å¯¾ç…§çš„ã«ã€å‰ç¯€ã§ç¤ºã—ãŸã‚ˆã†ã«ã€å˜ä¸€ã®<a href=#customized-built-in-element id=custom-elements-autonomous-drawbacks:customized-built-in-element>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã¯ã€<code id=custom-elements-autonomous-drawbacks:the-button-element><a href=form-elements.html#the-button-element>button</a></code>è¦ç´ ã®ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã¨å‹•ä½œã‚’è‡ªå‹•çš„ã«ç¶™æ‰¿ã™ã‚‹ã€‚ã“ã‚Œã‚‰ã®å‹•ä½œã‚’æ‰‹å‹•ã§å®Ÿè£…ã™ã‚‹å¿…è¦ã¯ãªã„ã€‚ä¸€èˆ¬ã«ã€HTMLã®æ—¢å­˜è¦ç´ ã®ä¸Šã«æ§‹ç¯‰ã•ã‚Œã‚‹é‡è¦ãªå‹•ä½œã‚„ã‚»ãƒãƒ³ãƒ†ã‚£ã‚¯ã‚¹ã‚’æŒã¤è¦ç´ ã«ã¤ã„ã¦ã¯ã€<a href=#customized-built-in-element id=custom-elements-autonomous-drawbacks:customized-built-in-element-2>ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸçµ„ã¿è¾¼ã¿è¦ç´ </a>ã®é–‹ç™ºã€ä¿å®ˆã€ãŠã‚ˆã³æ¶ˆè²»ãŒå®¹æ˜“ã«ãªã‚‹ã€‚</p>

  <h5 id=custom-elements-upgrades-examples><span class=secno>4.13.1.4</span> Upgrading elements after their creation<a href=#custom-elements-upgrades-examples class=self-link></a></h5>

  

  <p>Because <a href=#element-definition id=custom-elements-upgrades-examples:element-definition>element definition</a> can occur at any time, a non-custom element could be
  <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-create-element id=custom-elements-upgrades-examples:create-an-element data-x-internal=create-an-element>created</a>, and then later become a <a href=#custom-element id=custom-elements-upgrades-examples:custom-element>custom
  element</a> after an appropriate <a href=#custom-element-definition id=custom-elements-upgrades-examples:custom-element-definition>definition</a> is
  registered. We call this process "upgrading" the element, from a normal element into a custom
  element.</p>

  <p><a href=#upgrades id=custom-elements-upgrades-examples:upgrades>Upgrades</a> enable scenarios where it may be
  preferable for <a href=#custom-element-definition id=custom-elements-upgrades-examples:custom-element-definition-2>custom element definitions</a> to be
  registered after relevant elements has been initially created, such as by the parser. They allow
  progressive enhancement of the content in the custom element. For example, in the following HTML
  document the element definition for <code>img-viewer</code> is loaded
  asynchronously:</p>

  <pre>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;title&gt;Image viewer example&lt;/title&gt;

&lt;img-viewer filter="Kelvin"&gt;
  &lt;img src="images/tree.jpg" alt="A beautiful tree towering over an empty savannah"&gt;
&lt;/img-viewer&gt;

&lt;script src="js/elements/img-viewer.js" async&gt;&lt;/script&gt;</pre>

  <p>The definition for the <code>img-viewer</code> element here is loaded using a
  <code id=custom-elements-upgrades-examples:the-script-element><a href=scripting.html#the-script-element>script</a></code> element marked with the <code id=custom-elements-upgrades-examples:attr-script-async><a href=scripting.html#attr-script-async>async</a></code>
  attribute, placed after the <code>&lt;img-viewer&gt;</code> tag in the markup. While the
  script is loading, the <code>img-viewer</code> element will be treated as an undefined
  element, similar to a <code id=custom-elements-upgrades-examples:the-span-element><a href=text-level-semantics.html#the-span-element>span</a></code>. Once the script loads, it will define the <code>img-viewer</code> element, and the existing <code>img-viewer</code> element on
  the page will be upgraded, applying the custom element's definition (which presumably includes
  applying an image filter identified by the string "Kelvin", enhancing the image's visual
  appearance).</p>

  <hr>

  <p>Note that <a href=#upgrades id=custom-elements-upgrades-examples:upgrades-2>upgrades</a> only apply to elements in the
  document tree. (Formally, elements that are <a id=custom-elements-upgrades-examples:connected href=https://triple-underscore.github.io/DOM4-ja.html#connected data-x-internal=connected>connected</a>.) An element that is not
  inserted into a document will stay un-upgraded. An example illustrates this point:</p>

  <pre>&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;title&gt;Upgrade edge-cases example&lt;/title&gt;

&lt;example-element&gt;&lt;/example-element&gt;

&lt;script&gt;
  "use strict";

  const inDocument = document.querySelector("example-element");
  const outOfDocument = document.createElement("example-element");

  // Before the element definition, both are HTMLElement:
  console.assert(inDocument instanceof HTMLElement);
  console.assert(outOfDocument instanceof HTMLElement);

  class ExampleElement extends HTMLElement {}
  customElements.define("example-element", ExampleElement);

  // After element definition, the in-document element was upgraded:
  console.assert(inDocument instanceof ExampleElement);
  console.assert(!(outOfDocument instanceof ExampleElement));

  document.body.appendChild(outOfDocument);

  // Now that we've moved the element into the document, it too was upgraded:
  console.assert(outOfDocument instanceof ExampleElement);
&lt;/script&gt;</pre>

  <h4 id=custom-element-conformance><span class=secno>4.13.2</span> Requirements for custom element constructors<a href=#custom-element-conformance class=self-link></a></h4>

  <p>When authoring <a href=#custom-element-constructor id=custom-element-conformance:custom-element-constructor>custom element constructors</a>,
  authors are bound by the following conformance requirements:</p>

  <ul><li><p>A parameter-less call to <code>super()</code> must be the first statement in the
   constructor body, to establish the correct prototype chain and <b>this</b> value before any
   further code is run.</li><li><p>A <code>return</code> statement must not appear anywhere inside the constructor
   body, unless it is a simple early-return (<code>return</code> or <code>return
   this</code>).</li><li><p>The constructor must not use the <code id=custom-element-conformance:dom-document-write><a href=dynamic-markup-insertion.html#dom-document-write>document.write()</a></code>
   or <code id=custom-element-conformance:dom-document-open><a href=dynamic-markup-insertion.html#dom-document-open>document.open()</a></code> methods.</li><li><p>The element's attributes and children must not be inspected, as in the non-<a href=#upgrades id=custom-element-conformance:upgrades>upgrade</a> case none will be present, and relying on
   upgrades makes the element less usable.</li><li><p>The element must not gain any attributes or children, as this violates the expectations of
   consumers who use the <code id=custom-element-conformance:dom-document-createelement><a data-x-internal=dom-document-createelement href=https://triple-underscore.github.io/DOM4-ja.html#dom-document-createelement>createElement</a></code> or <code id=custom-element-conformance:dom-document-createelementns><a data-x-internal=dom-document-createelementns href=https://triple-underscore.github.io/DOM4-ja.html#dom-document-createelementns>createElementNS</a></code> methods.</li><li><p>In general, work should be deferred to <code>connectedCallback</code> as much as
   possibleâ€”especially work involving fetching resources or rendering. However, note that <code>connectedCallback</code> can be called more than once, so any initialization work that
   is truly one-time will need a guard to prevent it from running twice.</li><li><p>In general, the constructor should be used to set up initial state and default values, and
   to set up event listeners and possibly a <a id=custom-element-conformance:shadow-root href=https://triple-underscore.github.io/DOM4-ja.html#concept-shadow-root data-x-internal=shadow-root>shadow root</a>.</li></ul>

  <p>Several of these requirements are checked during <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-create-element id=custom-element-conformance:create-an-element data-x-internal=create-an-element>element
  creation</a>, either directly or indirectly, and failing to follow them will result in a custom
  element that cannot be instantiated by the parser or DOM APIs. This is true even if the work is
  done inside a constructor-initiated <span>microtask</span>, as a <span>microtask checkpoint</span> can occur immediately after construction.</p>

  <h4 id=custom-elements-core-concepts><span class=secno>4.13.3</span> Core concepts<a href=#custom-elements-core-concepts class=self-link></a></h4>

  <p>A <dfn id=custom-element>custom element</dfn> is an element that is <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-custom id=custom-elements-core-concepts:concept-element-custom data-x-internal=concept-element-custom>custom</a>. Informally, this means that its constructor and
  prototype are defined by the author, instead of by the user agent. This author-supplied
  constructor function is called the <dfn id=custom-element-constructor data-export="">custom element constructor</dfn>.</p>

  <p>Two distinct types of <a href=#custom-element id=custom-elements-core-concepts:custom-element>custom elements</a> can be defined:</p>

  <ol><li><p>An <dfn id=autonomous-custom-element data-export="">autonomous custom element</dfn>, which is defined with no <code>extends</code> option. These types of custom elements have a local name equal to their
   <a href=#concept-custom-element-definition-name id=custom-elements-core-concepts:concept-custom-element-definition-name>defined name</a>.</li><li><p>A <dfn id=customized-built-in-element data-export="">customized built-in element</dfn>, which is defined with an <code>extends</code> option. These types of custom elements have a local name equal to the
   value passed in their <code>extends</code> option, and their <a href=#concept-custom-element-definition-name id=custom-elements-core-concepts:concept-custom-element-definition-name-2>defined name</a> is used as the value of the
   <dfn id=attr-is><code>is</code></dfn> attribute, which therefore must be a <a href=#valid-custom-element-name id=custom-elements-core-concepts:valid-custom-element-name>valid
   custom element name</a>.</li></ol>

  <p>After a <a href=#custom-element id=custom-elements-core-concepts:custom-element-2>custom element</a> is <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-create-element id=custom-elements-core-concepts:create-an-element data-x-internal=create-an-element>created</a>,
  changing the value of the <code id=custom-elements-core-concepts:attr-is><a href=#attr-is>is</a></code> attribute does not
  change the element's behavior, as it is saved on the element as its <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-is-value id=custom-elements-core-concepts:concept-element-is-value data-x-internal=concept-element-is-value><code>is</code> value</a>.</p>

  <p><a href=#autonomous-custom-element id=custom-elements-core-concepts:autonomous-custom-element>Autonomous custom elements</a> have the following
  element definition:</p>

  <dl class=element><dt><a href=dom.html#concept-element-categories id=custom-elements-core-concepts:concept-element-categories>ã‚«ãƒ†ã‚´ãƒªãƒ¼</a>ï¼š<dd><a id=custom-elements-core-concepts:flow-content-2 href=dom.html#flow-content-2>ãƒ•ãƒ­ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</a>ã€‚<dd><a id=custom-elements-core-concepts:phrasing-content-2 href=dom.html#phrasing-content-2>ãƒ•ãƒ¬ãƒ¼ã‚¸ãƒ³ã‚°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</a>ã€‚<dd><a id=custom-elements-core-concepts:palpable-content-2 href=dom.html#palpable-content-2>ãƒ‘ãƒ«ãƒ‘ãƒ–ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</a>ã€‚<dt><a href=dom.html#concept-element-contexts id=custom-elements-core-concepts:concept-element-contexts>ã“ã®è¦ç´ ã‚’ä½¿ç”¨ã§ãã‚‹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</a>ï¼š<dd><a id=custom-elements-core-concepts:phrasing-content-2-2 href=dom.html#phrasing-content-2>ãƒ•ãƒ¬ãƒ¼ã‚¸ãƒ³ã‚°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</a>ãŒæœŸå¾…ã•ã‚Œã‚‹å ´æ‰€ã€‚<dt><a href=dom.html#concept-element-content-model id=custom-elements-core-concepts:concept-element-content-model>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ¢ãƒ‡ãƒ«</a>ï¼š<dd><a id=custom-elements-core-concepts:transparent href=dom.html#transparent>é€éçš„</a>ã€‚<dt><a href=dom.html#concept-element-attributes id=custom-elements-core-concepts:concept-element-attributes>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å±æ€§</a>ï¼š<dd><a id=custom-elements-core-concepts:global-attributes href=dom.html#global-attributes>Global attributes</a>, except the <code id=custom-elements-core-concepts:attr-is-2><a href=#attr-is>is</a></code> attribute<dd>åå‰ç©ºé–“ã‚’æŒãŸãªã„ãã®ä»–ã®å±æ€§ï¼ˆæ–‡å‚ç…§ï¼‰ã€‚<dt><a href=dom.html#concept-element-dom id=custom-elements-core-concepts:concept-element-dom>DOMã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹</a>ï¼š<dd>Supplied by the element's author (inherits from <code>HTMLElement</code>)</dl>


  <p>An <a href=#autonomous-custom-element id=custom-elements-core-concepts:autonomous-custom-element-2>autonomous custom element</a> does not have any special meaning: it
  <a id=custom-elements-core-concepts:represents href=dom.html#represents>represents</a> its children. A <a href=#customized-built-in-element id=custom-elements-core-concepts:customized-built-in-element>customized built-in element</a> inherits the
  semantics of the element that it extends.</p>

  <p>Any namespace-less attribute that is relevant to the element's functioning, as determined by
  the element's author, may be specified on an <a href=#autonomous-custom-element id=custom-elements-core-concepts:autonomous-custom-element-3>autonomous custom element</a>, so long as
  the attribute name is <a id=custom-elements-core-concepts:xml-compatible href=infrastructure.html#xml-compatible>XML-compatible</a> and contains no <a href=https://triple-underscore.github.io/infra-ja.html#ascii-upper-alpha id=custom-elements-core-concepts:uppercase-ascii-letters data-x-internal=uppercase-ascii-letters>ASCII upper alphas</a>. The exception is the <code id=custom-elements-core-concepts:attr-is-3><a href=#attr-is>is</a></code> attribute,
  which must not be specified on an <a href=#autonomous-custom-element id=custom-elements-core-concepts:autonomous-custom-element-4>autonomous custom element</a> (and which will have no
  effect if it is).</p>

  <p><a href=#customized-built-in-element id=custom-elements-core-concepts:customized-built-in-element-2>Customized built-in elements</a> follow the
  normal requirements for attributes, based on the elements they extend. To add custom
  attribute-based behavior, use <code id=custom-elements-core-concepts:attr-data-*><a href=dom.html#attr-data-*>data-*</a></code> attributes.</p>

  <hr>

  <p>A <dfn id=valid-custom-element-name data-export="">valid custom element name</dfn> is a sequence of characters
  <var>name</var> that meets all of the following requirements:</p>

  <ul><li>
    <p><var>name</var> must match the <code id=custom-elements-core-concepts:prod-potentialcustomelementname><a href=#prod-potentialcustomelementname>PotentialCustomElementName</a></code> production:</p>

    <dl><dt><code><dfn id=prod-potentialcustomelementname>PotentialCustomElementName</dfn> ::=</code><dd><code>[a-z] (<a href=#prod-pcenchar id=custom-elements-core-concepts:prod-pcenchar>PCENChar</a>)* '-'
     (<a href=#prod-pcenchar id=custom-elements-core-concepts:prod-pcenchar-2>PCENChar</a>)*</code><dt><code><dfn id=prod-pcenchar>PCENChar</dfn> ::=</code><dd><code>"-" | "." | [0-9] | "_" | [a-z] | #xB7 | [#xC0-#xD6] | [#xD8-#xF6] |
     [#xF8-#x37D] | [#x37F-#x1FFF] | [#x200C-#x200D] | [#x203F-#x2040] | [#x2070-#x218F] |
     [#x2C00-#x2FEF] | [#x3001-#xD7FF] | [#xF900-#xFDCF] | [#xFDF0-#xFFFD] |
     [#x10000-#xEFFFF]</code></dl>

    <p>This uses the <a href=https://www.w3.org/TR/xml/#sec-notation>EBNF notation</a> from the
    <cite>XML</cite> specification. <a href=references.html#refsXML>[XML]</a></p>
   </li><li>
    <p><var>name</var> must not be any of the following:</p>

    <ul class=brief><li><code>annotation-xml</code></li><li><code>color-profile</code></li><li><code>font-face</code></li><li><code>font-face-src</code></li><li><code>font-face-uri</code></li><li><code>font-face-format</code></li><li><code>font-face-name</code></li><li><code>missing-glyph</code></li></ul>

    <p class=note>The list of names above is the summary of all hyphen-containing element names
    from the <a href=infrastructure.html#other-applicable-specifications id=custom-elements-core-concepts:other-applicable-specifications>applicable specifications</a>, namely
    <cite>SVG</cite> and <cite>MathML</cite>. <a href=references.html#refsSVG>[SVG]</a> <a href=references.html#refsMATHML>[MATHML]</a></p>
   </li></ul>

  <div class=note>
   <p>These requirements ensure a number of goals for <a href=#valid-custom-element-name id=custom-elements-core-concepts:valid-custom-element-name-2>valid
   custom element names</a>:</p>

   <ul><li><p>They start with an <a id=custom-elements-core-concepts:lowercase-ascii-letters href=https://triple-underscore.github.io/infra-ja.html#ascii-lower-alpha data-x-internal=lowercase-ascii-letters>ASCII lower alpha</a>, ensuring that the HTML parser will
    treat them as tags instead of as text.</li><li><p>They do not contain any <a href=https://triple-underscore.github.io/infra-ja.html#ascii-upper-alpha id=custom-elements-core-concepts:uppercase-ascii-letters-2 data-x-internal=uppercase-ascii-letters>ASCII upper alphas</a>,
    ensuring that the user agent can always treat HTML elements ASCII-case-insensitively.</li><li><p>They contain a hyphen, used for namespacing and to ensure forward compatibility (since no
    elements will be added to HTML, SVG, or MathML with hyphen-containing local names in the
    future).</li><li><p>They can always be created with <code id=custom-elements-core-concepts:dom-document-createelement><a data-x-internal=dom-document-createelement href=https://triple-underscore.github.io/DOM4-ja.html#dom-document-createelement>createElement()</a></code> and <code id=custom-elements-core-concepts:dom-document-createelementns><a data-x-internal=dom-document-createelementns href=https://triple-underscore.github.io/DOM4-ja.html#dom-document-createelementns>createElementNS()</a></code>, which have restrictions that go
    beyond the parser's.</li></ul>

   <p>Apart from these restrictions, a large variety of names is allowed, to give maximum
   flexibility for use cases like <code>&lt;math-Î±&gt;</code> or <code>&lt;emotion-ğŸ˜&gt;</code>.</p>
  </div>

  <p>A <dfn id=custom-element-definition>custom element definition</dfn> describes a <a href=#custom-element id=custom-elements-core-concepts:custom-element-3>custom element</a> and consists
  of:</p>

  <dl><dt>A <dfn data-dfn-for="custom element definition" id=concept-custom-element-definition-name data-export="">name</dfn><dd>A <a href=#valid-custom-element-name id=custom-elements-core-concepts:valid-custom-element-name-3>valid custom element name</a><dt>A <dfn data-dfn-for="custom element definition" id=concept-custom-element-definition-local-name data-export="">local name</dfn><dd>A local name<dt>A <dfn data-dfn-for="custom element definition" id=concept-custom-element-definition-constructor data-export="">constructor</dfn><dd>A Web IDL <code id=custom-elements-core-concepts:idl-function><a data-x-internal=idl-function href=https://triple-underscore.github.io/WebIDL-ja.html#common-Function>Function</a></code> callback function type value wrapping
   the <a href=#custom-element-constructor id=custom-elements-core-concepts:custom-element-constructor>custom element constructor</a><dt>A list of <dfn id=concept-custom-element-definition-observed-attributes>observed
   attributes</dfn><dd>A <code>sequence&lt;DOMString&gt;</code><dt>A collection of <dfn id=concept-custom-element-definition-lifecycle-callbacks>lifecycle callbacks</dfn><dd>A map, whose four keys are the strings "<code>connectedCallback</code>",
   "<code>disconnectedCallback</code>", "<code>adoptedCallback</code>", and
   "<code>attributeChangedCallback</code>". The corresponding values are either a Web IDL
   <code id=custom-elements-core-concepts:idl-function-2><a data-x-internal=idl-function href=https://triple-underscore.github.io/WebIDL-ja.html#common-Function>Function</a></code> callback function type value, or null. By default the
   value of each entry is null.<dt>A <dfn id=concept-custom-element-definition-construction-stack>construction
   stack</dfn><dd>A list, initially empty, that is manipulated by the <a href=#concept-upgrade-an-element id=custom-elements-core-concepts:concept-upgrade-an-element>upgrade an element</a> algorithm and the <a href=#html-element-constructors>HTML element constructors</a>. Each entry in the list will be
   either an element or an <dfn id=concept-already-constructed-marker><i>already
   constructed</i> marker</dfn>.</dl>

  <p>To <dfn id=look-up-a-custom-element-definition data-export="">look up a custom element definition</dfn>, given a <var>document</var>,
  <var>namespace</var>, <var>localName</var>, and <var>is</var>, perform the following steps. They
  will return either a <a href=#custom-element-definition id=custom-elements-core-concepts:custom-element-definition>custom element definition</a> or null:</p>

  <ol><li><p>If <var>namespace</var> is not the <a id=custom-elements-core-concepts:html-namespace-2 href=https://triple-underscore.github.io/infra-ja.html#html-namespace data-x-internal=html-namespace-2>HTML namespace</a>, return null.</li><li><p>If <var>document</var> does not have a <a href=browsers.html#concept-document-bc id=custom-elements-core-concepts:concept-document-bc>browsing
   context</a>, return null.</li><li><p>Let <var>registry</var> be <var>document</var>'s <a href=browsers.html#concept-document-bc id=custom-elements-core-concepts:concept-document-bc-2>browsing context</a>'s <code>Window</code>'s
   <code>CustomElementRegistry</code> object.</li><li><p>If there is <a href=#custom-element-definition id=custom-elements-core-concepts:custom-element-definition-2>custom element definition</a> in <var>registry</var> with <a href=#concept-custom-element-definition-name id=custom-elements-core-concepts:concept-custom-element-definition-name-3>name</a> and <a href=#concept-custom-element-definition-local-name id=custom-elements-core-concepts:concept-custom-element-definition-local-name>local name</a> both equal to
   <var>localName</var>, return that <a href=#custom-element-definition id=custom-elements-core-concepts:custom-element-definition-3>custom element definition</a>.</li><li><p>If there is a <a href=#custom-element-definition id=custom-elements-core-concepts:custom-element-definition-4>custom element definition</a> in <var>registry</var> with <a href=#concept-custom-element-definition-name id=custom-elements-core-concepts:concept-custom-element-definition-name-4>name</a> equal to <var>is</var> and <a href=#concept-custom-element-definition-local-name id=custom-elements-core-concepts:concept-custom-element-definition-local-name-2>local name</a> equal to
   <var>localName</var>, return that <a href=#custom-element-definition id=custom-elements-core-concepts:custom-element-definition-5>custom element definition</a>.</li><li><p>Return null.</li></ol>

  <h4 id=custom-elements-api><span class=secno>4.13.4</span> The <code>CustomElementRegistry</code> interface<a href=#custom-elements-api class=self-link></a></h4>

  <p>Each <code>Window</code> object is associated with a unique instance of a
  <code>CustomElementRegistry</code> object, allocated when the <code>Window</code> object is
  created.</p>

  <p class=note>Custom element registries are associated with <code>Window</code> objects, instead
  of <code>Document</code> objects, since each <a href=#custom-element-constructor id=custom-elements-api:custom-element-constructor>custom element constructor</a> inherits from
  the <code>HTMLElement</code> interface, and there is exactly one <code>HTMLElement</code>
  interface per <code>Window</code> object.</p>

  <p>The <dfn id=dom-window-customelements><code>customElements</code></dfn> attribute of the
  <code>Window</code> interface must return the <code>CustomElementRegistry</code> object for that
  <code>Window</code> object.</p>

  

  <p>Every <code>CustomElementRegistry</code> has a set of <a href=#custom-element-definition id=custom-elements-api:custom-element-definition>custom element definitions</a>, initially empty. In general, algorithms in this
  specification look up elements in the registry by any of <a href=#concept-custom-element-definition-name id=custom-elements-api:concept-custom-element-definition-name>name</a>, <a href=#concept-custom-element-definition-local-name id=custom-elements-api:concept-custom-element-definition-local-name>local name</a>, or <a href=#concept-custom-element-definition-constructor id=custom-elements-api:concept-custom-element-definition-constructor>constructor</a>.</p>

  <p>Every <code>CustomElementRegistry</code> also has an <dfn id=element-definition-is-running>element definition is running</dfn>
  flag which is used to prevent reentrant invocations of <a href=#element-definition id=custom-elements-api:element-definition>element definition</a>. It is
  initially unset.</p>

  <p>Every <code>CustomElementRegistry</code> also has a <dfn id=when-defined-promise-map>when-defined promise map</dfn>,
  mapping <a href=#valid-custom-element-name id=custom-elements-api:valid-custom-element-name>valid custom element names</a> to promises. It
  is used to implement the <code id=custom-elements-api:dom-customelementregistry-whendefined-2><a href=#dom-customelementregistry-whendefined-2>whenDefined()</a></code> method.</p>

  <dl class=domintro><dt><var>window</var> . <code id=custom-elements-api:dom-window-customelements><a href=#dom-window-customelements>customElements</a></code> . <code id=dom-customelementregistry-define><a href=#dom-customelementregistry-define-2>define</a></code>(<var>name</var>,
   <var>constructor</var>)<dd>Defines a new <a href=#custom-element id=custom-elements-api:custom-element>custom element</a>, mapping the given name to the given constructor as
   an <a href=#autonomous-custom-element id=custom-elements-api:autonomous-custom-element>autonomous custom element</a>.<dt><var>window</var> . <code id=custom-elements-api:dom-window-customelements-2><a href=#dom-window-customelements>customElements</a></code> . <code id=custom-elements-api:dom-customelementregistry-define-2><a href=#dom-customelementregistry-define-2>define</a></code>(<var>name</var>, <var>constructor</var>,
   { extends: <var>baseLocalName</var> })<dd>Defines a new <a href=#custom-element id=custom-elements-api:custom-element-2>custom element</a>, mapping the given name to the given constructor as
   a <a href=#customized-built-in-element id=custom-elements-api:customized-built-in-element>customized built-in element</a> for the <a id=custom-elements-api:element-type href=infrastructure.html#element-type>element type</a> identified by the
   supplied <var>baseLocalName</var>. A <a id=custom-elements-api:notsupportederror href=https://triple-underscore.github.io/WebIDL-ja.html#notsupportederror data-x-internal=notsupportederror>"<code>NotSupportedError</code>"</a>
   <code id=custom-elements-api:domexception><a data-x-internal=domexception href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException>DOMException</a></code> will be thrown upon trying to extend a <a href=#custom-element id=custom-elements-api:custom-element-3>custom element</a> or
   an unknown element.<dt><var>window</var> . <code id=custom-elements-api:dom-window-customelements-3><a href=#dom-window-customelements>customElements</a></code> . <code id=dom-customelementregistry-get><a href=#dom-customelementregistry-get-2>get</a></code>(<var>name</var>)<dd>Retrieves the <a href=#custom-element-constructor id=custom-elements-api:custom-element-constructor-2>custom element constructor</a> defined for the given <a href=#concept-custom-element-definition-name id=custom-elements-api:concept-custom-element-definition-name-2>name</a>. Returns undefined if there is no
   <a href=#custom-element-definition id=custom-elements-api:custom-element-definition-2>custom element definition</a> with the given <a href=#concept-custom-element-definition-name id=custom-elements-api:concept-custom-element-definition-name-3>name</a>.<dt><var>window</var> . <code id=custom-elements-api:dom-window-customelements-4><a href=#dom-window-customelements>customElements</a></code> . <code id=dom-customelementregistry-whendefined><a href=#dom-customelementregistry-whendefined-2>whenDefined</a></code>(<var>name</var>)<dd>Returns a promise that will be fulfilled when a <a href=#custom-element id=custom-elements-api:custom-element-4>custom element</a> becomes defined
   with the given name. (If such a <a href=#custom-element id=custom-elements-api:custom-element-5>custom element</a> is already defined, the returned
   promise will be immediately fulfilled.) Returns a promise rejected with a
   <a id=custom-elements-api:syntaxerror href=https://triple-underscore.github.io/WebIDL-ja.html#syntaxerror data-x-internal=syntaxerror>"<code>SyntaxError</code>"</a> <code id=custom-elements-api:domexception-2><a data-x-internal=domexception href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException>DOMException</a></code> if not given a <a href=#valid-custom-element-name id=custom-elements-api:valid-custom-element-name-2>valid
   custom element name</a>.</dl>

  <p><dfn id=element-definition>Element definition</dfn> is a process of adding a <a href=#custom-element-definition id=custom-elements-api:custom-element-definition-3>custom element definition</a>
  to the <code>CustomElementRegistry</code>. This is accomplished by the <code id=custom-elements-api:dom-customelementregistry-define-2-2><a href=#dom-customelementregistry-define-2>define()</a></code> method. When invoked, the <dfn id=dom-customelementregistry-define-2><code>define(<var>name</var>, <var>constructor</var>,
  <var>options</var>)</code></dfn> method must run these steps:</p>

  <ol><li><p>If <a id=custom-elements-api:isconstructor href=https://tc39.github.io/ecma262/#sec-isconstructor data-x-internal=isconstructor>IsConstructor</a>(<var>constructor</var>) is false, then throw a
   <code id=custom-elements-api:typeerror><a data-x-internal=typeerror href=https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror>TypeError</a></code> and abort these steps.</li><li><p>If <var>name</var> is not a <a href=#valid-custom-element-name id=custom-elements-api:valid-custom-element-name-3>valid custom element name</a>, then throw a
   <a id=custom-elements-api:syntaxerror-2 href=https://triple-underscore.github.io/WebIDL-ja.html#syntaxerror data-x-internal=syntaxerror>"<code>SyntaxError</code>"</a> <code id=custom-elements-api:domexception-3><a data-x-internal=domexception href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException>DOMException</a></code> and abort these steps.</li><li><p>If this <code>CustomElementRegistry</code> contains an entry with <a href=#concept-custom-element-definition-name id=custom-elements-api:concept-custom-element-definition-name-4>name</a> <var>name</var>, then throw a
   <a id=custom-elements-api:notsupportederror-2 href=https://triple-underscore.github.io/WebIDL-ja.html#notsupportederror data-x-internal=notsupportederror>"<code>NotSupportedError</code>"</a> <code id=custom-elements-api:domexception-4><a data-x-internal=domexception href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException>DOMException</a></code> and abort these
   steps.</li><li><p>If this <code>CustomElementRegistry</code> contains an entry with <a href=#concept-custom-element-definition-constructor id=custom-elements-api:concept-custom-element-definition-constructor-2>constructor</a> <var>constructor</var>,
   then throw a <a id=custom-elements-api:notsupportederror-3 href=https://triple-underscore.github.io/WebIDL-ja.html#notsupportederror data-x-internal=notsupportederror>"<code>NotSupportedError</code>"</a> <code id=custom-elements-api:domexception-5><a data-x-internal=domexception href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException>DOMException</a></code> and abort
   these steps.</li><li><p>Let <var>localName</var> be <var>name</var>.</li><li><p>Let <var>extends</var> be the value of the <code>extends</code> member of
   <var>options</var>, or null if no such member exists.</li><li>
    <p>If <var>extends</var> is not null, then:</p>

    <ol><li><p>If <var>extends</var> is a <a href=#valid-custom-element-name id=custom-elements-api:valid-custom-element-name-4>valid custom element name</a>, then throw a
     <a id=custom-elements-api:notsupportederror-4 href=https://triple-underscore.github.io/WebIDL-ja.html#notsupportederror data-x-internal=notsupportederror>"<code>NotSupportedError</code>"</a> <code id=custom-elements-api:domexception-6><a data-x-internal=domexception href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException>DOMException</a></code>.</li><li><p>If the <a id=custom-elements-api:element-interface href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-interface data-x-internal=element-interface>element interface</a> for <var>extends</var> and the <a id=custom-elements-api:html-namespace-2 href=https://triple-underscore.github.io/infra-ja.html#html-namespace data-x-internal=html-namespace-2>HTML
     namespace</a> is <code>HTMLUnknownElement</code> (e.g., if <var>extends</var> does not
     indicate an element definition in this specification), then throw a
     <a id=custom-elements-api:notsupportederror-5 href=https://triple-underscore.github.io/WebIDL-ja.html#notsupportederror data-x-internal=notsupportederror>"<code>NotSupportedError</code>"</a> <code id=custom-elements-api:domexception-7><a data-x-internal=domexception href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException>DOMException</a></code>.</li><li><p>Set <var>localName</var> to <var>extends</var>.</li></ol>
   </li><li><p>If this <code>CustomElementRegistry</code>'s <a href=#element-definition-is-running id=custom-elements-api:element-definition-is-running>element definition is running</a>
   flag is set, then throw a <a id=custom-elements-api:notsupportederror-6 href=https://triple-underscore.github.io/WebIDL-ja.html#notsupportederror data-x-internal=notsupportederror>"<code>NotSupportedError</code>"</a> <code id=custom-elements-api:domexception-8><a data-x-internal=domexception href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException>DOMException</a></code>
   and abort these steps.</li><li><p>Set this <code>CustomElementRegistry</code>'s <a href=#element-definition-is-running id=custom-elements-api:element-definition-is-running-2>element definition is running</a>
   flag.</li><li>
    <p>Run the following substeps while catching any exceptions:</p>

    <ol><li><p>Let <var>prototype</var> be <a href=https://tc39.github.io/ecma262/#sec-get-o-p id=custom-elements-api:js-get data-x-internal=js-get>Get</a>(<var>constructor</var>, "prototype"). ä¾‹å¤–ã‚’å†åº¦æŠ•ã’ã‚‹ã€‚</li><li><p>If <a href=https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values id=custom-elements-api:js-type data-x-internal=js-type>Type</a>(<var>prototype</var>) is not Object, then throw a
     <code id=custom-elements-api:typeerror-2><a data-x-internal=typeerror href=https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror>TypeError</a></code> exception.</li><li><p>Let <var>lifecycleCallbacks</var> be a map with the four keys "<code>connectedCallback</code>", "<code>disconnectedCallback</code>", "<code>adoptedCallback</code>", and "<code>attributeChangedCallback</code>", each
     of which belongs to an entry whose value is null.</p>

     </li><li>
      <p>For each of the four keys <var>callbackName</var> in <var>lifecycleCallbacks</var>, in the
      order listed in the previous step:</p>

      <ol><li><p>Let <var>callbackValue</var> be <a href=https://tc39.github.io/ecma262/#sec-get-o-p id=custom-elements-api:js-get-2 data-x-internal=js-get>Get</a>(<var>prototype</var>, <var>callbackName</var>). ä¾‹å¤–ã‚’å†åº¦æŠ•ã’ã‚‹ã€‚</p>

       </li><li><p>If <var>callbackValue</var> is not undefined, then set the value of the entry in
       <var>lifecycleCallbacks</var> with key <var>callbackName</var> to the result of <a href=https://triple-underscore.github.io/WebIDL-ja.html#es-type-mapping id=custom-elements-api:concept-idl-convert data-x-internal=concept-idl-convert>converting</a> <var>callbackValue</var> to the Web IDL
       <code id=custom-elements-api:idl-function><a data-x-internal=idl-function href=https://triple-underscore.github.io/WebIDL-ja.html#common-Function>Function</a></code> callback type. Rethrow any exceptions from the
       conversion.</li></ol>
     </li><li><p>Let <var>observedAttributes</var> be an empty <code>sequence&lt;DOMString&gt;</code>.</li><li>
      <p>If the value of the entry in <var>lifecycleCallbacks</var> with key "<code>attributeChangedCallback</code>" is not null, then:</p>

      <ol><li><p>Let <var>observedAttributesIterable</var> be <a href=https://tc39.github.io/ecma262/#sec-get-o-p id=custom-elements-api:js-get-3 data-x-internal=js-get>Get</a>(<var>constructor</var>, "observedAttributes"). ä¾‹å¤–ã‚’å†åº¦æŠ•ã’ã‚‹ã€‚</li><li><p>If <var>observedAttributesIterable</var> is not undefined, then set
       <var>observedAttributes</var> to the result of <a href=https://triple-underscore.github.io/WebIDL-ja.html#es-type-mapping id=custom-elements-api:concept-idl-convert-2 data-x-internal=concept-idl-convert>converting</a> <var>observedAttributesIterable</var> to a
       <code>sequence&lt;DOMString&gt;</code>. Rethrow any exceptions from the
       conversion.</li></ol>
    </li></ol>

    <p>Then, perform the following substep, regardless of whether the above steps threw an exception
    or not:</p>

    <ol><li><p>Unset this <code>CustomElementRegistry</code>'s <a href=#element-definition-is-running id=custom-elements-api:element-definition-is-running-3>element definition is
     running</a> flag.</li></ol>

    <p>Finally, if the first set of substeps threw an exception, then rethrow that exception, and
    terminate this algorithm. Otherwise, continue onward.</p>
   </li><li><p>Let <var>definition</var> be a new <a href=#custom-element-definition id=custom-elements-api:custom-element-definition-4>custom element definition</a> with <a href=#concept-custom-element-definition-name id=custom-elements-api:concept-custom-element-definition-name-5>name</a> <var>name</var>, <a href=#concept-custom-element-definition-local-name id=custom-elements-api:concept-custom-element-definition-local-name-2>local name</a> <var>localName</var>,
   <a href=#concept-custom-element-definition-constructor id=custom-elements-api:concept-custom-element-definition-constructor-3>constructor</a>
   <var>constructor</var>, <a href=#concept-custom-element-definition-observed-attributes id=custom-elements-api:concept-custom-element-definition-observed-attributes>observed attributes</a>
   <var>observedAttributes</var>, and <a href=#concept-custom-element-definition-lifecycle-callbacks id=custom-elements-api:concept-custom-element-definition-lifecycle-callbacks>lifecycle callbacks</a>
   <var>lifecycleCallbacks</var>.</li><li><p>Add <var>definition</var> to this <code>CustomElementRegistry</code>.</li><li><p>Let <var>document</var> be this <code>CustomElementRegistry</code>'s <span>relevant global object</span>'s <span>associated <code>Document</code></span>.</li><li><p>Let <var>upgrade candidates</var> be all elements that are <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-shadow-including-descendant id=custom-elements-api:shadow-including-descendant data-x-internal=shadow-including-descendant>shadow-including descendants</a> of <var>document</var>, whose namespace
   is the <a id=custom-elements-api:html-namespace-2-2 href=https://triple-underscore.github.io/infra-ja.html#html-namespace data-x-internal=html-namespace-2>HTML namespace</a> and whose local name is <var>localName</var>, in
   <a id=custom-elements-api:shadow-including-tree-order href=https://triple-underscore.github.io/DOM4-ja.html#concept-shadow-including-tree-order data-x-internal=shadow-including-tree-order>shadow-including tree order</a>. Additionally, if <var>extends</var> is non-null, only
   include elements whose <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-is-value id=custom-elements-api:concept-element-is-value data-x-internal=concept-element-is-value><code>is</code>
   value</a> is equal to <var>name</var>.</li><li><p>For each element <var>element</var> in <var>upgrade candidates</var>, <a href=#enqueue-a-custom-element-upgrade-reaction id=custom-elements-api:enqueue-a-custom-element-upgrade-reaction>enqueue a
   custom element upgrade reaction</a> given <var>element</var> and
   <var>definition</var>.</li><li>
    <p>If this <code>CustomElementRegistry</code>'s <a href=#when-defined-promise-map id=custom-elements-api:when-defined-promise-map>when-defined promise map</a>
    contains an entry with key <var>name</var>:</p>

    <ol><li><p>Let <var>promise</var> be the value of that entry.</li><li><p>Resolve <var>promise</var> with undefined.</li><li><p>Delete the entry with key <var>name</var> from this
     <code>CustomElementRegistry</code>'s <a href=#when-defined-promise-map id=custom-elements-api:when-defined-promise-map-2>when-defined promise map</a>.</li></ol>
   </li></ol>

  <p>When invoked, the <dfn id=dom-customelementregistry-get-2><code>get(<var>name</var>)</code></dfn> method must run these
  steps:</p>

  <ol><li><p>If this <code>CustomElementRegistry</code> contains an entry with <a href=#concept-custom-element-definition-name id=custom-elements-api:concept-custom-element-definition-name-6>name</a> <var>name</var>, then return that
   entry's <a href=#concept-custom-element-definition-constructor id=custom-elements-api:concept-custom-element-definition-constructor-4>constructor</a>.</li><li><p>Otherwise, return undefined.</li></ol>

  <p>When invoked, the <dfn id=dom-customelementregistry-whendefined-2><code>whenDefined(<var>name</var>)</code></dfn> method
  must run these steps:</p>

  <ol><li><p>If <var>name</var> is not a <a href=#valid-custom-element-name id=custom-elements-api:valid-custom-element-name-5>valid custom element name</a>, then return a new
   promise rejected with a <a id=custom-elements-api:syntaxerror-3 href=https://triple-underscore.github.io/WebIDL-ja.html#syntaxerror data-x-internal=syntaxerror>"<code>SyntaxError</code>"</a> <code id=custom-elements-api:domexception-9><a data-x-internal=domexception href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException>DOMException</a></code> and
   abort these steps.</li><li><p>If this <code>CustomElementRegistry</code> contains an entry with <a href=#concept-custom-element-definition-name id=custom-elements-api:concept-custom-element-definition-name-7>name</a> <var>name</var>, then return a new
   promise resolved with undefined and abort these steps.</li><li><p>Let <var>map</var> be this <code>CustomElementRegistry</code>'s <a href=#when-defined-promise-map id=custom-elements-api:when-defined-promise-map-3>when-defined
   promise map</a>.</li><li><p>If <var>map</var> does not contain an entry with key <var>name</var>, create an entry in
   <var>map</var> with key <var>name</var> and whose value is a new promise.</li><li><p>Let <var>promise</var> be the value of the entry in <var>map</var> with key
   <var>name</var>.</li><li><p>Return <var>promise</var>.</li></ol>

  <div class=example>
   <p>The <code id=custom-elements-api:dom-customelementregistry-whendefined-2-2><a href=#dom-customelementregistry-whendefined-2>whenDefined()</a></code> method can be
   used to avoid performing an action until all appropriate <a href=#custom-element id=custom-elements-api:custom-element-6>custom
   elements</a> are <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-defined id=custom-elements-api:concept-element-defined data-x-internal=concept-element-defined>defined</a>. In this example, we
   combine it with the <code>:defined</code> pseudo-class to hide a
   dynamically-loaded article's contents until we're sure that all of the <a href=#autonomous-custom-element id=custom-elements-api:autonomous-custom-element-2>autonomous custom elements</a> it uses are defined.</p>

   <pre>articleContainer.hidden = true;

fetch(articleURL)
  .then(response =&gt; response.text())
  .then(text =&gt; {
    articleContainer.innerHTML = text;

    return Promise.all(
      [...articleContainer.querySelectorAll(":not(:defined)")]
        .map(el =&gt; customElements.whenDefined(el.localName))
    );
  })
  .then(() =&gt; {
    articleContainer.hidden = false;
  });</pre>
  </div>

  <h4 id=upgrades><span class=secno>4.13.5</span> <dfn>Upgrades</dfn><a href=#upgrades class=self-link></a></h4>

  <p>To <dfn id=concept-upgrade-an-element data-export="">upgrade an element</dfn>, given as
  input a <a href=#custom-element-definition id=upgrades:custom-element-definition>custom element definition</a> <var>definition</var> and an element
  <var>element</var>, run the following steps:</p>

  <ol><li>
    <p>If <var>element</var> is <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-custom id=upgrades:concept-element-custom data-x-internal=concept-element-custom>custom</a>, abort these
    steps.</p>

    <div class=example>
     <p>This can occur due to reentrant invocation of this algorithm, as in the following
     example:</p>

     <pre>&lt;!DOCTYPE html&gt;
&lt;x-foo id="a"&gt;&lt;/x-foo&gt;
&lt;x-foo id="b"&gt;&lt;/x-foo&gt;

&lt;script&gt;
// Defining enqueues upgrade reactions for both "a" and "b"
customElements.define("x-foo", class extends HTMLElement {
  constructor() {
    super();

    const b = document.querySelector("#b");
    b.remove();

    // While this constructor is running for "a", "b" is still
    // undefined, and so inserting it into the document will enqueue a
    // second upgrade reaction for "b" in addition to the one enqueued
    // by defining x-foo.
    document.body.appendChild(b);
  }
})
&lt;/script&gt;</pre>

     <p>This step will thus bail out the algorithm early when <a href=#concept-upgrade-an-element id=upgrades:concept-upgrade-an-element>upgrade an element</a> is invoked
     with "<code>b</code>" a second time.</p>
    </div>
   </li><li><p>If <var>element</var>'s <a id=upgrades:custom-element-state href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-custom-element-state data-x-internal=custom-element-state>custom element state</a> is "<code>failed</code>", then abort these steps.</li><li><p>For each <var>attribute</var> in <var>element</var>'s <a id=upgrades:attribute-list href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-attribute data-x-internal=attribute-list>attribute list</a>, in
   order, <a href=#enqueue-a-custom-element-callback-reaction id=upgrades:enqueue-a-custom-element-callback-reaction>enqueue a custom element callback reaction</a> with <var>element</var>, callback
   name "<code>attributeChangedCallback</code>", and an argument list containing
   <var>attribute</var>'s local name, null, <var>attribute</var>'s value, and <var>attribute</var>'s
   namespace.</li><li><p>If <var>element</var> is <a id=upgrades:connected href=https://triple-underscore.github.io/DOM4-ja.html#connected data-x-internal=connected>connected</a>, then <a href=#enqueue-a-custom-element-callback-reaction id=upgrades:enqueue-a-custom-element-callback-reaction-2>enqueue a custom element
   callback reaction</a> with <var>element</var>, callback name "<code>connectedCallback</code>", and an empty argument list.</li><li><p>Add <var>element</var> to the end of <var>definition</var>'s <a href=#concept-custom-element-definition-construction-stack id=upgrades:concept-custom-element-definition-construction-stack>construction stack</a>.</li><li><p>Let <var>C</var> be <var>definition</var>'s <a href=#concept-custom-element-definition-constructor id=upgrades:concept-custom-element-definition-constructor>constructor</a>.</li><li>
    <p>Run the following substeps while catching any exceptions:</p>

    <ol><li>
      <p>Let <var>constructResult</var> be the result of <a href=https://heycam.github.io/webidl/#construct-a-callback-function id=upgrades:es-constructing-callback-functions data-x-internal=es-constructing-callback-functions>constructing</a> <var>C</var>, with no
      arguments.</p>

      <p class=note>If <var>C</var> <a href=#custom-element-conformance>non-conformantly</a>
      uses an API decorated with the <code id=upgrades:cereactions><a href=#cereactions>[CEReactions]</a></code> extended
      attribute, then the reactions enqueued at the beginning of this algorithm will execute during
      this step, before <var>C</var> finishes and control returns to this algorithm. Otherwise, they
      will execute after <var>C</var> and the rest of the upgrade process finishes.</p>
     </li><li>
      <p>If <a id=upgrades:samevalue href=https://tc39.github.io/ecma262/#sec-samevalue data-x-internal=samevalue>SameValue</a>(<var>constructResult</var>, <var>element</var>) is false,
      then throw an <a id=upgrades:invalidstateerror href=https://triple-underscore.github.io/WebIDL-ja.html#invalidstateerror data-x-internal=invalidstateerror>"<code>InvalidStateError</code>"</a> <code id=upgrades:domexception><a data-x-internal=domexception href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-DOMException>DOMException</a></code>.</p>

      <p class=note>This can occur if <var>C</var> constructs another instance of the same custom
      element before calling <code>super()</code>, or if <var>C</var> uses JavaScript's
      <code>return</code>-override feature to return an arbitrary object from the
      constructor.</p>
     </li></ol>

    <p>Then, perform the following substep, regardless of whether the above steps threw an exception
    or not:</p>

    <ol><li>
      <p>Remove the last entry from the end of <var>definition</var>'s <a href=#concept-custom-element-definition-construction-stack id=upgrades:concept-custom-element-definition-construction-stack-2>construction stack</a>.</p>

      <div class=note>
       <p>Assuming <var>C</var> calls <code>super()</code> (as it will if it is <a href=#custom-element-conformance>conformant</a>), and that the call succeeds, this will be
       the <a href=#concept-already-constructed-marker id=upgrades:concept-already-constructed-marker><i>already
       constructed</i> marker</a> that replaced the <var>element</var> we pushed at the beginning
       of this algorithm. (The <a href=#html-element-constructors>HTML element constructor</a>
       carries out this replacement.)</p>

       <p>If <var>C</var> does not call <code>super()</code> (i.e. it is not <a href=#custom-element-conformance>conformant</a>), or if any step in the <a href=#html-element-constructors>HTML element constructor</a> throws, then this entry will
       still be <var>element</var>.</p>
      </div>
     </li></ol>

    <p>Finally, if the above steps threw an exception, then:</p>

    <ol><li><p>Set <var>element</var>'s <a id=upgrades:custom-element-state-2 href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-custom-element-state data-x-internal=custom-element-state>custom element state</a> to "<code>failed</code>".</li><li><p>Empty <var>element</var>'s <a href=#custom-element-reaction-queue id=upgrades:custom-element-reaction-queue>custom element reaction queue</a>.</p>

     </li><li><p>Rethrow the exception, and terminate this algorithm.</li></ol>
   </li><li><p>Set <var>element</var>'s <a id=upgrades:custom-element-state-3 href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-custom-element-state data-x-internal=custom-element-state>custom element state</a> to "<code>custom</code>".</li><li><p>Set <var>element</var>'s <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-custom-element-definition id=upgrades:concept-element-custom-element-definition data-x-internal=concept-element-custom-element-definition>custom
   element definition</a> to <var>definition</var>.</li></ol>

  <p>To <dfn id=concept-try-upgrade data-export="">try to upgrade an element</dfn>, given as
  input an element <var>element</var>, run the following steps:</p>

  <ol><li><p>Let <var>definition</var> be the result of <a href=#look-up-a-custom-element-definition id=upgrades:look-up-a-custom-element-definition>looking up a custom element definition</a> given <var>element</var>'s <a id=upgrades:node-document href=https://triple-underscore.github.io/DOM4-ja.html#concept-node-document data-x-internal=node-document>node
   document</a>, <var>element</var>'s namespace, <var>element</var>'s local name, and
   <var>element</var>'s <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-is-value id=upgrades:concept-element-is-value data-x-internal=concept-element-is-value><code>is</code>
   value</a>.</li><li><p>If <var>definition</var> is not null, then <a href=#enqueue-a-custom-element-upgrade-reaction id=upgrades:enqueue-a-custom-element-upgrade-reaction>enqueue a custom element upgrade
   reaction</a> given <var>element</var> and <var>definition</var>.</li></ol>

  <h4 id=custom-element-reactions><span class=secno>4.13.6</span> Custom element reactions<a href=#custom-element-reactions class=self-link></a></h4>

  <p>A <a href=#custom-element id=custom-element-reactions:custom-element>custom element</a> possesses the ability to respond to certain occurrences by
  running author code:</p>

  <ul><li><p>When <a href=#upgrades id=custom-element-reactions:upgrades>upgraded</a>, its <a href=#custom-element-constructor id=custom-element-reactions:custom-element-constructor>constructor</a> is run.</li><li><p>When it <a id=custom-element-reactions:becomes-connected href=infrastructure.html#becomes-connected>becomes connected</a>, its <code>connectedCallback</code> is
   run.</li><li><p>When it <a id=custom-element-reactions:becomes-disconnected href=infrastructure.html#becomes-disconnected>becomes disconnected</a>, its <code>disconnectedCallback</code>
   is run.</li><li><p>When it is <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-node-adopt id=custom-element-reactions:concept-node-adopt data-x-internal=concept-node-adopt>adopted</a> into a new document, its <code>adoptedCallback</code> is run.</li><li><p>When any of its attributes are <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-attributes-change id=custom-element-reactions:concept-element-attributes-change data-x-internal=concept-element-attributes-change>changed</a>, <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-attributes-append id=custom-element-reactions:concept-element-attributes-append data-x-internal=concept-element-attributes-append>appended</a>, <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-attributes-remove id=custom-element-reactions:concept-element-attributes-remove data-x-internal=concept-element-attributes-remove>removed</a>, or <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-attributes-replace id=custom-element-reactions:concept-element-attributes-replace data-x-internal=concept-element-attributes-replace>replaced</a>, its <code>attributeChangedCallback</code> is run.</li></ul>

  <p>We call these reactions collectively <dfn id=concept-custom-element-reaction>custom
  element reactions</dfn>.</p>

  <p>The way in which <a href=#concept-custom-element-reaction id=custom-element-reactions:concept-custom-element-reaction>custom element reactions</a>
  are invoked is done with special care, to avoid running author code during the middle of delicate
  operations. Effectively, they are delayed until "just before returning to user script". This means
  that for most purposes they appear to execute synchronously, but in the case of complicated
  composite operations (like <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-node-clone id=custom-element-reactions:concept-node-clone data-x-internal=concept-node-clone>cloning</a>, or <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-range id=custom-element-reactions:concept-range data-x-internal=concept-range>range</a> manipulation), they will instead be delayed until after all
  the relevant user agent processing steps have completed, and then run together as a batch.</p>

  <p>Additionally, the precise ordering of these reactions is managed via a somewhat-complicated
  stack-of-queues system, described below. The intention behind this system is to guarantee that
  <a href=#concept-custom-element-reaction id=custom-element-reactions:concept-custom-element-reaction-2>custom element reactions</a> always are invoked
  in the same order as their triggering actions, at least within the local context of a single
  <a href=#custom-element id=custom-element-reactions:custom-element-2>custom element</a>. (Because <a href=#concept-custom-element-reaction id=custom-element-reactions:concept-custom-element-reaction-3>custom
  element reaction</a> code can perform its own mutations, it is not possible to give a global
  ordering guarantee across multiple elements.)</p>

  <hr>

  <p>Each <span>unit of related similar-origin browsing contexts</span> has a <dfn id=custom-element-reactions-stack>custom element
  reactions stack</dfn>, which is initially empty. The <dfn id=current-element-queue>current element queue</dfn> is the
  <a href=#element-queue id=custom-element-reactions:element-queue>element queue</a> at the top of the <a href=#custom-element-reactions-stack id=custom-element-reactions:custom-element-reactions-stack>custom element reactions stack</a>. Each
  item in the stack is an <dfn id=element-queue>element queue</dfn>, which is initially empty as well. Each item in
  an <a href=#element-queue id=custom-element-reactions:element-queue-2>element queue</a> is an element. (The elements are not necessarily <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-custom id=custom-element-reactions:concept-element-custom data-x-internal=concept-element-custom>custom</a> yet, since this queue is used for <a href=#upgrades id=custom-element-reactions:upgrades-2>upgrades</a> as well.)</p>

  <p>Each <a href=#custom-element-reactions-stack id=custom-element-reactions:custom-element-reactions-stack-2>custom element reactions stack</a> has an associated <dfn id=backup-element-queue>backup element
  queue</dfn>, which an initially-empty <a href=#element-queue id=custom-element-reactions:element-queue-3>element queue</a>. Elements are pushed onto the
  <a href=#backup-element-queue id=custom-element-reactions:backup-element-queue>backup element queue</a> during operations that affect the DOM without going through an
  API decorated with <code id=custom-element-reactions:cereactions><a href=#cereactions>[CEReactions]</a></code>, or through the parser's
  <span>create an element for the token</span> algorithm. An example of this is a user-initiated
  editing operation which modifies the descendants or attributes of an <span>editable</span>
  element. To prevent reentrancy when processing the <a href=#backup-element-queue id=custom-element-reactions:backup-element-queue-2>backup element queue</a>, each
  <a href=#custom-element-reactions-stack id=custom-element-reactions:custom-element-reactions-stack-3>custom element reactions stack</a> also has a <dfn id=processing-the-backup-element-queue>processing the backup element
  queue</dfn> flag, initially unset.</p>

  <p>All elements have an associated <dfn id=custom-element-reaction-queue>custom element reaction queue</dfn>, initially empty. Each
  item in the <a href=#custom-element-reaction-queue id=custom-element-reactions:custom-element-reaction-queue>custom element reaction queue</a> is of one of two types:</p>

  <ul><li><p>An <dfn id=upgrade-reaction>upgrade reaction</dfn>, which will <a href=#upgrades id=custom-element-reactions:upgrades-3>upgrade</a> the custom element and contains a <a href=#custom-element-definition id=custom-element-reactions:custom-element-definition>custom
   element definition</a>; or</li><li><p>A <dfn id=callback-reaction>callback reaction</dfn>, which will call a lifecycle callback, and contains a
   callback function as well as a list of arguments.</li></ul>

  <p>ã“ã‚Œã¯ã€æ¬¡ã®æ¨¡å¼å›³ã«ã™ã¹ã¦è¦ç´„ã•ã‚Œã‚‹ï¼š</p>

  <p><img src=https://html.spec.whatwg.org/multipage/images/custom-element-reactions.svg style="width: 80%; max-width: 580px;" alt="A custom element reactions stack consists of a stack of element queues. Zooming in on a particular queue, we see that it contains a number of elements (in our example, &lt;x-a&gt;, then &lt;x-b&gt;, then &lt;x-c&gt;). Any particular element in the queue then has a custom element reaction queue. Zooming in on the custom element reaction queue, we see that it contains a variety of queued-up reactions (in our example, upgrade, then attribute changed, then another attribute changed, then connected)."></p>

  <p>To <dfn id=enqueue-an-element-on-the-appropriate-element-queue>enqueue an element on the appropriate element queue</dfn>, given an element
  <var>element</var>, run the following steps:</p>

  <ol><li>
    <p>If the <a href=#custom-element-reactions-stack id=custom-element-reactions:custom-element-reactions-stack-4>custom element reactions stack</a> is empty, then:</p>

    <ol><li><p>Add <var>element</var> to the <a href=#backup-element-queue id=custom-element-reactions:backup-element-queue-3>backup element queue</a>.</li><li><p>If the <a href=#processing-the-backup-element-queue id=custom-element-reactions:processing-the-backup-element-queue>processing the backup element queue</a> flag is set, abort this
     algorithm.</li><li><p>Set the <a href=#processing-the-backup-element-queue id=custom-element-reactions:processing-the-backup-element-queue-2>processing the backup element queue</a> flag.</li><li>
      <p><span>Queue a microtask</span> to perform the following steps:</p>

      <ol><li><p><a href=#invoke-custom-element-reactions id=custom-element-reactions:invoke-custom-element-reactions>Invoke custom element reactions</a> in the <a href=#backup-element-queue id=custom-element-reactions:backup-element-queue-4>backup element
       queue</a>.</li><li><p>Unset the <a href=#processing-the-backup-element-queue id=custom-element-reactions:processing-the-backup-element-queue-3>processing the backup element queue</a> flag.</li></ol>
     </li></ol>
   </li><li><p>Otherwise, add <var>element</var> to the <a href=#current-element-queue id=custom-element-reactions:current-element-queue>current element queue</a>.</li></ol>

  <p>To <dfn id=enqueue-a-custom-element-callback-reaction data-export="">enqueue a custom element callback reaction</dfn>, given a <a href=#custom-element id=custom-element-reactions:custom-element-3>custom
  element</a> <var>element</var>, a callback name <var>callbackName</var>, and a list of
  arguments <var>args</var>, run the following steps:</p>

  <ol><li><p>Let <var>definition</var> be <var>element</var>'s <a href=https://triple-underscore.github.io/DOM4-ja.html#concept-element-custom-element-definition id=custom-element-reactions:concept-element-custom-element-definition data-x-internal=concept-element-custom-element-definition>custom element definition</a>.</p>

   </li><li><p>Let <var>callback</var> be the value of the entry in <var>definition</var>'s <a href=#concept-custom-element-definition-lifecycle-callbacks id=custom-element-reactions:concept-custom-element-definition-lifecycle-callbacks>lifecycle callbacks</a> with
   key <var>callbackName</var>.</li><li><p>If <var>callback</var> is null, then abort these steps.</li><li>
    <p>If <var>callbackName</var> is "<code>attributeChangedCallback</code>", then:</p>

    <ol><li><p>Let <var>attributeName</var> be the first element of <var>args</var>.</li><li><p>If <var>definition</var>'s <a href=#concept-custom-element-definition-observed-attributes id=custom-element-reactions:concept-custom-element-definition-observed-attributes>observed attributes</a> does
     not contain <var>attributeName</var>, then abort these steps.</li></ol>
   </li><li><p>Add a new <a href=#callback-reaction id=custom-element-reactions:callback-reaction>callback reaction</a> to <var>element</var>'s <a href=#custom-element-reaction-queue id=custom-element-reactions:custom-element-reaction-queue-2>custom element
   reaction queue</a>, with callback function <var>callback</var> and arguments
   <var>args</var>.</li><li><p><a href=#enqueue-an-element-on-the-appropriate-element-queue id=custom-element-reactions:enqueue-an-element-on-the-appropriate-element-queue>Enqueue an element on the appropriate element queue</a> given
   <var>element</var>.</li></ol>

  <p>To <dfn id=enqueue-a-custom-element-upgrade-reaction data-export="">enqueue a custom element upgrade reaction</dfn>, given an element
  <var>element</var> and <a href=#custom-element-definition id=custom-element-reactions:custom-element-definition-2>custom element definition</a> <var>definition</var>, run the
  following steps:</p>

  <ol><li><p>Add a new <a href=#upgrade-reaction id=custom-element-reactions:upgrade-reaction>upgrade reaction</a> to <var>element</var>'s <a href=#custom-element-reaction-queue id=custom-element-reactions:custom-element-reaction-queue-3>custom element
   reaction queue</a>, with <a href=#custom-element-definition id=custom-element-reactions:custom-element-definition-3>custom element definition</a>
   <var>definition</var>.</li><li><p><a href=#enqueue-an-element-on-the-appropriate-element-queue id=custom-element-reactions:enqueue-an-element-on-the-appropriate-element-queue-2>Enqueue an element on the appropriate element queue</a> given
   <var>element</var>.</li></ol>

  <p>To <dfn id=invoke-custom-element-reactions>invoke custom element reactions</dfn> in an <a href=#element-queue id=custom-element-reactions:element-queue-4>element queue</a>
  <var>queue</var>, run the following steps:</p>

  <ol><li>
    <p>For each <a href=#custom-element id=custom-element-reactions:custom-element-4>custom element</a> <var>element</var> in <var>queue</var>:</p>

    <ol><li><p>Let <var>reactions</var> be <var>element</var>'s <a href=#custom-element-reaction-queue id=custom-element-reactions:custom-element-reaction-queue-4>custom element reaction
     queue</a>.</li><li>
      <p>Repeat until <var>reactions</var> is empty:</p>

      <ol><li>
        <p>Remove the first element of <var>reactions</var>, and let <var>reaction</var> be that
        element. Switch on <var>reaction</var>'s type:</p>

        <dl class=switch><dt><a href=#upgrade-reaction id=custom-element-reactions:upgrade-reaction-2>upgrade reaction</a><dd><a href=#concept-upgrade-an-element id=custom-element-reactions:concept-upgrade-an-element>Upgrade</a> <var>element</var> using
         <var>reaction</var>'s <a href=#custom-element-definition id=custom-element-reactions:custom-element-definition-4>custom element definition</a>.<dt><a href=#callback-reaction id=custom-element-reactions:callback-reaction-2>callback reaction</a><dd><a href=https://heycam.github.io/webidl/#invoke-a-callback-function id=custom-element-reactions:es-invoking-callback-functions data-x-internal=es-invoking-callback-functions>Invoke</a> <var>reaction</var>'s
         callback function with <var>reaction</var>'s arguments, and with <var>element</var> as the
         <a href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-callback-this-value id=custom-element-reactions:dfn-callback-this-value data-x-internal=dfn-callback-this-value>callback this value</a>.</dl>

        <p>If this throws an exception, catch it, and <span>report the exception</span>.</p>
       </li></ol>
     </li></ol>
   </li></ol>

  <hr>

  <p>To ensure <a href=#concept-custom-element-reaction id=custom-element-reactions:concept-custom-element-reaction-4>custom element reactions</a> are
  triggered appropriately, we introduce the <dfn data-export="" data-lt=CEReactions data-dfn-type=extended-attribute id=cereactions><code>[CEReactions]</code></dfn> IDL <a id=custom-element-reactions:extended-attribute href=https://triple-underscore.github.io/WebIDL-ja.html#dfn-extended-attribute data-x-internal=extended-attribute>extended
  attribute</a>. It indicates that the relevant algorithm is to be supplemented with additional
  steps in order to appropriately track and invoke <a href=#concept-custom-element-reaction id=custom-element-reactions:concept-custom-element-reaction-5>custom element reactions</a>.</p>

  <p>The <code id=custom-element-reactions:cereactions-2><a href=#cereactions>[CEReactions]</a></code> extended attribute must take no
  arguments, and must not appear on anything other than an operation, attribute, setter, or deleter.
  Additionally, it must not appear on readonly attributes.</p>

  <p>Operations, attributes, setters, or deleters annotated with the <code id=custom-element-reactions:cereactions-3><a href=#cereactions>[CEReactions]</a></code> extended attribute must run the following steps
  surrounding the actions listed in the description of the operation, setter, deleter, or the
  attribute's setter:</p>

  <dl><dt>Before executing the listed actions<dd>Push a new <a href=#element-queue id=custom-element-reactions:element-queue-5>element queue</a> onto the <a href=#custom-element-reactions-stack id=custom-element-reactions:custom-element-reactions-stack-5>custom element reactions
   stack</a>.<dt>After executing the listed actions<dd>Pop the <a href=#element-queue id=custom-element-reactions:element-queue-6>element queue</a> from the <a href=#custom-element-reactions-stack id=custom-element-reactions:custom-element-reactions-stack-6>custom element reactions stack</a>, and
   <a href=#invoke-custom-element-reactions id=custom-element-reactions:invoke-custom-element-reactions-2>invoke custom element reactions</a> in that queue.</dl>

  <div class=note>
   <p>The intent behind this extended attribute is somewhat subtle. One way of accomplishing its
   goals would be to say that every operation, attribute, setter, and deleter on the platform
   must have these steps inserted, and to allow implementers to optimize away
   unnecessary cases (where no DOM mutation is possible that could cause <a href=#concept-custom-element-reaction id=custom-element-reactions:concept-custom-element-reaction-6>custom element reactions</a> to occur).</p>

   <p>However, in practice this imprecision could lead to non-interoperable implementations of <a href=#concept-custom-element-reaction id=custom-element-reactions:concept-custom-element-reaction-7>custom element reactions</a>, as some implementations
   might forget to invoke these steps in some cases. Instead, we settled on the approach of
   explicitly annotating all relevant IDL constructs, as a way of ensuring interoperable behavior
   and helping implementations easily pinpoint all cases where these steps are necessary.</p>
  </div>

  <p>Any nonstandard APIs introduced by the user agent that could modify the DOM in such a way as to
  cause <a href=#enqueue-a-custom-element-callback-reaction id=custom-element-reactions:enqueue-a-custom-element-callback-reaction>enqueuing a custom element
  callback reaction</a> or <a href=#enqueue-a-custom-element-upgrade-reaction id=custom-element-reactions:enqueue-a-custom-element-upgrade-reaction>enqueuing a
  custom element upgrade reaction</a>, for example by modifying any attributes or child elements,
  must also be decorated with the <code id=custom-element-reactions:cereactions-4><a href=#cereactions>[CEReactions]</a></code> attribute.</p>

  <div class=note>
   <p>As of the time of this writing, the following nonstandard or not-yet-standardized APIs are
   known to fall into this category:</p>

   <ul><li><p><code>HTMLElement</code>'s <code>outerText</code> IDL attribute</li><li><p><code>HTMLInputElement</code>'s <code>webkitdirectory</code> and <code>incremental</code> IDL attributes</li><li><p><code>HTMLLinkElement</code>'s <code>disabled</code> and <code>scope</code> IDL attributes</li><li><p><code id=custom-element-reactions:shadowroot><a data-x-internal=shadowroot href=https://triple-underscore.github.io/DOM4-ja.html#interface-shadowroot>ShadowRoot</a></code>'s <code>innerHTML</code> IDL attribute</li></ul>
  </div>


  <nav><a href=canvas.html>â† 4.12.5 canvasè¦ç´ </a> â€“ <a href=./>ç›®æ¬¡</a> â€“ <a href=semantics-other.html>4.14 å°‚ç”¨è¦ç´ ãªã—ã®ä¸€èˆ¬çš„èªå½™ â†’</a></nav>
</body></html>