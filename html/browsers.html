<!DOCTYPE html><html class="split" lang="ja"><script src="https://html.spec.whatwg.org/link-fixup.js" defer=""></script><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"><title>HTML Standard 日本語訳</title><meta content="#3c790a" name="theme-color"><link rel="stylesheet" href="https://resources.whatwg.org/spec.css" crossorigin=""><link rel="stylesheet" href="https://resources.whatwg.org/standard.css" crossorigin=""><link rel="stylesheet" href="https://resources.whatwg.org/standard-shared-with-dev.css" crossorigin=""><link rel="icon" href="https://resources.whatwg.org/logo.svg" crossorigin=""><link rel="stylesheet" href="https://html.spec.whatwg.org/styles.css" crossorigin=""><script>
   function toggleStatus(div) {
     div.parentNode.classList.toggle('wrapped');
   }
   function setLinkFragment(link) {
     link.hash = location.hash;
   }
  </script><body>
  
  <script async="" crossorigin="" src="./html-dfn.js"></script>
  <script data-file-issue-url="https://github.com/momdo/momdo.github.io/issues/new" async="" crossorigin="" src="https://resources.whatwg.org/file-issue.js"></script>
  
  <header id="head" class="head with-buttons"><a href="https://whatwg.org/" class="logo"><img width="100" alt="WHATWG" crossorigin="" src="https://resources.whatwg.org/logo.svg" height="100"></a><hgroup><h1 class="allcaps">HTML</h1><h2 id="living-standard" class="no-num no-toc">Living Standard — Last Updated <span class="pubdate">18 October 2021</span></h2></hgroup>
   
   

   
  </header>

  

  

  

  
  

  
  

  

  <nav><a href="dnd.html">← 6.9 ドラッグアンドドロップ</a> — <a href="./">目次</a> — <a href="window-object.html">7.3 Windowオブジェクト →</a></nav><ol class="toc"><li id="toc-browsers"><a href="browsers.html#browsers"><span class="secno">7</span> ウェブページの読み込み</a><ol><li><a href="browsers.html#windows"><span class="secno">7.1</span> ブラウジングコンテキスト</a><ol><li><a href="browsers.html#creating-browsing-contexts"><span class="secno">7.1.1</span> ブラウジングコンテキストを作成する</a><li><a href="browsers.html#nested-browsing-contexts"><span class="secno">7.1.2</span> 関連するブラウジングコンテキスト</a><ol><li><a href="browsers.html#navigating-nested-browsing-contexts-in-the-dom"><span class="secno">7.1.2.1</span> DOMで関連するブラウジングコンテキストをナビゲートする</a></ol><li><a href="browsers.html#security-nav"><span class="secno">7.1.3</span> Security</a><li><a href="browsers.html#groupings-of-browsing-contexts"><span class="secno">7.1.4</span> Groupings of browsing contexts</a><li><a href="browsers.html#browsing-context-names"><span class="secno">7.1.5</span> ブラウジングコンテキスト名</a></ol><li><a href="browsers.html#cross-origin-objects"><span class="secno">7.2</span> Security infrastructure for <code>Window</code>, <code>WindowProxy</code>, and <code>Location</code> objects</a><ol><li><a href="browsers.html#integration-with-idl"><span class="secno">7.2.1</span> Integration with IDL</a><li><a href="browsers.html#shared-internal-slot:-crossoriginpropertydescriptormap"><span class="secno">7.2.2</span> Shared internal slot: [[CrossOriginPropertyDescriptorMap]]</a><li><a href="browsers.html#shared-abstract-operations"><span class="secno">7.2.3</span> Shared abstract operations</a><ol><li><a href="browsers.html#crossoriginproperties-(-o-)"><span class="secno">7.2.3.1</span> CrossOriginProperties ( <var>O</var> )</a><li><a href="browsers.html#crossoriginpropertyfallback-(-p-)"><span class="secno">7.2.3.2</span> CrossOriginPropertyFallback ( <var>P</var> )</a><li><a href="browsers.html#isplatformobjectsameorigin-(-o-)"><span class="secno">7.2.3.3</span> IsPlatformObjectSameOrigin ( <var>O</var> )</a><li><a href="browsers.html#crossorigingetownpropertyhelper-(-o,-p-)"><span class="secno">7.2.3.4</span> CrossOriginGetOwnPropertyHelper ( <var>O</var>, <var>P</var> )</a><li><a href="browsers.html#crossoriginget-(-o,-p,-receiver-)"><span class="secno">7.2.3.5</span> CrossOriginGet ( <var>O</var>, <var>P</var>, <var>Receiver</var> )</a><li><a href="browsers.html#crossoriginset-(-o,-p,-v,-receiver-)"><span class="secno">7.2.3.6</span> CrossOriginSet ( <var>O</var>, <var>P</var>, <var>V</var>, <var>Receiver</var> )</a><li><a href="browsers.html#crossoriginownpropertykeys-(-o-)"><span class="secno">7.2.3.7</span> CrossOriginOwnPropertyKeys ( <var>O</var> )</a></ol></ol></ol></ol><h2 id="browsers"><span class="secno">7</span> ウェブページの読み込み<a href="#browsers" class="self-link"></a></h2>

  

  <p>このセクションは、ウェブブラウザーに最も直接的に適用される機能について説明する。それでもやはり、特に指定しない限り、このセクションで定義されている要件は、ウェブブラウザーであるかどうかに関わらず、すべてのユーザーエージェントに適用<em>される</em>。</p>

  



  <h3 id="windows"><span class="secno">7.1</span> ブラウジングコンテキスト<a href="#windows" class="self-link"></a></h3>

  <p><dfn id="browsing-context" data-export="">ブラウジングコンテキスト</dfn>は<code id="windows:document"><a href="dom.html#document">Document</a></code>オブジェクトがユーザーに提示される環境である。</p>

  <p class="note">ウェブブラウザーのタブまたはウィンドウは通常、<code id="windows:the-iframe-element"><a href="iframe-embed-object.html#the-iframe-element">iframe</a></code>または<code id="windows:frameset"><a href="obsolete.html#frameset">frameset</a></code>内の<code id="windows:frame"><a href="obsolete.html#frame">frame</a></code>を含む、<a href="#browsing-context" id="windows:browsing-context">ブラウジングコンテキスト</a>を含む。</p>

  <p><a href="#browsing-context" id="windows:browsing-context-2">ブラウジングコンテキスト</a>は、対応する<code id="windows:windowproxy"><a href="window-object.html#windowproxy">WindowProxy</a></code>オブジェクトを持つ。</p>

  <p><a href="#browsing-context" id="windows:browsing-context-3">ブラウジングコンテキスト</a>は、<dfn id="opener-browsing-context" data-export="">オープナーブラウジングコンテキスト</dfn>を持ち、これはnullまたは<a href="#browsing-context" id="windows:browsing-context-4">ブラウジングコンテキスト</a>である最初はnullである。</p>

  <p><a href="#browsing-context" id="windows:browsing-context-5">ブラウジングコンテキスト</a>は、<dfn id="disowned-its-opener">不所有</dfn>の真偽値を持つ。最初はfalseである。</p>

  <p><a href="#browsing-context" id="windows:browsing-context-6">ブラウジングコンテキスト</a>は、<dfn id="is-closing">閉じている</dfn>真偽値を持つ。最初はfalseである。</p>

  <div class="example"><p>次の例は、<a href="#browsing-context" id="windows:browsing-context-7">ブラウジングコンテキスト</a>のさまざまな可能性を示している。<a href="#disowned-its-opener" id="windows:disowned-its-opener">不所有</a>、<a href="#is-closing" id="windows:is-closing">閉じている</a>、どちらでもない、または両方である可能性がある。</p>

   <pre><code class='js'><c- c1>// Neither disowned nor is closing:</c->
<c- a>const</c-> popup1 <c- o>=</c-> window<c- p>.</c->open<c- p>();</c->

<c- c1>// Disowned, but not is closing:</c->
<c- a>const</c-> popup2 <c- o>=</c-> window<c- p>.</c->open<c- p>();</c->
popup2<c- p>.</c->opener <c- o>=</c-> <c- kc>null</c-><c- p>;</c->

<c- c1>// Not disowned, but is closing:</c->
<c- a>const</c-> popup3 <c- o>=</c-> window<c- p>.</c->open<c- p>();</c->
popup3<c- p>.</c->close<c- p>();</c->

<c- c1>// Disowned, is closing:</c->
<c- a>const</c-> popup4 <c- o>=</c-> window<c- p>.</c->open<c- p>();</c->
popup4<c- p>.</c->opener <c- o>=</c-> <c- kc>null</c-><c- p>;</c->
popup4<c- p>.</c->close<c- p>();</c-></code></pre></div>

  <p><a href="#browsing-context" id="windows:browsing-context-8">ブラウジングコンテキスト</a>は、<a href="#browsing-context" id="windows:browsing-context-9">ブラウジングコンテキスト</a>が提示されていた、している、またはするだろう<code id="windows:document-2"><a href="dom.html#document">Document</a></code>オブジェクトを一覧表示する<a id="windows:session-history" href="history.html#session-history">セッション履歴</a>を持つ。<dfn data-dfn-for="Document" id="concept-document-bc" data-lt="browsing context" data-export=""><code>Document</code>のブラウジングコンテキスト</dfn>は、そのようなブラウジングコンテキストが存在しかつ<a href="window-object.html#a-browsing-context-is-discarded" id="windows:a-browsing-context-is-discarded">破棄</a>されていない場合、<a id="windows:session-history-2" href="history.html#session-history">セッション履歴</a>にその<code id="windows:document-3"><a href="dom.html#document">Document</a></code>が含まれる<a href="#browsing-context" id="windows:browsing-context-10">ブラウジングコンテキスト</a>であり、そうでなければnullである。</p>

  <p class="note"><code id="windows:document-4"><a href="dom.html#document">Document</a></code>は、必ずしも非nullの<a href="#concept-document-bc" id="windows:concept-document-bc">ブラウジングコンテキスト</a>を持つとは限らない。具体的には、データマイニングツールはブラウジングコンテキストをインスタンス化できないだろう。<code id="windows:dom-domimplementation-createdocument"><a data-x-internal="dom-domimplementation-createdocument" href="https://triple-underscore.github.io/DOM4-ja.htmlcreatedocument">createDocument()</a></code>のような API を使用して作成された<code id="windows:document-5"><a href="dom.html#document">Document</a></code>は、非nullの<a href="#concept-document-bc" id="windows:concept-document-bc-2">ブラウジングコンテキスト</a>を持つことはない。<a href="infrastructure.html#remove-an-element-from-a-document" id="windows:remove-an-element-from-a-document">文書から削除</a>されて以来、<code id="windows:the-iframe-element-2"><a href="iframe-embed-object.html#the-iframe-element">iframe</a></code>要素で当初は作成された<code id="windows:document-6"><a href="dom.html#document">Document</a></code>は、そのブラウジングコンテキストが<a href="window-object.html#a-browsing-context-is-discarded" id="windows:a-browsing-context-is-discarded-2">破棄された</a>ので、関連付けられたブラウジングコンテキストを持たない。</p>

  <p><a href="#browsing-context" id="windows:browsing-context-11">ブラウジングコンテキスト</a>の<dfn data-dfn-for="browsing context" id="active-window" data-export="">アクティブウィンドウ</dfn>は、その <code id="windows:windowproxy-2"><a href="window-object.html#windowproxy">WindowProxy</a></code>オブジェクトの<a href="window-object.html#concept-windowproxy-window" id="windows:concept-windowproxy-window">[[Window]]</a>内部スロット値である。<a href="#browsing-context" id="windows:browsing-context-12">ブラウジングコンテキスト</a>の<dfn id="active-document" data-export="">アクティブ文書</dfn>は、その<a href="#active-window" id="windows:active-window">アクティブウィンドウ</a>に<a href="window-object.html#concept-document-window" id="windows:concept-document-window">関連付けられた<code>Document</code></a>である。<p class="note">一般に、<code id="windows:document-8"><a href="dom.html#document">Document</a></code>オブジェクトが非null<a href="#concept-document-bc" id="windows:concept-document-bc-3">ブラウジングコンテキスト</a>を持っている限り、 <code id="windows:window"><a href="window-object.html#window">Window</a></code>オブジェクトから<code id="windows:document-7"><a href="dom.html#document">Document</a></code>オブジェクトへのマッピングは1対1になる。例外が1つある。<code id="windows:window-2"><a href="window-object.html#window">Window</a></code>は、マッピングが1対2になるように、同じ<a href="#browsing-context" id="windows:browsing-context-13">ブラウジングコンテキスト</a>で2番目の<code id="windows:document-9"><a href="dom.html#document">Document</a></code>のプレゼンテーションに再利用できる。This occurs when a <a href="#browsing-context" id="windows:browsing-context-14">browsing context</a> is <a href="browsing-the-web.html#navigate" id="windows:navigate">navigated</a> from the <a href="dom.html#is-initial-about:blank" id="windows:is-initial-about:blank">initial <code>about:blank</code></a> <code id="windows:document-10"><a href="dom.html#document">Document</a></code> to another, with <var id="windows:navigation-hh"><a href="browsing-the-web.html#navigation-hh">historyHandling</a></var> set to "<code id="windows:hh-replace"><a href="browsing-the-web.html#hh-replace">replace</a></code>".</p>

  <p>A <a href="#browsing-context" id="windows:browsing-context-15">browsing context</a> has a <dfn id="virtual-browsing-context-group-id">virtual browsing context group ID</dfn> integer. It is initially 0. This is used by <a href="origin.html#coop-struct-report-only-value" id="windows:coop-struct-report-only-value">cross-origin opener policy reporting</a>, to keep track of the browsing context group switches that would have happened if the report-only policy had been enforced.</p>

  <p>A <a href="#browsing-context" id="windows:browsing-context-16">browsing context</a> has an <dfn id="browsing-context-initial-url">initial URL</dfn>, which is a <a id="windows:url" href="https://triple-underscore.github.io/URL-ja.html#concept-url" data-x-internal="url">URL</a> or null. 最初はnullである。</p>

  <p>A <a href="#browsing-context" id="windows:browsing-context-17">browsing context</a> has an <dfn id="opener-origin-at-creation">opener origin at creation</dfn>, which is an <a id="windows:concept-origin" href="origin.html#concept-origin">origin</a> or null. 最初はnullである。</p>

  <h4 id="creating-browsing-contexts"><span class="secno">7.1.1</span> ブラウジングコンテキストを作成する<a href="#creating-browsing-contexts" class="self-link"></a></h4>

  <p>To <dfn id="set-the-active-document">set the active document</dfn> of a <a href="#browsing-context" id="creating-browsing-contexts:browsing-context">browsing context</a> <var>browsingContext</var> to a <code id="creating-browsing-contexts:document"><a href="dom.html#document">Document</a></code> object <var>document</var>, run these steps:</p>

  <ol><li><p><var>window</var>を<var>document</var>の<a id="creating-browsing-contexts:concept-relevant-global" href="webappapis.html#concept-relevant-global">関連するグローバルオブジェクト</a>にする。<li><p><var>browsingContext</var>の<a href="#active-window" id="creating-browsing-contexts:active-window">アクティブウィンドウ</a>を<var>window</var>に設定する。<li><p><var>window</var>の<a href="window-object.html#concept-document-window" id="creating-browsing-contexts:concept-document-window">関連<code>Document</code></a>を<var>document</var>に設定する。<li><p><var>window</var>の<a id="creating-browsing-contexts:relevant-settings-object" href="webappapis.html#relevant-settings-object">関連設定オブジェクト</a>の<a href="webappapis.html#concept-environment-execution-ready-flag" id="creating-browsing-contexts:concept-environment-execution-ready-flag">実行準備フラグ</a>を設定する。</ol>

  <hr>

  <p><a href="#browsing-context" id="creating-browsing-contexts:browsing-context-2">ブラウジングコンテキスト</a>は、関連付けられている<dfn id="creator-origin">作成者の生成元</dfn>（nullまたは<a id="creating-browsing-contexts:concept-origin" href="origin.html#concept-origin">生成元</a>を返す）、<dfn id="creator-url">作成者のURL</dfn>（nullまたは<a id="creating-browsing-contexts:url" href="https://triple-underscore.github.io/URL-ja.html#concept-url" data-x-internal="url">URL</a>を返す）、および<dfn id="creator-base-url">作成者のベースURL</dfn>（nullまたは<a id="creating-browsing-contexts:url-2" href="https://triple-underscore.github.io/URL-ja.html#concept-url" data-x-internal="url">URL</a>を返す）を持つ。これらは最初はnullである。</p>

  

  <p>To <dfn id="determining-the-origin">determine the origin</dfn>, given <a href="#browsing-context" id="creating-browsing-contexts:browsing-context-3">browsing context</a> <var>browsingContext</var>, <a id="creating-browsing-contexts:url-3" href="https://triple-underscore.github.io/URL-ja.html#concept-url" data-x-internal="url">URL</a> <var>url</var>, <a id="creating-browsing-contexts:sandboxing-flag-set" href="origin.html#sandboxing-flag-set">sandboxing flag set</a> <var>sandboxFlags</var>, and an <a id="creating-browsing-contexts:concept-origin-2" href="origin.html#concept-origin">origin</a> <var>invocationOrigin</var>:</p>

  <ol><li id="sandboxOrigin"><p>If <var>sandboxFlags</var> has its <a id="creating-browsing-contexts:sandboxed-origin-browsing-context-flag" href="origin.html#sandboxed-origin-browsing-context-flag">sandboxed origin browsing context flag</a> set, then return a new <a href="origin.html#concept-origin-opaque" id="creating-browsing-contexts:concept-origin-opaque">opaque origin</a>.<li><p>If <var>url</var> is null, then return a new <a href="origin.html#concept-origin-opaque" id="creating-browsing-contexts:concept-origin-opaque-2">opaque origin</a>.<li><p>If <var>invocationOrigin</var> is non-null and <var>url</var> <a id="creating-browsing-contexts:matches-about:blank" href="urls-and-fetching.html#matches-about:blank">matches <code>about:blank</code></a>, then return <var>invocationOrigin</var>.</p>

    <p class="note">The result here is that two documents end up with the same underlying <a id="creating-browsing-contexts:concept-origin-3" href="origin.html#concept-origin">origin</a>, meaning that <code id="creating-browsing-contexts:dom-document-domain"><a href="origin.html#dom-document-domain">document.domain</a></code> affects both.</p>
   <li><p>If <var>url</var> is <code id="creating-browsing-contexts:about:srcdoc"><a href="urls-and-fetching.html#about:srcdoc">about:srcdoc</a></code>, then return the <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="creating-browsing-contexts:concept-document-origin" data-x-internal="concept-document-origin">origin</a> of <var>browsingContext</var>'s <a href="#bc-container-document" id="creating-browsing-contexts:bc-container-document">container document</a>.<li><p>Return <var>url</var>'s <a href="https://triple-underscore.github.io/URL-ja.html#concept-url-origin" id="creating-browsing-contexts:concept-url-origin" data-x-internal="concept-url-origin">origin</a>.</ol>

  <p>To <dfn id="creating-a-new-browsing-context">create a new browsing context</dfn>, given null or a <code id="creating-browsing-contexts:document-2"><a href="dom.html#document">Document</a></code> object <var>creator</var>, null or an element <var>embedder</var>, and a <a href="#browsing-context-group" id="creating-browsing-contexts:browsing-context-group">browsing context group</a> <var>group</var>, run these steps:</p>

  

  <ol><li><p>Let <var>browsingContext</var> be a new <a href="#browsing-context" id="creating-browsing-contexts:browsing-context-4">browsing context</a>.<li id="creator-browsing-context"><p>If <var>creator</var> is non-null, then set <var>browsingContext</var>'s <a href="#creator-origin" id="creating-browsing-contexts:creator-origin">creator origin</a> to return <var>creator</var>'s <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="creating-browsing-contexts:concept-document-origin-2" data-x-internal="concept-document-origin">origin</a>, <var>browsingContext</var>'s <a href="#creator-url" id="creating-browsing-contexts:creator-url">creator URL</a> to return <var>creator</var>'s <a href="https://triple-underscore.github.io/DOM4-ja.html#concept-document-url" id="creating-browsing-contexts:the-document's-address" data-x-internal="the-document's-address">URL</a>, <var>browsingContext</var>'s <a href="#creator-base-url" id="creating-browsing-contexts:creator-base-url">creator base URL</a> to return <var>creator</var>'s <a href="urls-and-fetching.html#document-base-url" id="creating-browsing-contexts:document-base-url">base URL</a>, and <var>browsingContext</var>'s <a href="#virtual-browsing-context-group-id" id="creating-browsing-contexts:virtual-browsing-context-group-id">virtual browsing context group ID</a> to <var>creator</var>'s <a href="#top-level-browsing-context" id="creating-browsing-contexts:top-level-browsing-context">top-level browsing context</a>'s <a href="#virtual-browsing-context-group-id" id="creating-browsing-contexts:virtual-browsing-context-group-id-2">virtual browsing context group ID</a>.<li><p>Let <var>sandboxFlags</var> be the result of <a id="creating-browsing-contexts:determining-the-creation-sandboxing-flags" href="origin.html#determining-the-creation-sandboxing-flags">determining the creation sandboxing flags</a> given <var>browsingContext</var> and <var>embedder</var>.<li id="about-blank-origin"><p>Let <var>origin</var> be the result of <a href="#determining-the-origin" id="creating-browsing-contexts:determining-the-origin">determining the origin</a> given <var>browsingContext</var>, <code id="creating-browsing-contexts:about:blank"><a href="infrastructure.html#about:blank">about:blank</a></code>, <var>sandboxFlags</var>, and <var>browsingContext</var>'s <a href="#creator-origin" id="creating-browsing-contexts:creator-origin-2">creator origin</a>.<li><p>Let <var>permissionsPolicy</var> be the result of <a id="creating-browsing-contexts:creating-a-permissions-policy" href="https://triple-underscore.github.io/webappsec-permissions-policy-ja.html#create-for-browsingcontext" data-x-internal="creating-a-permissions-policy">creating a permissions policy</a> given <var>browsingContext</var> and <var>origin</var>. <a href="references.html#refsPERMISSIONSPOLICY">[PERMISSIONSPOLICY]</a></p>

    <p class="XXX">This needs to use <var>embedder</var>.</p>
   <li><p>Let <var>agent</var> be the result of <a href="webappapis.html#obtain-similar-origin-window-agent" id="creating-browsing-contexts:obtain-similar-origin-window-agent">obtaining a similar-origin window agent</a> given <var>origin</var>, <var>group</var>, and false.<li><p>Let <var>realm execution context</var> be the result of <a id="creating-browsing-contexts:creating-a-new-javascript-realm" href="webappapis.html#creating-a-new-javascript-realm">creating a new JavaScript realm</a> given <var>agent</var> and the following customizations:</p>

    <ul><li><p>For the global object, create a new <code id="creating-browsing-contexts:window"><a href="window-object.html#window">Window</a></code> object.<li><p>For the global <b>this</b> binding, use <var>browsingContext</var>'s <code id="creating-browsing-contexts:windowproxy"><a href="window-object.html#windowproxy">WindowProxy</a></code> object.</ul>
   <li><p>Let <var>topLevelCreationURL</var> be <code id="creating-browsing-contexts:about:blank-2"><a href="infrastructure.html#about:blank">about:blank</a></code> if <var>embedder</var> is null; otherwise <var>embedder</var>'s <a id="creating-browsing-contexts:relevant-settings-object-2" href="webappapis.html#relevant-settings-object">relevant settings object</a>'s <a id="creating-browsing-contexts:concept-environment-top-level-creation-url" href="webappapis.html#concept-environment-top-level-creation-url">top-level creation URL</a>.<li><p>Let <var>topLevelOrigin</var> be <var>origin</var> if <var>embedder</var> is null; otherwise <var>embedder</var>'s <a id="creating-browsing-contexts:relevant-settings-object-3" href="webappapis.html#relevant-settings-object">relevant settings object</a>'s <a id="creating-browsing-contexts:concept-environment-top-level-origin" href="webappapis.html#concept-environment-top-level-origin">top-level origin</a>.<li><p><a id="creating-browsing-contexts:set-up-a-window-environment-settings-object" href="window-object.html#set-up-a-window-environment-settings-object">Set up a window environment settings object</a> with <code id="creating-browsing-contexts:about:blank-3"><a href="infrastructure.html#about:blank">about:blank</a></code>, <var>realm execution context</var>, null, <var>topLevelCreationURL</var>, and <var>topLevelOrigin</var>.<li><p>Let <var>coop</var> be a new <a id="creating-browsing-contexts:cross-origin-opener-policy" href="origin.html#cross-origin-opener-policy">cross-origin opener policy</a>.<li><p>If <var>creator</var> is non-null and <var>creator</var>'s <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="creating-browsing-contexts:concept-document-origin-3" data-x-internal="concept-document-origin">origin</a> is <a id="creating-browsing-contexts:same-origin" href="origin.html#same-origin">same origin</a> with <var>creator</var>'s <a id="creating-browsing-contexts:relevant-settings-object-4" href="webappapis.html#relevant-settings-object">relevant settings object</a>'s <a id="creating-browsing-contexts:concept-environment-top-level-origin-2" href="webappapis.html#concept-environment-top-level-origin">top-level origin</a>, then set <var>coop</var> to <var>creator</var>'s <a href="#concept-document-bc" id="creating-browsing-contexts:concept-document-bc">browsing context</a>'s <a href="#top-level-browsing-context" id="creating-browsing-contexts:top-level-browsing-context-2">top-level browsing context</a>'s <a href="#active-document" id="creating-browsing-contexts:active-document">active document</a>'s <a href="dom.html#concept-document-coop" id="creating-browsing-contexts:concept-document-coop">cross-origin opener policy</a>.<li><p>Let <var>document</var> be a new <code id="creating-browsing-contexts:document-3"><a href="dom.html#document">Document</a></code>, marked as an <a href="https://triple-underscore.github.io/DOM4-ja.html#html-document" id="creating-browsing-contexts:html-documents" data-x-internal="html-documents">HTML document</a> in <a id="creating-browsing-contexts:quirks-mode" href="https://triple-underscore.github.io/DOM4-ja.html#concept-document-quirks" data-x-internal="quirks-mode">quirks mode</a>, whose <a href="https://triple-underscore.github.io/DOM4-ja.html#concept-document-content-type" id="creating-browsing-contexts:concept-document-content-type" data-x-internal="concept-document-content-type">content type</a> is "<code>text/html</code>", <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="creating-browsing-contexts:concept-document-origin-4" data-x-internal="concept-document-origin">origin</a> is <var>origin</var>, <a id="creating-browsing-contexts:active-sandboxing-flag-set" href="origin.html#active-sandboxing-flag-set">active sandboxing flag set</a> is <var>sandboxFlags</var>, <a href="dom.html#concept-document-permissions-policy" id="creating-browsing-contexts:concept-document-permissions-policy">permissions policy</a> is <var>permissionsPolicy</var>, <a href="dom.html#concept-document-coop" id="creating-browsing-contexts:concept-document-coop-2">cross-origin opener policy</a> is <var>coop</var>, <a href="dom.html#concept-document-navigation-id" id="creating-browsing-contexts:concept-document-navigation-id">navigation id</a> is null, and which is <a id="creating-browsing-contexts:ready-for-post-load-tasks" href="parsing.html#ready-for-post-load-tasks">ready for post-load tasks</a>.<li><p>Assert: <var>document</var>'s <a href="https://triple-underscore.github.io/DOM4-ja.html#concept-document-url" id="creating-browsing-contexts:the-document's-address-2" data-x-internal="the-document's-address">URL</a> and <var>document</var>'s <a id="creating-browsing-contexts:relevant-settings-object-5" href="webappapis.html#relevant-settings-object">relevant settings object</a>'s <a href="webappapis.html#concept-environment-creation-url" id="creating-browsing-contexts:concept-environment-creation-url">creation URL</a> are <code id="creating-browsing-contexts:about:blank-4"><a href="infrastructure.html#about:blank">about:blank</a></code>.<li><p>Set <var>document</var>'s <a id="creating-browsing-contexts:is-initial-about:blank" href="dom.html#is-initial-about:blank">is initial <code>about:blank</code></a> to true.<li><p>Ensure that <var>document</var> has a single child <code id="creating-browsing-contexts:the-html-element"><a href="semantics.html#the-html-element">html</a></code> node, which itself has two empty child nodes: a <code id="creating-browsing-contexts:the-head-element"><a href="semantics.html#the-head-element">head</a></code> element, and a <code id="creating-browsing-contexts:the-body-element"><a href="sections.html#the-body-element">body</a></code> element.<li><p><a href="#set-the-active-document" id="creating-browsing-contexts:set-the-active-document">Set the active document</a> of <var>browsingContext</var> to <var>document</var>.<li><p>If <var>browsingContext</var>'s <a href="#creator-url" id="creating-browsing-contexts:creator-url-2">creator URL</a> is non-null, then set <var>document</var>'s <a href="dom.html#the-document's-referrer" id="creating-browsing-contexts:the-document's-referrer">referrer</a> to the <a href="https://triple-underscore.github.io/URL-ja.html#concept-url-serializer" id="creating-browsing-contexts:concept-url-serializer" data-x-internal="concept-url-serializer">serialization</a> of it.<li><p>If <var>creator</var> is non-null, then set <var>document</var>'s <a href="dom.html#concept-document-policy-container" id="creating-browsing-contexts:concept-document-policy-container">policy container</a> to a <a href="origin.html#clone-a-policy-container" id="creating-browsing-contexts:clone-a-policy-container">clone</a> of <var>creator</var>'s <a href="dom.html#concept-document-policy-container" id="creating-browsing-contexts:concept-document-policy-container-2">policy container</a>.<li><p>Append a new <a id="creating-browsing-contexts:session-history-entry" href="history.html#session-history-entry">session history entry</a> to <var>browsingContext</var>'s <a id="creating-browsing-contexts:session-history" href="history.html#session-history">session history</a> whose <a href="history.html#she-url" id="creating-browsing-contexts:she-url">URL</a> is <code id="creating-browsing-contexts:about:blank-5"><a href="infrastructure.html#about:blank">about:blank</a></code> and <a href="history.html#she-document" id="creating-browsing-contexts:she-document">document</a> is <var>document</var>.<li><p><a id="creating-browsing-contexts:completely-finish-loading" href="browsing-the-web.html#completely-finish-loading">Completely finish loading</a> <var>document</var>.<li><p>Return <var>browsingContext</var>.</ol>

  <p>To <dfn id="creating-a-new-top-level-browsing-context">create a new top-level browsing context</dfn>:</p>

  <ol><li><p>Let <var>group</var> be the result of <a href="#creating-a-new-browsing-context-group" id="creating-browsing-contexts:creating-a-new-browsing-context-group">creating a new browsing context group</a>.<li><p>Return <var>group</var>'s <a href="#browsing-context-set" id="creating-browsing-contexts:browsing-context-set">browsing context set</a>[0].</ol>

  <p class="note">This creates a <a href="#top-level-browsing-context" id="creating-browsing-contexts:top-level-browsing-context-3">top-level browsing context</a>.</p>

  <p>To <dfn id="creating-a-new-auxiliary-browsing-context">create a new auxiliary browsing context</dfn>, given a <a href="#browsing-context" id="creating-browsing-contexts:browsing-context-5">browsing context</a> <var>opener</var>:</p>

  <ol><li><p>Let <var>group</var> be <var>opener</var>'s <a href="#top-level-browsing-context" id="creating-browsing-contexts:top-level-browsing-context-4">top-level browsing context</a>'s <a href="#tlbc-group" id="creating-browsing-contexts:tlbc-group">group</a><li><p>Assert: <var>group</var> is non-null, as <a href="browsing-the-web.html#navigate" id="creating-browsing-contexts:navigate">navigating</a> invokes this directly.<li><p>Let <var>browsingContext</var> be the result of <a href="#creating-a-new-browsing-context" id="creating-browsing-contexts:creating-a-new-browsing-context">creating a new browsing context</a> with <var>opener</var>'s <a href="#active-document" id="creating-browsing-contexts:active-document-2">active document</a>, null, and <var>group</var>.<li><p><a href="#bcg-append" id="creating-browsing-contexts:bcg-append">Append</a> <var>browsingContext</var> to <var>group</var>.<li><p>Set <var>browsingContext</var>'s <a href="#opener-browsing-context" id="creating-browsing-contexts:opener-browsing-context">opener browsing context</a> to <var>opener</var>.<li><p>Set <var>browsingContext</var>'s <a href="#virtual-browsing-context-group-id" id="creating-browsing-contexts:virtual-browsing-context-group-id-3">virtual browsing context group ID</a> to <var>opener</var>'s <a href="#top-level-browsing-context" id="creating-browsing-contexts:top-level-browsing-context-5">top-level browsing context</a>'s <a href="#virtual-browsing-context-group-id" id="creating-browsing-contexts:virtual-browsing-context-group-id-4">virtual browsing context group ID</a>.<li><p>Set <var>browsingContext</var>'s <a href="#opener-origin-at-creation" id="creating-browsing-contexts:opener-origin-at-creation">opener origin at creation</a> to <var>opener</var>'s <a href="#active-document" id="creating-browsing-contexts:active-document-3">active document</a>'s <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="creating-browsing-contexts:concept-document-origin-5" data-x-internal="concept-document-origin">origin</a>.<li id="copy-session-storage"><p><a id="creating-browsing-contexts:legacy-clone-a-browsing-session-storage-shed" href="https://triple-underscore.github.io/storage-ja.html#legacy-clone-a-browsing-session-storage-shed" data-x-internal="legacy-clone-a-browsing-session-storage-shed">Legacy-clone a browsing session storage shed</a> with <var>opener</var>'s <a href="history.html#tlbc-browsing-session" id="creating-browsing-contexts:tlbc-browsing-session">browsing session</a> and <var>browsingContext</var>'s <a href="history.html#tlbc-browsing-session" id="creating-browsing-contexts:tlbc-browsing-session-2">browsing session</a>. <a href="references.html#refsSTORAGE">[STORAGE]</a><li><p>Return <var>browsingContext</var>.</ol>

  <p class="note">This creates a <a href="#top-level-browsing-context" id="creating-browsing-contexts:top-level-browsing-context-6">top-level browsing context</a> that is also an <a href="#auxiliary-browsing-context" id="creating-browsing-contexts:auxiliary-browsing-context">auxiliary browsing context</a>.</p>

  <p>To <dfn id="creating-a-new-nested-browsing-context">create a new nested browsing context</dfn>, given an element <var>element</var>:</p>

  <ol><li><p>Let <var>group</var> be <var>element</var>'s <a id="creating-browsing-contexts:node-document" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>'s <a href="#concept-document-bc" id="creating-browsing-contexts:concept-document-bc-2">browsing context</a>'s <a href="#top-level-browsing-context" id="creating-browsing-contexts:top-level-browsing-context-7">top-level browsing context</a>'s <a href="#tlbc-group" id="creating-browsing-contexts:tlbc-group-2">group</a>.<li><p>Let <var>browsingContext</var> be the result of <a href="#creating-a-new-browsing-context" id="creating-browsing-contexts:creating-a-new-browsing-context-2">creating a new browsing context</a> with <var>element</var>'s <a id="creating-browsing-contexts:node-document-2" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>, <var>element</var>, and <var>group</var>.<li><p>Set <var>element</var>'s <a href="#nested-browsing-context" id="creating-browsing-contexts:nested-browsing-context">nested browsing context</a> to <var>browsingContext</var>.<li><p>If <var>element</var> has a <code>name</code> attribute, then set <var>browsingContext</var>'s <a href="#browsing-context-name" id="creating-browsing-contexts:browsing-context-name">name</a> to the value of this attribute.</ol>

  


  <h4 id="nested-browsing-contexts"><span class="secno">7.1.2</span> 関連するブラウジングコンテキスト<a href="#nested-browsing-contexts" class="self-link"></a></h4>

  <p>特定の要素（たとえば、<code id="nested-browsing-contexts:the-iframe-element"><a href="iframe-embed-object.html#the-iframe-element">iframe</a></code>要素）は、<a href="#browsing-context" id="nested-browsing-contexts:browsing-context">ブラウジングコンテキスト</a>をさらにインスタンス化できる。この要素は、<dfn id="browsing-context-container" data-lt="browsing context container" data-export="">ブラウジングコンテキストコンテナー</dfn>と呼ばれる。</p>

  <p>各<a href="#browsing-context-container" id="nested-browsing-contexts:browsing-context-container">ブラウジングコンテキストコンテナー</a>は、<a href="#browsing-context" id="nested-browsing-contexts:browsing-context-2">ブラウジングコンテキスト</a>またはnullのいずれとなる、<dfn id="nested-browsing-context" data-export="">ネストされたブラウジングコンテキスト</dfn>を持つ。最初はnullである。</p>

  <p><a href="#browsing-context" id="nested-browsing-contexts:browsing-context-3">ブラウジングコンテキスト</a><var>bc</var>の<dfn id="bc-container">コンテナー</dfn>は、<a href="#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context">ネストされたブラウジングコンテキスト</a>が<var>bc</var>である<a href="#browsing-context-container" id="nested-browsing-contexts:browsing-context-container-2">ブラウジングコンテキストコンテナー</a>であり、そのような要素がない場合はnullである。</p>

  <p>各<a href="#browsing-context" id="nested-browsing-contexts:browsing-context-4">ブラウジングコンテキスト</a><var>bc</var>は、<dfn data-dfn-for="browsing context" id="bc-container-document" data-export="">コンテナー文書</dfn>を持ち、これは次の手順を実行した結果である：</p>

  <ol><li><p><var>bc</var>の<a href="#bc-container" id="nested-browsing-contexts:bc-container">コンテナー</a>がnullである場合、nullを返す。<li><p><var>bc</var>の<a href="#bc-container" id="nested-browsing-contexts:bc-container-2">コンテナー</a>の<a id="nested-browsing-contexts:node-document" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">ノード文書</a>を返す。</p>

    <p class="note"><var>bc</var>の<a href="#bc-container" id="nested-browsing-contexts:bc-container-4">コンテナー</a>を<a id="nested-browsing-contexts:connected" href="https://triple-underscore.github.io/DOM4-ja.html#connected" data-x-internal="connected">接続する</a>必要があるため、これは<var>bc</var>の<a href="#bc-container" id="nested-browsing-contexts:bc-container-3">コンテナー</a>の<a id="nested-browsing-contexts:shadow-including-root" href="https://triple-underscore.github.io/DOM4-ja.html#concept-shadow-including-root" data-x-internal="shadow-including-root">シャドウを含むルート</a>と同じである。</p>
   </ol>

  <p><var>child</var>の<a href="#bc-container-document" id="nested-browsing-contexts:bc-container-document">コンテナー文書</a>がnullでなく、かつ<var>child</var>の<a href="#bc-container-document" id="nested-browsing-contexts:bc-container-document-2">コンテナー文書</a>の<a href="#concept-document-bc" id="nested-browsing-contexts:concept-document-bc">ブラウジングコンテキスト</a>が<var>parent</var>である場合、<a href="#browsing-context" id="nested-browsing-contexts:browsing-context-5">ブラウジングコンテキスト</a><var>child</var>は、別の<a href="#browsing-context" id="nested-browsing-contexts:browsing-context-6">ブラウジングコンテキスト</a><var>parent</var>の<dfn id="child-browsing-context" data-export="">子ブラウジングコンテキスト</dfn>と呼ばれる。</p>

  <p><a href="#browsing-context" id="nested-browsing-contexts:browsing-context-7">ブラウジングコンテキスト</a><var>child</var>は、<var>child</var>が<a href="#child-browsing-context" id="nested-browsing-contexts:child-browsing-context">子ブラウジングコンテキスト</a>であり、かつ<var>child</var>の<a href="#bc-container" id="nested-browsing-contexts:bc-container-5">コンテナー</a>が<a id="nested-browsing-contexts:in-a-document-tree" href="https://triple-underscore.github.io/DOM4-ja.html#in-a-document" data-x-internal="in-a-document-tree">文書ツリー内</a>である場合、<var>parent</var>の<dfn id="document-tree-child-browsing-context">文書ツリーの子ブラウジングコンテキスト</dfn>である。</p>

  <p><a href="#browsing-context" id="nested-browsing-contexts:browsing-context-8">ブラウジングコンテキスト</a><var>child</var>は<dfn id="parent-browsing-context" data-export="">親ブラウジングコンテキスト</dfn>を持ってもよい。もしそのようなブラウジングコンテキストが存在すれば、これは<a href="#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-2">子ブラウジングコンテキスト</a>として<var>child</var>を持つ一意な<a href="#browsing-context" id="nested-browsing-contexts:browsing-context-9">ブラウジングコンテキスト</a>である。そうでなければ、<a href="#browsing-context" id="nested-browsing-contexts:browsing-context-10">ブラウジングコンテキスト</a>は、<a href="#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context">親ブラウジングコンテキスト</a>を持たない。</p>

  <p><a href="#browsing-context" id="nested-browsing-contexts:browsing-context-11">ブラウジングコンテキスト</a><var>A</var>が<var>A</var>の<a href="#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-3">子ブラウジングコンテキスト</a>であり、かつ<var>B</var>の<a href="#ancestor-browsing-context" id="nested-browsing-contexts:ancestor-browsing-context">祖先</a>自身であるブラウジングコンテキスト<var>A'</var>が存在する場合、またはブラウジングコンテキスト<var>A</var>が<var>B</var>の<a href="#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context-2">親ブラウジングコンテキスト</a>である場合、ブラウジングコンテキスト<var>B</var>の<dfn id="ancestor-browsing-context" data-lt="ancestor browsing context" data-export="">祖先</dfn>であると言われる。</p>

  <p><a href="#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context-3">親ブラウジングコンテキスト</a>を持たない<a href="#browsing-context" id="nested-browsing-contexts:browsing-context-12">ブラウジングコンテキスト</a>は、それ自身の<dfn id="top-level-browsing-context" data-export="">トップレベルブラウジングコンテキスト</dfn>であり、<a href="#ancestor-browsing-context" id="nested-browsing-contexts:ancestor-browsing-context-2">祖先ブラウジングコンテキスト</a>であるブラウジングコンテキストのすべてとなる。</p>

  <p><a href="#top-level-browsing-context" id="nested-browsing-contexts:top-level-browsing-context">トップレベルブラウジングコンテキスト</a>は、関連する<dfn id="tlbc-group">グループ</dfn>（nullまたは<a href="#browsing-context-group" id="nested-browsing-contexts:browsing-context-group">ブラウジングコンテキストグループ</a>）を持つ。最初はnullである。</p>

  <p><a href="#bc-container" id="nested-browsing-contexts:bc-container-6">コンテナー</a>がnullの間に、<a href="#top-level-browsing-context" id="nested-browsing-contexts:top-level-browsing-context-2">トップレベルブラウジングコンテキスト</a>に関連する新しいブラウジングコンテキストを作成することができる。そのようなブラウジングコンテキストは、<dfn id="auxiliary-browsing-context" data-lt="auxiliary browsing context" data-export="">補助ブラウジングコンテキスト</dfn>と呼ばれる。補助ブラウジングコンテキストは常に<a href="#top-level-browsing-context" id="nested-browsing-contexts:top-level-browsing-context-3">トップレベルブラウジングコンテキスト</a>である。</p>

  <p><a href="#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-4">子ブラウジングコンテキスト</a>である<a href="#browsing-context" id="nested-browsing-contexts:browsing-context-13">ブラウジングコンテキスト</a>に対する<a href="#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context-4">親ブラウジングコンテキスト</a>の推移的クロージャは、<a href="#ancestor-browsing-context" id="nested-browsing-contexts:ancestor-browsing-context-3">祖先ブラウジングコンテキスト</a>のリストを与える。</p>

  <p><code id="nested-browsing-contexts:document"><a href="dom.html#document">Document</a></code> <var>d</var>の<dfn id="list-of-the-descendant-browsing-contexts">子孫ブラウジングコンテキストのリスト</dfn>は、以下のアルゴリズムによって返される（順序付きの）リストである：</p>

  <ol><li><p><var>list</var>を空の<a id="nested-browsing-contexts:list" href="https://triple-underscore.github.io/infra-ja.html#list" data-x-internal="list">リスト</a>にする。<li><p><a href="#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context-2">ネストされたブラウジングコンテキスト</a>がnullでなく、<a id="nested-browsing-contexts:shadow-including-root-2" href="https://triple-underscore.github.io/DOM4-ja.html#concept-shadow-including-root" data-x-internal="shadow-including-root">シャドウを含むルート</a>が<var>d</var>である各<a href="#browsing-context-container" id="nested-browsing-contexts:browsing-context-container-3">ブラウジングコンテキストコンテナー</a><var>container</var>ごとに、<a id="nested-browsing-contexts:shadow-including-tree-order" href="https://triple-underscore.github.io/DOM4-ja.html#concept-shadow-including-tree-order" data-x-internal="shadow-including-tree-order">シャドウを含むツリーの順序</a>で：</p>

    <ol><li><p><var>nestedBC</var>を<var>コンテナー</var>の<a href="#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context-3">ネストされたブラウジングコンテキスト</a>にする。<li><p><var>nestedBC</var>を<var>list</var>に<a href="https://triple-underscore.github.io/infra-ja.html#list-append" id="nested-browsing-contexts:list-append" data-x-internal="list-append">追加する</a>。<li><p><var>nestedBC</var>の<a href="#active-document" id="nested-browsing-contexts:active-document">アクティブ文書</a>の<a href="#list-of-the-descendant-browsing-contexts" id="nested-browsing-contexts:list-of-the-descendant-browsing-contexts">子孫ブラウジングコンテキストのリスト</a>で<var>list</var>を<a href="https://triple-underscore.github.io/infra-ja.html#list-extend" id="nested-browsing-contexts:list-extend" data-x-internal="list-extend">拡張する</a>。</ol>
   <li><p><var>list</var>を返す。</ol>

  <p>A <code id="nested-browsing-contexts:document-2"><a href="dom.html#document">Document</a></code> <var>d</var> is said to be <dfn data-dfn-for="Document" id="fully-active" data-export="">fully active</dfn> when <var>d</var>'s <a href="#concept-document-bc" id="nested-browsing-contexts:concept-document-bc-2">browsing context</a> is non-null, <var>d</var>'s <a href="#concept-document-bc" id="nested-browsing-contexts:concept-document-bc-3">browsing context</a>'s <a href="#active-document" id="nested-browsing-contexts:active-document-2">active document</a> is <var>d</var>, and either <var>d</var>'s <a href="#concept-document-bc" id="nested-browsing-contexts:concept-document-bc-4">browsing context</a> is a <a href="#top-level-browsing-context" id="nested-browsing-contexts:top-level-browsing-context-4">top-level browsing context</a>, or <var>d</var>'s <a href="#concept-document-bc" id="nested-browsing-contexts:concept-document-bc-5">browsing context</a>'s <a href="#bc-container-document" id="nested-browsing-contexts:bc-container-document-3">container document</a> is <a href="#fully-active" id="nested-browsing-contexts:fully-active">fully active</a>.</p>

  <p><a href="#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-5">子ブラウジングコンテキスト</a>は要素に関連付けられているため、常にその<a href="#parent-browsing-context" id="nested-browsing-contexts:parent-browsing-context-5">親ブラウジングコンテキスト</a>内の特定の<code id="nested-browsing-contexts:document-3"><a href="dom.html#document">Document</a></code>に関連付けられている。 ユーザーエージェントは、ユーザーにがいない自身が<a href="#fully-active" id="nested-browsing-contexts:fully-active-2">完全にアクティブ</a>でない<code id="nested-browsing-contexts:document-4"><a href="dom.html#document">Document</a></code>にある要素の<a href="#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-6">子ブラウジングコンテキスト</a>と対話することを許可してはならない。</p>

  <div class="example"><p>次の例は、<a href="#active-document" id="nested-browsing-contexts:active-document-3">アクティブな</a><code id="nested-browsing-contexts:document-5"><a href="dom.html#document">Document</a></code>オブジェクトと<a href="#fully-active" id="nested-browsing-contexts:fully-active-3">完全にアクティブな</a><code id="nested-browsing-contexts:document-5"><a -ERR:REF-NOT-FOUND->Document</a></code>オブジェクトの違いを示している。 ここで、<code>a.html</code>はブラウザーのウィンドウに読み込まれ、<code>b-1.html</code>は示されているように最初に<code id="nested-browsing-contexts:the-iframe-element-2"><a href="iframe-embed-object.html#the-iframe-element">iframe</a></code>に読み込まれ、<code>b-2.html</code>および<code>c.html</code>は省略される（単に空の文書にすることができる）。</p>

   <pre><code class='html'><c- c>&lt;!-- a.html --></c->
<c- cp>&lt;!DOCTYPE html></c->
<c- p>&lt;</c-><c- f>html</c-> <c- e>lang</c-><c- o>=</c-><c- s>"en"</c-><c- p>></c->
<c- p>&lt;</c-><c- f>title</c-><c- p>></c->Browsing context A<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->

<c- p>&lt;</c-><c- f>iframe</c-> <c- e>src</c-><c- o>=</c-><c- s>"b-1.html"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
<c- p>&lt;</c-><c- f>button</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"frames[0].location.href = 'b-2.html'"</c-><c- p>></c->Click me<c- p>&lt;/</c-><c- f>button</c-><c- p>></c->

<c- c>&lt;!-- b-1.html --></c->
<c- cp>&lt;!DOCTYPE html></c->
<c- p>&lt;</c-><c- f>html</c-> <c- e>lang</c-><c- o>=</c-><c- s>"en"</c-><c- p>></c->
<c- p>&lt;</c-><c- f>title</c-><c- p>></c->Browsing context B<c- p>&lt;/</c-><c- f>title</c-><c- p>></c->

<c- p>&lt;</c-><c- f>iframe</c-> <c- e>src</c-><c- o>=</c-><c- s>"c.html"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c-></code></pre>

   <p>この時点で、<code>a.html</code>、<code>b-1.html</code>、および<code>c.html</code>によって提供される文書はすべて、それぞれの<a href="#concept-document-bc" id="nested-browsing-contexts:concept-document-bc-6">ブラウジングコンテキスト</a>の<a href="#active-document" id="nested-browsing-contexts:active-document-4">アクティブな文書</a>である。それらはまた、すべて<a href="#fully-active" id="nested-browsing-contexts:fully-active-4">完全にアクティブ</a>である。</p>

   <p><code id="nested-browsing-contexts:the-button-element"><a href="form-elements.html#the-button-element">button</a></code>をクリックし、<code>b-2.html</code>からブラウジングコンテキストBに新しい<code id="nested-browsing-contexts:document-6"><a href="dom.html#document">Document</a></code>をロードする後に、次の結果が得られる：</p>

   <ul><li><p><code>a.html</code> <code id="nested-browsing-contexts:document-7"><a href="dom.html#document">Document</a></code>は、ブラウジングコンテキストAの<a href="#active-document" id="nested-browsing-contexts:active-document-5">アクティブな文書</a>のままであり、<a href="#fully-active" id="nested-browsing-contexts:fully-active-5">完全にアクティブ</a>である。<li><p><code>b-1.html</code> <code id="nested-browsing-contexts:document-8"><a href="dom.html#document">Document</a></code> は、ブラウジングコンテキストBの<a href="#active-document" id="nested-browsing-contexts:active-document-6">アクティブな文書</a>では<em>なくなった</em>。そのため、<a href="#fully-active" id="nested-browsing-contexts:fully-active-6">完全にアクティブ</a>にもならない。<li><p>新しい<code>b-2.html</code> <code id="nested-browsing-contexts:document-9"><a href="dom.html#document">Document</a></code> は、ブラウジングコンテキストBの<a href="#active-document" id="nested-browsing-contexts:active-document-7">アクティブな文書</a>になり、<a href="#fully-active" id="nested-browsing-contexts:fully-active-7">完全にアクティブ</a>にもなる。<li><p><code>c.html</code> <code id="nested-browsing-contexts:document-10"><a href="dom.html#document">Document</a></code>は引き続きブラウジングコンテキストCの<a href="#active-document" id="nested-browsing-contexts:active-document-8">アクティブな文書</a>である。しかし、Cの<a href="#bc-container-document" id="nested-browsing-contexts:bc-container-document-4">コンテナー文書</a>は<code>b-1.html</code> <code id="nested-browsing-contexts:document-11"><a href="dom.html#document">Document</a></code>であり、それ自身は<a href="#fully-active" id="nested-browsing-contexts:fully-active-8">完全にアクティブ</a>ではないため、 <code>c.html</code> <code id="nested-browsing-contexts:document-12"><a href="dom.html#document">Document</a></code>は<a href="#fully-active" id="nested-browsing-contexts:fully-active-9">完全にアクティブ</a>にはならない（<a href="#active-document" id="nested-browsing-contexts:active-document-9">アクティブ</a>であるにもかかわらず）。</ul>

   <p>ここに含まれる複雑さ、特に<a href="history.html#history">セッション履歴</a>に影響を与える詳細については、<cite>A Model of Navigation History</cite>を参照のこと。<a href="references.html#refsNAVMODEL">[NAVMODEL]</a></p>
  </div>

  <p><a href="#child-browsing-context" id="nested-browsing-contexts:child-browsing-context-7">子ブラウジングコンテキスト</a>は、<dfn id="delaying-load-events-mode">遅延<code>load</code>イベントモード</dfn>にすることができる。新しい<code id="nested-browsing-contexts:document-13"><a href="dom.html#document">Document</a></code>が作成される前に、<a href="#bc-container" id="nested-browsing-contexts:bc-container-7">コンテナー</a>の<a id="nested-browsing-contexts:delay-the-load-event" href="parsing.html#delay-the-load-event">ロードイベントを遅延させる</a>ために、<a href="browsing-the-web.html#navigate" id="nested-browsing-contexts:navigate">ナビゲート</a>時に使用される。</p>

  <p><a href="#browsing-context" id="nested-browsing-contexts:browsing-context-14">ブラウジングコンテキスト</a>の<dfn id="document-family">文書ファミリー</dfn>は、その<a href="#browsing-context" id="nested-browsing-contexts:browsing-context-15">ブラウジングコンテキスト</a>の<a id="nested-browsing-contexts:session-history" href="history.html#session-history">セッション履歴</a>ですべての<code id="nested-browsing-contexts:document-14"><a href="dom.html#document">Document</a></code>オブジェクトおよびすべてのそれら<code id="nested-browsing-contexts:document-15"><a href="dom.html#document">Document</a></code>オブジェクトの<a href="#document-family" id="nested-browsing-contexts:document-family">文書ファミリー</a>の和集合で構成される。<code id="nested-browsing-contexts:document-16"><a href="dom.html#document">Document</a></code>オブジェクトの<a href="#document-family" id="nested-browsing-contexts:document-family-2">文書ファミリー</a>は、<code id="nested-browsing-contexts:document-17"><a href="dom.html#document">Document</a></code>オブジェクトの<a href="#list-of-the-descendant-browsing-contexts" id="nested-browsing-contexts:list-of-the-descendant-browsing-contexts-2">子孫のブラウジングコンテキストのリスト</a>にある<a href="#browsing-context" id="nested-browsing-contexts:browsing-context-16">ブラウジングコンテキスト</a>のすべての<a href="#document-family" id="nested-browsing-contexts:document-family-3">文書ファミリー</a>の和集合で構成される。</p>

  <p><a href="#browsing-context-container" id="nested-browsing-contexts:browsing-context-container-4">ブラウジングコンテキストコンテナー</a> <var>container</var>の<dfn id="concept-bcc-content-document">コンテンツ文書</dfn>は、次のアルゴリズムの結果である：</p>

  <ol><li><p><var>container</var>の<a href="#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context-4">ネストされたブラウジングコンテキスト</a>がnullである場合、nullを返す。<li><p><var>context</var>を<var>container</var>の<a href="#nested-browsing-context" id="nested-browsing-contexts:nested-browsing-context-5">ネストされたブラウジングコンテキスト</a>にする。<li><p><var>document</var>を<var>context</var>の<a href="#active-document" id="nested-browsing-contexts:active-document-10">アクティブ文書</a>にする。<li><p><var>document</var>の<a href="https://dom.spec.whatwg.org/#concept-document-origin" id="nested-browsing-contexts:concept-document-origin" data-x-internal="concept-document-origin">生成元</a>および<var>container</var>の<a id="nested-browsing-contexts:node-document-2" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">ノード文書</a>の<a href="https://dom.spec.whatwg.org/#concept-document-origin" id="nested-browsing-contexts:concept-document-origin-2" data-x-internal="concept-document-origin">生成元</a>が<a id="nested-browsing-contexts:same-origin-domain" href="origin.html#same-origin-domain">同一生成元ドメイン</a>でない場合、nullを返す。<li><p><var>document</var>を返す。</ol>


  <h5 id="navigating-nested-browsing-contexts-in-the-dom"><span class="secno">7.1.2.1</span> DOMで関連するブラウジングコンテキストをナビゲートする<a href="#navigating-nested-browsing-contexts-in-the-dom" class="self-link"></a></h5>

  <dl class="domintro"><dt><code><var>window</var>.<a href="#dom-top" id="dom-top-dev">top</a></code><div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/top" title="Returns a reference to the topmost window in the window hierarchy.">Window/top</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>3+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>12.1+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>12.1+</span></span></div></div></div><dd><p><a href="#top-level-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context">トップレベルブラウジングコンテキスト</a>の<code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy"><a href="window-object.html#windowproxy">WindowProxy</a></code>を返す。<dt><code><var>window</var>.<a href="#dom-opener" id="dom-opener-dev">opener</a> [ = <var>value</var> ]</code><div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/opener" title="The Window interface's opener property returns a reference to the window that opened the window, either with open(), or by navigating a link with a target attribute.">Window/opener</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>3+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>9+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd><p><a href="#opener-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:opener-browsing-context">オープナーブラウジングコンテキスト</a>に対する<code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-2"><a href="window-object.html#windowproxy">WindowProxy</a></code>を返す。</p>

    <p>存在しないまたはnullが設定されている場合、nullを返す。</p>

    <p>nullに設定可能である。</p>
   <dt><code><var>window</var>.<a href="#dom-parent" id="dom-parent-dev">parent</a></code><div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/parent" title="The Window.parent property is a reference to the parent of the current window or subframe.">Window/parent</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1.3+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>3+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>9+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd><p><a href="#parent-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:parent-browsing-context">親ブラウジングコンテキスト</a>に対する<code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-3"><a href="window-object.html#windowproxy">WindowProxy</a></code>を返す。<dt><code><var>window</var>.<a href="#dom-frameelement" id="dom-frameelement-dev">frameElement</a></code><div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/frameElement" title="The Window.frameElement property returns the element (such as &lt;iframe> or &lt;object>) in which the window is embedded.">Window/frameElement</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>3+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>12.1+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>5.5+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>12.1+</span></span></div></div></div><dd><p><a href="#browsing-context-container" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-container">ブラウジングコンテキストコンテナー</a>の<code id="navigating-nested-browsing-contexts-in-the-dom:element"><a data-x-internal="element" href="https://triple-underscore.github.io/DOM4-ja.html#interface-element">Element</a></code>を返す。</p>

    <p>存在しない場合、生成元をまたいだ状況でnullを返す。</p>
   </dl>

  

  <p>The <dfn data-dfn-for="Window" id="dom-top" data-dfn-type="attribute"><code>top</code></dfn> attribute's getter must run these steps:</p>

  <ol><li><p>If this <code id="navigating-nested-browsing-contexts-in-the-dom:window"><a href="window-object.html#window">Window</a></code> object's <a href="window-object.html#window-bc" id="navigating-nested-browsing-contexts-in-the-dom:window-bc">browsing context</a> is null, then return null.<li><p>Return this <code id="navigating-nested-browsing-contexts-in-the-dom:window-2"><a href="window-object.html#window">Window</a></code> object's <a href="window-object.html#window-bc" id="navigating-nested-browsing-contexts-in-the-dom:window-bc-2">browsing context</a>'s <a href="#top-level-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context-2">top-level browsing context</a>'s <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-4"><a href="window-object.html#windowproxy">WindowProxy</a></code> object.</ol>

  <p>The <dfn data-dfn-for="Window" id="dom-opener" data-dfn-type="attribute"><code>opener</code></dfn> attribute's getter must run these steps:</p>

  <ol><li><p>Let <var>current</var> be this <code id="navigating-nested-browsing-contexts-in-the-dom:window-3"><a href="window-object.html#window">Window</a></code> object's <a href="window-object.html#window-bc" id="navigating-nested-browsing-contexts-in-the-dom:window-bc-3">browsing context</a>.<li><p>If <var>current</var> is null, then return null.<li><p>If <var>current</var>'s <a href="#disowned-its-opener" id="navigating-nested-browsing-contexts-in-the-dom:disowned-its-opener">disowned</a> is true, then return null.<li><p>If <var>current</var>'s <a href="#opener-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:opener-browsing-context-2">opener browsing context</a> is null, then return null.<li><p>Return <var>current</var>'s <a href="#opener-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:opener-browsing-context-3">opener browsing context</a>'s <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-5"><a href="window-object.html#windowproxy">WindowProxy</a></code> object.</ol>

  <p>The <code id="navigating-nested-browsing-contexts-in-the-dom:dom-opener"><a href="#dom-opener">opener</a></code> attribute's setter must run these steps:</p>

  <ol><li><p>If the given value is null and this <code id="navigating-nested-browsing-contexts-in-the-dom:window-4"><a href="window-object.html#window">Window</a></code> object's <a href="window-object.html#window-bc" id="navigating-nested-browsing-contexts-in-the-dom:window-bc-4">browsing context</a> is non-null, then set this <code id="navigating-nested-browsing-contexts-in-the-dom:window-5"><a href="window-object.html#window">Window</a></code> object's <a href="window-object.html#window-bc" id="navigating-nested-browsing-contexts-in-the-dom:window-bc-5">browsing context</a>'s <a href="#disowned-its-opener" id="navigating-nested-browsing-contexts-in-the-dom:disowned-its-opener-2">disowned</a> to true.<li><p>If the given value is non-null, then return ? <a id="navigating-nested-browsing-contexts-in-the-dom:ordinarydefineownproperty" href="https://tc39.es/ecma262/#sec-ordinarydefineownproperty" data-x-internal="ordinarydefineownproperty">OrdinaryDefineOwnProperty</a>(this <code id="navigating-nested-browsing-contexts-in-the-dom:window-6"><a href="window-object.html#window">Window</a></code> object, "<code>opener</code>", { [[Value]]: the given value, [[Writable]]: true, [[Enumerable]]: true, [[Configurable]]: true }).</ol>

  <div class="note"><p>If a <a href="#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context">browsing context</a>'s <a href="#disowned-its-opener" id="navigating-nested-browsing-contexts-in-the-dom:disowned-its-opener-3">disowned</a> is true, its <code id="navigating-nested-browsing-contexts-in-the-dom:dom-opener-2"><a href="#dom-opener">window.opener</a></code> attribute is null. That prevents scripts in the <a href="#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-2">browsing context</a> from changing any properties of its <a href="#opener-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:opener-browsing-context-4">opener browsing context</a>'s <code id="navigating-nested-browsing-contexts-in-the-dom:window-7"><a href="window-object.html#window">Window</a></code> object (i.e., the <code id="navigating-nested-browsing-contexts-in-the-dom:window-8"><a href="window-object.html#window">Window</a></code> object from which the <a href="#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-3">browsing context</a> was created).</p>

   <p>Otherwise, if a <a href="#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-4">browsing context</a>'s <a href="#disowned-its-opener" id="navigating-nested-browsing-contexts-in-the-dom:disowned-its-opener-4">disowned</a> is false, then scripts in that <a href="#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-5">browsing context</a> can use <code id="navigating-nested-browsing-contexts-in-the-dom:dom-opener-3"><a href="#dom-opener">window.opener</a></code> to change properties of its <a href="#opener-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:opener-browsing-context-5">opener browsing context</a>'s <code id="navigating-nested-browsing-contexts-in-the-dom:window-9"><a href="window-object.html#window">Window</a></code> object. For example, a script running in the <a href="#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-6">browsing context</a> can change the value of <code>window.opener.location</code>, causing the <a href="#opener-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:opener-browsing-context-6">opener browsing context</a> to navigate to a completely different document.</p>
  </div>

  <p>The <dfn data-dfn-for="Window" id="dom-parent" data-dfn-type="attribute"><code>parent</code></dfn> attribute's getter must run these steps:</p>

  <ol><li><p>Let <var>current</var> be this <code id="navigating-nested-browsing-contexts-in-the-dom:window-10"><a href="window-object.html#window">Window</a></code> object's <a href="window-object.html#window-bc" id="navigating-nested-browsing-contexts-in-the-dom:window-bc-6">browsing context</a>.<li><p>If <var>current</var> is null, then return null.<li><p>If <var>current</var> is a <a href="#child-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:child-browsing-context">child browsing context</a> of another <a href="#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-7">browsing context</a> <var>parent</var>, then return <var>parent</var>'s <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-6"><a href="window-object.html#windowproxy">WindowProxy</a></code> object.<li><p>Assert: <var>current</var> is a <a href="#top-level-browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context-3">top-level browsing context</a>.<li><p>Return <var>current</var>'s <code id="navigating-nested-browsing-contexts-in-the-dom:windowproxy-7"><a href="window-object.html#windowproxy">WindowProxy</a></code> object.</ol>

  <p>The <dfn data-dfn-for="Window" id="dom-frameelement" data-dfn-type="attribute"><code>frameElement</code></dfn> attribute's getter must run these steps:</p>

  <ol><li><p>Let <var>current</var> be this <code id="navigating-nested-browsing-contexts-in-the-dom:window-11"><a href="window-object.html#window">Window</a></code> object's <a href="window-object.html#window-bc" id="navigating-nested-browsing-contexts-in-the-dom:window-bc-7">browsing context</a>.<li><p>If <var>current</var> is null, then return null.<li><p>Let <var>container</var> be <var>current</var>'s <a href="#bc-container" id="navigating-nested-browsing-contexts-in-the-dom:bc-container">container</a>.<li><p>If <var>container</var> is null, then return null.<li><p>If <var>container</var>'s <a id="navigating-nested-browsing-contexts-in-the-dom:node-document" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>'s <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="navigating-nested-browsing-contexts-in-the-dom:concept-document-origin" data-x-internal="concept-document-origin">origin</a> is not <a id="navigating-nested-browsing-contexts-in-the-dom:same-origin-domain" href="origin.html#same-origin-domain">same origin-domain</a> with the <a id="navigating-nested-browsing-contexts-in-the-dom:current-settings-object" href="webappapis.html#current-settings-object">current settings object</a>'s <a href="webappapis.html#concept-settings-object-origin" id="navigating-nested-browsing-contexts-in-the-dom:concept-settings-object-origin">origin</a>, then return null.<li><p>Return <var>container</var>.</ol>

  <div class="example"><p>An example of when these IDL attributes can return null is as follows:</p>

   <pre><code class='html'><c- cp>&lt;!DOCTYPE html></c->
<c- p>&lt;</c-><c- f>iframe</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->

<c- p>&lt;</c-><c- f>script</c-><c- p>></c->
<c- u>"use strict"</c-><c- p>;</c->
<c- a>const</c-> element <c- o>=</c-> document<c- p>.</c->querySelector<c- p>(</c-><c- u>"iframe"</c-><c- p>);</c->
<c- a>const</c-> iframeWindow <c- o>=</c-> element<c- p>.</c->contentWindow<c- p>;</c->
element<c- p>.</c->remove<c- p>();</c->

console<c- p>.</c->assert<c- p>(</c->iframeWindow<c- p>.</c->top <c- o>===</c-> <c- kc>null</c-><c- p>);</c->
console<c- p>.</c->assert<c- p>(</c->iframeWindow<c- p>.</c->parent <c- o>===</c-> <c- kc>null</c-><c- p>);</c->
console<c- p>.</c->assert<c- p>(</c->iframeWindow<c- p>.</c->frameElement <c- o>===</c-> <c- kc>null</c-><c- p>);</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c-></code></pre>

   <p>Here the <a href="#browsing-context" id="navigating-nested-browsing-contexts-in-the-dom:browsing-context-8">browsing context</a> corresponding to <code>iframeWindow</code> was <a href="window-object.html#a-browsing-context-is-discarded" id="navigating-nested-browsing-contexts-in-the-dom:a-browsing-context-is-discarded">discarded</a> when <code>element</code> was removed from the document.</p>
  </div>



  <h4 id="security-nav"><span class="secno">7.1.3</span> Security<a href="#security-nav" class="self-link"></a></h4>

  <p id="security-1">A <a href="#browsing-context" id="security-nav:browsing-context">browsing context</a> <var>A</var> is <dfn id="familiar-with">familiar with</dfn> a second <a href="#browsing-context" id="security-nav:browsing-context-2">browsing context</a> <var>B</var> if one of the following conditions is true:</p>

  <ul><li>Either the <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="security-nav:concept-document-origin" data-x-internal="concept-document-origin">origin</a> of the <a href="#active-document" id="security-nav:active-document">active document</a> of <var>A</var> is the <a href="origin.html#same-origin" id="security-nav:same-origin">same</a> as the <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="security-nav:concept-document-origin-2" data-x-internal="concept-document-origin">origin</a> of the <a href="#active-document" id="security-nav:active-document-2">active document</a> of <var>B</var>, or<li>The browsing context <var>A</var> is a <a href="#child-browsing-context" id="security-nav:child-browsing-context">child browsing context</a> and its <a href="#top-level-browsing-context" id="security-nav:top-level-browsing-context">top-level browsing context</a> is <var>B</var>, or<li>The browsing context <var>B</var> is an <a href="#auxiliary-browsing-context" id="security-nav:auxiliary-browsing-context">auxiliary browsing context</a> and <var>A</var> is <a href="#familiar-with" id="security-nav:familiar-with">familiar with</a> <var>B</var>'s <a href="#opener-browsing-context" id="security-nav:opener-browsing-context">opener browsing context</a>, or<li>The browsing context <var>B</var> is not a <a href="#top-level-browsing-context" id="security-nav:top-level-browsing-context-2">top-level browsing context</a>, but there exists an <a href="#ancestor-browsing-context" id="security-nav:ancestor-browsing-context">ancestor browsing context</a> of <var>B</var> whose <a href="#active-document" id="security-nav:active-document-3">active document</a> has the <a href="origin.html#same-origin" id="security-nav:same-origin-2">same</a> <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="security-nav:concept-document-origin-3" data-x-internal="concept-document-origin">origin</a> as the <a href="#active-document" id="security-nav:active-document-4">active document</a> of <var>A</var> (possibly in fact being <var>A</var> itself).</ul>

  <hr>

  <p>A <a href="#browsing-context" id="security-nav:browsing-context-3">browsing context</a> <var>A</var> is <dfn id="allowed-to-navigate">allowed to navigate</dfn> a second <a href="#browsing-context" id="security-nav:browsing-context-4">browsing context</a> <var>B</var> if the following algorithm returns true:</p>

  <ol><li><p>If <var>A</var> is not the same <a href="#browsing-context" id="security-nav:browsing-context-5">browsing context</a> as <var>B</var>, and <var>A</var> is not one of the <a href="#ancestor-browsing-context" id="security-nav:ancestor-browsing-context-2">ancestor browsing contexts</a> of <var>B</var>, and <var>B</var> is not a <a href="#top-level-browsing-context" id="security-nav:top-level-browsing-context-3">top-level browsing context</a>, and <var>A</var>'s <a href="#active-document" id="security-nav:active-document-5">active document</a>'s <a id="security-nav:active-sandboxing-flag-set" href="origin.html#active-sandboxing-flag-set">active sandboxing flag set</a> has its <a id="security-nav:sandboxed-navigation-browsing-context-flag" href="origin.html#sandboxed-navigation-browsing-context-flag">sandboxed navigation browsing context flag</a> set, then return false.<li><p>Otherwise, if <var>B</var> is a <a href="#top-level-browsing-context" id="security-nav:top-level-browsing-context-4">top-level browsing context</a>, and is one of the <a href="#ancestor-browsing-context" id="security-nav:ancestor-browsing-context-3">ancestor browsing contexts</a> of <var>A</var>, then:</p>

    <ol><li><p>If <var>A</var>'s <a href="#active-window" id="security-nav:active-window">active window</a> has <a id="security-nav:transient-activation" href="interaction.html#transient-activation">transient activation</a> and <var>A</var>'s <a href="#active-document" id="security-nav:active-document-6">active document</a>'s <a id="security-nav:active-sandboxing-flag-set-2" href="origin.html#active-sandboxing-flag-set">active sandboxing flag set</a> has its <a id="security-nav:sandboxed-top-level-navigation-with-user-activation-browsing-context-flag" href="origin.html#sandboxed-top-level-navigation-with-user-activation-browsing-context-flag">sandboxed top-level navigation with user activation browsing context flag</a> set, then return false.<li><p>Otherwise, if <var>A</var>'s <a href="#active-window" id="security-nav:active-window-2">active window</a> does not have <a id="security-nav:transient-activation-2" href="interaction.html#transient-activation">transient activation</a> and <var>A</var>'s <a href="#active-document" id="security-nav:active-document-7">active document</a>'s <a id="security-nav:active-sandboxing-flag-set-3" href="origin.html#active-sandboxing-flag-set">active sandboxing flag set</a> has its <a id="security-nav:sandboxed-top-level-navigation-without-user-activation-browsing-context-flag" href="origin.html#sandboxed-top-level-navigation-without-user-activation-browsing-context-flag">sandboxed top-level navigation without user activation browsing context flag</a> set, then return false.</ol>
   <li><p>Otherwise, if <var>B</var> is a <a href="#top-level-browsing-context" id="security-nav:top-level-browsing-context-5">top-level browsing context</a>, and is neither <var>A</var> nor one of the <a href="#ancestor-browsing-context" id="security-nav:ancestor-browsing-context-4">ancestor browsing contexts</a> of <var>A</var>, and <var>A</var>'s <code id="security-nav:document"><a href="dom.html#document">Document</a></code>'s <a id="security-nav:active-sandboxing-flag-set-4" href="origin.html#active-sandboxing-flag-set">active sandboxing flag set</a> has its <a id="security-nav:sandboxed-navigation-browsing-context-flag-2" href="origin.html#sandboxed-navigation-browsing-context-flag">sandboxed navigation browsing context flag</a> set, and <var>A</var> is not the <a id="security-nav:one-permitted-sandboxed-navigator" href="origin.html#one-permitted-sandboxed-navigator">one permitted sandboxed navigator</a> of <var>B</var>, then return false.<li><p>Return true.</ol>

  <hr>

  <p>An element has a <dfn id="browsing-context-scope-origin">browsing context scope origin</dfn> if its <code id="security-nav:document-2"><a href="dom.html#document">Document</a></code>'s <a href="#concept-document-bc" id="security-nav:concept-document-bc">browsing context</a> is a <a href="#top-level-browsing-context" id="security-nav:top-level-browsing-context-6">top-level browsing context</a> or if all of its <code id="security-nav:document-3"><a href="dom.html#document">Document</a></code>'s <a href="#ancestor-browsing-context" id="security-nav:ancestor-browsing-context-5">ancestor browsing contexts</a> all have <a href="#active-document" id="security-nav:active-document-8">active documents</a> whose <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="security-nav:concept-document-origin-4" data-x-internal="concept-document-origin">origins</a> are the <a id="security-nav:same-origin-3" href="origin.html#same-origin">same origin</a> as the element's <a id="security-nav:node-document" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>'s <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="security-nav:concept-document-origin-5" data-x-internal="concept-document-origin">origin</a>. If an element has a <a href="#browsing-context-scope-origin" id="security-nav:browsing-context-scope-origin">browsing context scope origin</a>, then its value is the <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="security-nav:concept-document-origin-6" data-x-internal="concept-document-origin">origin</a> of the element's <a id="security-nav:node-document-2" href="https://triple-underscore.github.io/DOM4-ja.html#concept-node-document" data-x-internal="node-document">node document</a>.</p>

  


  

  <h4 id="groupings-of-browsing-contexts"><span class="secno">7.1.4</span> Groupings of browsing contexts<a href="#groupings-of-browsing-contexts" class="self-link"></a></h4>

  <p>A user agent holds a <dfn id="browsing-context-group-set">browsing context group set</dfn> (a <a id="groupings-of-browsing-contexts:set" href="https://triple-underscore.github.io/infra-ja.html#ordered-set" data-x-internal="set">set</a> of <a href="#browsing-context-group" id="groupings-of-browsing-contexts:browsing-context-group">browsing context groups</a>).</p>

  <p>A <dfn id="browsing-context-group">browsing context group</dfn> holds a <dfn id="browsing-context-set">browsing context set</dfn> (a <a id="groupings-of-browsing-contexts:set-2" href="https://triple-underscore.github.io/infra-ja.html#ordered-set" data-x-internal="set">set</a> of <a href="#top-level-browsing-context" id="groupings-of-browsing-contexts:top-level-browsing-context">top-level browsing contexts</a>).</p>

  <p class="note">A <a href="#top-level-browsing-context" id="groupings-of-browsing-contexts:top-level-browsing-context-2">top-level browsing context</a> is added to the <a href="#browsing-context-group" id="groupings-of-browsing-contexts:browsing-context-group-2">group</a> when the group is <a href="#creating-a-new-browsing-context-group" id="groupings-of-browsing-contexts:creating-a-new-browsing-context-group">created</a>. All subsequent <a href="#top-level-browsing-context" id="groupings-of-browsing-contexts:top-level-browsing-context-3">top-level browsing contexts</a> added to the <a href="#browsing-context-group" id="groupings-of-browsing-contexts:browsing-context-group-3">group</a> will be <a href="#auxiliary-browsing-context" id="groupings-of-browsing-contexts:auxiliary-browsing-context">auxiliary browsing contexts</a>.</p>

  <p>A <a href="#browsing-context-group" id="groupings-of-browsing-contexts:browsing-context-group-4">browsing context group</a> has an associated <dfn id="agent-cluster-map">agent cluster map</dfn> (a weak <a href="https://triple-underscore.github.io/infra-ja.html#ordered-map" id="groupings-of-browsing-contexts:ordered-map" data-x-internal="ordered-map">map</a> of <a href="webappapis.html#agent-cluster-key" id="groupings-of-browsing-contexts:agent-cluster-key">agent cluster keys</a> to <a href="https://tc39.es/ecma262/#sec-agent-clusters" id="groupings-of-browsing-contexts:agent-cluster" data-x-internal="agent-cluster">agent clusters</a>). User agents are responsible for collecting agent clusters when it is deemed that nothing can access them anymore.</p>

  <p>A <a href="#browsing-context-group" id="groupings-of-browsing-contexts:browsing-context-group-5">browsing context group</a> has an associated <dfn id="historical-agent-cluster-key-map">historical agent cluster key map</dfn>, which is a <a href="https://triple-underscore.github.io/infra-ja.html#ordered-map" id="groupings-of-browsing-contexts:ordered-map-2" data-x-internal="ordered-map">map</a> of <a href="origin.html#concept-origin" id="groupings-of-browsing-contexts:concept-origin">origins</a> to <a href="webappapis.html#agent-cluster-key" id="groupings-of-browsing-contexts:agent-cluster-key-2">agent cluster keys</a>. This map is used to ensure the consistency of the <a href="origin.html#origin-keyed-agent-clusters">origin-keyed agent clusters</a> feature by recording what agent cluster keys were previously used for a given origin.</p>

  <p class="note">The <a href="#historical-agent-cluster-key-map" id="groupings-of-browsing-contexts:historical-agent-cluster-key-map">historical agent cluster key map</a> only ever gains entries over the lifetime of the browsing context group.</p>

  <p>A <a href="#browsing-context-group" id="groupings-of-browsing-contexts:browsing-context-group-6">browsing context group</a> has a <dfn id="bcg-cross-origin-isolation">cross-origin isolation mode</dfn>, which is a <a href="#cross-origin-isolation-mode" id="groupings-of-browsing-contexts:cross-origin-isolation-mode">cross-origin isolation mode</a>. It is initially "<code id="groupings-of-browsing-contexts:cross-origin-isolation-none"><a href="#cross-origin-isolation-none">none</a></code>".</p>

  <p>A <dfn id="cross-origin-isolation-mode">cross-origin isolation mode</dfn> is one of three possible values: "<dfn id="cross-origin-isolation-none"><code>none</code></dfn>", "<dfn id="cross-origin-isolation-logical"><code>logical</code></dfn>", or "<dfn id="cross-origin-isolation-concrete"><code>concrete</code></dfn>".</p>

  <div class="note"><p>"<code id="groupings-of-browsing-contexts:cross-origin-isolation-logical"><a href="#cross-origin-isolation-logical">logical</a></code>" and "<code id="groupings-of-browsing-contexts:cross-origin-isolation-concrete"><a href="#cross-origin-isolation-concrete">concrete</a></code>" are similar. They are both used for <a href="#browsing-context-group" id="groupings-of-browsing-contexts:browsing-context-group-7">browsing context groups</a> where:</p>

   <ul><li><p>every top-level <a id="groupings-of-browsing-contexts:document" href="dom.html#document">Document</a> has `<code><a href="iana.html#cross-origin-opener-policy-2" id="groupings-of-browsing-contexts:cross-origin-opener-policy-2">Cross-Origin-Opener-Policy</a>: <a href="origin.html#coop-same-origin" id="groupings-of-browsing-contexts:coop-same-origin">same-origin</a></code>`, and<li><p>every <a id="groupings-of-browsing-contexts:document-2" href="dom.html#document">Document</a> has `<code><a id="groupings-of-browsing-contexts:cross-origin-embedder-policy" href="iana.html#cross-origin-embedder-policy">Cross-Origin-Embedder-Policy</a>: <a href="origin.html#coep-require-corp" id="groupings-of-browsing-contexts:coep-require-corp">require-corp</a></code>`.</ul>

   <p>On some platforms, it is difficult to provide the security properties required to grant safe access to the APIs gated by the <a href="webappapis.html#concept-settings-object-cross-origin-isolated-capability" id="groupings-of-browsing-contexts:concept-settings-object-cross-origin-isolated-capability">cross-origin isolated capability</a>. As a result, only "<code id="groupings-of-browsing-contexts:cross-origin-isolation-concrete-2"><a href="#cross-origin-isolation-concrete">concrete</a></code>" can grant access that capability. "<code id="groupings-of-browsing-contexts:cross-origin-isolation-logical-2"><a href="#cross-origin-isolation-logical">logical</a></code>" is used on platform not supporting this capability, where various restrictions imposed by cross-origin isolation will still apply, but the capability is not granted.</p>
  </div>

  <p>To <dfn id="creating-a-new-browsing-context-group">create a new browsing context group</dfn>, run these steps:</p>

  <ol><li><p>Let <var>group</var> be a new <a href="#browsing-context-group" id="groupings-of-browsing-contexts:browsing-context-group-8">browsing context group</a>.<li><p><a href="https://triple-underscore.github.io/infra-ja.html#set-append" id="groupings-of-browsing-contexts:set-append" data-x-internal="set-append">Append</a> <var>group</var> to the user agent's <a href="#browsing-context-group-set" id="groupings-of-browsing-contexts:browsing-context-group-set">browsing context group set</a>.<li><p>Let <var>browsingContext</var> be the result of <a href="#creating-a-new-browsing-context" id="groupings-of-browsing-contexts:creating-a-new-browsing-context">creating a new browsing context</a> with null, null, and <var>group</var>.<li><p><a href="#bcg-append" id="groupings-of-browsing-contexts:bcg-append">Append</a> <var>browsingContext</var> to <var>group</var>.<li><p>Return <var>group</var>.</ol>

  <p>To <dfn id="bcg-append">append</dfn> a <a href="#top-level-browsing-context" id="groupings-of-browsing-contexts:top-level-browsing-context-4">top-level browsing context</a> <var>browsingContext</var> to a <a href="#browsing-context-group" id="groupings-of-browsing-contexts:browsing-context-group-9">browsing context group</a> <var>group</var>, run these steps:</p>

  <ol><li><p><a href="https://triple-underscore.github.io/infra-ja.html#set-append" id="groupings-of-browsing-contexts:set-append-2" data-x-internal="set-append">Append</a> <var>browsingContext</var> to <var>group</var>'s <a href="#browsing-context-set" id="groupings-of-browsing-contexts:browsing-context-set">browsing context set</a>.<li><p>Set <var>browsingContext</var>'s <a href="#tlbc-group" id="groupings-of-browsing-contexts:tlbc-group">group</a> to <var>group</var>.</ol>

  <p>To <dfn id="bcg-remove">remove</dfn> a <a href="#top-level-browsing-context" id="groupings-of-browsing-contexts:top-level-browsing-context-5">top-level browsing context</a> <var>browsingContext</var>, run these steps:</p>

  <ol><li><p>Assert: <var>browsingContext</var>'s <a href="#tlbc-group" id="groupings-of-browsing-contexts:tlbc-group-2">group</a> is non-null, because a <a href="#browsing-context" id="groupings-of-browsing-contexts:browsing-context">browsing context</a> only gets <a href="window-object.html#a-browsing-context-is-discarded" id="groupings-of-browsing-contexts:a-browsing-context-is-discarded">discarded</a> once.<li><p>Let <var>group</var> be <var>browsingContext</var>'s <a href="#tlbc-group" id="groupings-of-browsing-contexts:tlbc-group-3">group</a>.<li><p>Set <var>browsingContext</var>'s <a href="#tlbc-group" id="groupings-of-browsing-contexts:tlbc-group-4">group</a> to null.<li><p><a href="https://triple-underscore.github.io/infra-ja.html#list-remove" id="groupings-of-browsing-contexts:list-remove" data-x-internal="list-remove">Remove</a> <var>browsingContext</var> from <var>group</var>'s <a href="#browsing-context-set" id="groupings-of-browsing-contexts:browsing-context-set-2">browsing context set</a>.<li><p>If <var>group</var>'s <a href="#browsing-context-set" id="groupings-of-browsing-contexts:browsing-context-set-3">browsing context set</a> <a href="https://triple-underscore.github.io/infra-ja.html#list-empty" id="groupings-of-browsing-contexts:list-is-empty" data-x-internal="list-is-empty">is empty</a>, then <a href="https://triple-underscore.github.io/infra-ja.html#list-remove" id="groupings-of-browsing-contexts:list-remove-2" data-x-internal="list-remove">remove</a> <var>group</var> from the user agent's <a href="#browsing-context-group-set" id="groupings-of-browsing-contexts:browsing-context-group-set-2">browsing context group set</a>.</ol>

  <p class="note"><a href="#bcg-append" id="groupings-of-browsing-contexts:bcg-append-2">Append</a> and <a href="#bcg-remove" id="groupings-of-browsing-contexts:bcg-remove">remove</a> are primitive operations that help define the lifetime of a <a href="#browsing-context-group" id="groupings-of-browsing-contexts:browsing-context-group-10">browsing context group</a>. They are called from <a href="#creating-a-new-browsing-context-group" id="groupings-of-browsing-contexts:creating-a-new-browsing-context-group-2">creating a new browsing context group</a>, <a href="#creating-a-new-auxiliary-browsing-context" id="groupings-of-browsing-contexts:creating-a-new-auxiliary-browsing-context">creating a new auxiliary browsing context</a>, and <a href="window-object.html#a-browsing-context-is-discarded" id="groupings-of-browsing-contexts:a-browsing-context-is-discarded-2">discarding a browsing context</a>.</p>

  <hr>

  <p class="note">The HTML Standard used to define "<span id="unit-of-related-browsing-contexts">unit of related browsing contexts</span>" and "<span id="unit-of-related-similar-origin-browsing-contexts">unit of related similar-origin browsing contexts</span>". These have been removed as they were not adequate.</p>

  



  <h4 id="browsing-context-names"><span class="secno">7.1.5</span> ブラウジングコンテキスト名<a href="#browsing-context-names" class="self-link"></a></h4>

  <p>ブラウジングコンテキストは、<dfn id="browsing-context-name">ブラウジングコンテキスト名</dfn>を持つことができる。特に明記しない限り、それは空文字列である。</p>

  <p><dfn id="valid-browsing-context-name">妥当なブラウジングコンテキスト名</dfn>は、U+005F LOW LINE文字で始まらない少なくとも1文字をもつ任意の文字列である。（アンダースコアで始まる名前は、特別なキーワードのために予約されている。）</p>

  <p><dfn id="valid-browsing-context-name-or-keyword">妥当なブラウジングコンテキスト名またはキーワード</dfn>は、<a href="#valid-browsing-context-name" id="browsing-context-names:valid-browsing-context-name">妥当なブラウジングコンテキスト名</a>または<a id="browsing-context-names:ascii-case-insensitive" href="https://triple-underscore.github.io/infra-ja.html#ascii-case-insensitive" data-x-internal="ascii-case-insensitive">ASCII大文字・小文字不区別</a>で<code>_blank</code>、<code>_self</code>、<code>_parent</code>、または<code>_top</code>の1つに一致するいずれかとなる任意の文字列である。</p>

  <p>これらの値は、以下の（非規範的な）テーブルで要約されるように、ページがサンドボックス化されるかどうかに基づいて異なる意味を持つ。この表において、"current"はリンクまたはスクリプト内にある<a href="#browsing-context" id="browsing-context-names:browsing-context">ブラウジングコンテキスト</a>を意味し、"parent"はリンクまたはスクリプト内にあるいずれかの<a href="#parent-browsing-context" id="browsing-context-names:parent-browsing-context">親ブラウジングコンテキスト</a>を意味し、"top"はリンクまたはスクリプトがあるいずれかの<a href="#top-level-browsing-context" id="browsing-context-names:top-level-browsing-context">トップレベルブラウジングコンテキスト</a>を意味し、"new"はさまざまなユーザー設定とユーザーエージェントのポリシーに次第で、新しい<a href="#top-level-browsing-context" id="browsing-context-names:top-level-browsing-context-2">トップレベルブラウジングコンテキスト</a>または<a href="#auxiliary-browsing-context" id="browsing-context-names:auxiliary-browsing-context">補助ブラウジングコンテキスト</a>が作成されることを意味し、"none"は何も起こらないことを意味し、"maybe new"は"<code id="browsing-context-names:attr-iframe-sandbox-allow-popups"><a href="origin.html#attr-iframe-sandbox-allow-popups">allow-popups</a></code>"キーワードはまた<code id="browsing-context-names:attr-iframe-sandbox"><a href="iframe-embed-object.html#attr-iframe-sandbox">sandbox</a></code>属性で指定される場合（またはユーザーがサンドボックスを覆う場合）、"new"と同じであり、そうでなければ"none"と同じである。</p>

  <table><thead><tr><th rowspan="2">キーワード<th rowspan="2">普通の効果<th colspan="2"><code id="browsing-context-names:the-iframe-element"><a href="iframe-embed-object.html#the-iframe-element">iframe</a></code>での効果<tr><th><code>sandbox=""</code><th><code>sandbox="allow-top-navigation"</code><tbody><tr><td>リンクおよびフォーム送信に対して、何も指定しない<td>current<td>current<td>current<tr><td>空文字列<td>current<td>current<td>current<tr><td><code>_blank</code><td>new<td>maybe new<td>maybe new<tr><td><code>_self</code><td>current<td>current<td>current<tr><td>親が存在しない場合の<code>_parent</code><td>current<td>current<td>current<tr><td>親がまたトップである場合の<code>_parent</code><td>parent/top<td>none<td>parent/top<tr><td>存在するがトップでない場合の<code>_parent</code><td>parent<td>none<td>none<tr><td>トップが現在である場合の<code>_top</code><td>current<td>current<td>current<tr><td>トップが現在でない場合の<code>_top</code><td>top<td>none<td>top<tr><td>名前が存在しない<td>new<td>maybe new<td>maybe new<tr><td>名前が存在しかつ子孫である<td>specified descendant<td>specified descendant<td>specified descendant<tr><td>名前が存在し現在である<td>current<td>current<td>current<tr><td>名前が存在しかつトップとなる祖先である<td>specified ancestor<td>none<td>specified ancestor/top<tr><td>名前が存在しかつトップでない祖先である<td>specified ancestor<td>none<td>none<tr><td>他の名前が共通のトップとともに存在する<td>specified<td>none<td>none<tr><td><a href="#familiar-with" id="browsing-context-names:familiar-with">familiar</a>かつ<a id="browsing-context-names:one-permitted-sandboxed-navigator" href="origin.html#one-permitted-sandboxed-navigator">ある許可されたサンドボックス化されたナビゲーター</a>である場合、異なるトップをもつ名前が存在する<td>specified<td>specified<td>specified<tr><td><a href="#familiar-with" id="browsing-context-names:familiar-with-2">familiar</a>だが<a id="browsing-context-names:one-permitted-sandboxed-navigator-2" href="origin.html#one-permitted-sandboxed-navigator">ある許可されたサンドボックス化されたナビゲーター</a>でない場合、異なるトップをもつ名前が存在する<td>specified<td>none<td>none<tr><td><a href="#familiar-with" id="browsing-context-names:familiar-with-3">familiar</a>でない、異なるトップをもつ名前が存在する<td>new<td>maybe new<td>maybe new</table>

  <p class="tablenote"><small>サンドボックス化されたブラウジングコンテキストの制限のほとんどは、他のアルゴリズムにより適用される。たとえば、下記で与えられる<a href="#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name" id="browsing-context-names:the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name">ブラウジングコンテキスト名で与えられたをブラウジングコンテキストを選択するための規則</a>でなく、<a href="browsing-the-web.html#navigate" id="browsing-context-names:navigate">ナビゲーション</a>アルゴリズムとして。</small></p>

  

  <hr>

  <p><dfn id="the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name">The rules for choosing a browsing context</dfn>, given a <a href="#browsing-context-name" id="browsing-context-names:browsing-context-name">browsing context name</a> <var>name</var>, a <a href="#browsing-context" id="browsing-context-names:browsing-context-2">browsing context</a> <var>current</var>, and a boolean <var>noopener</var> are as follows:</p>

  <ol><li><p>Let <var>chosen</var> be null.<li><p>Let <var>windowType</var> be "<code>existing or none</code>".<li><p>Let <var>sandboxingFlagSet</var> be <var>current</var>'s <a href="#active-document" id="browsing-context-names:active-document">active document</a>'s <a id="browsing-context-names:active-sandboxing-flag-set" href="origin.html#active-sandboxing-flag-set">active sandboxing flag set</a>.<li><p>If <var>name</var> is the empty string or an <a id="browsing-context-names:ascii-case-insensitive-2" href="https://triple-underscore.github.io/infra-ja.html#ascii-case-insensitive" data-x-internal="ascii-case-insensitive">ASCII case-insensitive</a> match for "<code>_self</code>", then set <var>chosen</var> to <var>current</var>.<li><p>Otherwise, if <var>name</var> is an <a id="browsing-context-names:ascii-case-insensitive-3" href="https://triple-underscore.github.io/infra-ja.html#ascii-case-insensitive" data-x-internal="ascii-case-insensitive">ASCII case-insensitive</a> match for "<code>_parent</code>", set <var>chosen</var> to <var>current</var>'s <a href="#parent-browsing-context" id="browsing-context-names:parent-browsing-context-2">parent browsing context</a>, if any, and <var>current</var> otherwise.<li><p>Otherwise, if <var>name</var> is an <a id="browsing-context-names:ascii-case-insensitive-4" href="https://triple-underscore.github.io/infra-ja.html#ascii-case-insensitive" data-x-internal="ascii-case-insensitive">ASCII case-insensitive</a> match for "<code>_top</code>", set <var>chosen</var> to <var>current</var>'s <a href="#top-level-browsing-context" id="browsing-context-names:top-level-browsing-context-3">top-level browsing context</a>, if any, and <var>current</var> otherwise.<li><p>Otherwise, if <var>name</var> is not an <a id="browsing-context-names:ascii-case-insensitive-5" href="https://triple-underscore.github.io/infra-ja.html#ascii-case-insensitive" data-x-internal="ascii-case-insensitive">ASCII case-insensitive</a> match for "<code>_blank</code>", there exists a browsing context whose <a href="#browsing-context-name" id="browsing-context-names:browsing-context-name-2">name</a> is the same as <var>name</var>, <var>current</var> is <a href="#familiar-with" id="browsing-context-names:familiar-with-4">familiar with</a> that browsing context, and the user agent determines that the two browsing contexts are related enough that it is ok if they reach each other, set <var>chosen</var> to that browsing context. If there are multiple matching browsing contexts, the user agent should set <var>chosen</var> to one in some arbitrary consistent manner, such as the most recently opened, most recently focused, or more closely related.</p>

    <p class="XXX">This will be made more precise in <a href="https://github.com/whatwg/html/issues/313">issue #313</a>.</p>
   <li><p>Otherwise, a new browsing context is being requested, and what happens depends on the user agent's configuration and abilities — it is determined by the rules given for the first applicable option from the following list:</p>

    <dl class="switch"><dt id="popup-blocker">If <var>current</var>'s <a href="#active-window" id="browsing-context-names:active-window">active window</a> does not have <a id="browsing-context-names:transient-activation" href="interaction.html#transient-activation">transient activation</a> and the user agent has been configured to not show popups (i.e., the user agent has a "popup blocker" enabled)<dd><p>The user agent may inform the user that a popup has been blocked.<dt id="sandboxWindowOpen">If <var>sandboxingFlagSet</var> has the <a id="browsing-context-names:sandboxed-auxiliary-navigation-browsing-context-flag" href="origin.html#sandboxed-auxiliary-navigation-browsing-context-flag">sandboxed auxiliary navigation browsing context flag</a> set<dd><p>The user agent may report to a developer console that a popup has been blocked.<dt>If the user agent has been configured such that in this instance it will create a new browsing context<dd><ol><li><p>Set <var>windowType</var> to "<code>new and unrestricted</code>".<li><p>If <var>current</var>'s <a href="#top-level-browsing-context" id="browsing-context-names:top-level-browsing-context-4">top-level browsing context</a>'s <a href="#active-document" id="browsing-context-names:active-document-2">active document</a>'s <a href="dom.html#concept-document-coop" id="browsing-context-names:concept-document-coop">cross-origin opener policy</a>'s <a href="origin.html#coop-struct-value" id="browsing-context-names:coop-struct-value">value</a> is "<code id="browsing-context-names:coop-same-origin"><a href="origin.html#coop-same-origin">same-origin</a></code>" or "<code id="browsing-context-names:coop-same-origin-plus-coep"><a href="origin.html#coop-same-origin-plus-coep">same-origin-plus-COEP</a></code>", then:</p>

        <ol><li><p>Let <var>currentDocument</var> be <var>current</var>'s <a href="#active-document" id="browsing-context-names:active-document-3">active document</a>.<li><p>If <var>currentDocument</var>'s <a href="https://dom.spec.whatwg.org/#concept-document-origin" id="browsing-context-names:concept-document-origin" data-x-internal="concept-document-origin">origin</a> is not <a id="browsing-context-names:same-origin" href="origin.html#same-origin">same origin</a> with <var>currentDocument</var>'s <a id="browsing-context-names:relevant-settings-object" href="webappapis.html#relevant-settings-object">relevant settings object</a>'s <a id="browsing-context-names:concept-environment-top-level-origin" href="webappapis.html#concept-environment-top-level-origin">top-level origin</a>, then set <var>noopener</var> to true, <var>name</var> to "<code>_blank</code>", and <var>windowType</var> to "<code>new with no opener</code>".</p>

          <p class="note">In the presence of a <a id="browsing-context-names:cross-origin-opener-policy" href="origin.html#cross-origin-opener-policy">cross-origin opener policy</a>, nested documents that are cross-origin with their top-level browsing context's active document always set <var>noopener</var> to true.</p>
         </ol>
       <li id="noopener"><p>If <var>noopener</var> is true, then set <var>chosen</var> to the result of <a href="#creating-a-new-top-level-browsing-context" id="browsing-context-names:creating-a-new-top-level-browsing-context">creating a new top-level browsing context</a>.<li><p>Otherwise:</p>

        <ol><li><p>Set <var>chosen</var> to the result of <a href="#creating-a-new-auxiliary-browsing-context" id="browsing-context-names:creating-a-new-auxiliary-browsing-context">creating a new auxiliary browsing context</a> with <var>current</var>.<li><p>If <var>sandboxingFlagSet</var>'s <a id="browsing-context-names:sandboxed-navigation-browsing-context-flag" href="origin.html#sandboxed-navigation-browsing-context-flag">sandboxed navigation browsing context flag</a> is set, then <var>current</var> must be set as <var>chosen</var>'s <a id="browsing-context-names:one-permitted-sandboxed-navigator-3" href="origin.html#one-permitted-sandboxed-navigator">one permitted sandboxed navigator</a>.</ol>
       <li><p>If <var>sandboxingFlagSet</var>'s <a id="browsing-context-names:sandbox-propagates-to-auxiliary-browsing-contexts-flag" href="origin.html#sandbox-propagates-to-auxiliary-browsing-contexts-flag">sandbox propagates to auxiliary browsing contexts flag</a> is set, then all the flags that are set in <var>sandboxingFlagSet</var> must be set in <var>chosen</var>'s <a id="browsing-context-names:popup-sandboxing-flag-set" href="origin.html#popup-sandboxing-flag-set">popup sandboxing flag set</a>.<li><p>If <var>name</var> is not an <a id="browsing-context-names:ascii-case-insensitive-6" href="https://triple-underscore.github.io/infra-ja.html#ascii-case-insensitive" data-x-internal="ascii-case-insensitive">ASCII case-insensitive</a> match for "<code>_blank</code>", then set <var>chosen</var>'s <a href="#browsing-context-name" id="browsing-context-names:browsing-context-name-3">name</a> to <var>name</var>.</ol>

      <p class="note">If the newly created <a href="#browsing-context" id="browsing-context-names:browsing-context-3">browsing context</a> is immediately <a href="browsing-the-web.html#navigate" id="browsing-context-names:navigate-2">navigated</a>, then the navigation will be done with <var id="browsing-context-names:navigation-hh"><a href="browsing-the-web.html#navigation-hh">historyHandling</a></var> set to "<code id="browsing-context-names:hh-replace"><a href="browsing-the-web.html#hh-replace">replace</a></code>".</p>
     <dt>If the user agent has been configured such that in this instance it will reuse <var>current</var><dd><p>Set <var>chosen</var> to <var>current</var>.<dt>If the user agent has been configured such that in this instance it will not find a browsing context<dd><p>Do nothing.</dl>

    <p class="note">User agents are encouraged to provide a way for users to configure the user agent to always reuse <var>current</var>.</p>
   <li><p>Return <var>chosen</var> and <var>windowType</var>.</ol>


  <h3 id="cross-origin-objects"><span class="secno">7.2</span> Security infrastructure for <code id="cross-origin-objects:window"><a href="window-object.html#window">Window</a></code>, <code id="cross-origin-objects:windowproxy"><a href="window-object.html#windowproxy">WindowProxy</a></code>, and <code id="cross-origin-objects:location"><a href="history.html#location">Location</a></code> objects<a href="#cross-origin-objects" class="self-link"></a></h3>

  <p>Although typically objects cannot be accessed across <a href="origin.html#concept-origin" id="cross-origin-objects:concept-origin">origins</a>, the web platform would not be true to itself if it did not have some legacy exceptions to that rule that the web depends upon.<h4 id="integration-with-idl"><span class="secno">7.2.1</span> Integration with IDL<a href="#integration-with-idl" class="self-link"></a></h4>

  <p>When <a id="integration-with-idl:perform-a-security-check" href="https://webidl.spec.whatwg.org/#dfn-perform-a-security-check" data-x-internal="perform-a-security-check">perform a security check</a> is invoked, with a <var>platformObject</var>, <var>identifier</var>, and <var>type</var>, run these steps:</p>

  <ol><li><p>If <var>platformObject</var> is not a <code id="integration-with-idl:window"><a href="window-object.html#window">Window</a></code> or <code id="integration-with-idl:location"><a href="history.html#location">Location</a></code> object, then return.</p>

   <li><p>For each <var>e</var> of ! <a href="#crossoriginproperties-(-o-)" id="integration-with-idl:crossoriginproperties-(-o-)">CrossOriginProperties</a>(<var>platformObject</var>):</p>

    <ol><li><p>If <a id="integration-with-idl:samevalue" href="https://tc39.es/ecma262/#sec-samevalue" data-x-internal="samevalue">SameValue</a>(<var>e</var>.[[Property]], <var>identifier</var>) is true, then:</p>

      <ol><li><p>If <var>type</var> is "<code>method</code>" and <var>e</var> has neither [[NeedsGet]] nor [[NeedsSet]], then return.<li><p>Otherwise, if <var>type</var> is "<code>getter</code>" and <var>e</var>.[[NeedsGet]] is true, then return.<li><p>Otherwise, if <var>type</var> is "<code>setter</code>" and <var>e</var>.[[NeedsSet]] is true, then return.</ol>
     </ol>
   <li><p>If ! <a href="#isplatformobjectsameorigin-(-o-)" id="integration-with-idl:isplatformobjectsameorigin-(-o-)">IsPlatformObjectSameOrigin</a>(<var>platformObject</var>) is false, then throw a <a id="integration-with-idl:securityerror" href="https://webidl.spec.whatwg.org/#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="integration-with-idl:domexception"><a data-x-internal="domexception" href="https://webidl.spec.whatwg.org/#dfn-DOMException">DOMException</a></code>.</ol>


  <h4 id="shared-internal-slot:-crossoriginpropertydescriptormap"><span class="secno">7.2.2</span> Shared internal slot: [[CrossOriginPropertyDescriptorMap]]<a href="#shared-internal-slot:-crossoriginpropertydescriptormap" class="self-link"></a></h4>

  <p><code id="shared-internal-slot:-crossoriginpropertydescriptormap:window"><a href="window-object.html#window">Window</a></code> and <code id="shared-internal-slot:-crossoriginpropertydescriptormap:location"><a href="history.html#location">Location</a></code> objects both have a <dfn id="crossoriginpropertydescriptormap">[[CrossOriginPropertyDescriptorMap]]</dfn> internal slot, whose value is initially an empty map.<p class="note">The <a href="#crossoriginpropertydescriptormap" id="shared-internal-slot:-crossoriginpropertydescriptormap:crossoriginpropertydescriptormap">[[CrossOriginPropertyDescriptorMap]]</a> internal slot contains a map with entries whose keys are (<var>currentGlobal</var>, <var>objectGlobal</var>, <var>propertyKey</var>)-tuples and values are property descriptors, as a memoization of what is visible to scripts when <var>currentGlobal</var> inspects a <code id="shared-internal-slot:-crossoriginpropertydescriptormap:window-2"><a href="window-object.html#window">Window</a></code> or <code id="shared-internal-slot:-crossoriginpropertydescriptormap:location-2"><a href="history.html#location">Location</a></code> object from <var>objectGlobal</var>. It is filled lazily by <a href="#crossorigingetownpropertyhelper-(-o,-p-)" id="shared-internal-slot:-crossoriginpropertydescriptormap:crossorigingetownpropertyhelper-(-o,-p-)">CrossOriginGetOwnPropertyHelper</a>, which consults it on future lookups.</p>

  <p>User agents should allow a value held in the map to be garbage collected along with its corresponding key when nothing holds a reference to any part of the value. That is, as long as garbage collection is not observable.</p>

  <p class="example">For example, with <code>const href = Object.getOwnPropertyDescriptor(crossOriginLocation, "href").set</code> the value and its corresponding key in the map cannot be garbage collected as that would be observable.</p>

  <p>User agents may have an optimization whereby they remove key-value pairs from the map when <code id="shared-internal-slot:-crossoriginpropertydescriptormap:dom-document-domain"><a href="origin.html#dom-document-domain">document.domain</a></code> is set. This is not observable as <code id="shared-internal-slot:-crossoriginpropertydescriptormap:dom-document-domain-2"><a href="origin.html#dom-document-domain">document.domain</a></code> cannot revisit an earlier value.</p>

  <p class="example">For example, setting <code id="shared-internal-slot:-crossoriginpropertydescriptormap:dom-document-domain-3"><a href="origin.html#dom-document-domain">document.domain</a></code> to "<code>example.com</code>" on www.example.com means user agents can remove all key-value pairs from the map where part of the key is www.example.com, as that can never be part of the <a id="shared-internal-slot:-crossoriginpropertydescriptormap:concept-origin" href="origin.html#concept-origin">origin</a> again and therefore the corresponding value could never be retrieved from the map.</p>


  <h4 id="shared-abstract-operations"><span class="secno">7.2.3</span> Shared abstract operations<a href="#shared-abstract-operations" class="self-link"></a></h4>

  <h5 id="crossoriginproperties-(-o-)"><span class="secno">7.2.3.1</span> <dfn>CrossOriginProperties</dfn> ( <var>O</var> )<a href="#crossoriginproperties-(-o-)" class="self-link"></a></h5>

  <ol><li><p>Assert: <var>O</var> is a <code id="crossoriginproperties-(-o-):location"><a href="history.html#location">Location</a></code> or <code id="crossoriginproperties-(-o-):window"><a href="window-object.html#window">Window</a></code> object.<li><p>If <var>O</var> is a <code id="crossoriginproperties-(-o-):location-2"><a href="history.html#location">Location</a></code> object, then return « { [[Property]]: "<code>href</code>", [[NeedsGet]]: false, [[NeedsSet]]: true }, { [[Property]]: "<code>replace</code>" } ».<li><p>Return « { [[Property]]: "<code>window</code>", [[NeedsGet]]: true, [[NeedsSet]]: false }, { [[Property]]: "<code>self</code>", [[NeedsGet]]: true, [[NeedsSet]]: false }, { [[Property]]: "<code>location</code>", [[NeedsGet]]: true, [[NeedsSet]]: true }, { [[Property]]: "<code>close</code>" }, { [[Property]]: "<code>closed</code>", [[NeedsGet]]: true, [[NeedsSet]]: false }, { [[Property]]: "<code>focus</code>" }, { [[Property]]: "<code>blur</code>" }, { [[Property]]: "<code>frames</code>", [[NeedsGet]]: true, [[NeedsSet]]: false }, { [[Property]]: "<code>length</code>", [[NeedsGet]]: true, [[NeedsSet]]: false }, { [[Property]]: "<code>top</code>", [[NeedsGet]]: true, [[NeedsSet]]: false }, { [[Property]]: "<code>opener</code>", [[NeedsGet]]: true, [[NeedsSet]]: false }, { [[Property]]: "<code>parent</code>", [[NeedsGet]]: true, [[NeedsSet]]: false }, { [[Property]]: "<code>postMessage</code>" } ».</ol>

  <p class="note">Indexed properties do not need to be safelisted in this algorithm, as they are handled directly by the <code id="crossoriginproperties-(-o-):windowproxy"><a href="window-object.html#windowproxy">WindowProxy</a></code> object.</p>

  <p>A JavaScript property name <var>P</var> is a <dfn id="cross-origin-accessible-window-property-name">cross-origin accessible window property name</dfn> if it is "<code>window</code>", "<code>self</code>", "<code>location</code>", "<code>close</code>", "<code>closed</code>", "<code>focus</code>", "<code>blur</code>", "<code>frames</code>", "<code>length</code>", "<code>top</code>", "<code>opener</code>", "<code>parent</code>", "<code>postMessage</code>", or an <a id="crossoriginproperties-(-o-):array-index-property-name" href="https://webidl.spec.whatwg.org/#dfn-array-index-property-name" data-x-internal="array-index-property-name">array index property name</a>.</p>

  <h5 id="crossoriginpropertyfallback-(-p-)"><span class="secno">7.2.3.2</span> <dfn>CrossOriginPropertyFallback</dfn> ( <var>P</var> )<a href="#crossoriginpropertyfallback-(-p-)" class="self-link"></a></h5>

  <ol><li><p>If <var>P</var> is "<code>then</code>", <a id="crossoriginpropertyfallback-(-p-):@@tostringtag" href="infrastructure.html#@@tostringtag">@@toStringTag</a>, <a id="crossoriginpropertyfallback-(-p-):@@hasinstance" href="infrastructure.html#@@hasinstance">@@hasInstance</a>, or <a id="crossoriginpropertyfallback-(-p-):@@isconcatspreadable" href="infrastructure.html#@@isconcatspreadable">@@isConcatSpreadable</a>, then return <a id="crossoriginpropertyfallback-(-p-):propertydescriptor" href="https://tc39.es/ecma262/#sec-property-descriptor-specification-type" data-x-internal="propertydescriptor">PropertyDescriptor</a>{ [[Value]]: undefined, [[Writable]]: false, [[Enumerable]]: false, [[Configurable]]: true }.<li><p>Throw a <a id="crossoriginpropertyfallback-(-p-):securityerror" href="https://webidl.spec.whatwg.org/#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="crossoriginpropertyfallback-(-p-):domexception"><a data-x-internal="domexception" href="https://webidl.spec.whatwg.org/#dfn-DOMException">DOMException</a></code>.</ol>

  <h5 id="isplatformobjectsameorigin-(-o-)"><span class="secno">7.2.3.3</span> <dfn>IsPlatformObjectSameOrigin</dfn> ( <var>O</var> )<a href="#isplatformobjectsameorigin-(-o-)" class="self-link"></a></h5>

  <ol><li><p>Return true if the <a id="isplatformobjectsameorigin-(-o-):current-settings-object" href="webappapis.html#current-settings-object">current settings object</a>'s <a href="webappapis.html#concept-settings-object-origin" id="isplatformobjectsameorigin-(-o-):concept-settings-object-origin">origin</a> is <a id="isplatformobjectsameorigin-(-o-):same-origin-domain" href="origin.html#same-origin-domain">same origin-domain</a> with <var>O</var>'s <a id="isplatformobjectsameorigin-(-o-):relevant-settings-object" href="webappapis.html#relevant-settings-object">relevant settings object</a>'s <a href="webappapis.html#concept-settings-object-origin" id="isplatformobjectsameorigin-(-o-):concept-settings-object-origin-2">origin</a>, and false otherwise.</ol>

  <p class="note">Here the <a id="isplatformobjectsameorigin-(-o-):current-settings-object-2" href="webappapis.html#current-settings-object">current settings object</a> roughly corresponds to the "caller", because this check occurs before the <a href="https://tc39.es/ecma262/#sec-execution-contexts" id="isplatformobjectsameorigin-(-o-):javascript-execution-context" data-x-internal="javascript-execution-context">execution context</a> for the getter/setter/method in question makes its way onto the <a id="isplatformobjectsameorigin-(-o-):javascript-execution-context-stack" href="https://tc39.es/ecma262/#execution-context-stack" data-x-internal="javascript-execution-context-stack">JavaScript execution context stack</a>. For example, in the code <code>w.document</code>, this step is invoked before the <code id="isplatformobjectsameorigin-(-o-):dom-document-2"><a href="window-object.html#dom-document-2">document</a></code> getter is reached as part of the <a href="window-object.html#windowproxy-get">[[Get]]</a> algorithm for the <code id="isplatformobjectsameorigin-(-o-):windowproxy"><a href="window-object.html#windowproxy">WindowProxy</a></code> <var>w</var>.</p>

  <h5 id="crossorigingetownpropertyhelper-(-o,-p-)"><span class="secno">7.2.3.4</span> <dfn>CrossOriginGetOwnPropertyHelper</dfn> ( <var>O</var>, <var>P</var> )<a href="#crossorigingetownpropertyhelper-(-o,-p-)" class="self-link"></a></h5>

  <p class="note">If this abstract operation returns undefined and there is no custom behavior, the caller needs to throw a <a id="crossorigingetownpropertyhelper-(-o,-p-):securityerror" href="https://webidl.spec.whatwg.org/#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="crossorigingetownpropertyhelper-(-o,-p-):domexception"><a data-x-internal="domexception" href="https://webidl.spec.whatwg.org/#dfn-DOMException">DOMException</a></code>. In practice this is handled by the caller calling <a href="#crossoriginpropertyfallback-(-p-)" id="crossorigingetownpropertyhelper-(-o,-p-):crossoriginpropertyfallback-(-p-)">CrossOriginPropertyFallback</a>.</p>

  <ol><li><p>Let <var>crossOriginKey</var> be a tuple consisting of the <a id="crossorigingetownpropertyhelper-(-o,-p-):current-settings-object" href="webappapis.html#current-settings-object">current settings object</a>, <var>O</var>'s <a id="crossorigingetownpropertyhelper-(-o,-p-):relevant-settings-object" href="webappapis.html#relevant-settings-object">relevant settings object</a>, and <var>P</var>.<li><p>For each <var>e</var> of ! <a href="#crossoriginproperties-(-o-)" id="crossorigingetownpropertyhelper-(-o,-p-):crossoriginproperties-(-o-)">CrossOriginProperties</a>(<var>O</var>):</p>

    <ol><li><p>If <a id="crossorigingetownpropertyhelper-(-o,-p-):samevalue" href="https://tc39.es/ecma262/#sec-samevalue" data-x-internal="samevalue">SameValue</a>(<var>e</var>.[[Property]], <var>P</var>) is true, then:</p>

      <ol><li><p>If the value of the <a href="#crossoriginpropertydescriptormap" id="crossorigingetownpropertyhelper-(-o,-p-):crossoriginpropertydescriptormap">[[CrossOriginPropertyDescriptorMap]]</a> internal slot of <var>O</var> contains an entry whose key is <var>crossOriginKey</var>, then return that entry's value.<li><p>Let <var>originalDesc</var> be <a id="crossorigingetownpropertyhelper-(-o,-p-):ordinarygetownproperty" href="https://tc39.es/ecma262/#sec-ordinarygetownproperty" data-x-internal="ordinarygetownproperty">OrdinaryGetOwnProperty</a>(<var>O</var>, <var>P</var>).<li><p>Let <var>crossOriginDesc</var> be undefined.<li><p>If <var>e</var>.[[NeedsGet]] and <var>e</var>.[[NeedsSet]] are absent, then:</p>

        <ol><li><p>Let <var>value</var> be <var>originalDesc</var>.[[Value]].<li><p>If ! <a id="crossorigingetownpropertyhelper-(-o,-p-):iscallable" href="https://tc39.es/ecma262/#sec-iscallable" data-x-internal="iscallable">IsCallable</a>(<var>value</var>) is true, then set <var>value</var> to an anonymous built-in function, created in the <a id="crossorigingetownpropertyhelper-(-o,-p-):current-realm-record" href="https://tc39.es/ecma262/#current-realm" data-x-internal="current-realm-record">current Realm Record</a>, that performs the same steps as the IDL operation <var>P</var> on object <var>O</var>.<li><p>Set <var>crossOriginDesc</var> to <a id="crossorigingetownpropertyhelper-(-o,-p-):propertydescriptor" href="https://tc39.es/ecma262/#sec-property-descriptor-specification-type" data-x-internal="propertydescriptor">PropertyDescriptor</a>{ [[Value]]: <var>value</var>, [[Enumerable]]: false, [[Writable]]: false, [[Configurable]]: true }.</ol>
       <li><p>Otherwise:</p>

        <ol><li><p>Let <var>crossOriginGet</var> be undefined.<li><p>If <var>e</var>.[[NeedsGet]] is true, then set <var>crossOriginGet</var> to an anonymous built-in function, created in the <a id="crossorigingetownpropertyhelper-(-o,-p-):current-realm-record-2" href="https://tc39.es/ecma262/#current-realm" data-x-internal="current-realm-record">current Realm Record</a>, that performs the same steps as the getter of the IDL attribute <var>P</var> on object <var>O</var>.<li><p>Let <var>crossOriginSet</var> be undefined.<li><p>If <var>e</var>.[[NeedsSet]] is true, then set <var>crossOriginSet</var> to an anonymous built-in function, created in the <a id="crossorigingetownpropertyhelper-(-o,-p-):current-realm-record-3" href="https://tc39.es/ecma262/#current-realm" data-x-internal="current-realm-record">current Realm Record</a>, that performs the same steps as the setter of the IDL attribute <var>P</var> on object <var>O</var>.<li><p>Set <var>crossOriginDesc</var> to <a id="crossorigingetownpropertyhelper-(-o,-p-):propertydescriptor-2" href="https://tc39.es/ecma262/#sec-property-descriptor-specification-type" data-x-internal="propertydescriptor">PropertyDescriptor</a>{ [[Get]]: <var>crossOriginGet</var>, [[Set]]: <var>crossOriginSet</var>, [[Enumerable]]: false, [[Configurable]]: true }.</ol>
       <li><p>Create an entry in the value of the <a href="#crossoriginpropertydescriptormap" id="crossorigingetownpropertyhelper-(-o,-p-):crossoriginpropertydescriptormap-2">[[CrossOriginPropertyDescriptorMap]]</a> internal slot of <var>O</var> with key <var>crossOriginKey</var> and value <var>crossOriginDesc</var>.<li><p>Return <var>crossOriginDesc</var>.</ol>
     </ol>
   <li><p>Return undefined.</ol>

  <p class="note">The reason that the property descriptors produced here are configurable is to preserve the <a id="crossorigingetownpropertyhelper-(-o,-p-):invariants-of-the-essential-internal-methods" href="https://tc39.es/ecma262/#sec-invariants-of-the-essential-internal-methods" data-x-internal="invariants-of-the-essential-internal-methods">invariants of the essential internal methods</a> required by the JavaScript specification. In particular, since the value of the property can change as a consequence of navigation, it is required that the property be configurable. (However, see <a href="https://github.com/tc39/ecma262/issues/672">tc39/ecma262 issue #672</a> and references to it elsewhere in this specification for cases where we are not able to preserve these invariants, for compatibility with existing web content.) <a href="references.html#refsJAVASCRIPT">[JAVASCRIPT]</a></p>

  <p class="note">The reason the property descriptors are non-enumerable, despite this mismatching the same-origin behavior, is for compatibility with existing web content. See <a href="https://github.com/whatwg/html/issues/3183">issue #3183</a> for details.</p>

  <h5 id="crossoriginget-(-o,-p,-receiver-)"><span class="secno">7.2.3.5</span> <dfn>CrossOriginGet</dfn> ( <var>O</var>, <var>P</var>, <var>Receiver</var> )<a href="#crossoriginget-(-o,-p,-receiver-)" class="self-link"></a></h5>

  <ol><li><p>Let <var>desc</var> be ? <var>O</var>.[[GetOwnProperty]](<var>P</var>).<li><p>Assert: <var>desc</var> is not undefined.<li><p>If ! <a id="crossoriginget-(-o,-p,-receiver-):isdatadescriptor" href="https://tc39.es/ecma262/#sec-isdatadescriptor" data-x-internal="isdatadescriptor">IsDataDescriptor</a>(<var>desc</var>) is true, then return <var>desc</var>.[[Value]].<li><p>Assert: <a id="crossoriginget-(-o,-p,-receiver-):isaccessordescriptor" href="https://tc39.es/ecma262/#sec-isaccessordescriptor" data-x-internal="isaccessordescriptor">IsAccessorDescriptor</a>(<var>desc</var>) is true.<li><p>Let <var>getter</var> be <var>desc</var>.[[Get]].<li><p>If <var>getter</var> is undefined, then throw a <a id="crossoriginget-(-o,-p,-receiver-):securityerror" href="https://webidl.spec.whatwg.org/#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="crossoriginget-(-o,-p,-receiver-):domexception"><a data-x-internal="domexception" href="https://webidl.spec.whatwg.org/#dfn-DOMException">DOMException</a></code>.<li><p>Return ? <a id="crossoriginget-(-o,-p,-receiver-):call" href="https://tc39.es/ecma262/#sec-call" data-x-internal="call">Call</a>(<var>getter</var>, <var>Receiver</var>).</ol>

  <h5 id="crossoriginset-(-o,-p,-v,-receiver-)"><span class="secno">7.2.3.6</span> <dfn>CrossOriginSet</dfn> ( <var>O</var>, <var>P</var>, <var>V</var>, <var>Receiver</var> )<a href="#crossoriginset-(-o,-p,-v,-receiver-)" class="self-link"></a></h5>

  <ol><li><p>Let <var>desc</var> be ? <var>O</var>.[[GetOwnProperty]](<var>P</var>).<li><p>Assert: <var>desc</var> is not undefined.<li><p>If <var>desc</var>.[[Set]] is present and its value is not undefined, then:<ol><li><p>Perform ? <a id="crossoriginset-(-o,-p,-v,-receiver-):call" href="https://tc39.es/ecma262/#sec-call" data-x-internal="call">Call</a>(<var>setter</var>, <var>Receiver</var>, «<var>V</var>»).<li><p>Return true.</ol>
   <li><p>Throw a <a id="crossoriginset-(-o,-p,-v,-receiver-):securityerror" href="https://webidl.spec.whatwg.org/#securityerror" data-x-internal="securityerror">"<code>SecurityError</code>"</a> <code id="crossoriginset-(-o,-p,-v,-receiver-):domexception"><a data-x-internal="domexception" href="https://webidl.spec.whatwg.org/#dfn-DOMException">DOMException</a></code>.</ol>

  <h5 id="crossoriginownpropertykeys-(-o-)"><span class="secno">7.2.3.7</span> <dfn>CrossOriginOwnPropertyKeys</dfn> ( <var>O</var> )<a href="#crossoriginownpropertykeys-(-o-)" class="self-link"></a></h5>

  <ol><li><p>Let <var>keys</var> be a new empty <a href="https://tc39.es/ecma262/#sec-list-and-record-specification-type" id="crossoriginownpropertykeys-(-o-):js-list" data-x-internal="js-list">List</a>.<li><p>For each <var>e</var> of ! <a href="#crossoriginproperties-(-o-)" id="crossoriginownpropertykeys-(-o-):crossoriginproperties-(-o-)">CrossOriginProperties</a>(<var>O</var>), <a href="https://triple-underscore.github.io/infra-ja.html#list-append" id="crossoriginownpropertykeys-(-o-):list-append" data-x-internal="list-append">append</a> <var>e</var>.[[Property]] to <var>keys</var>.<li><p>Return the concatenation of <var>keys</var> and « "<code>then</code>", <a id="crossoriginownpropertykeys-(-o-):@@tostringtag" href="infrastructure.html#@@tostringtag">@@toStringTag</a>, <a id="crossoriginownpropertykeys-(-o-):@@hasinstance" href="infrastructure.html#@@hasinstance">@@hasInstance</a>, <a id="crossoriginownpropertykeys-(-o-):@@isconcatspreadable" href="infrastructure.html#@@isconcatspreadable">@@isConcatSpreadable</a> ».</ol>

  



  <nav><a href="dnd.html">← 6.9 ドラッグアンドドロップ</a> — <a href="./">目次</a> — <a href="window-object.html">7.3 Windowオブジェクト →</a></nav>
