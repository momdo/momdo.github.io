<!DOCTYPE html><html class="split" lang="ja"><script src="https://html.spec.whatwg.org/link-fixup.js" defer=""></script><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"><title>HTML Standard 日本語訳</title><meta content="#3c790a" name="theme-color"><link rel="stylesheet" href="https://resources.whatwg.org/spec.css" crossorigin=""><link rel="stylesheet" href="https://resources.whatwg.org/standard.css" crossorigin=""><link rel="stylesheet" href="https://resources.whatwg.org/standard-shared-with-dev.css" crossorigin=""><link rel="icon" href="https://resources.whatwg.org/logo.svg" crossorigin=""><link rel="stylesheet" href="https://html.spec.whatwg.org/styles.css" crossorigin=""><script>
   function toggleStatus(div) {
     div.parentNode.classList.toggle('wrapped');
   }
   function setLinkFragment(link) {
     link.hash = location.hash;
   }
  </script><body>
  
  <script async="" crossorigin="" src="./html-dfn.js"></script>
  <script data-file-issue-url="https://github.com/momdo/momdo.github.io/issues/new" async="" crossorigin="" src="https://resources.whatwg.org/file-issue.js"></script>
  
  <header id="head" class="head with-buttons"><a href="https://whatwg.org/" class="logo"><img width="100" alt="WHATWG" crossorigin="" src="https://resources.whatwg.org/logo.svg" height="100"></a><hgroup><h1 class="allcaps">HTML</h1><h2 id="living-standard" class="no-num no-toc">Living Standard — Last Updated <span class="pubdate">23 July 2021</span></h2></hgroup>
   
   

   
  </header>

  

  

  

  
  

  
  

  

  <nav><a href="dynamic-markup-insertion.html">← 8.4 動的マークアップの挿入</a> — <a href="./">目次</a> — <a href="system-state.html">8.9 システム状態および性能 →</a></nav><ol class="toc"><li id="toc-webappapis"><ol><li><a href="timers-and-user-prompts.html#timers"><span class="secno">8.6</span> タイマー</a><li><a href="timers-and-user-prompts.html#microtask-queuing"><span class="secno">8.7</span> マイクロタスクのキュー</a><li><a href="timers-and-user-prompts.html#user-prompts"><span class="secno">8.8</span> ユーザープロンプト</a><ol><li><a href="timers-and-user-prompts.html#simple-dialogs"><span class="secno">8.8.1</span> 単純ダイアログ</a><li><a href="timers-and-user-prompts.html#printing"><span class="secno">8.8.2</span> 印刷</a></ol></ol></ol><h3 id="timers"><span class="secno">8.6</span> タイマー<a href="#timers" class="self-link"></a></h3>

  <p><code id="timers:dom-settimeout"><a href="#dom-settimeout">setTimeout()</a></code>と<code id="timers:dom-setinterval"><a href="#dom-setinterval">setInterval()</a></code>メソッドは、著者がタイマーベースのコールバックをスケジュールできるようにする。</p>

  <dl class="domintro"><dt><var>handle</var> = self . <code id="dom-settimeout-dev"><a href="#dom-settimeout">setTimeout</a></code>( <var>handler</var> [, <var>timeout</var> [, <var>arguments</var>... ] ] )<div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout" title="The setTimeout() method of the WindowOrWorkerGlobalScope mixin sets a timer which executes a function or specified piece of code once the timer expires.">WindowOrWorkerGlobalScope/setTimeout</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>30+</span></span><hr><span class="opera yes"><span>Opera</span><span>4+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>30+</span></span><span class="webview_android yes"><span>WebView Android</span><span>4.4+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>3.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd><p><var>timeout</var>ミリ秒後に<var>handler</var>を実行するためにタイムアウトをスケジュールする。すべての<var>arguments</var>は直接<var>handler</var>に渡される。</p>
   <dt><var>handle</var> = self . <code id="timers:dom-settimeout-2"><a href="#dom-settimeout">setTimeout</a></code>( <var>code</var> [, <var>timeout</var> ] )<dd><p><var>timeout</var>ミリ秒後に<var>code</var>を実行するためにタイムアウトをスケジュールする。</p>
   <dt>self . <code id="dom-cleartimeout-dev"><a href="#dom-cleartimeout">clearTimeout</a></code>( <var>handle</var> )<div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/clearTimeout" title="The clearTimeout() method of the WindowOrWorkerGlobalScope mixin cancels a timeout previously established by calling setTimeout().">WindowOrWorkerGlobalScope/clearTimeout</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>45+</span></span><hr><span class="opera yes"><span>Opera</span><span>4+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>45+</span></span><span class="webview_android yes"><span>WebView Android</span><span>45+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>5.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd><p><var>handle</var>で識別される<code id="timers:dom-settimeout-3"><a href="#dom-settimeout">setTimeout()</a></code>または<code id="timers:dom-setinterval-2"><a href="#dom-setinterval">setInterval()</a></code>で設定されたタイムアウトをキャンセルする。</p>
   <dt><var>handle</var> = self . <code id="dom-setinterval-dev"><a href="#dom-setinterval">setInterval</a></code>( <var>handler</var> [, <var>timeout</var> [, <var>arguments</var>... ] ] )<div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setInterval" title="The setInterval() method, offered on the Window and Worker interfaces, repeatedly calls a function or executes a code snippet, with a fixed time delay between each call.">WindowOrWorkerGlobalScope/setInterval</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>30+</span></span><hr><span class="opera yes"><span>Opera</span><span>4+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>30+</span></span><span class="webview_android yes"><span>WebView Android</span><span>4.4+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>3.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd><p><var>timeout</var>ミリ秒ごとに<var>handler</var>を実行するためにタイムアウトをスケジュールする。すべての<var>arguments</var>は直接<var>handler</var>に渡される。</p>
   <dt><var>handle</var> = self . <code id="timers:dom-setinterval-3"><a href="#dom-setinterval">setInterval</a></code>( <var>code</var> [, <var>timeout</var> ] )<dd><p><var>timeout</var>ミリ秒ごとに<var>code</var>を実行するためにタイムアウトをスケジュールする。</p>
   <dt>self . <code id="dom-clearinterval-dev"><a href="#dom-clearinterval">clearInterval</a></code>( <var>handle</var> )<div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/clearInterval" title="The clearInterval() method of the WindowOrWorkerGlobalScope mixin cancels a timed, repeating action which was previously established by a call to setInterval().">WindowOrWorkerGlobalScope/clearInterval</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>4+</span></span><span class="chrome yes"><span>Chrome</span><span>4+</span></span><hr><span class="opera yes"><span>Opera</span><span>4+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>37+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd><p><var>handle</var>で識別される<code id="timers:dom-setinterval-4"><a href="#dom-setinterval">setInterval()</a></code>または<code id="timers:dom-settimeout-4"><a href="#dom-settimeout">setTimeout()</a></code>で設定されたタイムアウトをキャンセルする。</p>
   </dl>

  <p class="note">タイマーは入れ子にすることができる。しかし、5つのそのようなネストされたタイマー後に、間隔は少なくとも4ミリ秒であることが強制される。</p>

  <p class="note">このAPIは、タイマーがスケジュールどおり正確に動作することを保証しない。CPU負荷やその他のタスクなどによる遅延が予想される。</p>

  

  <p>Objects that implement the <code id="timers:windoworworkerglobalscope"><a href="webappapis.html#windoworworkerglobalscope">WindowOrWorkerGlobalScope</a></code> mixin have a <dfn id="list-of-active-timers" data-export="">list of active timers</dfn>. Each entry in this lists is identified by a number, which must be unique within the list for the lifetime of the object that implements the <code id="timers:windoworworkerglobalscope-2"><a href="webappapis.html#windoworworkerglobalscope">WindowOrWorkerGlobalScope</a></code> mixin.</p>

  <hr>

  <p>The <dfn data-dfn-for="WindowOrWorkerGlobalScope" id="dom-settimeout" data-dfn-type="method"><code id="dom-windowtimers-setTimeout">setTimeout(<var>handler</var>, <var>timeout</var>, ...<var>arguments</var>)</code></dfn> method must return the value returned by the <a href="#timer-initialisation-steps" id="timers:timer-initialisation-steps">timer initialization steps</a>, passing them the method's arguments, the object on which the method for which the algorithm is running is implemented (a <code id="timers:window"><a href="window-object.html#window">Window</a></code> or <code id="timers:workerglobalscope"><a href="workers.html#workerglobalscope">WorkerGlobalScope</a></code> object) as the <var>method context</var>, and the <var>repeat</var> flag set to false.</p>

  <p>The <dfn data-dfn-for="WindowOrWorkerGlobalScope" id="dom-setinterval" data-dfn-type="method"><code id="dom-windowtimers-setInterval">setInterval(<var>handler</var>, <var>timeout</var>, ...<var>arguments</var>)</code></dfn> method must return the value returned by the <a href="#timer-initialisation-steps" id="timers:timer-initialisation-steps-2">timer initialization steps</a>, passing them the method's arguments, the object on which the method for which the algorithm is running is implemented (a <code id="timers:window-2"><a href="window-object.html#window">Window</a></code> or <code id="timers:workerglobalscope-2"><a href="workers.html#workerglobalscope">WorkerGlobalScope</a></code> object) as the <var>method context</var>, and the <var>repeat</var> flag set to true.</p>

  <p>The <dfn data-dfn-for="WindowOrWorkerGlobalScope" id="dom-cleartimeout" data-dfn-type="method"><code id="dom-windowtimers-clearTimeout">clearTimeout(<var>handle</var>)</code></dfn> and <dfn data-dfn-for="WindowOrWorkerGlobalScope" id="dom-clearinterval" data-dfn-type="method"><code id="dom-windowtimers-clearInterval">clearInterval(<var>handle</var>)</code></dfn> methods must clear the entry identified as <var>handle</var> from the <a href="#list-of-active-timers" id="timers:list-of-active-timers">list of active timers</a> of the <code id="timers:windoworworkerglobalscope-3"><a href="webappapis.html#windoworworkerglobalscope">WindowOrWorkerGlobalScope</a></code> object on which the method was invoked, if any, where <var>handle</var> is the argument passed to the method. (If <var>handle</var> does not identify an entry in the <a href="#list-of-active-timers" id="timers:list-of-active-timers-2">list of active timers</a> of the <code id="timers:windoworworkerglobalscope-4"><a href="webappapis.html#windoworworkerglobalscope">WindowOrWorkerGlobalScope</a></code> object on which the method was invoked, the method does nothing.)</p>

  <p class="note">Because <code id="timers:dom-cleartimeout"><a href="#dom-cleartimeout">clearTimeout()</a></code> and <code id="timers:dom-clearinterval"><a href="#dom-clearinterval">clearInterval()</a></code> clear entries from the same list, either method can be used to clear timers created by <code id="timers:dom-settimeout-5"><a href="#dom-settimeout">setTimeout()</a></code> or <code id="timers:dom-setinterval-5"><a href="#dom-setinterval">setInterval()</a></code>.</p>

  <hr>

  <p>The <dfn id="timer-initialisation-steps">timer initialization steps</dfn>, which are invoked with some method arguments, a <var>method context</var>, a <var>repeat</var> flag which can be true or false, and optionally (and only if the <var>repeat</var> flag is true) a <var>previous handle</var>, are as follows:</p>

  <ol><li><p>Let <var>method context proxy</var> be <var>method context</var> if that is a <code id="timers:workerglobalscope-3"><a href="workers.html#workerglobalscope">WorkerGlobalScope</a></code> object, or else the <code id="timers:windowproxy"><a href="window-object.html#windowproxy">WindowProxy</a></code> that corresponds to <var>method context</var>.<li><p>If <var>previous handle</var> was provided, let <var>handle</var> be <var>previous handle</var>; otherwise, let <var>handle</var> be an <a id="timers:implementation-defined" href="https://triple-underscore.github.io/infra-ja.html#implementation-defined" data-x-internal="implementation-defined">implementation-defined</a> integer that is greater than zero that will identify the timeout to be set by this call in the <a href="#list-of-active-timers" id="timers:list-of-active-timers-3">list of active timers</a>.<li><p>If <var>previous handle</var> was not provided, add an entry to the <a href="#list-of-active-timers" id="timers:list-of-active-timers-4">list of active timers</a> for <var>handle</var>.<li><p>Let <var>callerRealm</var> be the <a id="timers:current-realm-record" href="https://tc39.es/ecma262/#current-realm" data-x-internal="current-realm-record">current Realm Record</a>, and <var>calleeRealm</var> be <var>method context</var>'s <a id="timers:javascript-realm" href="https://tc39.es/ecma262/#sec-code-realms" data-x-internal="javascript-realm">JavaScript realm</a>.<li><p>Let <var>initiating script</var> be the <a id="timers:active-script" href="webappapis.html#active-script">active script</a>.<li><p>Assert: <var>initiating script</var> is not null, since this algorithm is always called from some script.<li><p>Let <var>task</var> be a <a href="webappapis.html#concept-task" id="timers:concept-task">task</a> that runs the following substeps:</p>

    <ol><li><p>If the entry for <var>handle</var> in the <a href="#list-of-active-timers" id="timers:list-of-active-timers-5">list of active timers</a> has been cleared, then abort these steps.<li><p>Run the appropriate set of steps from the following list:</p>

      <dl class="switch"><dt>If the first method argument is a <code id="timers:idl-function"><a data-x-internal="idl-function" href="https://triple-underscore.github.io/WebIDL-ja.html#common-Function">Function</a></code><dd><p><a href="https://triple-underscore.github.io/WebIDL-ja.html#invoke-a-callback-function" id="timers:es-invoking-callback-functions" data-x-internal="es-invoking-callback-functions">Invoke</a> the <code id="timers:idl-function-2"><a data-x-internal="idl-function" href="https://triple-underscore.github.io/WebIDL-ja.html#common-Function">Function</a></code>. Use the third and subsequent method arguments (if any) as the arguments for invoking the <code id="timers:idl-function-3"><a data-x-internal="idl-function" href="https://triple-underscore.github.io/WebIDL-ja.html#common-Function">Function</a></code>. Use <var>method context proxy</var> as the <a href="https://triple-underscore.github.io/WebIDL-ja.html#dfn-callback-this-value" id="timers:dfn-callback-this-value" data-x-internal="dfn-callback-this-value">callback this value</a>. If this throws an exception, catch it, and <a id="timers:report-the-exception" href="webappapis.html#report-the-exception">report the exception</a>.<dt>そうでなければ<dd><ol><li><p>Perform <a href="webappapis.html#hostensurecancompilestrings(callerrealm,-calleerealm)" id="timers:hostensurecancompilestrings(callerrealm,-calleerealm)">HostEnsureCanCompileStrings</a>(<var>callerRealm</var>, <var>calleeRealm</var>). If this throws an exception, catch it, <a id="timers:report-the-exception-2" href="webappapis.html#report-the-exception">report the exception</a>, and abort these steps.<li><p>Let <var>script source</var> be the first method argument.<li><p>Let <var>settings object</var> be <var>method context</var>'s <a id="timers:environment-settings-object" href="webappapis.html#environment-settings-object">environment settings object</a>.<li><p>Let <var>base URL</var> be <var>initiating script</var>'s <a href="webappapis.html#concept-script-base-url" id="timers:concept-script-base-url">base URL</a>.<li><p>Assert: <var>base URL</var> is not null, as <var>initiating script</var> is a <a id="timers:classic-script" href="webappapis.html#classic-script">classic script</a> or a <a id="timers:javascript-module-script" href="webappapis.html#javascript-module-script">JavaScript module script</a>.<li><p>Let <var>fetch options</var> be a <a id="timers:script-fetch-options" href="webappapis.html#script-fetch-options">script fetch options</a> whose <a href="webappapis.html#concept-script-fetch-options-nonce" id="timers:concept-script-fetch-options-nonce">cryptographic nonce</a> is <var>initiating script</var>'s <a href="webappapis.html#concept-script-script-fetch-options" id="timers:concept-script-script-fetch-options">fetch options</a>'s <a href="webappapis.html#concept-script-fetch-options-nonce" id="timers:concept-script-fetch-options-nonce-2">cryptographic nonce</a>, <a href="webappapis.html#concept-script-fetch-options-integrity" id="timers:concept-script-fetch-options-integrity">integrity metadata</a> is the empty string, <a href="webappapis.html#concept-script-fetch-options-parser" id="timers:concept-script-fetch-options-parser">parser metadata</a> is "<code>not-parser-inserted</code>", <a href="webappapis.html#concept-script-fetch-options-credentials" id="timers:concept-script-fetch-options-credentials">credentials mode</a> is <var>initiating script</var>'s <a href="webappapis.html#concept-script-script-fetch-options" id="timers:concept-script-script-fetch-options-2">fetch options</a>'s <a href="webappapis.html#concept-script-fetch-options-credentials" id="timers:concept-script-fetch-options-credentials-2">credentials mode</a>, and <a href="webappapis.html#concept-script-fetch-options-referrer-policy" id="timers:concept-script-fetch-options-referrer-policy">referrer policy</a> is <var>initiating script</var>'s <a href="webappapis.html#concept-script-script-fetch-options" id="timers:concept-script-script-fetch-options-3">fetch options</a>'s <a href="webappapis.html#concept-script-fetch-options-referrer-policy" id="timers:concept-script-fetch-options-referrer-policy-2">referrer policy</a>.</p>

          <p class="note">The effect of these options ensures that the string compilation done by <code id="timers:dom-settimeout-6"><a href="#dom-settimeout">setTimeout()</a></code> and <code id="timers:dom-setinterval-6"><a href="#dom-setinterval">setInterval()</a></code> behaves equivalently to that done by <code id="timers:eval()"><a data-x-internal="eval()" href="https://tc39.es/ecma262/#sec-eval-x">eval()</a></code>. That is, <a id="timers:module-script" href="webappapis.html#module-script">module script</a> fetches via <code id="timers:import()"><a data-x-internal="import()" href="https://tc39.es/ecma262/#sec-import-calls">import()</a></code> will behave the same in both contexts.</p>
         <li><p>Let <var>script</var> be the result of <a id="timers:creating-a-classic-script" href="webappapis.html#creating-a-classic-script">creating a classic script</a> given <var>script source</var>, <var>settings object</var>, <var>base URL</var>, and <var>fetch options</var>.<li><p><a href="webappapis.html#run-a-classic-script" id="timers:run-a-classic-script">Run the classic script</a> <var>script</var>.</ol>
       </dl>
     <li><p>If the <var>repeat</var> flag is true, then call <a href="#timer-initialisation-steps" id="timers:timer-initialisation-steps-3">timer initialization steps</a> again, passing them the same method arguments, the same <var>method context</var>, with the <var>repeat</var> flag still set to true, and with the <var>previous handle</var> set to <var>handler</var>.</ol>
   <li><p>Let <var>timeout</var> be the second method argument.<li><p>If the currently running <a href="webappapis.html#concept-task" id="timers:concept-task-2">task</a> is a task that was created by this algorithm, then let <var>nesting level</var> be the <a href="webappapis.html#concept-task" id="timers:concept-task-3">task</a>'s <a href="#timer-nesting-level" id="timers:timer-nesting-level">timer nesting level</a>. Otherwise, let <var>nesting level</var> be zero.</p>

    <p class="note">The task's <a href="#timer-nesting-level" id="timers:timer-nesting-level-2">timer nesting level</a> is used both for nested calls to <code id="timers:dom-settimeout-7"><a href="#dom-settimeout">setTimeout()</a></code>, and for the repeating timers created by <code id="timers:dom-setinterval-7"><a href="#dom-setinterval">setInterval()</a></code>. (Or, indeed, for any combination of the two.) In other words, it represents nested invocations of this algorithm, not of a particular method.</p>
   <li><p>If <var>timeout</var> is less than 0, then set <var>timeout</var> to 0.<li><p>If <var>nesting level</var> is greater than 5, and <var>timeout</var> is less than 4, then set <var>timeout</var> to 4.<li><p>Increment <var>nesting level</var> by one.<li><p>Let <var>task</var>'s <dfn id="timer-nesting-level">timer nesting level</dfn> be <var>nesting level</var>.<li><p>Return <var>handle</var>, and then continue running this algorithm <a id="timers:in-parallel" href="infrastructure.html#in-parallel">in parallel</a>.<li><p>If <var>method context</var> is a <code id="timers:window-3"><a href="window-object.html#window">Window</a></code> object, wait until the <code id="timers:document"><a href="dom.html#document">Document</a></code> associated with <var>method context</var> has been <a id="timers:fully-active" href="browsers.html#fully-active">fully active</a> for a further <var>timeout</var> milliseconds (not necessarily consecutively).</p>

    <p>Otherwise, <var>method context</var> is a <code id="timers:workerglobalscope-4"><a href="workers.html#workerglobalscope">WorkerGlobalScope</a></code> object; wait until <var>timeout</var> milliseconds have passed with the worker not suspended (not necessarily consecutively).</p>
   <li><p>Wait until any invocations of this algorithm that had the same <var>method context</var>, that started before this one, and whose <var>timeout</var> is equal to or less than this one's, have completed.</p>

    <p class="note">Argument conversion as defined by Web IDL (for example, invoking <code>toString()</code> methods on objects passed as the first argument) happens in the algorithms defined in Web IDL, before this algorithm is invoked.</p>

    <div class="example"><p>So for example, the following rather silly code will result in the log containing "<code>ONE TWO </code>":</p>

     <pre><code class='js'><c- a>var</c-> log <c- o>=</c-> <c- t>''</c-><c- p>;</c->
<c- a>function</c-> logger<c- p>(</c->s<c- p>)</c-> <c- p>{</c-> log <c- o>+=</c-> s <c- o>+</c-> <c- t>' '</c-><c- p>;</c-> <c- p>}</c->

setTimeout<c- p>({</c-> toString<c- o>:</c-> <c- a>function</c-> <c- p>()</c-> <c- p>{</c->
  setTimeout<c- p>(</c-><c- u>"logger('ONE')"</c-><c- p>,</c-> <c- mf>100</c-><c- p>);</c->
  <c- k>return</c-> <c- u>"logger('TWO')"</c-><c- p>;</c->
<c- p>}</c-> <c- p>},</c-> <c- mf>100</c-><c- p>);</c-></code></pre>

    </div>
   <li><p>Optionally, wait a further <a id="timers:implementation-defined-2" href="https://triple-underscore.github.io/infra-ja.html#implementation-defined" data-x-internal="implementation-defined">implementation-defined</a> length of time.</p>

    <p class="note">This is intended to allow user agents to pad timeouts as needed to optimize the power usage of the device. For example, some processors have a low-power mode where the granularity of timers is reduced; on such platforms, user agents can slow timers down to fit this schedule instead of requiring the processor to use the more accurate mode with its associated higher power usage.</p>
   <li><p><a id="timers:queue-a-global-task" href="webappapis.html#queue-a-global-task">Queue a global task</a> on the <dfn id="timer-task-source">timer task source</dfn> given <var>method context</var> to run <var>task</var>.</p>

    <p class="note">Once the task has been processed, if the <var>repeat</var> flag is false, it is safe to remove the entry for <var>handle</var> from the <a href="#list-of-active-timers" id="timers:list-of-active-timers-6">list of active timers</a> (there is no way for the entry's existence to be detected past this point, so it does not technically matter one way or the other).</p>
   </ol>

  

  <div class="example"><p>遅延なく背中合わせに数ミリ秒のタスクを実行するために、飢えたユーザーインターフェイスを避けるために（およびCPUを占有するためのスクリプトを殺すブラウザーを避けるために）ブラウザーに戻って従いつつ、作業を実行する前の簡単なキューの次のタイマー：</p>

   <pre><code class='js'><c- a>function</c-> doExpensiveWork<c- p>()</c-> <c- p>{</c->
  <c- a>var</c-> done <c- o>=</c-> <c- kc>false</c-><c- p>;</c->
  <c- c1>// ...</c->
  <c- c1>// this part of the function takes up to five milliseconds</c->
  <c- c1>// set done to true if we're done</c->
  <c- c1>// ...</c->
  <c- k>return</c-> done<c- p>;</c->
<c- p>}</c->

<c- a>function</c-> rescheduleWork<c- p>()</c-> <c- p>{</c->
  <c- a>var</c-> handle <c- o>=</c-> setTimeout<c- p>(</c->rescheduleWork<c- p>,</c-> <c- mf>0</c-><c- p>);</c-> <c- c1>// preschedule next iteration</c->
  <c- k>if</c-> <c- p>(</c->doExpensiveWork<c- p>())</c->
    clearTimeout<c- p>(</c->handle<c- p>);</c-> <c- c1>// clear the timeout if we don't need it</c->
<c- p>}</c->

<c- a>function</c-> scheduleWork<c- p>()</c-> <c- p>{</c->
  setTimeout<c- p>(</c->rescheduleWork<c- p>,</c-> <c- mf>0</c-><c- p>);</c->
<c- p>}</c->

scheduleWork<c- p>();</c-> <c- c1>// queues a task to do lots of work</c-></code></pre>

  </div>


  <h3 id="microtask-queuing"><span class="secno">8.7</span> マイクロタスクのキュー<a href="#microtask-queuing" class="self-link"></a></h3><div class="mdn-anno wrapped"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/queueMicrotask" title="The queueMicrotask() method, which is exposed on the Window or Worker interface, queues a microtask to be executed at a safe time prior to control returning to the browser's event loop.">WindowOrWorkerGlobalScope/queueMicrotask</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>69+</span></span><span class="safari yes"><span>Safari</span><span>12.1+</span></span><span class="chrome yes"><span>Chrome</span><span>71+</span></span><hr><span class="opera yes"><span>Opera</span><span>58+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge no"><span>Edge (Legacy)</span><span>No</span></span><span class="ie no"><span>Internet Explorer</span><span>No</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>79+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>12.2+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>71+</span></span><span class="webview_android yes"><span>WebView Android</span><span>71+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>10.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>50+</span></span></div></div></div>

  <dl class="domintro"><dt><var>self</var> . <code id="dom-queuemicrotask-dev"><a href="#dom-queuemicrotask">queueMicrotask</a></code>(<var>callback</var>)<dd><p>指定された<var>callback</var>を実行するための<a id="microtask-queuing:microtask" href="webappapis.html#microtask">マイクロタスク</a>を<a href="webappapis.html#queue-a-microtask" id="microtask-queuing:queue-a-microtask">キューに入れる</a>。</dl>

  <p><dfn data-dfn-for="WindowOrWorkerGlobalScope" id="dom-queuemicrotask" data-dfn-type="method"><code>queueMicrotask(<var>callback</var>)</code></dfn>メソッドは、<var>callback</var>を<a href="https://triple-underscore.github.io/WebIDL-ja.html#invoke-a-callback-function" id="microtask-queuing:es-invoking-callback-functions" data-x-internal="es-invoking-callback-functions">呼び出す</a>ために<a id="microtask-queuing:queue-a-microtask-2" href="webappapis.html#queue-a-microtask">マイクロタスクをキューに入れ</a>、かつ<var>callback</var>が例外を投げた場合は<a id="microtask-queuing:report-the-exception" href="webappapis.html#report-the-exception">例外を報告</a>しなければならない。</p>

  <p><code id="microtask-queuing:dom-queuemicrotask"><a href="#dom-queuemicrotask">queueMicrotask()</a></code>メソッドは、著者が<a id="microtask-queuing:microtask-queue" href="webappapis.html#microtask-queue">マイクロタスクキュー</a>でコールバックをスケジュールすることを可能にする。This allows their code to run once the <a id="microtask-queuing:javascript-execution-context-stack" href="https://tc39.es/ecma262/#execution-context-stack" data-x-internal="javascript-execution-context-stack">JavaScript execution context stack</a> is next empty, which happens once all currently executing synchronous JavaScript has run to completion. This doesn't yield control back to the <a id="microtask-queuing:event-loop" href="webappapis.html#event-loop">event loop</a>, as would be the case when using, for example, <code id="microtask-queuing:dom-settimeout"><a href="#dom-settimeout">setTimeout(<var>f</var>, 0)</a></code>.</p>

  <p>著者は、大量のマイクロタスクをスケジュールすることが、大量の同期コードを実行するのと同じパフォーマンスの低下があることに注意する必要がある。 Both will prevent the browser from doing its own work, such as rendering. 多くの場合、<code id="microtask-queuing:dom-animationframeprovider-requestanimationframe"><a href="imagebitmap-and-animations.html#dom-animationframeprovider-requestanimationframe">requestAnimationFrame()</a></code>または<code id="microtask-queuing:requestidlecallback()"><a data-x-internal="requestidlecallback()" href="https://triple-underscore.github.io/requestidlecallback-ja.html#the-requestidlecallback-method">requestIdleCallback()</a></code>の方がよい選択である。 特に、次のレンダリングサイクルの前にコードを実行することが目標である場合、それは<code id="microtask-queuing:dom-animationframeprovider-requestanimationframe-2"><a href="imagebitmap-and-animations.html#dom-animationframeprovider-requestanimationframe">requestAnimationFrame()</a></code>の目的である。</p>

  <p>As can be seen from the following examples, the best way of thinking about <code id="microtask-queuing:dom-queuemicrotask-2"><a href="#dom-queuemicrotask">queueMicrotask()</a></code> is as a mechanism for rearranging synchronous code, effectively placing the queued code immediately after the currently executing synchronous JavaScript has run to completion.</p>

  <div class="example"><p><code id="microtask-queuing:dom-queuemicrotask-3"><a href="#dom-queuemicrotask">queueMicrotask()</a></code> 使用する最も一般的な理由は、情報が同期的に利用できる場合でも、過度の遅延を発生させることなく、一貫した順序を作成することである。</p>

   <p>たとえば、以前にロードされたデータの内部キャッシュも維持する、<code>load</code>イベントを発生させるカスタム要素について考えてみる。ナイーブな実装は次のようになるだろう：</p>

   <pre><code class='js'>MyElement<c- p>.</c->prototype<c- p>.</c->loadData <c- o>=</c-> <c- a>function</c-> <c- p>(</c->url<c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-><c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>])</c-> <c- p>{</c->
    <c- k>this</c-><c- p>.</c->_setData<c- p>(</c-><c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>]);</c->
    <c- k>this</c-><c- p>.</c->dispatchEvent<c- p>(</c-><c- k>new</c-> Event<c- p>(</c-><c- u>"load"</c-><c- p>));</c->
  <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
    fetch<c- p>(</c->url<c- p>).</c->then<c- p>(</c->res <c- p>=></c-> res<c- p>.</c->arrayBuffer<c- p>()).</c->then<c- p>(</c->data <c- p>=></c-> <c- p>{</c->
      <c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>]</c-> <c- o>=</c-> data<c- p>;</c->
      <c- k>this</c-><c- p>.</c->_setData<c- p>(</c->data<c- p>);</c->
      <c- k>this</c-><c- p>.</c->dispatchEvent<c- p>(</c-><c- k>new</c-> Event<c- p>(</c-><c- u>"load"</c-><c- p>));</c->
    <c- p>});</c->
  <c- p>}</c->
<c- p>};</c-></code></pre>

   <p>しかし、このナイーブな実装には、ユーザーに一貫性のない動作が発生するという問題がある。たとえば、次のようなコードは</p>

   <pre><code class='js'>element<c- p>.</c->addEventListener<c- p>(</c-><c- u>"load"</c-><c- p>,</c-> <c- p>()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- u>"loaded"</c-><c- p>));</c->
console<c- p>.</c->log<c- p>(</c-><c- u>"1"</c-><c- p>);</c->
element<c- p>.</c->loadData<c- p>();</c->
console<c- p>.</c->log<c- p>(</c-><c- u>"2"</c-><c- p>);</c-></code></pre>

   <p>"1, 2, loaded"（データをフェッチする必要がある場合）を記録することもあれば、"1, loaded, 2"（データがすでにキャッシュされている場合）を記録することもある。同様に、<code>loadData()</code>の呼び出し後、データが要素に設定されているかどうかは一貫性がない。</p>

   <p>一貫した順序を取得するためには、<code id="microtask-queuing:dom-queuemicrotask-4"><a href="#dom-queuemicrotask">queueMicrotask()</a></code>を使用できる：</p>

   <pre><code class='js'>MyElement<c- p>.</c->prototype<c- p>.</c->loadData <c- o>=</c-> <c- a>function</c-> <c- p>(</c->url<c- p>)</c-> <c- p>{</c->
  <c- k>if</c-> <c- p>(</c-><c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>])</c-> <c- p>{</c-><strong>
    queueMicrotask<c- p>(()</c-> <c- p>=></c-> <c- p>{</c->
      <c- k>this</c-><c- p>.</c->_setData<c- p>(</c-><c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>]);</c->
      <c- k>this</c-><c- p>.</c->dispatchEvent<c- p>(</c-><c- k>new</c-> Event<c- p>(</c-><c- u>"load"</c-><c- p>));</c->
    <c- p>});</c-></strong>
  <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
    fetch<c- p>(</c->url<c- p>).</c->then<c- p>(</c->res <c- p>=></c-> res<c- p>.</c->arrayBuffer<c- p>()).</c->then<c- p>(</c->data <c- p>=></c-> <c- p>{</c->
      <c- k>this</c-><c- p>.</c->_cache<c- p>[</c->url<c- p>]</c-> <c- o>=</c-> data<c- p>;</c->
      <c- k>this</c-><c- p>.</c->_setData<c- p>(</c->data<c- p>);</c->
      <c- k>this</c-><c- p>.</c->dispatchEvent<c- p>(</c-><c- k>new</c-> Event<c- p>(</c-><c- u>"load"</c-><c- p>));</c->
    <c- p>});</c->
  <c- p>}</c->
<c- p>};</c-></code></pre>

   <p>By essentially rearranging the queued code to be after the <a id="microtask-queuing:javascript-execution-context-stack-2" href="https://tc39.es/ecma262/#execution-context-stack" data-x-internal="javascript-execution-context-stack">JavaScript execution context stack</a> empties, this ensures a consistent ordering and update of the element's state.</p>
  </div>

  <div class="example"><p><code id="microtask-queuing:dom-queuemicrotask-5"><a href="#dom-queuemicrotask">queueMicrotask()</a></code>のもう1つの興味深い使用法は、 複数の呼び出し元による作業の調整されていない"バッチ処理"を可能にすることである。たとえば、できるだけ早くどこかにデータを送信したいが、簡単に回避できる場合は、 複数のネットワークリクエストを行いたくないライブラリ関数について考えてみる。このバランスをとる1つの方法は次のようになる：</p>

   <pre><code class='js'><c- a>const</c-> queuedToSend <c- o>=</c-> <c- p>[];</c->

<c- a>function</c-> sendData<c- p>(</c->data<c- p>)</c-> <c- p>{</c->
  queuedToSend<c- p>.</c->push<c- p>(</c->data<c- p>);</c->

  <c- k>if</c-> <c- p>(</c->queuedToSend<c- p>.</c->length <c- o>===</c-> <c- mf>1</c-><c- p>)</c-> <c- p>{</c->
    queueMicrotask<c- p>(()</c-> <c- p>=></c-> <c- p>{</c->
      <c- a>const</c-> stringToSend <c- o>=</c-> JSON<c- p>.</c->stringify<c- p>(</c->queuedToSend<c- p>);</c->
      queuedToSend<c- p>.</c->length <c- o>=</c-> <c- mf>0</c-><c- p>;</c->

      fetch<c- p>(</c-><c- u>"/endpoint"</c-><c- p>,</c-> stringToSend<c- p>);</c->
    <c- p>});</c->
  <c- p>}</c->
<c- p>}</c-></code></pre>

   <p>With this architecture, multiple subsequent calls to <code>sendData()</code> within the currently executing synchronous JavaScript will be batched together into one <code id="microtask-queuing:fetch()"><a data-x-internal="fetch()" href="https://triple-underscore.github.io/Fetch-ja.html#dom-global-fetch">fetch()</a></code> call, but with no intervening event loop tasks preempting the fetch (as would have happened with similar code that instead used <code id="microtask-queuing:dom-settimeout-2"><a href="#dom-settimeout">setTimeout()</a></code>).</p>
  </div>


  <h3 id="user-prompts"><span class="secno">8.8</span> ユーザープロンプト<a href="#user-prompts" class="self-link"></a></h3>

  

  <h4 id="simple-dialogs"><span class="secno">8.8.1</span> 単純ダイアログ<a href="#simple-dialogs" class="self-link"></a></h4>

  <dl class="domintro"><dt><var>window</var> . <code id="dom-alert-dev"><a href="#dom-alert">alert</a></code>(<var>message</var>)<div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/alert" title="window.alert() instructs the browser to display a dialog with an optional message, and to wait until the user dismisses the dialog.">Window/alert</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>3+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd><p>指定されたメッセージを持つモーダルアラートを表示し、それを命令するユーザーに対して待機する。</p>
   <dt><var>result</var> = <var>window</var> . <code id="dom-confirm-dev"><a href="#dom-confirm">confirm</a></code>(<var>message</var>)<div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/confirm" title="window.confirm() instructs the browser to display a dialog with an optional message, and to wait until the user either confirms or cancels the dialog.">Window/confirm</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>3+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd><p>与えられたメッセージとともにモーダルOK/Cancelプロンプトを表示し、それを命令するユーザーに対して待機し、ユーザーがOKをクリックした場合はtrueを返し、ユーザーがCancelをクリックする場合はfalseを返す。</p>
   <dt><var>result</var> = <var>window</var> . <code id="dom-prompt-dev"><a href="#dom-prompt">prompt</a></code>(<var>message</var> [, <var>default</var>] )<div class="mdn-anno wrapped before"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/prompt" title="window.prompt() instructs the browser to display a dialog with an optional message prompting the user to input some text, and to wait until the user either submits the text or cancels the dialog.">Window/prompt</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>3+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>4+</span></span><hr><span class="firefox_android yes"><span>Firefox Android</span><span>4+</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div><dd><p>与えられたメッセージとともにモーダルテキストコントロールプロンプトを表示し、ユーザーがそれを閉じるのを待ち、ユーザーが入力した値を返す。ユーザーがプロンプトをキャンセルした場合、代わりにnullを返す。2番目の引数が存在する場合、指定された値がデフォルトとして使用される。</p>
   </dl>

  <p class="note"><a id="simple-dialogs:media-data" href="media.html#media-data">メディアデータ</a>を読み込む<a href="media.html#media-element" id="simple-dialogs:media-element">メディア要素</a>のような、<a href="webappapis.html#concept-task" id="simple-dialogs:concept-task">タスク</a>または<a href="webappapis.html#microtask" id="simple-dialogs:microtask">マイクロタスク</a>に依存するロジックは、このメソッドが発動されるときに延期される。</p>

  

  <p>The <dfn data-dfn-for="Window" id="dom-alert-noargs" data-dfn-type="method"><code>alert()</code></dfn> and <dfn data-dfn-for="Window" id="dom-alert" data-dfn-type="method"><code>alert(<var>message</var>)</code></dfn> method steps are:</p>

  <ol><li><p>If we <a href="#cannot-show-simple-dialogs" id="simple-dialogs:cannot-show-simple-dialogs">cannot show simple dialogs</a> for <a id="simple-dialogs:this" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>, then return.<li><p>If the method was invoked with no arguments, then let <var>message</var> be the empty string; otherwise, let <var>message</var> be the method's first argument.<li><p>Set <var>message</var> to the result of <a href="https://triple-underscore.github.io/infra-ja.html#normalize-newlines" id="simple-dialogs:normalize-newlines" data-x-internal="normalize-newlines">normalizing newlines</a> given <var>message</var>.<li><p>Set <var>message</var> to the result of <a href="#optionally-truncate-a-simple-dialog-string" id="simple-dialogs:optionally-truncate-a-simple-dialog-string">optionally truncating</a> <var>message</var>.<li><p>Show <var>message</var> to the user, treating U+000A LF as a line break.<li><p>Optionally, <a id="simple-dialogs:pause" href="webappapis.html#pause">pause</a> while waiting for the user to acknowledge the message.</ol>

  <p class="note">This method is defined using two overloads, instead of using an optional argument, for historical reasons. The practical impact of this is that <code class="js">alert(undefined)</code> is treated as <code class="js">alert("undefined")</code>, but <code class="js">alert()</code> is treated as <code class="js">alert("")</code>.</p>

  <p>The <dfn data-dfn-for="Window" id="dom-confirm" data-dfn-type="method"><code>confirm(<var>message</var>)</code></dfn> method steps are:</p>

  <ol><li><p>If we <a href="#cannot-show-simple-dialogs" id="simple-dialogs:cannot-show-simple-dialogs-2">cannot show simple dialogs</a> for <a id="simple-dialogs:this-2" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>, then return false.<li><p>Set <var>message</var> to the result of <a href="https://triple-underscore.github.io/infra-ja.html#normalize-newlines" id="simple-dialogs:normalize-newlines-2" data-x-internal="normalize-newlines">normalizing newlines</a> given <var>message</var>.<li><p>Set <var>message</var> to the result of <a href="#optionally-truncate-a-simple-dialog-string" id="simple-dialogs:optionally-truncate-a-simple-dialog-string-2">optionally truncating</a> <var>message</var>.<li><p>Show <var>message</var> to the user, treating U+000A LF as a line break, and ask the user to respond with a positive or negative response.<li><p><a id="simple-dialogs:pause-2" href="webappapis.html#pause">Pause</a> until the user responds either positively or negatively.<li><p>If the user responded positively, return true; otherwise, the user responded negatively: return false.</ol>

  <p>The <dfn data-dfn-for="Window" id="dom-prompt" data-dfn-type="method"><code>prompt(<var>message</var>, <var>default</var>)</code></dfn> method steps are:</p>

  <ol><li><p>If we <a href="#cannot-show-simple-dialogs" id="simple-dialogs:cannot-show-simple-dialogs-3">cannot show simple dialogs</a> for <a id="simple-dialogs:this-3" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>, then return null.<li><p>Set <var>message</var> to the result of <a href="https://triple-underscore.github.io/infra-ja.html#normalize-newlines" id="simple-dialogs:normalize-newlines-3" data-x-internal="normalize-newlines">normalizing newlines</a> given <var>message</var>.<li><p>Set <var>message</var> to the result of <a href="#optionally-truncate-a-simple-dialog-string" id="simple-dialogs:optionally-truncate-a-simple-dialog-string-3">optionally truncating</a> <var>message</var>.<li><p>Set <var>default</var> to the result of <a href="#optionally-truncate-a-simple-dialog-string" id="simple-dialogs:optionally-truncate-a-simple-dialog-string-4">optionally truncating</a> <var>default</var>.<li><p>Show <var>message</var> to the user, treating U+000A LF as a line break, and ask the user to either respond with a string value or abort. The response must be defaulted to the value given by <var>default</var>.<li><p><a id="simple-dialogs:pause-3" href="webappapis.html#pause">Pause</a> while waiting for the user's response.<li><p>If the user aborts, then return null; otherwise, return the string that the user responded with.</ol>

  <p>To <dfn id="optionally-truncate-a-simple-dialog-string">optionally truncate a simple dialog string</dfn> <var>s</var>, return either <var>s</var> itself or some string derived from <var>s</var> that is shorter. User agents should not provide UI for displaying the elided portion of <var>s</var>, as this makes it too easy for abusers to create dialogs of the form "Important security alert! Click 'Show More' for full details!".</p>

  <p class="note">For example, a user agent might want to only display the first 100 characters of a message. Or, a user agent might replace the middle of the string with "…". These types of modifications can be useful in limiting the abuse potential of unnaturally large, trustworthy-looking system dialogs.</p>

  <p>We <dfn id="cannot-show-simple-dialogs">cannot show simple dialogs</dfn> for a <code id="simple-dialogs:window"><a href="window-object.html#window">Window</a></code> <var>window</var> when the following algorithm returns true:</p>

  <ol><li><p>If the <a id="simple-dialogs:active-sandboxing-flag-set" href="origin.html#active-sandboxing-flag-set">active sandboxing flag set</a> of <var>window</var>'s <a href="window-object.html#concept-document-window" id="simple-dialogs:concept-document-window">associated <code>Document</code></a> has the <a id="simple-dialogs:sandboxed-modals-flag" href="origin.html#sandboxed-modals-flag">sandboxed modals flag</a> set, then return true.<li><p>If <var>window</var>'s <a id="simple-dialogs:relevant-settings-object" href="webappapis.html#relevant-settings-object">relevant settings object</a>'s <a href="webappapis.html#concept-settings-object-origin" id="simple-dialogs:concept-settings-object-origin">origin</a> and <var>window</var>'s <a id="simple-dialogs:relevant-settings-object-2" href="webappapis.html#relevant-settings-object">relevant settings object</a>'s <a id="simple-dialogs:concept-environment-top-level-origin" href="webappapis.html#concept-environment-top-level-origin">top-level origin</a> are not <a id="simple-dialogs:same-origin-domain" href="origin.html#same-origin-domain">same origin-domain</a>, then return true.<li>If <var>window</var>'s <a id="simple-dialogs:relevant-agent" href="webappapis.html#relevant-agent">relevant agent</a>'s <a href="webappapis.html#concept-agent-event-loop" id="simple-dialogs:concept-agent-event-loop">event loop</a>'s <a id="simple-dialogs:termination-nesting-level" href="browsing-the-web.html#termination-nesting-level">termination nesting level</a> is nonzero, then optionally return true.<li><p>Optionally, return true. (For example, the user agent might give the user the option to ignore all modal dialogs, and would thus abort at this step whenever the method was invoked.)<li><p>falseを返す。</ol>

  


  <h4 id="printing"><span class="secno">8.8.2</span> 印刷<a href="#printing" class="self-link"></a></h4><div class="mdn-anno wrapped"><button onclick="toggleStatus(this)" class="mdn-anno-btn"><b title="Support in all current engines." class="all-engines-flag">✔</b><span>MDN</span></button><div class="feature"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/print" title="Opens the Print Dialog to print the current document.">Window/print</a><p class="all-engines-text">Support in all current engines.<div class="support"><span class="firefox yes"><span>Firefox</span><span>1+</span></span><span class="safari yes"><span>Safari</span><span>1.1+</span></span><span class="chrome yes"><span>Chrome</span><span>1+</span></span><hr><span class="opera yes"><span>Opera</span><span>6+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span><hr><span class="edge yes"><span>Edge (Legacy)</span><span>12+</span></span><span class="ie yes"><span>Internet Explorer</span><span>5+</span></span><hr><span class="firefox_android no"><span>Firefox Android</span><span>No</span></span><span class="safari_ios yes"><span>Safari iOS</span><span>1+</span></span><span class="chrome_android yes"><span>Chrome Android</span><span>18+</span></span><span class="webview_android yes"><span>WebView Android</span><span>1+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>1.0+</span></span><span class="opera_android yes"><span>Opera Android</span><span>10.1+</span></span></div></div></div>

  <dl class="domintro"><dt><var>window</var> . <code id="dom-print-dev"><a href="#dom-print">print</a></code>()<dd><p>ページを印刷するようユーザーに指示する。</p>
   </dl>

  

  <p>The <dfn data-dfn-for="Window" id="dom-print" data-dfn-type="method"><code>print()</code></dfn> method steps are:</p>

  <ol><li><p>Let <var>document</var> be <a id="printing:this" href="https://triple-underscore.github.io/WebIDL-ja.html#this" data-x-internal="this">this</a>'s <a href="window-object.html#concept-document-window" id="printing:concept-document-window">associated <code>Document</code></a>.<li><p>If <var>document</var> is not <a id="printing:fully-active" href="browsers.html#fully-active">fully active</a>, then return.<li><p>If <var>document</var>'s <a id="printing:unload-counter" href="browsing-the-web.html#unload-counter">unload counter</a> is greater than 0, then return.<li><p>If <var>document</var> is <a id="printing:ready-for-post-load-tasks" href="parsing.html#ready-for-post-load-tasks">ready for post-load tasks</a>, then run the <a href="#printing-steps" id="printing:printing-steps">printing steps</a> for <var>document</var>.<li><p>Otherwise, set <var>document</var>'s <dfn id="print-when-loaded">print when loaded</dfn> flag.</ol>

  <p>User agents should also run the <a href="#printing-steps" id="printing:printing-steps-2">printing steps</a> whenever the user asks for the opportunity to <a id="printing:obtain-a-physical-form" href="rendering.html#obtain-a-physical-form">obtain a physical form</a> (e.g. printed copy), or the representation of a physical form (e.g. PDF copy), of a document.</p>

  <p>The <dfn id="printing-steps">printing steps</dfn> for a <code id="printing:document"><a href="dom.html#document">Document</a></code> <var>document</var> are:</p>

  <ol><li><p>The user agent may display a message to the user or return (or both).</p>

    <p class="example">For instance, a kiosk browser could silently ignore any invocations of the <code id="printing:dom-print"><a href="#dom-print">print()</a></code> method.</p>

    <p class="example">For instance, a browser on a mobile device could detect that there are no printers in the vicinity and display a message saying so before continuing to offer a "save to PDF" option.</p>
   <li><p>If the <a id="printing:active-sandboxing-flag-set" href="origin.html#active-sandboxing-flag-set">active sandboxing flag set</a> of <var>document</var> has the <a id="printing:sandboxed-modals-flag" href="origin.html#sandboxed-modals-flag">sandboxed modals flag</a> set, then return.</p>

    <p class="note">If the printing dialog is blocked by a <code id="printing:document-2"><a href="dom.html#document">Document</a></code>'s sandbox, then neither the <code id="printing:event-beforeprint"><a href="indices.html#event-beforeprint">beforeprint</a></code> nor <code id="printing:event-afterprint"><a href="indices.html#event-afterprint">afterprint</a></code> events will be fired.</p>
   <li><p>The user agent must <a href="https://triple-underscore.github.io/DOM4-ja.html#concept-event-fire" id="printing:concept-event-fire" data-x-internal="concept-event-fire">fire an event</a> named <code id="printing:event-beforeprint-2"><a href="indices.html#event-beforeprint">beforeprint</a></code> at the <a id="printing:concept-relevant-global" href="webappapis.html#concept-relevant-global">relevant global object</a> of <var>document</var>, as well as any <a href="browsers.html#child-browsing-context" id="printing:child-browsing-context">child browsing contexts</a> in it.</p>

    <p class="example">The <code id="printing:event-beforeprint-3"><a href="indices.html#event-beforeprint">beforeprint</a></code> event can be used to annotate the printed copy, for instance adding the time at which the document was printed.</p>
   <li><p>The user agent should offer the user the opportunity to <a id="printing:obtain-a-physical-form-2" href="rendering.html#obtain-a-physical-form">obtain a physical form</a> (or the representation of a physical form) of <var>document</var>. The user agent may wait for the user to either accept or decline before returning; if so, the user agent must <a id="printing:pause" href="webappapis.html#pause">pause</a> while the method is waiting. Even if the user agent doesn't wait at this point, the user agent must use the state of the relevant documents as they are at this point in the algorithm if and when it eventually creates the alternate form.<li><p>The user agent must <a href="https://triple-underscore.github.io/DOM4-ja.html#concept-event-fire" id="printing:concept-event-fire-2" data-x-internal="concept-event-fire">fire an event</a> named <code id="printing:event-afterprint-2"><a href="indices.html#event-afterprint">afterprint</a></code> at the <a id="printing:concept-relevant-global-2" href="webappapis.html#concept-relevant-global">relevant global object</a> of <var>document</var>, as well as any <a href="browsers.html#child-browsing-context" id="printing:child-browsing-context-2">child browsing contexts</a> in it.</p>

    <p class="example">The <code id="printing:event-afterprint-3"><a href="indices.html#event-afterprint">afterprint</a></code> event can be used to revert annotations added in the earlier event, as well as showing post-printing UI. For instance, if a page is walking the user through the steps of applying for a home loan, the script could automatically advance to the next step after having printed a form or other.</p>
   </ol>

  


  <nav><a href="dynamic-markup-insertion.html">← 8.4 動的マークアップの挿入</a> — <a href="./">目次</a> — <a href="system-state.html">8.9 システム状態および性能 →</a></nav>
